"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const Baseof_1 = __importDefault(require("@layouts/Baseof"));
const button_1 = require("@components/chat/ui/button");
const icons_1 = require("@components/chat/ui/icons");
const lanceDbStorageSkills_1 = require("../../../../src/skills/lanceDbStorageSkills"); // Adjust path
const DocTypeFilter_1 = __importDefault(require("@components/Search/DocTypeFilter"));
const DateRangeFilter_1 = __importDefault(require("@components/Search/DateRangeFilter"));
const MetadataFilter_1 = __importDefault(require("@components/Search/MetadataFilter"));
const SearchResultsDisplay_1 = __importDefault(require("@components/chat/custom/SearchResultsDisplay"));
const SearchPage = () => {
    const [userId] = (0, react_1.useState)("test-user-123"); // Placeholder
    const [searchTerm, setSearchTerm] = (0, react_1.useState)('');
    const [filters, setFilters] = (0, react_1.useState)({});
    const [results, setResults] = (0, react_1.useState)([]);
    const [isLoading, setIsLoading] = (0, react_1.useState)(false);
    const [error, setError] = (0, react_1.useState)(null);
    const handleSearch = (0, react_1.useCallback)(async () => {
        if (!searchTerm.trim()) {
            setError("Please enter a search term.");
            return;
        }
        setIsLoading(true);
        setError(null);
        setResults([]);
        try {
            const response = await (0, lanceDbStorageSkills_1.hybridSearch)(userId, searchTerm, {
                semanticLimit: 10,
                keywordLimit: 20,
                filters: filters,
            });
            if (response.ok && response.data) {
                setResults(response.data);
            }
            else {
                setError(response.error?.message || "An unknown error occurred during search.");
            }
        }
        catch (e) {
            setError(e.message || "An unexpected exception occurred.");
        }
        finally {
            setIsLoading(false);
        }
    }, [userId, searchTerm, filters]);
    const handleFilterChange = (update) => {
        setFilters(prev => ({ ...prev, ...update }));
    };
    return ((0, jsx_runtime_1.jsx)(Baseof_1.default, { title: "Advanced Search", children: (0, jsx_runtime_1.jsx)("div", { className: "container mx-auto p-4 md:p-6 lg:p-8", children: (0, jsx_runtime_1.jsxs)("div", { className: "max-w-4xl mx-auto", children: [(0, jsx_runtime_1.jsx)("h1", { className: "text-3xl font-bold mb-2 text-gray-800 dark:text-gray-100", children: "Advanced Search" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-600 dark:text-gray-400 mb-6", children: "Search and filter your entire knowledge base using keywords and specific criteria." }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 mb-4", children: [(0, jsx_runtime_1.jsx)("input", { type: "text", value: searchTerm, onChange: (e) => setSearchTerm(e.target.value), onKeyDown: (e) => e.key === 'Enter' && handleSearch(), placeholder: "Search for keywords...", className: "flex-grow text-base p-2 rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 shadow-sm focus:border-sky-500 focus:ring-sky-500" }), (0, jsx_runtime_1.jsxs)(button_1.Button, { onClick: handleSearch, disabled: isLoading, children: [(0, jsx_runtime_1.jsx)(icons_1.IconSearch, { className: "mr-2 h-4 w-4" }), isLoading ? 'Searching...' : 'Search'] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-4 mb-8", children: [(0, jsx_runtime_1.jsx)(DocTypeFilter_1.default, { selectedTypes: filters.doc_types || [], onChange: (doc_types) => handleFilterChange({ doc_types }) }), (0, jsx_runtime_1.jsx)(DateRangeFilter_1.default, { filters: filters, onChange: handleFilterChange }), (0, jsx_runtime_1.jsx)(MetadataFilter_1.default, { properties: filters.metadata_properties || {}, onChange: (metadata_properties) => handleFilterChange({ metadata_properties }) })] }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("h2", { className: "text-2xl font-bold border-b pb-2 mb-4 dark:border-gray-600", children: "Results" }), error && (0, jsx_runtime_1.jsxs)("p", { className: "text-red-500", children: ["Error: ", error] }), isLoading && (0, jsx_runtime_1.jsx)("p", { children: "Loading results..." }), !isLoading && !error && ((0, jsx_runtime_1.jsx)(SearchResultsDisplay_1.default, { results: results }))] })] }) }) }));
};
exports.default = SearchPage;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsaUNBQXFEO0FBQ3JELDZEQUFxQztBQUNyQyx1REFBb0Q7QUFDcEQscURBQXVEO0FBRXZELHNGQUEyRSxDQUFDLGNBQWM7QUFDMUYscUZBQTZEO0FBQzdELHlGQUFpRTtBQUNqRSx1RkFBK0Q7QUFDL0Qsd0dBQWdGO0FBRWhGLE1BQU0sVUFBVSxHQUFhLEdBQUcsRUFBRTtJQUNoQyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFTLGVBQWUsQ0FBQyxDQUFDLENBQUMsY0FBYztJQUNsRSxNQUFNLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBUyxFQUFFLENBQUMsQ0FBQztJQUN6RCxNQUFNLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBc0IsRUFBRSxDQUFDLENBQUM7SUFDaEUsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQTJCLEVBQUUsQ0FBQyxDQUFDO0lBQ3JFLE1BQU0sQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFVLEtBQUssQ0FBQyxDQUFDO0lBQzNELE1BQU0sQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFnQixJQUFJLENBQUMsQ0FBQztJQUV4RCxNQUFNLFlBQVksR0FBRyxJQUFBLG1CQUFXLEVBQUMsS0FBSyxJQUFJLEVBQUU7UUFDMUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDO1lBQ3ZCLFFBQVEsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO1lBQ3hDLE9BQU87UUFDVCxDQUFDO1FBQ0QsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ25CLFFBQVEsQ0FBQyxJQUFJLENBQUMs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S0FBSyxJQUFJLCtCQUFHLFNBQVMsRUFBQyxjQUFjLHdCQUFTLEtBQUssSUFBSyxFQUN2RCxTQUFTLElBQUksK0RBQXlCLEVBQ3RDLENBQUMsU0FBUyxJQUFJLENBQUMsS0FBSyxJQUFJLENBQ3ZCLHVCQUFDLDhCQUFvQixJQUFDLE9BQU8sRUFBRSxPQUFPLEdBQUksQ0FDM0MsSUFDRyxJQUNGLEdBQ0YsR0FDQyxDQUNWLENBQUM7QUFDSixDQUFDLENBQUM7QUFFRixrQkFBZSxVQUFVLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IEJhc2VvZiBmcm9tICdAbGF5b3V0cy9CYXNlb2YnO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnQGNvbXBvbmVudHMvY2hhdC91aS9idXR0b24nO1xuaW1wb3J0IHsgSWNvblNlYXJjaCB9IGZyb20gJ0Bjb21wb25lbnRzL2NoYXQvdWkvaWNvbnMnO1xuaW1wb3J0IHsgSHlicmlkU2VhcmNoRmlsdGVycywgSHlicmlkU2VhcmNoUmVzdWx0SXRlbSB9IGZyb20gJ0BsaWIvZGF0YVR5cGVzL1NlYXJjaFJlc3VsdHNUeXBlcyc7IC8vIEFkanVzdCBwYXRoXG5pbXBvcnQgeyBoeWJyaWRTZWFyY2ggfSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvc2tpbGxzL2xhbmNlRGJTdG9yYWdlU2tpbGxzJzsgLy8gQWRqdXN0IHBhdGhcbmltcG9ydCBEb2NUeXBlRmlsdGVyIGZyb20gJ0Bjb21wb25lbnRzL1NlYXJjaC9Eb2NUeXBlRmlsdGVyJztcbmltcG9ydCBEYXRlUmFuZ2VGaWx0ZXIgZnJvbSAnQGNvbXBvbmVudHMvU2VhcmNoL0RhdGVSYW5nZUZpbHRlcic7XG5pbXBvcnQgTWV0YWRhdGFGaWx0ZXIgZnJvbSAnQGNvbXBvbmVudHMvU2VhcmNoL01ldGFkYXRhRmlsdGVyJztcbmltcG9ydCBTZWFyY2hSZXN1bHRzRGlzcGxheSBmcm9tICdAY29tcG9uZW50cy9jaGF0L2N1c3RvbS9TZWFyY2hSZXN1bHRzRGlzcGxheSc7XG5cbmNvbnN0IFNlYXJjaFBhZ2U6IFJlYWN0LkZDID0gKCkgPT4ge1xuICBjb25zdCBbdXNlcklkXSA9IHVzZVN0YXRlPHN0cmluZz4oXCJ0ZXN0LXVzZXItMTIzXCIpOyAvLyBQbGFjZWhvbGRlclxuICBjb25zdCBbc2VhcmNoVGVybSwgc2V0U2VhcmNoVGVybV0gPSB1c2VTdGF0ZTxzdHJpbmc+KCcnKTtcbiAgY29uc3QgW2ZpbHRlcnMsIHNldEZpbHRlcnNdID0gdXNlU3RhdGU8SHlicmlkU2VhcmNoRmlsdGVycz4oe30pO1xuICBjb25zdCBbcmVzdWx0cywgc2V0UmVzdWx0c10gPSB1c2VTdGF0ZTxIeWJyaWRTZWFyY2hSZXN1bHRJdGVtW10+KFtdKTtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcblxuICBjb25zdCBoYW5kbGVTZWFyY2ggPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XG4gICAgaWYgKCFzZWFyY2hUZXJtLnRyaW0oKSkge1xuICAgICAgc2V0RXJyb3IoXCJQbGVhc2UgZW50ZXIgYSBzZWFyY2ggdGVybS5cIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICBzZXRFcnJvcihudWxsKTtcbiAgICBzZXRSZXN1bHRzKFtdKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGh5YnJpZFNlYXJjaCh1c2VySWQsIHNlYXJjaFRlcm0sIHtcbiAgICAgICAgc2VtYW50aWNMaW1pdDogMTAsXG4gICAgICAgIGtleXdvcmRMaW1pdDogMjAsXG4gICAgICAgIGZpbHRlcnM6IGZpbHRlcnMsXG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlc3BvbnNlLm9rICYmIHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgc2V0UmVzdWx0cyhyZXNwb25zZS5kYXRhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldEVycm9yKHJlc3BvbnNlLmVycm9yPy5tZXNzYWdlIHx8IFwiQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCBkdXJpbmcgc2VhcmNoLlwiKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlOiBhbnkpIHtcbiAgICAgIHNldEVycm9yKGUubWVzc2FnZSB8fCBcIkFuIHVuZXhwZWN0ZWQgZXhjZXB0aW9uIG9jY3VycmVkLlwiKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICB9XG4gIH0sIFt1c2VySWQsIHNlYXJjaFRlcm0sIGZpbHRlcnNdKTtcblxuICBjb25zdCBoYW5kbGVGaWx0ZXJDaGFuZ2UgPSAodXBkYXRlOiBQYXJ0aWFsPEh5YnJpZFNlYXJjaEZpbHRlcnM+KSA9PiB7XG4gICAgc2V0RmlsdGVycyhwcmV2ID0+ICh7IC4uLnByZXYsIC4uLnVwZGF0ZSB9KSk7XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8QmFzZW9mIHRpdGxlPVwiQWR2YW5jZWQgU2VhcmNoXCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRhaW5lciBteC1hdXRvIHAtNCBtZDpwLTYgbGc6cC04XCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWF4LXctNHhsIG14LWF1dG9cIj5cbiAgICAgICAgICA8aDEgY2xhc3NOYW1lPVwidGV4dC0zeGwgZm9udC1ib2xkIG1iLTIgdGV4dC1ncmF5LTgwMCBkYXJrOnRleHQtZ3JheS0xMDBcIj5cbiAgICAgICAgICAgIEFkdmFuY2VkIFNlYXJjaFxuICAgICAgICAgIDwvaDE+XG4gICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTYwMCBkYXJrOnRleHQtZ3JheS00MDAgbWItNlwiPlxuICAgICAgICAgICAgU2VhcmNoIGFuZCBmaWx0ZXIgeW91ciBlbnRpcmUga25vd2xlZGdlIGJhc2UgdXNpbmcga2V5d29yZHMgYW5kIHNwZWNpZmljIGNyaXRlcmlhLlxuICAgICAgICAgIDwvcD5cblxuICAgICAgICAgIHsvKiBTZWFyY2ggQmFyICovfVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgbWItNFwiPlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgdmFsdWU9e3NlYXJjaFRlcm19XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0U2VhcmNoVGVybShlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgIG9uS2V5RG93bj17KGUpID0+IGUua2V5ID09PSAnRW50ZXInICYmIGhhbmRsZVNlYXJjaCgpfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlNlYXJjaCBmb3Iga2V5d29yZHMuLi5cIlxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4LWdyb3cgdGV4dC1iYXNlIHAtMiByb3VuZGVkLW1kIGJvcmRlci1ncmF5LTMwMCBkYXJrOmJvcmRlci1ncmF5LTYwMCBiZy13aGl0ZSBkYXJrOmJnLWdyYXktNzAwIHNoYWRvdy1zbSBmb2N1czpib3JkZXItc2t5LTUwMCBmb2N1czpyaW5nLXNreS01MDBcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17aGFuZGxlU2VhcmNofSBkaXNhYmxlZD17aXNMb2FkaW5nfT5cbiAgICAgICAgICAgICAgPEljb25TZWFyY2ggY2xhc3NOYW1lPVwibXItMiBoLTQgdy00XCIgLz5cbiAgICAgICAgICAgICAge2lzTG9hZGluZyA/ICdTZWFyY2hpbmcuLi4nIDogJ1NlYXJjaCd9XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIHsvKiBGaWx0ZXJzIFNlY3Rpb24gKi99XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTQgbWItOFwiPlxuICAgICAgICAgICAgPERvY1R5cGVGaWx0ZXJcbiAgICAgICAgICAgICAgc2VsZWN0ZWRUeXBlcz17ZmlsdGVycy5kb2NfdHlwZXMgfHwgW119XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZG9jX3R5cGVzKSA9PiBoYW5kbGVGaWx0ZXJDaGFuZ2UoeyBkb2NfdHlwZXMgfSl9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPERhdGVSYW5nZUZpbHRlclxuICAgICAgICAgICAgICBmaWx0ZXJzPXtmaWx0ZXJzfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlRmlsdGVyQ2hhbmdlfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxNZXRhZGF0YUZpbHRlclxuICAgICAgICAgICAgICBwcm9wZXJ0aWVzPXtmaWx0ZXJzLm1ldGFkYXRhX3Byb3BlcnRpZXMgfHwge319XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsobWV0YWRhdGFfcHJvcGVydGllcykgPT4gaGFuZGxlRmlsdGVyQ2hhbmdlKHsgbWV0YWRhdGFfcHJvcGVydGllcyB9KX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICB7LyogUmVzdWx0cyBTZWN0aW9uICovfVxuICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwidGV4dC0yeGwgZm9udC1ib2xkIGJvcmRlci1iIHBiLTIgbWItNCBkYXJrOmJvcmRlci1ncmF5LTYwMFwiPlJlc3VsdHM8L2gyPlxuICAgICAgICAgICAge2Vycm9yICYmIDxwIGNsYXNzTmFtZT1cInRleHQtcmVkLTUwMFwiPkVycm9yOiB7ZXJyb3J9PC9wPn1cbiAgICAgICAgICAgIHtpc0xvYWRpbmcgJiYgPHA+TG9hZGluZyByZXN1bHRzLi4uPC9wPn1cbiAgICAgICAgICAgIHshaXNMb2FkaW5nICYmICFlcnJvciAmJiAoXG4gICAgICAgICAgICAgIDxTZWFyY2hSZXN1bHRzRGlzcGxheSByZXN1bHRzPXtyZXN1bHRzfSAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L0Jhc2VvZj5cbiAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFNlYXJjaFBhZ2U7XG4iXX0=