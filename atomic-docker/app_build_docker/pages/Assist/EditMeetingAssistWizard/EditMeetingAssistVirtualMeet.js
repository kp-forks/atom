"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getServerSideProps = getServerSideProps;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const Switch_1 = __importDefault(require("@components/Switch"));
const Box_1 = __importDefault(require("@components/common/Box"));
const Text_1 = __importDefault(require("@components/common/Text"));
const supertokens_node_1 = __importDefault(require("supertokens-node"));
const backendConfig_1 = require("../../../config/backendConfig");
const session_1 = __importDefault(require("supertokens-node/recipe/session"));
async function getServerSideProps({ req, res }) {
    // Notice how the server uses `API` from `withSSRContext`, instead of the top-level `API`.
    // const SSR = withSSRContext({ req })
    // this runs on the backend, so we must call init on supertokens-node SDK
    supertokens_node_1.default.init((0, backendConfig_1.backendConfig)());
    let session;
    try {
        session = await session_1.default.getSession(req, res, {
            overrideGlobalClaimValidators: async function () {
                return [];
            },
        });
    }
    catch (err) {
        if (err.type === session_1.default.Error.TRY_REFRESH_TOKEN) {
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        else if (err.type === session_1.default.Error.UNAUTHORISED) {
            // this will force the frontend to try and refresh which will fail
            // clearing all cookies and redirecting the user to the login screen.
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        throw err;
    }
    if (!session?.getUserId()) {
        return {
            redirect: {
                destination: '/User/Login/UserLogin',
                permanent: false,
            },
        };
    }
    return {
        props: {
            sub: session.getUserId(),
        }
    };
}
function EditMeetingAssistVirtualMeet(props) {
    const [zoomMeet, setZoomMeet] = (0, react_1.useState)(props?.zoomMeet);
    const [googleMeet, setGoogleMeet] = (0, react_1.useState)(props?.googleMeet);
    const [enableConference, setEnableConference] = (0, react_1.useState)(props?.enableConference);
    const [notAvailable, setNotAvailable] = (0, react_1.useState)(false);
    const isZoomAvailable = props?.isZoomAvailable;
    const isGoogleMeetAvailable = props?.isGoogleMeetAvailable;
    const setParentZoomMeet = props?.setParentZoomMeet;
    const setParentGoogleMeet = props?.setParentGoogleMeet;
    const setParentConferenceApp = props?.setParentConferenceApp;
    const onEnableVirtual = (value) => {
        setEnableConference(value);
        if (!isZoomAvailable && !isGoogleMeetAvailable) {
            setNotAvailable(true);
            setParentConferenceApp(null);
        }
        else {
            setNotAvailable(false);
        }
        if (value === false) {
            setParentConferenceApp(null);
        }
    };
    const onZoomMeet = (value) => {
        setZoomMeet(value);
        setParentZoomMeet(value);
        setGoogleMeet(!value);
        setParentGoogleMeet(!value);
        if (value) {
            setParentConferenceApp('zoom');
        }
        else {
            setParentConferenceApp('google');
        }
    };
    const onGoogleMeet = (value) => {
        setGoogleMeet(value);
        setParentGoogleMeet(value);
        setZoomMeet(!value);
        setParentZoomMeet(!value);
        if (value) {
            setParentConferenceApp('google');
        }
        else {
            setParentConferenceApp('zoom');
        }
    };
    return ((0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", children: [(0, jsx_runtime_1.jsxs)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", pt: { phone: 'm', tablet: 's' }, children: "Enable a virtual meeting for this event?" }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { checked: enableConference, onValueChange: onEnableVirtual, style: { marginBottom: 20 } }) })] }), (0, jsx_runtime_1.jsx)(Box_1.default, { children: notAvailable
                    ? ((0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "subheader", children: "3rd party providers are not enabled. Please enable either zoom or google to use this feature." }) })) : ((0, jsx_runtime_1.jsx)(Box_1.default, { children: enableConference
                        ? ((0, jsx_runtime_1.jsxs)(Box_1.default, { children: [(0, jsx_runtime_1.jsx)(Box_1.default, { children: isZoomAvailable
                                        ? ((0, jsx_runtime_1.jsxs)(Box_1.default, { children: [(0, jsx_runtime_1.jsxs)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", pt: { phone: 'm', tablet: 's' }, children: "Enable a Zoom Meeting for this event?" }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { checked: zoomMeet, onValueChange: onZoomMeet, style: { marginBottom: 20 } }) })] }), (0, jsx_runtime_1.jsx)(Box_1.default, {})] })) : null }), (0, jsx_runtime_1.jsx)(Box_1.default, { children: isGoogleMeetAvailable
                                        ? ((0, jsx_runtime_1.jsxs)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", pt: { phone: 'm', tablet: 's' }, children: "Enable a Google Meet for this event?" }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { checked: googleMeet, onValueChange: onGoogleMeet, style: { marginBottom: 20 } }) })] })) : null })] })) : null })) })] }));
}
exports.default = EditMeetingAssistVirtualMeet;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRWRpdE1lZXRpbmdBc3Npc3RWaXJ0dWFsTWVldC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkVkaXRNZWV0aW5nQXNzaXN0VmlydHVhbE1lZXQudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBZUEsZ0RBcUNDOztBQXBERCxpQ0FJZ0I7QUFDZCxnRUFBd0M7QUFDeEMsaUVBQXdDO0FBQ3hDLG1FQUEwQztBQUk1Qyx3RUFBOEM7QUFDOUMsaUVBQTZEO0FBQzdELDhFQUFxRDtBQUU5QyxLQUFLLFVBQVUsa0JBQWtCLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFpRDtJQUNsRywwRkFBMEY7SUFDMUYsc0NBQXNDO0lBQ3RDLHlFQUF5RTtJQUN6RSwwQkFBZSxDQUFDLElBQUksQ0FBQyxJQUFBLDZCQUFhLEdBQUUsQ0FBQyxDQUFBO0lBQ3JDLElBQUksT0FBTyxDQUFBO0lBQ1gsSUFBSSxDQUFDO1FBQ0gsT0FBTyxHQUFHLE1BQU0saUJBQU8sQ0FBQyxVQUFVLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRTtZQUMzQyw2QkFBNkIsRUFBRSxLQUFLO2dCQUNsQyxPQUFPLEVBQUUsQ0FBQTtZQUNYLENBQUM7U0FDRixDQUFDLENBQUE7SUFDSixDQUFDO0lBQUMsT0FBTyxHQUFRLEVBQUUsQ0FBQztRQUNsQixJQUFJLEdBQUcsQ0FBQyxJQUFJLEtBQUssaUJBQU8sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUNqRCxPQUFPLEVBQUUsS0FBSyxFQUFFLEVBQUUsZUFBZSxFQUFFLGVBQWUsRUFBRSxFQUFFLENBQUE7UUFDeEQsQ0FBQzthQUFNLElBQUksR0FBRyxDQUFDLElBQUksS0FBSyxpQkFBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsQ0FBQztZQUNuRCxrRUFBa0U7WUFDbEUscUVBQXFFO1lBQ3JFLE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBRSxlQUFlLEVBQUUsZUFBZSxFQUFFLEVBQUUsQ0FBQTtRQUN4RCxDQUFD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b3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHtcbiAgICB1c2VTdGF0ZSxcbiAgICBEaXNwYXRjaCxcbiAgICBTZXRTdGF0ZUFjdGlvbixcbiAgfSBmcm9tICdyZWFjdCdcbiAgaW1wb3J0IFN3aXRjaDEgZnJvbSAnQGNvbXBvbmVudHMvU3dpdGNoJ1xuICBpbXBvcnQgQm94IGZyb20gJ0Bjb21wb25lbnRzL2NvbW1vbi9Cb3gnXG4gIGltcG9ydCBUZXh0IGZyb20gJ0Bjb21wb25lbnRzL2NvbW1vbi9UZXh0J1xuICBpbXBvcnQgeyBDb25mZXJlbmNlQXBwVHlwZSB9IGZyb20gJ0BsaWIvZGF0YVR5cGVzL01lZXRpbmdBc3Npc3RUeXBlJ1xuXG5pbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgc3VwZXJ0b2tlbnNOb2RlIGZyb20gJ3N1cGVydG9rZW5zLW5vZGUnXG5pbXBvcnQgeyBiYWNrZW5kQ29uZmlnIH0gZnJvbSAnLi4vLi4vLi4vY29uZmlnL2JhY2tlbmRDb25maWcnXG5pbXBvcnQgU2Vzc2lvbiBmcm9tICdzdXBlcnRva2Vucy1ub2RlL3JlY2lwZS9zZXNzaW9uJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2VydmVyU2lkZVByb3BzKHsgcmVxLCByZXMgfTogeyByZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSB9KSB7XG4gIC8vIE5vdGljZSBob3cgdGhlIHNlcnZlciB1c2VzIGBBUElgIGZyb20gYHdpdGhTU1JDb250ZXh0YCwgaW5zdGVhZCBvZiB0aGUgdG9wLWxldmVsIGBBUElgLlxuICAvLyBjb25zdCBTU1IgPSB3aXRoU1NSQ29udGV4dCh7IHJlcSB9KVxuICAvLyB0aGlzIHJ1bnMgb24gdGhlIGJhY2tlbmQsIHNvIHdlIG11c3QgY2FsbCBpbml0IG9uIHN1cGVydG9rZW5zLW5vZGUgU0RLXG4gIHN1cGVydG9rZW5zTm9kZS5pbml0KGJhY2tlbmRDb25maWcoKSlcbiAgbGV0IHNlc3Npb25cbiAgdHJ5IHtcbiAgICBzZXNzaW9uID0gYXdhaXQgU2Vzc2lvbi5nZXRTZXNzaW9uKHJlcSwgcmVzLCB7XG4gICAgICBvdmVycmlkZUdsb2JhbENsYWltVmFsaWRhdG9yczogYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gW11cbiAgICAgIH0sXG4gICAgfSlcbiAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICBpZiAoZXJyLnR5cGUgPT09IFNlc3Npb24uRXJyb3IuVFJZX1JFRlJFU0hfVE9LRU4pIHtcbiAgICAgIHJldHVybiB7IHByb3BzOiB7IGZyb21TdXBlcnRva2VuczogJ25lZWRzLXJlZnJlc2gnIH0gfVxuICAgIH0gZWxzZSBpZiAoZXJyLnR5cGUgPT09IFNlc3Npb24uRXJyb3IuVU5BVVRIT1JJU0VEKSB7XG4gICAgICAvLyB0aGlzIHdpbGwgZm9yY2UgdGhlIGZyb250ZW5kIHRvIHRyeSBhbmQgcmVmcmVzaCB3aGljaCB3aWxsIGZhaWxcbiAgICAgIC8vIGNsZWFyaW5nIGFsbCBjb29raWVzIGFuZCByZWRpcmVjdGluZyB0aGUgdXNlciB0byB0aGUgbG9naW4gc2NyZWVuLlxuICAgICAgcmV0dXJuIHsgcHJvcHM6IHsgZnJvbVN1cGVydG9rZW5zOiAnbmVlZHMtcmVmcmVzaCcgfSB9XG4gICAgfVxuICAgIHRocm93IGVyclxuICB9XG5cbiAgaWYgKCFzZXNzaW9uPy5nZXRVc2VySWQoKSkge1xuICAgIHJldHVybiB7XG4gICAgICByZWRpcmVjdDoge1xuICAgICAgICBkZXN0aW5hdGlvbjogJy9Vc2VyL0xvZ2luL1VzZXJMb2dpbicsXG4gICAgICAgIHBlcm1hbmVudDogZmFsc2UsXG4gICAgICB9LFxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcHJvcHM6IHtcbiAgICAgIHN1Yjogc2Vzc2lvbi5nZXRVc2VySWQoKSxcbiAgICB9XG4gIH1cbn1cblxudHlwZSBQcm9wcyA9IHtcbiAgICBpc1pvb21BdmFpbGFibGU6IGJvb2xlYW4sXG4gICAgaXNHb29nbGVNZWV0QXZhaWxhYmxlOiBib29sZWFuLFxuICAgIHpvb21NZWV0OiBib29sZWFuLFxuICAgIGdvb2dsZU1lZXQ6IGJvb2xlYW4sXG4gICAgZW5hYmxlQ29uZmVyZW5jZTogYm9vbGVhbixcbiAgICBzZXRQYXJlbnRab29tTWVldDogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248Ym9vbGVhbj4+LFxuICAgIHNldFBhcmVudEdvb2dsZU1lZXQ6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPGJvb2xlYW4+PixcbiAgICBzZXRQYXJlbnRFbmFibGVDb25mZXJlbmNlOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxib29sZWFuPj4sXG4gICAgc2V0UGFyZW50Q29uZmVyZW5jZUFwcDogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248Q29uZmVyZW5jZUFwcFR5cGUgfCBudWxsPj4sXG59XG5cbmZ1bmN0aW9uIEVkaXRNZWV0aW5nQXNzaXN0VmlydHVhbE1lZXQocHJvcHM6IFByb3BzKSB7XG4gICAgY29uc3QgW3pvb21NZWV0LCBzZXRab29tTWVldF0gPSB1c2VTdGF0ZTxib29sZWFuPihwcm9wcz8uem9vbU1lZXQpXG4gICAgY29uc3QgW2dvb2dsZU1lZXQsIHNldEdvb2dsZU1lZXRdID0gdXNlU3RhdGU8Ym9vbGVhbj4ocHJvcHM/Lmdvb2dsZU1lZXQpXG4gICAgY29uc3QgW2VuYWJsZUNvbmZlcmVuY2UsIHNldEVuYWJsZUNvbmZlcmVuY2VdID0gdXNlU3RhdGU8Ym9vbGVhbj4ocHJvcHM/LmVuYWJsZUNvbmZlcmVuY2UpXG4gICAgY29uc3QgW25vdEF2YWlsYWJsZSwgc2V0Tm90QXZhaWxhYmxlXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKVxuXG4gICAgY29uc3QgaXNab29tQXZhaWxhYmxlID0gcHJvcHM/LmlzWm9vbUF2YWlsYWJsZVxuICAgIGNvbnN0IGlzR29vZ2xlTWVldEF2YWlsYWJsZSA9IHByb3BzPy5pc0dvb2dsZU1lZXRBdmFpbGFibGVcbiAgICBjb25zdCBzZXRQYXJlbnRab29tTWVldCA9IHByb3BzPy5zZXRQYXJlbnRab29tTWVldFxuICAgIGNvbnN0IHNldFBhcmVudEdvb2dsZU1lZXQgPSBwcm9wcz8uc2V0UGFyZW50R29vZ2xlTWVldFxuICAgIGNvbnN0IHNldFBhcmVudENvbmZlcmVuY2VBcHAgPSBwcm9wcz8uc2V0UGFyZW50Q29uZmVyZW5jZUFwcFxuXG4gICAgY29uc3Qgb25FbmFibGVWaXJ0dWFsID0gKHZhbHVlOiBib29sZWFuKSA9PiB7XG4gICAgICAgIHNldEVuYWJsZUNvbmZlcmVuY2UodmFsdWUpXG4gICAgXG4gICAgICAgIGlmICghaXNab29tQXZhaWxhYmxlICYmICFpc0dvb2dsZU1lZXRBdmFpbGFibGUpIHtcbiAgICAgICAgICBzZXROb3RBdmFpbGFibGUodHJ1ZSlcbiAgICAgICAgICBzZXRQYXJlbnRDb25mZXJlbmNlQXBwKG51bGwpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2V0Tm90QXZhaWxhYmxlKGZhbHNlKVxuICAgICAgICB9XG4gICAgXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBzZXRQYXJlbnRDb25mZXJlbmNlQXBwKG51bGwpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBcbiAgICAgIGNvbnN0IG9uWm9vbU1lZXQgPSAodmFsdWU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgc2V0Wm9vbU1lZXQodmFsdWUpXG4gICAgICAgIHNldFBhcmVudFpvb21NZWV0KHZhbHVlKVxuICAgICAgICBzZXRHb29nbGVNZWV0KCF2YWx1ZSlcbiAgICAgICAgc2V0UGFyZW50R29vZ2xlTWVldCghdmFsdWUpXG4gICAgXG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgIHNldFBhcmVudENvbmZlcmVuY2VBcHAoJ3pvb20nKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNldFBhcmVudENvbmZlcmVuY2VBcHAoJ2dvb2dsZScpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBcbiAgICAgIGNvbnN0IG9uR29vZ2xlTWVldCA9ICh2YWx1ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICBzZXRHb29nbGVNZWV0KHZhbHVlKVxuICAgICAgICBzZXRQYXJlbnRHb29nbGVNZWV0KHZhbHVlKVxuICAgICAgICBzZXRab29tTWVldCghdmFsdWUpXG4gICAgICAgIHNldFBhcmVudFpvb21NZWV0KCF2YWx1ZSlcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgc2V0UGFyZW50Q29uZmVyZW5jZUFwcCgnZ29vZ2xlJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZXRQYXJlbnRDb25mZXJlbmNlQXBwKCd6b29tJylcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIChcbiAgICAgICAgPEJveCBmbGV4PXsxfSBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICA8Qm94IHA9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCIgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0+XG4gICAgICAgICAgICAgIEVuYWJsZSBhIHZpcnR1YWwgbWVldGluZyBmb3IgdGhpcyBldmVudD9cbiAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1lbmRcIiBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fT5cbiAgICAgICAgICAgICAgPFN3aXRjaDFcbiAgICAgICAgICAgICAgICBjaGVja2VkPXtlbmFibGVDb25mZXJlbmNlfVxuICAgICAgICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9e29uRW5hYmxlVmlydHVhbH1cbiAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbkJvdHRvbTogMjB9fVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPEJveD5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbm90QXZhaWxhYmxlXG4gICAgICAgICAgICAgID8gKFxuICAgICAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwic3ViaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgIDNyZCBwYXJ0eSBwcm92aWRlcnMgYXJlIG5vdCBlbmFibGVkLiBQbGVhc2UgZW5hYmxlIGVpdGhlciB6b29tIG9yIGdvb2dsZSB0byB1c2UgdGhpcyBmZWF0dXJlLlxuICAgICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZUNvbmZlcmVuY2VcbiAgICAgICAgICAgICAgICAgICAgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgPEJveD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1pvb21BdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCb3ggcD17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCIgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFbmFibGUgYSBab29tIE1lZXRpbmcgZm9yIHRoaXMgZXZlbnQ/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1lbmRcIiBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTd2l0Y2gxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3pvb21NZWV0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblZhbHVlQ2hhbmdlPXtvblpvb21NZWV0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbkJvdHRvbTogMjB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0dvb2dsZU1lZXRBdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCb3ggcD17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiIHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVuYWJsZSBhIEdvb2dsZSBNZWV0IGZvciB0aGlzIGV2ZW50P1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1lbmRcIiBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U3dpdGNoMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17Z29vZ2xlTWVldH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9e29uR29vZ2xlTWVldH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luQm90dG9tOiAyMH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgKSA6IG51bGxcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIDwvQm94PlxuICAgICAgICA8L0JveD5cbiAgICAgIClcbn1cblxuZXhwb3J0IGRlZmF1bHQgRWRpdE1lZXRpbmdBc3Npc3RWaXJ0dWFsTWVldFxuXG5cblxuXG4iXX0=