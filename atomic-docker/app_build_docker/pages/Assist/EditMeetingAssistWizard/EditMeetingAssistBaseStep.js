"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getServerSideProps = getServerSideProps;
const jsx_runtime_1 = require("react/jsx-runtime");
const date_utils_1 = require("@lib/date-utils");
// import DateTimePicker from 'react-datetime-picker/dist/entry.nostyle'
const Switch_1 = __importDefault(require("@components/Switch"));
const Box_1 = __importDefault(require("@components/common/Box"));
const Text_1 = __importDefault(require("@components/common/Text"));
const TextField_1 = __importDefault(require("@components/TextField"));
const react_native_1 = require("react-native");
const react_1 = require("react");
const react_2 = require("@chakra-ui/react");
const supertokens_node_1 = __importDefault(require("supertokens-node"));
const backendConfig_1 = require("../../../config/backendConfig");
const session_1 = __importDefault(require("supertokens-node/recipe/session"));
async function getServerSideProps({ req, res }) {
    // Notice how the server uses `API` from `withSSRContext`, instead of the top-level `API`.
    // const SSR = withSSRContext({ req })
    // this runs on the backend, so we must call init on supertokens-node SDK
    supertokens_node_1.default.init((0, backendConfig_1.backendConfig)());
    let session;
    try {
        session = await session_1.default.getSession(req, res, {
            overrideGlobalClaimValidators: async function () {
                return [];
            },
        });
    }
    catch (err) {
        if (err.type === session_1.default.Error.TRY_REFRESH_TOKEN) {
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        else if (err.type === session_1.default.Error.UNAUTHORISED) {
            // this will force the frontend to try and refresh which will fail
            // clearing all cookies and redirecting the user to the login screen.
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        throw err;
    }
    if (!session?.getUserId()) {
        return {
            redirect: {
                destination: '/User/Login/UserLogin',
                permanent: false,
            },
        };
    }
    return {
        props: {
            sub: session.getUserId(),
        }
    };
}
function EditMeetingAssistBaseStep(props) {
    const [notes, setNotes] = (0, react_1.useState)(props?.notes);
    const [summary, setSummary] = (0, react_1.useState)(props?.summary);
    const [windowStartDate, setWindowStartDate] = (0, react_1.useState)(props?.windowStartDate);
    const [windowEndDate, setWindowEndDate] = (0, react_1.useState)(props?.windowEndDate);
    const [location, setLocation] = (0, react_1.useState)(props?.location);
    const [isStartDatePickerVisible, setIsStartDatePickerVisible] = (0, react_1.useState)(false);
    const [isEndDatePickerVisible, setIsEndDatePickerVisible] = (0, react_1.useState)(false);
    const [cancel, setCancel] = (0, react_1.useState)(props?.cancel);
    const [pageOffset, setPageOffset] = (0, react_1.useState)(0);
    const { height: fullHeight } = react_native_1.Dimensions.get('window');
    (0, react_1.useEffect)(() => {
        if (windowStartDate !== props?.windowStartDate) {
            setWindowStartDate(props?.windowStartDate);
        }
    }, [props?.windowStartDate, windowStartDate]);
    (0, react_1.useEffect)(() => {
        if (windowEndDate !== props?.windowEndDate) {
            setWindowEndDate(props?.windowEndDate);
        }
    }, [props?.windowEndDate, windowEndDate]);
    const setParentNotes = props?.setParentNotes;
    const setParentSummary = props?.setParentSummary;
    const setParentWindowStartDate = props?.setParentWindowStartDate;
    const setParentWindowEndDate = props?.setParentWindowEndDate;
    const setParentLocation = props?.setParentLocation;
    const setParentCancel = props?.setParentCancel;
    const changeNotes = (value) => {
        setNotes(value);
        setParentNotes(value);
    };
    const changeSummary = (value) => {
        setSummary(value);
        setParentSummary(value);
    };
    const changeWindowStartDate = (value) => {
        setWindowStartDate(value);
        setParentWindowStartDate(value);
    };
    const changeWindowEndDate = (value) => {
        setWindowEndDate(value);
        setParentWindowEndDate(value);
    };
    const changeLocation = (value) => {
        setLocation(value);
        setParentLocation(value);
    };
    const showStartDatePicker = () => {
        setIsStartDatePickerVisible(true);
    };
    const hideStartDatePicker = () => {
        setIsStartDatePickerVisible(false);
    };
    const showEndDatePicker = () => {
        setIsEndDatePickerVisible(true);
    };
    const hideEndDatePicker = () => {
        setIsEndDatePickerVisible(false);
    };
    const changeCancel = (value) => {
        setCancel(value);
        setParentCancel(value);
    };
    return ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, style: { width: '100%' }, children: (0, jsx_runtime_1.jsxs)(react_native_1.ScrollView, { style: { flex: 1, width: '100%' }, contentContainerStyle: { alignItems: 'center' }, children: [(0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, p: { phone: 's', tablet: 'm' }, style: { width: '80%' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Start" }), (0, jsx_runtime_1.jsx)(react_2.Input, { placeholder: "Select Date and Time", size: "md", type: "datetime-local", onChange: (e) => {
                                const durationMinutes = date_utils_1.dayjs.duration((0, date_utils_1.dayjs)(windowEndDate).diff((0, date_utils_1.dayjs)(windowStartDate))).asMinutes();
                                const newEndDate = (0, date_utils_1.dayjs)(e?.target?.value, "YYYY-MM-DDTHH:mm").add(durationMinutes, 'minutes').toDate();
                                changeWindowStartDate((0, date_utils_1.dayjs)(e?.target?.value, "YYYY-MM-DDTHH:mm").toDate());
                                changeWindowEndDate(newEndDate);
                            }, value: (0, date_utils_1.dayjs)(windowStartDate).format("YYYY-MM-DDTHH:mm") })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, p: { phone: 's', tablet: 'm' }, style: { width: '80%' }, children: [(0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: showEndDatePicker, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "End" }) }), (0, jsx_runtime_1.jsx)(react_2.Input, { placeholder: "Select Date and Time", size: "md", type: "datetime-local", onChange: (e) => {
                                changeWindowEndDate((0, date_utils_1.dayjs)(e?.target?.value, "YYYY-MM-DDTHH:mm").toDate());
                            }, value: (0, date_utils_1.dayjs)(windowEndDate).format("YYYY-MM-DDTHH:mm") })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", pt: { phone: 'm', tablet: 's' }, style: { width: '100%' }, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", pt: { phone: 'm', tablet: 's' }, children: "Do you want to cancel this meeting assist?" }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { checked: cancel, onValueChange: changeCancel, style: { marginBottom: 20 } }) })] }), (0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, p: { phone: 's', tablet: 'm' }, flexDirection: "row", justifyContent: "flex-start", alignItems: "center", style: { width: '80%' }, children: (0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsx)(TextField_1.default, { label: "Title", placeholder: "title", multiline: true, numberOfLines: 4, onChange: (e) => changeSummary(e?.target?.value), value: summary || props?.summary, style: { width: '100%' } }) }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, p: { phone: 's', tablet: 'm' }, flexDirection: "row", justifyContent: "flex-start", alignItems: "center", style: { width: '80%' }, children: (0, jsx_runtime_1.jsx)(TextField_1.default, { placeholder: "notes", onChange: (e) => changeNotes(e?.target?.value), value: notes || props?.notes, style: { width: '100%' }, multiline: true, numberOfLines: 4 }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, p: { phone: 's', tablet: 'm' }, flexDirection: "row", justifyContent: "flex-start", alignItems: "center", style: { width: '80%' }, children: (0, jsx_runtime_1.jsx)(TextField_1.default, { label: "Location", placeholder: "location if any", onChange: (e) => changeLocation(e?.target?.value), value: location || props?.location, style: { width: '100%' } }) })] }) }));
}
exports.default = EditMeetingAssistBaseStep;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRWRpdE1lZXRpbmdBc3Npc3RCYXNlU3RlcC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkVkaXRNZWV0aW5nQXNzaXN0QmFzZVN0ZXAudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBbUJBLGdEQXFDQzs7QUF2REQsZ0RBQXVDO0FBQ3ZDLHdFQUF3RTtBQUV4RSxnRUFBd0M7QUFDeEMsaUVBQXdDO0FBQ3hDLG1FQUEwQztBQUMxQyxzRUFBNkM7QUFFN0MsK0NBQXdIO0FBR3hILGlDQUE0RTtBQUM1RSw0Q0FBd0M7QUFFeEMsd0VBQThDO0FBQzlDLGlFQUE2RDtBQUM3RCw4RUFBcUQ7QUFFOUMsS0FBSyxVQUFVLGtCQUFrQixDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBaUQ7SUFDbEcsMEZBQTBGO0lBQzFGLHNDQUFzQztJQUN0Qyx5RUFBeUU7SUFDekUsMEJBQWUsQ0FBQyxJQUFJLENBQUMsSUFBQSw2QkFBYSxHQUFFLENBQUMsQ0FBQTtJQUNyQyxJQUFJLE9BQU8sQ0FBQTtJQUNYLElBQUksQ0FBQztRQUNILE9BQU8sR0FBRyxNQUFNLGlCQUFPLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUU7WUFDM0MsNkJBQTZCLEVBQUUsS0FBSztnQkFDbEMsT0FBTyxFQUFFLENBQUE7WUFDWCxDQUFDO1NBQ0YsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUFDLE9BQU8sR0FBUSxFQUFFLENBQUM7UUFDbEIsSUFBSSxHQUFHLENBQUMsSUFBSSxLQUFLLGlCQUFPLENBQUMsS0FBSyxDQUFDLGlCQUFpQixFQUFFLENBQUM7WUFDakQsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQUUsRUFBRSxDQUFBO1FBQ3hELENBQUM7YUFBTSxJQUFJLEdBQUcsQ0FBQyxJQUFJLEtBQUssaUJBQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFFLENBQUM7WUFDbkQsa0VBQWtFO1lBQ2xFLHFFQUFxRTtZQUNyRSxPQUFP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RSxNQUFNLEVBQUMsR0FDekIsR0FFQSxJQUNHLEdBRVgsQ0FDVCxDQUFBO0FBRUwsQ0FBQztBQUVELGtCQUFlLHlCQUF5QixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgeyBkYXlqcyB9IGZyb20gJ0BsaWIvZGF0ZS11dGlscydcbi8vIGltcG9ydCBEYXRlVGltZVBpY2tlciBmcm9tICdyZWFjdC1kYXRldGltZS1waWNrZXIvZGlzdC9lbnRyeS5ub3N0eWxlJ1xuXG5pbXBvcnQgU3dpdGNoMSBmcm9tICdAY29tcG9uZW50cy9Td2l0Y2gnXG5pbXBvcnQgQm94IGZyb20gJ0Bjb21wb25lbnRzL2NvbW1vbi9Cb3gnXG5pbXBvcnQgVGV4dCBmcm9tICdAY29tcG9uZW50cy9jb21tb24vVGV4dCdcbmltcG9ydCBUZXh0RmllbGQgZnJvbSAnQGNvbXBvbmVudHMvVGV4dEZpZWxkJ1xuXG5pbXBvcnQgeyBBcHBlYXJhbmNlLCBEaW1lbnNpb25zLCBLZXlib2FyZEF2b2lkaW5nVmlldywgUGxhdGZvcm0sIFByZXNzYWJsZSwgU3R5bGVTaGVldCwgU2Nyb2xsVmlldyB9IGZyb20gJ3JlYWN0LW5hdGl2ZSdcbmltcG9ydCB7IHBhbGV0dGUgfSBmcm9tICdAbGliL3RoZW1lL3RoZW1lJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IFJlYWN0LCB7IERpc3BhdGNoLCBTZXRTdGF0ZUFjdGlvbiwgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICdAY2hha3JhLXVpL3JlYWN0J1xuaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHN1cGVydG9rZW5zTm9kZSBmcm9tICdzdXBlcnRva2Vucy1ub2RlJ1xuaW1wb3J0IHsgYmFja2VuZENvbmZpZyB9IGZyb20gJy4uLy4uLy4uL2NvbmZpZy9iYWNrZW5kQ29uZmlnJ1xuaW1wb3J0IFNlc3Npb24gZnJvbSAnc3VwZXJ0b2tlbnMtbm9kZS9yZWNpcGUvc2Vzc2lvbidcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlcnZlclNpZGVQcm9wcyh7IHJlcSwgcmVzIH06IHsgcmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UgfSkge1xuICAvLyBOb3RpY2UgaG93IHRoZSBzZXJ2ZXIgdXNlcyBgQVBJYCBmcm9tIGB3aXRoU1NSQ29udGV4dGAsIGluc3RlYWQgb2YgdGhlIHRvcC1sZXZlbCBgQVBJYC5cbiAgLy8gY29uc3QgU1NSID0gd2l0aFNTUkNvbnRleHQoeyByZXEgfSlcbiAgLy8gdGhpcyBydW5zIG9uIHRoZSBiYWNrZW5kLCBzbyB3ZSBtdXN0IGNhbGwgaW5pdCBvbiBzdXBlcnRva2Vucy1ub2RlIFNES1xuICBzdXBlcnRva2Vuc05vZGUuaW5pdChiYWNrZW5kQ29uZmlnKCkpXG4gIGxldCBzZXNzaW9uXG4gIHRyeSB7XG4gICAgc2Vzc2lvbiA9IGF3YWl0IFNlc3Npb24uZ2V0U2Vzc2lvbihyZXEsIHJlcywge1xuICAgICAgb3ZlcnJpZGVHbG9iYWxDbGFpbVZhbGlkYXRvcnM6IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFtdXG4gICAgICB9LFxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgaWYgKGVyci50eXBlID09PSBTZXNzaW9uLkVycm9yLlRSWV9SRUZSRVNIX1RPS0VOKSB7XG4gICAgICByZXR1cm4geyBwcm9wczogeyBmcm9tU3VwZXJ0b2tlbnM6ICduZWVkcy1yZWZyZXNoJyB9IH1cbiAgICB9IGVsc2UgaWYgKGVyci50eXBlID09PSBTZXNzaW9uLkVycm9yLlVOQVVUSE9SSVNFRCkge1xuICAgICAgLy8gdGhpcyB3aWxsIGZvcmNlIHRoZSBmcm9udGVuZCB0byB0cnkgYW5kIHJlZnJlc2ggd2hpY2ggd2lsbCBmYWlsXG4gICAgICAvLyBjbGVhcmluZyBhbGwgY29va2llcyBhbmQgcmVkaXJlY3RpbmcgdGhlIHVzZXIgdG8gdGhlIGxvZ2luIHNjcmVlbi5cbiAgICAgIHJldHVybiB7IHByb3BzOiB7IGZyb21TdXBlcnRva2VuczogJ25lZWRzLXJlZnJlc2gnIH0gfVxuICAgIH1cbiAgICB0aHJvdyBlcnJcbiAgfVxuXG4gIGlmICghc2Vzc2lvbj8uZ2V0VXNlcklkKCkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVkaXJlY3Q6IHtcbiAgICAgICAgZGVzdGluYXRpb246ICcvVXNlci9Mb2dpbi9Vc2VyTG9naW4nLFxuICAgICAgICBwZXJtYW5lbnQ6IGZhbHNlLFxuICAgICAgfSxcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHByb3BzOiB7XG4gICAgICBzdWI6IHNlc3Npb24uZ2V0VXNlcklkKCksXG4gICAgfVxuICB9XG59XG5cbnR5cGUgUHJvcHMgPSB7XG4gICAgbm90ZXM6IHN0cmluZyxcbiAgICB3aW5kb3dTdGFydERhdGU6IERhdGUsXG4gICAgd2luZG93RW5kRGF0ZTogRGF0ZSxcbiAgICBsb2NhdGlvbjogc3RyaW5nIHwgdW5kZWZpbmVkLFxuICAgIGNhbmNlbDogYm9vbGVhbixcbiAgICBzdW1tYXJ5OiBzdHJpbmcsXG4gICAgc2V0UGFyZW50Tm90ZXM6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPHN0cmluZz4+LFxuICAgIHNldFBhcmVudFN1bW1hcnk6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPHN0cmluZz4+LFxuICAgIHNldFBhcmVudFdpbmRvd1N0YXJ0RGF0ZTogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248RGF0ZT4+LFxuICAgIHNldFBhcmVudFdpbmRvd0VuZERhdGU6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPERhdGU+PixcbiAgICBzZXRQYXJlbnRMb2NhdGlvbjogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248c3RyaW5nPj4sXG4gICAgc2V0UGFyZW50Q2FuY2VsOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxib29sZWFuPj4sXG59XG5cbmZ1bmN0aW9uIEVkaXRNZWV0aW5nQXNzaXN0QmFzZVN0ZXAocHJvcHM6IFByb3BzKSB7XG4gICAgY29uc3QgW25vdGVzLCBzZXROb3Rlc10gPSB1c2VTdGF0ZTxzdHJpbmc+KHByb3BzPy5ub3RlcylcbiAgICBjb25zdCBbc3VtbWFyeSwgc2V0U3VtbWFyeV0gPSB1c2VTdGF0ZTxzdHJpbmc+KHByb3BzPy5zdW1tYXJ5KVxuICAgIGNvbnN0IFt3aW5kb3dTdGFydERhdGUsIHNldFdpbmRvd1N0YXJ0RGF0ZV0gPSB1c2VTdGF0ZTxEYXRlPihwcm9wcz8ud2luZG93U3RhcnREYXRlKVxuICAgIGNvbnN0IFt3aW5kb3dFbmREYXRlLCBzZXRXaW5kb3dFbmREYXRlXSA9IHVzZVN0YXRlPERhdGU+KHByb3BzPy53aW5kb3dFbmREYXRlKVxuICAgIGNvbnN0IFtsb2NhdGlvbiwgc2V0TG9jYXRpb25dID0gdXNlU3RhdGU8c3RyaW5nIHwgdW5kZWZpbmVkPihwcm9wcz8ubG9jYXRpb24pXG4gICAgY29uc3QgW2lzU3RhcnREYXRlUGlja2VyVmlzaWJsZSwgc2V0SXNTdGFydERhdGVQaWNrZXJWaXNpYmxlXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKVxuICAgIGNvbnN0IFtpc0VuZERhdGVQaWNrZXJWaXNpYmxlLCBzZXRJc0VuZERhdGVQaWNrZXJWaXNpYmxlXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKVxuICAgIGNvbnN0IFtjYW5jZWwsIHNldENhbmNlbF0gPSB1c2VTdGF0ZTxib29sZWFuPihwcm9wcz8uY2FuY2VsKVxuICAgIGNvbnN0IFtwYWdlT2Zmc2V0LCBzZXRQYWdlT2Zmc2V0XSA9IHVzZVN0YXRlPG51bWJlcj4oMClcblxuICAgIGNvbnN0IHsgaGVpZ2h0OiBmdWxsSGVpZ2h0IH0gPSBEaW1lbnNpb25zLmdldCgnd2luZG93JylcbiAgICBcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAod2luZG93U3RhcnREYXRlICE9PSBwcm9wcz8ud2luZG93U3RhcnREYXRlKSB7XG4gICAgICAgICAgICBzZXRXaW5kb3dTdGFydERhdGUocHJvcHM/LndpbmRvd1N0YXJ0RGF0ZSlcbiAgICAgICAgfVxuICAgIH0sIFtwcm9wcz8ud2luZG93U3RhcnREYXRlLCB3aW5kb3dTdGFydERhdGVdKVxuXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKHdpbmRvd0VuZERhdGUgIT09IHByb3BzPy53aW5kb3dFbmREYXRlKSB7XG4gICAgICAgICAgICBzZXRXaW5kb3dFbmREYXRlKHByb3BzPy53aW5kb3dFbmREYXRlKVxuICAgICAgICB9XG4gICAgfSwgW3Byb3BzPy53aW5kb3dFbmREYXRlLCB3aW5kb3dFbmREYXRlXSlcblxuICAgIGNvbnN0IHNldFBhcmVudE5vdGVzID0gcHJvcHM/LnNldFBhcmVudE5vdGVzXG4gICAgY29uc3Qgc2V0UGFyZW50U3VtbWFyeSA9IHByb3BzPy5zZXRQYXJlbnRTdW1tYXJ5XG4gICAgY29uc3Qgc2V0UGFyZW50V2luZG93U3RhcnREYXRlID0gcHJvcHM/LnNldFBhcmVudFdpbmRvd1N0YXJ0RGF0ZVxuICAgIGNvbnN0IHNldFBhcmVudFdpbmRvd0VuZERhdGUgPSBwcm9wcz8uc2V0UGFyZW50V2luZG93RW5kRGF0ZVxuICAgIGNvbnN0IHNldFBhcmVudExvY2F0aW9uID0gcHJvcHM/LnNldFBhcmVudExvY2F0aW9uXG4gICAgY29uc3Qgc2V0UGFyZW50Q2FuY2VsID0gcHJvcHM/LnNldFBhcmVudENhbmNlbFxuXG5cbiAgICBjb25zdCBjaGFuZ2VOb3RlcyA9ICh2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIHNldE5vdGVzKHZhbHVlKVxuICAgICAgICBzZXRQYXJlbnROb3Rlcyh2YWx1ZSlcbiAgICB9XG5cbiAgICBjb25zdCBjaGFuZ2VTdW1tYXJ5ID0gKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgc2V0U3VtbWFyeSh2YWx1ZSlcbiAgICAgICAgc2V0UGFyZW50U3VtbWFyeSh2YWx1ZSlcbiAgICB9XG5cbiAgICBjb25zdCBjaGFuZ2VXaW5kb3dTdGFydERhdGUgPSAodmFsdWU6IERhdGUpID0+IHtcbiAgICAgICAgc2V0V2luZG93U3RhcnREYXRlKHZhbHVlKVxuICAgICAgICBzZXRQYXJlbnRXaW5kb3dTdGFydERhdGUodmFsdWUpXG4gICAgfVxuXG4gICAgY29uc3QgY2hhbmdlV2luZG93RW5kRGF0ZSA9ICh2YWx1ZTogRGF0ZSkgPT4ge1xuICAgICAgICBzZXRXaW5kb3dFbmREYXRlKHZhbHVlKVxuICAgICAgICBzZXRQYXJlbnRXaW5kb3dFbmREYXRlKHZhbHVlKVxuICAgIH1cblxuICAgIGNvbnN0IGNoYW5nZUxvY2F0aW9uID0gKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgc2V0TG9jYXRpb24odmFsdWUpXG4gICAgICAgIHNldFBhcmVudExvY2F0aW9uKHZhbHVlKVxuICAgIH1cblxuICAgIGNvbnN0IHNob3dTdGFydERhdGVQaWNrZXIgPSAoKSA9PiB7XG4gICAgICAgIHNldElzU3RhcnREYXRlUGlja2VyVmlzaWJsZSh0cnVlKVxuICAgIH1cblxuICAgIGNvbnN0IGhpZGVTdGFydERhdGVQaWNrZXIgPSAoKSA9PiB7XG4gICAgICAgIHNldElzU3RhcnREYXRlUGlja2VyVmlzaWJsZShmYWxzZSlcbiAgICB9XG5cbiAgICBjb25zdCBzaG93RW5kRGF0ZVBpY2tlciA9ICgpID0+IHtcbiAgICAgICAgc2V0SXNFbmREYXRlUGlja2VyVmlzaWJsZSh0cnVlKVxuICAgIH1cblxuICAgIGNvbnN0IGhpZGVFbmREYXRlUGlja2VyID0gKCkgPT4ge1xuICAgICAgICBzZXRJc0VuZERhdGVQaWNrZXJWaXNpYmxlKGZhbHNlKVxuICAgIH1cblxuICAgIGNvbnN0IGNoYW5nZUNhbmNlbCA9ICh2YWx1ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICBzZXRDYW5jZWwodmFsdWUpXG4gICAgICAgIHNldFBhcmVudENhbmNlbCh2YWx1ZSlcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgICA8Qm94IGZsZXg9ezF9IHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0+XG4gICAgICAgICAgICA8U2Nyb2xsVmlldyBzdHlsZT17eyBmbGV4OiAxLCB3aWR0aDogJzEwMCUnIH19IGNvbnRlbnRDb250YWluZXJTdHlsZT17eyBhbGlnbkl0ZW1zOiAnY2VudGVyJ319PlxuICAgICAgICAgICAgICAgIDxCb3ggZmxleD17MX0gcD17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fSBzdHlsZT17eyB3aWR0aDogJzgwJSd9fT5cbiAgICAgICAgICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0YXJ0XG4gICAgICAgICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiU2VsZWN0IERhdGUgYW5kIFRpbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cIm1kXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJkYXRldGltZS1sb2NhbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkdXJhdGlvbk1pbnV0ZXMgPSBkYXlqcy5kdXJhdGlvbihkYXlqcyh3aW5kb3dFbmREYXRlKS5kaWZmKGRheWpzKHdpbmRvd1N0YXJ0RGF0ZSkpKS5hc01pbnV0ZXMoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0VuZERhdGUgPSBkYXlqcyhlPy50YXJnZXQ/LnZhbHVlLCBcIllZWVktTU0tRERUSEg6bW1cIikuYWRkKGR1cmF0aW9uTWludXRlcywgJ21pbnV0ZXMnKS50b0RhdGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVdpbmRvd1N0YXJ0RGF0ZShkYXlqcyhlPy50YXJnZXQ/LnZhbHVlLCBcIllZWVktTU0tRERUSEg6bW1cIikudG9EYXRlKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlV2luZG93RW5kRGF0ZShuZXdFbmREYXRlKVxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtkYXlqcyh3aW5kb3dTdGFydERhdGUpLmZvcm1hdChcIllZWVktTU0tRERUSEg6bW1cIil9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgIDxCb3ggZmxleD17MX0gcD17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fSBzdHlsZT17eyB3aWR0aDogJzgwJSd9fT5cbiAgICAgICAgICAgICAgICAgICAgPFByZXNzYWJsZSBvblByZXNzPXtzaG93RW5kRGF0ZVBpY2tlcn0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRW5kXG4gICAgICAgICAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgICAgICAgIDwvUHJlc3NhYmxlPlxuICAgICAgICAgICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiU2VsZWN0IERhdGUgYW5kIFRpbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cIm1kXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJkYXRldGltZS1sb2NhbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VXaW5kb3dFbmREYXRlKGRheWpzKGU/LnRhcmdldD8udmFsdWUsIFwiWVlZWS1NTS1ERFRISDptbVwiKS50b0RhdGUoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17ZGF5anMod2luZG93RW5kRGF0ZSkuZm9ybWF0KFwiWVlZWS1NTS1ERFRISDptbVwiKX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICA8Qm94IHA9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgICAgICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1zdGFydFwiIHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19IHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCIgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRG8geW91IHdhbnQgdG8gY2FuY2VsIHRoaXMgbWVldGluZyBhc3Npc3Q/XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtZW5kXCIgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8U3dpdGNoMVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17Y2FuY2VsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9e2NoYW5nZUNhbmNlbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbkJvdHRvbTogMjB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPEJveCBmbGV4PXsxfSBwPXt7IHBob25lOiAncycsIHRhYmxldDogJ20nIH19IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgc3R5bGU9e3sgd2lkdGg6ICc4MCUnfX0+XG4gICAgICAgICAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dEZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPVwiVGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cInRpdGxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXVsdGlsaW5lPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJPZkxpbmVzPXs0fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGU6IHsgdGFyZ2V0OiB7IHZhbHVlOiBzdHJpbmcgfSB9KSA9PiBjaGFuZ2VTdW1tYXJ5KGU/LnRhcmdldD8udmFsdWUpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17c3VtbWFyeSB8fCBwcm9wcz8uc3VtbWFyeX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgd2lkdGg6ICcxMDAlJ319XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPEJveCBmbGV4PXsxfSBwPXt7IHBob25lOiAncycsIHRhYmxldDogJ20nIH19IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgc3R5bGU9e3sgd2lkdGg6ICc4MCUnIH19PlxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIm5vdGVzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGU6IHsgdGFyZ2V0OiB7IHZhbHVlOiBzdHJpbmcgfSB9KSA9PiBjaGFuZ2VOb3RlcyhlPy50YXJnZXQ/LnZhbHVlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17bm90ZXMgfHwgcHJvcHM/Lm5vdGVzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IHdpZHRoOiAnMTAwJSd9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG11bHRpbGluZT17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXJPZkxpbmVzPXs0fVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPEJveCBmbGV4PXsxfSBwPXt7IHBob25lOiAncycsIHRhYmxldDogJ20nIH19IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgc3R5bGU9e3sgd2lkdGg6ICc4MCUnIH19PlxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgPFRleHRGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJMb2NhdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cImxvY2F0aW9uIGlmIGFueVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGU6IHsgdGFyZ2V0OiB7IHZhbHVlOiBzdHJpbmcgfSB9KSA9PiBjaGFuZ2VMb2NhdGlvbihlPy50YXJnZXQ/LnZhbHVlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtsb2NhdGlvbiB8fCBwcm9wcz8ubG9jYXRpb259XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyB3aWR0aDogJzEwMCUnfX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICA8L1Njcm9sbFZpZXc+XG4gICAgICAgICAgIFxuICAgICAgICA8L0JveD5cbiAgICApXG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgRWRpdE1lZXRpbmdBc3Npc3RCYXNlU3RlcFxuXG5cbiJdfQ==