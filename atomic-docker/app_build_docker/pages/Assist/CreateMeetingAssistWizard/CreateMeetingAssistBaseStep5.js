"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getServerSideProps = getServerSideProps;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const date_utils_1 = require("@lib/date-utils");
// import DatePicker from 'react-native-date-picker'
// import DateTimePicker from 'react-datetime-picker/dist/entry.nostyle'
const colorsPalette_1 = require("@lib/theme/colorsPalette");
const react_2 = require("@chakra-ui/react");
const Switch_1 = __importDefault(require("@components/Switch"));
const Box_1 = __importDefault(require("@components/common/Box"));
const Text_1 = __importDefault(require("@components/common/Text"));
const TextField_1 = __importDefault(require("@components/TextField"));
const react_native_1 = require("react-native");
const react_3 = require("@chakra-ui/react");
const react_4 = require("@chakra-ui/react");
const supertokens_node_1 = __importDefault(require("supertokens-node"));
const backendConfig_1 = require("../../../config/backendConfig");
const session_1 = __importDefault(require("supertokens-node/recipe/session"));
async function getServerSideProps({ req, res }) {
    // Notice how the server uses `API` from `withSSRContext`, instead of the top-level `API`.
    // const SSR = withSSRContext({ req })
    // this runs on the backend, so we must call init on supertokens-node SDK
    supertokens_node_1.default.init((0, backendConfig_1.backendConfig)());
    let session;
    try {
        session = await session_1.default.getSession(req, res, {
            overrideGlobalClaimValidators: async function () {
                return [];
            },
        });
    }
    catch (err) {
        if (err.type === session_1.default.Error.TRY_REFRESH_TOKEN) {
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        else if (err.type === session_1.default.Error.UNAUTHORISED) {
            // this will force the frontend to try and refresh which will fail
            // clearing all cookies and redirecting the user to the login screen.
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        throw err;
    }
    if (!session?.getUserId()) {
        return {
            redirect: {
                destination: '/User/Login/UserLogin',
                permanent: false,
            },
        };
    }
    return {
        props: {
            sub: session.getUserId(),
        }
    };
}
const dark = react_native_1.Appearance.getColorScheme() === 'dark';
const styles = {
    container: {
        flex: 1,
    },
    duration: {
        fontSize: '21px',
        lineHeight: '28px',
    }
};
function CreateMeetingAssistBaseStep5(props) {
    const [cancelIfAnyRefuse, setCancelIfAnyRefuse] = (0, react_1.useState)(props?.cancelIfAnyRefuse);
    const [enableAttendeePreferences, setEnableAttendeePreferences] = (0, react_1.useState)(props?.enableAttendeePreferences);
    const [attendeeCanModify, setAttendeeCanModify] = (0, react_1.useState)(props?.attendeeCanModify);
    const [expireDate, setExpireDate] = (0, react_1.useState)(props?.expireDate);
    const [duration, setDuration] = (0, react_1.useState)(props?.duration);
    const [isMessage, setIsMessage] = (0, react_1.useState)(false);
    const [isExpireDatePicker, setIsExpireDatePicker] = (0, react_1.useState)(false);
    const setParentCancelIfAnyRefuse = props?.setParentCancelIfAnyRefuse;
    const setParentEnableAttendeePreferences = props?.setParentEnableAttendeePreferences;
    const setParentAttendeeCanModify = props?.setParentAttendeeCanModify;
    const setParentExpireDate = props?.setParentExpireDate;
    const setParentDuration = props?.setParentDuration;
    const toast = (0, react_3.useToast)();
    const changeCancelIfAnyRefuse = (value) => {
        setCancelIfAnyRefuse(value);
        setParentCancelIfAnyRefuse(value);
    };
    const changeEnableAttendeePreferences = (value) => {
        setEnableAttendeePreferences(value);
        setParentEnableAttendeePreferences(value);
    };
    const changeAttendeeCanModify = (value) => {
        setAttendeeCanModify(value);
        setParentAttendeeCanModify(value);
    };
    const changeExpireDate = (value) => {
        setExpireDate(value);
        setParentExpireDate(value);
    };
    // 
    const changeDuration = (e) => {
        const _value = e?.target?.value;
        const intValue = parseInt(_value.replace(/[^0-9.]/g, ''), 10);
        // validate
        if (intValue < 30) {
            toast({
                status: 'error',
                title: 'Too short',
                description: 'Your duration is too short. Make it more than or equal to 30 minutes',
                duration: 9000,
                isClosable: true,
            });
            setDuration(30);
            setParentDuration(30);
            return;
        }
        setDuration(intValue || 30);
        setParentDuration(intValue || 30);
    };
    const hideExpireDatePicker = () => setIsExpireDatePicker(false);
    const showExpireDatePicker = () => setIsExpireDatePicker(true);
    return ((0, jsx_runtime_1.jsx)(react_native_1.ScrollView, { style: { flex: 1, width: '100%', maxHeight: '65vh' }, contentContainerStyle: { alignItems: 'center', maxHeight: '65vh' }, children: (0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", style: { width: '100%' }, children: [(0, jsx_runtime_1.jsxs)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, flexDirection: { tablet: "row" }, justifyContent: "space-between", alignItems: "center", width: "70%", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", pt: { phone: 'm', tablet: 's' }, children: "Cancel planning if any refuse?" }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { onColor: colorsPalette_1.colorsPalette.purple30, offColor: colorsPalette_1.colorsPalette.purple60, checked: cancelIfAnyRefuse, onValueChange: changeCancelIfAnyRefuse, style: { marginBottom: 20 } }) })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, flexDirection: { tablet: "row" }, justifyContent: "space-between", alignItems: "center", width: "70%", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", pt: { phone: 'm', tablet: 's' }, children: "Allow attendee to select time preferences (slots) for event?" }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { onColor: colorsPalette_1.colorsPalette.purple30, offColor: colorsPalette_1.colorsPalette.purple60, checked: enableAttendeePreferences, onValueChange: changeEnableAttendeePreferences, style: { marginBottom: 20 } }) })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, flexDirection: { tablet: "row" }, justifyContent: "space-between", alignItems: "center", width: "70%", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", pt: { phone: 'm', tablet: 's' }, children: "Allow attendee to change existing time preferences (slots) for event?" }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { onColor: colorsPalette_1.colorsPalette.purple30, offColor: colorsPalette_1.colorsPalette.purple60, checked: attendeeCanModify, onValueChange: changeAttendeeCanModify, style: { marginBottom: 20 } }) })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, flexDirection: { tablet: "row" }, justifyContent: "space-between", alignItems: "center", width: "70%", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_2.Tooltip, { label: "You can select a time when the meeting assist will no longer valid if minimum number of attendees do not say \\'Yes\\'. In other words, no new events will be created.", "aria-label": 'A tooltip', children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "When will planning this event expire if minimum threshold of accepted invites is not met?" }) }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_4.Input, { placeholder: "Select Date and Time", size: "md", type: "datetime-local", onChange: (e) => {
                                    changeExpireDate((0, date_utils_1.dayjs)(e?.target?.value, "YYYY-MM-DDTHH:mm").toDate());
                                }, value: (0, date_utils_1.dayjs)(expireDate).format("YYYY-MM-DDTHH:mm") }) })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, flexDirection: { tablet: "row" }, justifyContent: "space-between", alignItems: "center", width: "70%", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "How long is the event?" }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", alignItems: "center", children: (0, jsx_runtime_1.jsx)(TextField_1.default, { label: "Duration (minutes)", type: "number", onChange: changeDuration, value: `${duration}`, placeholder: "1", style: styles.duration }) })] })] }) }));
}
exports.default = CreateMeetingAssistBaseStep5;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3JlYXRlTWVldGluZ0Fzc2lzdEJhc2VTdGVwNS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkNyZWF0ZU1lZXRpbmdBc3Npc3RCYXNlU3RlcDUudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBd0JBLGdEQXFDQzs7QUE3REQsaUNBSWM7QUFFZCxnREFBdUM7QUFDdkMsb0RBQW9EO0FBQ3BELHdFQUF3RTtBQUN4RSw0REFBa0U7QUFDbEUsNENBQTBDO0FBQ3pDLGdFQUF3QztBQUN6QyxpRUFBd0M7QUFDeEMsbUVBQTBDO0FBQzFDLHNFQUE2QztBQUU3QywrQ0FBNEc7QUFDNUcsNENBQTJDO0FBQzNDLDRDQUF3QztBQUV4Qyx3RUFBOEM7QUFDOUMsaUVBQTZEO0FBQzdELDhFQUFxRDtBQUU5QyxLQUFLLFVBQVUsa0JBQWtCLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFpRDtJQUNsRywwRkFBMEY7SUFDMUYsc0NBQXNDO0lBQ3RDLHlFQUF5RTtJQUN6RSwwQkFBZSxDQUFDLElBQUksQ0FBQyxJQUFBLDZCQUFhLEdBQUUsQ0FBQyxDQUFBO0lBQ3JDLElBQUksT0FBTyxDQUFBO0lBQ1gsSUFBSSxDQUFDO1FBQ0gsT0FBTyxHQUFHLE1BQU0saUJBQU8sQ0FBQyxVQUFVLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRTtZQUMzQyw2QkFBNkIsRUFBRSxLQUFLO2dCQUNsQyxPQUFPLEVBQUUsQ0FBQTtZQUNYLENBQUM7U0FDRixDQUFDLENBQUE7SUFDSixDQUFDO0lBQUMsT0FBTyxHQUFRLEVBQUUsQ0FBQztRQUNsQixJQUFJLEdBQUcsQ0FBQyxJQUFJLEtBQUssaUJBQU8sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUNqRCxPQUFPLEVBQUUsS0FBSyxFQUFFLEVBQUUsZUFBZSxFQUFFLGVBQWUsRUFBRSxFQUFFLENBQUE7UUFDeEQsQ0FBQzthQUFNLElBQUksR0FBRyxDQUFDLElBQUksS0FBSyxpQkFBTyxDQUFDLEtBQUss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ZSxcbiAgRGlzcGF0Y2gsXG4gIFNldFN0YXRlQWN0aW9uLFxufSBmcm9tICdyZWFjdCdcblxuaW1wb3J0IHsgZGF5anMgfSBmcm9tICdAbGliL2RhdGUtdXRpbHMnXG4vLyBpbXBvcnQgRGF0ZVBpY2tlciBmcm9tICdyZWFjdC1uYXRpdmUtZGF0ZS1waWNrZXInXG4vLyBpbXBvcnQgRGF0ZVRpbWVQaWNrZXIgZnJvbSAncmVhY3QtZGF0ZXRpbWUtcGlja2VyL2Rpc3QvZW50cnkubm9zdHlsZSdcbmltcG9ydCB7IGNvbG9yc1BhbGV0dGUgYXMgQ29sb3JzIH0gZnJvbSAnQGxpYi90aGVtZS9jb2xvcnNQYWxldHRlJ1xuaW1wb3J0IHsgVG9vbHRpcCB9IGZyb20gJ0BjaGFrcmEtdWkvcmVhY3QnXG4gaW1wb3J0IFN3aXRjaDEgZnJvbSAnQGNvbXBvbmVudHMvU3dpdGNoJ1xuaW1wb3J0IEJveCBmcm9tICdAY29tcG9uZW50cy9jb21tb24vQm94J1xuaW1wb3J0IFRleHQgZnJvbSAnQGNvbXBvbmVudHMvY29tbW9uL1RleHQnXG5pbXBvcnQgVGV4dEZpZWxkIGZyb20gJ0Bjb21wb25lbnRzL1RleHRGaWVsZCdcblxuaW1wb3J0IHsgQXBwZWFyYW5jZSwgUHJlc3NhYmxlLCBTdHlsZVNoZWV0LCBTY3JvbGxWaWV3LCBLZXlib2FyZEF2b2lkaW5nVmlldywgUGxhdGZvcm0gfSBmcm9tICdyZWFjdC1uYXRpdmUnXG5pbXBvcnQgeyB1c2VUb2FzdCB9IGZyb20gJ0BjaGFrcmEtdWkvcmVhY3QnXG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gJ0BjaGFrcmEtdWkvcmVhY3QnXG5pbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgc3VwZXJ0b2tlbnNOb2RlIGZyb20gJ3N1cGVydG9rZW5zLW5vZGUnXG5pbXBvcnQgeyBiYWNrZW5kQ29uZmlnIH0gZnJvbSAnLi4vLi4vLi4vY29uZmlnL2JhY2tlbmRDb25maWcnXG5pbXBvcnQgU2Vzc2lvbiBmcm9tICdzdXBlcnRva2Vucy1ub2RlL3JlY2lwZS9zZXNzaW9uJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2VydmVyU2lkZVByb3BzKHsgcmVxLCByZXMgfTogeyByZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSB9KSB7XG4gIC8vIE5vdGljZSBob3cgdGhlIHNlcnZlciB1c2VzIGBBUElgIGZyb20gYHdpdGhTU1JDb250ZXh0YCwgaW5zdGVhZCBvZiB0aGUgdG9wLWxldmVsIGBBUElgLlxuICAvLyBjb25zdCBTU1IgPSB3aXRoU1NSQ29udGV4dCh7IHJlcSB9KVxuICAvLyB0aGlzIHJ1bnMgb24gdGhlIGJhY2tlbmQsIHNvIHdlIG11c3QgY2FsbCBpbml0IG9uIHN1cGVydG9rZW5zLW5vZGUgU0RLXG4gIHN1cGVydG9rZW5zTm9kZS5pbml0KGJhY2tlbmRDb25maWcoKSlcbiAgbGV0IHNlc3Npb25cbiAgdHJ5IHtcbiAgICBzZXNzaW9uID0gYXdhaXQgU2Vzc2lvbi5nZXRTZXNzaW9uKHJlcSwgcmVzLCB7XG4gICAgICBvdmVycmlkZUdsb2JhbENsYWltVmFsaWRhdG9yczogYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gW11cbiAgICAgIH0sXG4gICAgfSlcbiAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICBpZiAoZXJyLnR5cGUgPT09IFNlc3Npb24uRXJyb3IuVFJZX1JFRlJFU0hfVE9LRU4pIHtcbiAgICAgIHJldHVybiB7IHByb3BzOiB7IGZyb21TdXBlcnRva2VuczogJ25lZWRzLXJlZnJlc2gnIH0gfVxuICAgIH0gZWxzZSBpZiAoZXJyLnR5cGUgPT09IFNlc3Npb24uRXJyb3IuVU5BVVRIT1JJU0VEKSB7XG4gICAgICAvLyB0aGlzIHdpbGwgZm9yY2UgdGhlIGZyb250ZW5kIHRvIHRyeSBhbmQgcmVmcmVzaCB3aGljaCB3aWxsIGZhaWxcbiAgICAgIC8vIGNsZWFyaW5nIGFsbCBjb29raWVzIGFuZCByZWRpcmVjdGluZyB0aGUgdXNlciB0byB0aGUgbG9naW4gc2NyZWVuLlxuICAgICAgcmV0dXJuIHsgcHJvcHM6IHsgZnJvbVN1cGVydG9rZW5zOiAnbmVlZHMtcmVmcmVzaCcgfSB9XG4gICAgfVxuICAgIHRocm93IGVyclxuICB9XG5cbiAgaWYgKCFzZXNzaW9uPy5nZXRVc2VySWQoKSkge1xuICAgIHJldHVybiB7XG4gICAgICByZWRpcmVjdDoge1xuICAgICAgICBkZXN0aW5hdGlvbjogJy9Vc2VyL0xvZ2luL1VzZXJMb2dpbicsXG4gICAgICAgIHBlcm1hbmVudDogZmFsc2UsXG4gICAgICB9LFxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcHJvcHM6IHtcbiAgICAgIHN1Yjogc2Vzc2lvbi5nZXRVc2VySWQoKSxcbiAgICB9XG4gIH1cbn1cblxudHlwZSBQcm9wcyA9IHtcbiAgICBjYW5jZWxJZkFueVJlZnVzZTogYm9vbGVhbixcbiAgICBlbmFibGVBdHRlbmRlZVByZWZlcmVuY2VzOiBib29sZWFuLFxuICAgIGF0dGVuZGVlQ2FuTW9kaWZ5OiBib29sZWFuLFxuICAgIGV4cGlyZURhdGU6IERhdGUsXG4gICAgZHVyYXRpb246IG51bWJlcixcbiAgICBzZXRQYXJlbnRDYW5jZWxJZkFueVJlZnVzZTogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248Ym9vbGVhbj4+LFxuICAgIHNldFBhcmVudEVuYWJsZUF0dGVuZGVlUHJlZmVyZW5jZXM6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPGJvb2xlYW4+PixcbiAgICBzZXRQYXJlbnRBdHRlbmRlZUNhbk1vZGlmeTogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248Ym9vbGVhbj4+LFxuICAgIHNldFBhcmVudEV4cGlyZURhdGU6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPERhdGU+PixcbiAgICBzZXRQYXJlbnREdXJhdGlvbjogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248bnVtYmVyPj4sXG59XG5cbmNvbnN0IGRhcmsgPSBBcHBlYXJhbmNlLmdldENvbG9yU2NoZW1lKCkgPT09ICdkYXJrJ1xuXG5jb25zdCBzdHlsZXMgPSB7XG4gICAgY29udGFpbmVyOiB7XG4gICAgICBmbGV4OiAxLFxuICAgIH0sXG4gICAgZHVyYXRpb246IHtcbiAgICAgICAgZm9udFNpemU6ICcyMXB4JyxcbiAgICAgICAgbGluZUhlaWdodDogJzI4cHgnLFxuICAgIH1cbn1cblxuZnVuY3Rpb24gQ3JlYXRlTWVldGluZ0Fzc2lzdEJhc2VTdGVwNShwcm9wczogUHJvcHMpIHtcbiAgICBjb25zdCBbY2FuY2VsSWZBbnlSZWZ1c2UsIHNldENhbmNlbElmQW55UmVmdXNlXSA9IHVzZVN0YXRlPGJvb2xlYW4+KHByb3BzPy5jYW5jZWxJZkFueVJlZnVzZSlcbiAgICBjb25zdCBbZW5hYmxlQXR0ZW5kZWVQcmVmZXJlbmNlcywgc2V0RW5hYmxlQXR0ZW5kZWVQcmVmZXJlbmNlc10gPSB1c2VTdGF0ZTxib29sZWFuPihwcm9wcz8uZW5hYmxlQXR0ZW5kZWVQcmVmZXJlbmNlcylcbiAgICBjb25zdCBbYXR0ZW5kZWVDYW5Nb2RpZnksIHNldEF0dGVuZGVlQ2FuTW9kaWZ5XSA9IHVzZVN0YXRlPGJvb2xlYW4+KHByb3BzPy5hdHRlbmRlZUNhbk1vZGlmeSlcbiAgICBjb25zdCBbZXhwaXJlRGF0ZSwgc2V0RXhwaXJlRGF0ZV0gPSB1c2VTdGF0ZTxEYXRlPihwcm9wcz8uZXhwaXJlRGF0ZSlcbiAgICBjb25zdCBbZHVyYXRpb24sIHNldER1cmF0aW9uXSA9IHVzZVN0YXRlPG51bWJlcj4ocHJvcHM/LmR1cmF0aW9uKVxuICAgIGNvbnN0IFtpc01lc3NhZ2UsIHNldElzTWVzc2FnZV0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSlcbiAgICBjb25zdCBbaXNFeHBpcmVEYXRlUGlja2VyLCBzZXRJc0V4cGlyZURhdGVQaWNrZXJdID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpXG5cbiAgICBjb25zdCBzZXRQYXJlbnRDYW5jZWxJZkFueVJlZnVzZSA9IHByb3BzPy5zZXRQYXJlbnRDYW5jZWxJZkFueVJlZnVzZVxuICAgIGNvbnN0IHNldFBhcmVudEVuYWJsZUF0dGVuZGVlUHJlZmVyZW5jZXMgPSBwcm9wcz8uc2V0UGFyZW50RW5hYmxlQXR0ZW5kZWVQcmVmZXJlbmNlc1xuICAgIGNvbnN0IHNldFBhcmVudEF0dGVuZGVlQ2FuTW9kaWZ5ID0gcHJvcHM/LnNldFBhcmVudEF0dGVuZGVlQ2FuTW9kaWZ5XG4gICAgY29uc3Qgc2V0UGFyZW50RXhwaXJlRGF0ZSA9IHByb3BzPy5zZXRQYXJlbnRFeHBpcmVEYXRlXG4gICAgY29uc3Qgc2V0UGFyZW50RHVyYXRpb24gPSBwcm9wcz8uc2V0UGFyZW50RHVyYXRpb25cbiAgICBjb25zdCB0b2FzdCA9IHVzZVRvYXN0KClcblxuICAgIGNvbnN0IGNoYW5nZUNhbmNlbElmQW55UmVmdXNlID0gKHZhbHVlOiBib29sZWFuKSA9PiB7XG4gICAgICAgIHNldENhbmNlbElmQW55UmVmdXNlKHZhbHVlKVxuICAgICAgICBzZXRQYXJlbnRDYW5jZWxJZkFueVJlZnVzZSh2YWx1ZSlcbiAgICB9XG5cbiAgICBjb25zdCBjaGFuZ2VFbmFibGVBdHRlbmRlZVByZWZlcmVuY2VzID0gKHZhbHVlOiBib29sZWFuKSA9PiB7XG4gICAgICAgIHNldEVuYWJsZUF0dGVuZGVlUHJlZmVyZW5jZXModmFsdWUpXG4gICAgICAgIHNldFBhcmVudEVuYWJsZUF0dGVuZGVlUHJlZmVyZW5jZXModmFsdWUpXG4gICAgfVxuXG4gICAgY29uc3QgY2hhbmdlQXR0ZW5kZWVDYW5Nb2RpZnkgPSAodmFsdWU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgc2V0QXR0ZW5kZWVDYW5Nb2RpZnkodmFsdWUpXG4gICAgICAgIHNldFBhcmVudEF0dGVuZGVlQ2FuTW9kaWZ5KHZhbHVlKVxuICAgIH1cblxuICAgIGNvbnN0IGNoYW5nZUV4cGlyZURhdGUgPSAodmFsdWU6IERhdGUpID0+IHtcbiAgICAgICAgc2V0RXhwaXJlRGF0ZSh2YWx1ZSlcbiAgICAgICAgc2V0UGFyZW50RXhwaXJlRGF0ZSh2YWx1ZSlcbiAgICB9XG5cbiAgICAvLyBcbiAgICBjb25zdCBjaGFuZ2VEdXJhdGlvbiA9IChlOiB7IHRhcmdldDogeyB2YWx1ZTogc3RyaW5nIH0gfSkgPT4ge1xuICAgICAgICBjb25zdCBfdmFsdWUgPSBlPy50YXJnZXQ/LnZhbHVlXG4gICAgICAgIGNvbnN0IGludFZhbHVlID0gcGFyc2VJbnQoX3ZhbHVlLnJlcGxhY2UoL1teMC05Ll0vZywgJycpLCAxMClcblxuICAgICAgICAvLyB2YWxpZGF0ZVxuICAgICAgICBpZiAoaW50VmFsdWUgPCAzMCkge1xuICAgICAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1RvbyBzaG9ydCcsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdZb3VyIGR1cmF0aW9uIGlzIHRvbyBzaG9ydC4gTWFrZSBpdCBtb3JlIHRoYW4gb3IgZXF1YWwgdG8gMzAgbWludXRlcycsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDkwMDAsXG4gICAgICAgICAgICAgICAgaXNDbG9zYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHNldER1cmF0aW9uKDMwKVxuICAgICAgICAgICAgc2V0UGFyZW50RHVyYXRpb24oMzApXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgc2V0RHVyYXRpb24oaW50VmFsdWUgfHwgMzApXG4gICAgICAgIHNldFBhcmVudER1cmF0aW9uKGludFZhbHVlIHx8IDMwKVxuICAgIH1cblxuICAgIGNvbnN0IGhpZGVFeHBpcmVEYXRlUGlja2VyID0gKCkgPT4gc2V0SXNFeHBpcmVEYXRlUGlja2VyKGZhbHNlKVxuXG4gICAgY29uc3Qgc2hvd0V4cGlyZURhdGVQaWNrZXIgPSAoKSA9PiBzZXRJc0V4cGlyZURhdGVQaWNrZXIodHJ1ZSlcblxuICAgIHJldHVybiAoXG5cbiAgICAgICAgPFNjcm9sbFZpZXcgc3R5bGU9e3sgZmxleDogMSwgd2lkdGg6ICcxMDAlJywgbWF4SGVpZ2h0OiAnNjV2aCcgfX0gIGNvbnRlbnRDb250YWluZXJTdHlsZT17eyBhbGlnbkl0ZW1zOiAnY2VudGVyJywgbWF4SGVpZ2h0OiAnNjV2aCd9fT5cbiAgICAgICAgICAgIDxCb3ggZmxleD17MX0ganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgc3R5bGU9e3sgd2lkdGg6ICcxMDAlJyB9fT5cbiAgICAgICAgICAgICAgICA8Qm94ICBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fSBmbGV4RGlyZWN0aW9uPXt7IHRhYmxldDogXCJyb3dcIn19IGp1c3RpZnlDb250ZW50PVwic3BhY2UtYmV0d2VlblwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIiB3aWR0aD1cIjcwJVwiPlxuICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCIgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2FuY2VsIHBsYW5uaW5nIGlmIGFueSByZWZ1c2U/XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtZW5kXCIgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8U3dpdGNoMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ29sb3I9e0NvbG9ycy5wdXJwbGUzMH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZDb2xvcj17Q29sb3JzLnB1cnBsZTYwfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NhbmNlbElmQW55UmVmdXNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9e2NoYW5nZUNhbmNlbElmQW55UmVmdXNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luQm90dG9tOiAyMH19XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICA8Qm94ICBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fSBmbGV4RGlyZWN0aW9uPXt7IHRhYmxldDogXCJyb3dcIn19IGp1c3RpZnlDb250ZW50PVwic3BhY2UtYmV0d2VlblwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIiB3aWR0aD1cIjcwJVwiPlxuICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCIgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQWxsb3cgYXR0ZW5kZWUgdG8gc2VsZWN0IHRpbWUgcHJlZmVyZW5jZXMgKHNsb3RzKSBmb3IgZXZlbnQ/XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtZW5kXCIgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8U3dpdGNoMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ29sb3I9e0NvbG9ycy5wdXJwbGUzMH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZDb2xvcj17Q29sb3JzLnB1cnBsZTYwfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2VuYWJsZUF0dGVuZGVlUHJlZmVyZW5jZXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25WYWx1ZUNoYW5nZT17Y2hhbmdlRW5hYmxlQXR0ZW5kZWVQcmVmZXJlbmNlc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbkJvdHRvbTogMjB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPEJveCAgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0gZmxleERpcmVjdGlvbj17eyB0YWJsZXQ6IFwicm93XCJ9fSBqdXN0aWZ5Q29udGVudD1cInNwYWNlLWJldHdlZW5cIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgd2lkdGg9XCI3MCVcIj5cbiAgICAgICAgICAgICAgICAgICAgPEJveCBmbGV4RGlyZWN0aW9uPVwicm93XCIganVzdGlmeUNvbnRlbnQ9XCJmbGV4LXN0YXJ0XCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiIHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFsbG93IGF0dGVuZGVlIHRvIGNoYW5nZSBleGlzdGluZyB0aW1lIHByZWZlcmVuY2VzIChzbG90cykgZm9yIGV2ZW50P1xuICAgICAgICAgICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgPEJveCBmbGV4RGlyZWN0aW9uPVwicm93XCIganVzdGlmeUNvbnRlbnQ9XCJmbGV4LWVuZFwiIHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFN3aXRjaDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNvbG9yPXtDb2xvcnMucHVycGxlMzB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmQ29sb3I9e0NvbG9ycy5wdXJwbGU2MH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXthdHRlbmRlZUNhbk1vZGlmeX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblZhbHVlQ2hhbmdlPXtjaGFuZ2VBdHRlbmRlZUNhbk1vZGlmeX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e21hcmdpbkJvdHRvbTogMjB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPEJveCBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fSBmbGV4RGlyZWN0aW9uPXt7IHRhYmxldDogXCJyb3dcIn19IGp1c3RpZnlDb250ZW50PVwic3BhY2UtYmV0d2VlblwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIiB3aWR0aD1cIjcwJVwiPlxuICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcCBsYWJlbD1cIllvdSBjYW4gc2VsZWN0IGEgdGltZSB3aGVuIHRoZSBtZWV0aW5nIGFzc2lzdCB3aWxsIG5vIGxvbmdlciB2YWxpZCBpZiBtaW5pbXVtIG51bWJlciBvZiBhdHRlbmRlZXMgZG8gbm90IHNheSBcXCdZZXNcXCcuIEluIG90aGVyIHdvcmRzLCBubyBuZXcgZXZlbnRzIHdpbGwgYmUgY3JlYXRlZC5cIiBhcmlhLWxhYmVsPSdBIHRvb2x0aXAnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0IHZhcmlhbnQ9XCJvcHRpb25IZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV2hlbiB3aWxsIHBsYW5uaW5nIHRoaXMgZXZlbnQgZXhwaXJlIGlmIG1pbmltdW0gdGhyZXNob2xkIG9mIGFjY2VwdGVkIGludml0ZXMgaXMgbm90IG1ldD9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtZW5kXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlNlbGVjdCBEYXRlIGFuZCBUaW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplPVwibWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJkYXRldGltZS1sb2NhbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUV4cGlyZURhdGUoZGF5anMoZT8udGFyZ2V0Py52YWx1ZSwgXCJZWVlZLU1NLUREVEhIOm1tXCIpLnRvRGF0ZSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtkYXlqcyhleHBpcmVEYXRlKS5mb3JtYXQoXCJZWVlZLU1NLUREVEhIOm1tXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPEJveCBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fSBmbGV4RGlyZWN0aW9uPXt7IHRhYmxldDogXCJyb3dcIn19IGp1c3RpZnlDb250ZW50PVwic3BhY2UtYmV0d2VlblwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIiB3aWR0aD1cIjcwJVwiPlxuICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSG93IGxvbmcgaXMgdGhlIGV2ZW50P1xuICAgICAgICAgICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgPEJveCBmbGV4RGlyZWN0aW9uPVwicm93XCIganVzdGlmeUNvbnRlbnQ9XCJmbGV4LWVuZFwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJEdXJhdGlvbiAobWludXRlcylcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e2NoYW5nZUR1cmF0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17YCR7ZHVyYXRpb259YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIxXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3N0eWxlcy5kdXJhdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgIDwvU2Nyb2xsVmlldz5cblxuICAgIClcblxufVxuXG5leHBvcnQgZGVmYXVsdCBDcmVhdGVNZWV0aW5nQXNzaXN0QmFzZVN0ZXA1XG5cblxuXG5cbiJdfQ==