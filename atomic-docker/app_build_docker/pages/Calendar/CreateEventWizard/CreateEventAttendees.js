"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getServerSideProps = getServerSideProps;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_native_1 = require("react-native");
const TextField_1 = __importDefault(require("@components/TextField"));
const themed_1 = require("@rneui/themed");
const Fab_1 = __importDefault(require("@mui/material/Fab"));
const Add_1 = __importDefault(require("@mui/icons-material/Add"));
const styles_1 = require("@mui/material/styles");
const Zoom_1 = __importDefault(require("@mui/material/Zoom"));
const SpeedDial_1 = __importDefault(require("@mui/material/SpeedDial"));
const SpeedDialIcon_1 = __importDefault(require("@mui/material/SpeedDialIcon"));
const SpeedDialAction_1 = __importDefault(require("@mui/material/SpeedDialAction"));
const colors_1 = require("@mui/material/colors");
const ImportContacts_1 = __importDefault(require("@mui/icons-material/ImportContacts"));
const Keyboard_1 = __importDefault(require("@mui/icons-material/Keyboard"));
const Edit_1 = __importDefault(require("@mui/icons-material/Edit"));
const Box_1 = __importDefault(require("@components/common/Box"));
const Text_1 = __importDefault(require("@components/common/Text"));
const Button_1 = __importDefault(require("@components/Button"));
const RegularCard_1 = __importDefault(require("@components/RegularCard"));
const ContactHelper_1 = require("@lib/Contact/ContactHelper");
const wizardHelper_1 = require("@lib/Calendar/CreateEventWizard/wizardHelper");
const theme_1 = require("@lib/theme/theme");
const fabStyle = {
    position: 'absolute',
    bottom: 16,
    right: 16,
};
const supertokens_node_1 = __importDefault(require("supertokens-node"));
const backendConfig_1 = require("../../../config/backendConfig");
const session_1 = __importDefault(require("supertokens-node/recipe/session"));
async function getServerSideProps({ req, res }) {
    // Notice how the server uses `API` from `withSSRContext`, instead of the top-level `API`.
    // const SSR = withSSRContext({ req })
    // this runs on the backend, so we must call init on supertokens-node SDK
    supertokens_node_1.default.init((0, backendConfig_1.backendConfig)());
    let session;
    try {
        session = await session_1.default.getSession(req, res, {
            overrideGlobalClaimValidators: async function () {
                return [];
            },
        });
    }
    catch (err) {
        if (err.type === session_1.default.Error.TRY_REFRESH_TOKEN) {
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        else if (err.type === session_1.default.Error.UNAUTHORISED) {
            // this will force the frontend to try and refresh which will fail
            // clearing all cookies and redirecting the user to the login screen.
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        throw err;
    }
    if (!session?.getUserId()) {
        return {
            redirect: {
                destination: '/User/Login/UserLogin',
                permanent: false,
            },
        };
    }
    return {
        props: {
            sub: session.getUserId(),
        }
    };
}
function Contacts(props) {
    const [contacts, setContacts] = (0, react_1.useState)(props?.contacts);
    const closeContacts = props?.closeContacts;
    return ((0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, minHeight: "65vh", maxHeight: "65vh", children: [contacts?.length > 0
                ? ((0, jsx_runtime_1.jsx)(react_native_1.FlatList, { data: contacts, renderItem: ({ item, index }) => ((0, jsx_runtime_1.jsx)(Contact, { contact: item, addContactToAttendees: props?.addContactToAttendees, removeContactFromAttendee: props?.removeContactFromAttendee, updateContactSelection: props?.updateContactSelection, contacts: contacts, setContacts: setContacts, setParentA: props?.setParentA, attendees: props?.attendees, setAttendees: props?.setAttendees, index: index })), keyExtractor: (item, index) => `${item}-${index}` })) : ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "subheader", children: "You have no contacts saved. Go to settings to enable and sync Contacts from your phone or 3rd party provider." }) })), (0, jsx_runtime_1.jsx)(Box_1.default, { justifyContent: "center", alignItems: "center", style: { width: '100%' }, children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: closeContacts, children: (0, jsx_runtime_1.jsx)(Text_1.default, { p: { phone: 'm', tablet: 'l' }, variant: "buttonLink", children: "Close" }) }) })] }));
}
function Contact(props) {
    const [selected, setSelected] = (0, react_1.useState)(props?.attendees.findIndex(i => i.id === props?.contact.id) > -1);
    const updateSelected = () => {
        const value = !selected;
        setSelected(value);
        if (value === true) {
            props?.updateContactSelection(value, props?.contact, props?.contacts, props?.setContacts, props?.index);
            props?.addContactToAttendees(props?.contact, props?.attendees, props?.setAttendees, props?.setParentA);
        }
        else if (value === false) {
            props?.updateContactSelection(value, props?.contact, props?.contacts, props?.setContacts, props?.index);
            props?.removeContactFromAttendee(props?.contact, props?.attendees, props?.setAttendees, props?.setParentA);
        }
    };
    return ((0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsxs)(RegularCard_1.default, { children: [(0, jsx_runtime_1.jsx)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: props?.contact?.name }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "caption", children: props?.contact?.emails?.filter(i => (i.primary === true))?.[0]?.value }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: updateSelected, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", children: selected ? 'Remove' : 'Add' }) }) })] }) }));
}
function ManualEntry(props) {
    const [emails, setEmails] = (0, react_1.useState)(props?.emails);
    const [additionalGuests, setAdditionalGuests] = (0, react_1.useState)(props?.additionalGuests || 0);
    const updateEntryInManualEntries = props?.updateEntryInManualEntries;
    const removeEntryFromManualEntries = props?.removeEntryFromManualEntries;
    const setManualEntries = props?.setManualEntries;
    const manualEntries = props?.manualEntries;
    const index = props?.index;
    const setParentA = props?.setParentA;
    const parentIndex = props?.parentIndex;
    const attendees = props?.attendees;
    const setAttendees = props?.setAttendees;
    const onEmailChange = (value) => {
        setEmails([{ ...emails?.[0], primary: true, value, type: '' }]);
        updateEntryInManualEntries(manualEntries, setManualEntries, index, attendees, setAttendees, setParentA, parentIndex, [{ ...emails?.[0], primary: true, value, type: '' }], undefined, additionalGuests);
    };
    const onNameChange = (value) => {
        setEmails([{ ...emails?.[0], primary: true, displayName: value, type: '' }]);
        updateEntryInManualEntries(manualEntries, setManualEntries, index, attendees, setAttendees, setParentA, parentIndex, [{ ...emails?.[0], primary: true, displayName: value, type: '' }], value, additionalGuests);
    };
    const onAdditionalGuestsChange = (text) => {
        setAdditionalGuests(parseInt(text.replace(/[^0-9.]/g, ''), 10));
        updateEntryInManualEntries(manualEntries, setManualEntries, index, attendees, setAttendees, setParentA, parentIndex, emails, undefined, parseInt(text.replace(/[^0-9.]/g, ''), 10));
    };
    return ((0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsxs)(RegularCard_1.default, { children: [(0, jsx_runtime_1.jsxs)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Email" }), (0, jsx_runtime_1.jsx)(TextField_1.default, { placeholder: "r@r.com", onChange: (e) => onEmailChange(e?.target?.value), value: emails?.[0]?.value || '', style: { width: '60%' }, validate: "email", validationMessage: "Please enter a valid email address" })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Display Name" }), (0, jsx_runtime_1.jsx)(TextField_1.default, { placeholder: "name", onChange: (e) => onNameChange(e?.target?.value), value: manualEntries?.[index]?.name || '', style: { width: '60%' } })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Additional Guests?" }), (0, jsx_runtime_1.jsx)(TextField_1.default, { type: "number", onChange: (e) => onAdditionalGuestsChange(e?.target?.value), value: `${additionalGuests}`, placeholder: "0", style: { width: '15%' } })] }), (0, jsx_runtime_1.jsx)(Button_1.default, { onClick: () => removeEntryFromManualEntries(manualEntries, setManualEntries, attendees, setAttendees, setParentA, index, parentIndex), children: "Remove" })] }) }));
}
function ManualEntries(props) {
    const [pageOffset, setPageOffset] = (0, react_1.useState)(0);
    const { height: fullHeight } = react_native_1.Dimensions.get('window');
    const theme = (0, styles_1.useTheme)();
    const transitionDuration = {
        enter: theme.transitions.duration.enteringScreen,
        exit: theme.transitions.duration.leavingScreen,
    };
    const closeManual = props?.closeManual;
    const addNewEntry = () => {
        const addOneToManualEntries = props?.addOneToManualEntries;
        addOneToManualEntries(props?.manualEntries, props?.setManualEntries, props?.attendees, props?.setAttendees, props?.setParentA);
    };
    return ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, style: { width: '100%' }, minHeight: "65vh", maxHeight: "65vh", children: (0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, style: { width: '100%' }, children: [props?.manualEntries?.length > 0
                    ? ((0, jsx_runtime_1.jsx)(react_native_1.FlatList, { data: props?.manualEntries, renderItem: ({ item, index }) => ((0, jsx_runtime_1.jsx)(ManualEntry, { ...item, updateEntryInManualEntries: props?.updateEntryInManualEntries, removeEntryFromManualEntries: props?.removeEntryFromManualEntries, index: index, setManualEntries: props?.setManualEntries, manualEntries: props?.manualEntries, setParentA: props?.setParentA, parentIndex: props?.attendees.findIndex(a => (a?.id === item?.id)), attendees: props?.attendees, setAttendees: props?.setAttendees })), keyExtractor: (item) => item?.id })) : ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "subheader", children: "Add a New Entry" }) })), (0, jsx_runtime_1.jsx)(Box_1.default, { justifyContent: "center", alignItems: "center", style: { width: '100%' }, children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: closeManual, children: (0, jsx_runtime_1.jsx)(Text_1.default, { p: { phone: 'm', tablet: 'l' }, variant: "buttonLink", children: "Close" }) }) }), (0, jsx_runtime_1.jsx)(Zoom_1.default, { in: true, timeout: transitionDuration, style: {
                        transitionDelay: `${transitionDuration.exit}ms`,
                    }, unmountOnExit: true, children: (0, jsx_runtime_1.jsx)(Fab_1.default, { sx: fabStyle, "aria-label": 'Add', color: "primary", onClick: addNewEntry, children: (0, jsx_runtime_1.jsx)(Add_1.default, { sx: { color: colors_1.pink[500] } }) }) })] }) }));
}
function CreateEventAttendees(props) {
    const [attendees, setAttendees] = (0, react_1.useState)(props?.attendees);
    const [isManual, setIsManual] = (0, react_1.useState)(false);
    const [manualEntries, setManualEntries] = (0, react_1.useState)([]);
    const [isContacts, setIsContacts] = (0, react_1.useState)(false);
    const [contacts, setContacts] = (0, react_1.useState)([]);
    const [isOpen, setIsOpen] = (0, react_1.useState)(false);
    // const [contactChecks, setContactChecks] = useState<boolean[]>([])
    const userId = props?.userId;
    // const parentAttendees = props?.attendees
    const setParentAttendees = props?.setParentAttendees;
    const client = props?.client;
    // get any contacts
    (0, react_1.useEffect)(() => {
        (async () => {
            if (!client || !userId) {
                return;
            }
            const newContacts = await (0, ContactHelper_1.listUserContactsHelper)(client, userId);
            if (newContacts && newContacts?.length > 0) {
                setContacts(newContacts
                    .map(c => ({ ...c, selected: false }))
                    .filter(c => (c?.emails?.[0]?.value && c?.emails?.[0]?.value?.length > 0)));
            }
        })();
    }, [client, userId]);
    const onManualChange = () => {
        setIsContacts(isManual);
        setIsManual(!isManual);
    };
    const onContactsChange = () => {
        setIsManual(isContacts);
        setIsContacts(!isContacts);
    };
    const closeContacts = () => setIsContacts(false);
    const closeManual = () => setIsManual(false);
    const actions = [
        { icon: (0, jsx_runtime_1.jsx)(ImportContacts_1.default, { color: "secondary" }), name: 'Import Contacts', method: onContactsChange },
        { icon: (0, jsx_runtime_1.jsx)(Keyboard_1.default, { color: "secondary" }), name: 'Manual Entry', method: onManualChange },
    ];
    if (isManual) {
        return ((0, jsx_runtime_1.jsx)(ManualEntries, { setManualEntries: setManualEntries, manualEntries: manualEntries, attendees: attendees, setAttendees: setAttendees, setParentA: setParentAttendees, updateEntryInManualEntries: wizardHelper_1.updateEntryInManualEntries, removeEntryFromManualEntries: wizardHelper_1.removeEntryFromManualEntries, addOneToManualEntries: wizardHelper_1.addOneToManualEntries, closeManual: closeManual }));
    }
    if (isContacts) {
        return ((0, jsx_runtime_1.jsx)(Contacts, { addContactToAttendees: wizardHelper_1.addContactToAttendees, removeContactFromAttendee: wizardHelper_1.removeContactFromAttendee, updateContactSelection: wizardHelper_1.updateContactSelection, contacts: contacts, setParentA: setParentAttendees, attendees: attendees, setAttendees: setAttendees, closeContacts: closeContacts }));
    }
    return ((0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, style: { width: '100%' }, minHeight: "65vh", maxHeight: "65vh", children: [attendees?.length > 0
                ? ((0, jsx_runtime_1.jsx)(react_native_1.FlatList, { data: attendees, renderItem: ({ item }) => ((0, jsx_runtime_1.jsx)(themed_1.ListItem, { containerStyle: {
                            backgroundColor: theme_1.palette.white,
                            borderBottomWidth: react_native_1.StyleSheet.hairlineWidth,
                            borderColor: theme_1.palette.darkGray
                        }, children: (0, jsx_runtime_1.jsxs)(themed_1.ListItem.Content, { children: [(0, jsx_runtime_1.jsx)(themed_1.ListItem.Title, { style: { color: theme_1.palette.textBlack, fontWeight: 'bold' }, children: item?.name }), (0, jsx_runtime_1.jsx)(themed_1.ListItem.Subtitle, { style: { color: theme_1.palette.textBlack, }, children: item?.emails?.[0]?.value })] }) })), keyExtractor: (item) => item?.id })) : ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "subheader", children: "Add an attendee from your contacts or manually enter one" }) })), (0, jsx_runtime_1.jsx)("div", { className: "absolute inset-0 z-20 pointer-events-none", children: (0, jsx_runtime_1.jsx)(SpeedDial_1.default, { ariaLabel: "Calendar SpeedDial", sx: { position: 'absolute', bottom: 24, right: 24, zIndex: 'speedDial' }, icon: (0, jsx_runtime_1.jsx)(SpeedDialIcon_1.default, { icon: (0, jsx_runtime_1.jsx)(Edit_1.default, {}), sx: { color: colors_1.pink[500] } }), children: actions.map((action) => ((0, jsx_runtime_1.jsx)(SpeedDialAction_1.default, { icon: action.icon, tooltipTitle: action.name, FabProps: {
                            onClick: action.method,
                        } }, action.name))) }) })] }));
}
exports.default = CreateEventAttendees;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3JlYXRlRXZlbnRBdHRlbmRlZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJDcmVhdGVFdmVudEF0dGVuZGVlcy50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFrRUEsZ0RBcUNDOztBQXZHRCxpQ0FLYztBQUNkLCtDQVNxQjtBQUNyQixzRUFBNkM7QUFDN0MsMENBRXNCO0FBQ3RCLDREQUFvQztBQUNwQyxrRUFBOEM7QUFDOUMsaURBQXdEO0FBQ3hELDhEQUFxQztBQUNyQyx3RUFBZ0Q7QUFDaEQsZ0ZBQXdEO0FBQ3hELG9GQUE0RDtBQUM1RCxpREFBMkM7QUFDM0Msd0ZBQW9FO0FBQ3BFLDRFQUF3RDtBQUN4RCxvRUFBZ0Q7QUFFaEQsaUVBQXdDO0FBQ3hDLG1FQUEwQztBQUMxQyxnRUFBdUM7QUFDdkMsMEVBQWlEO0FBRWpELDhEQUVtQztBQUluQywrRUFBd047QUFJeE4sNENBQTBDO0FBRzFDLE1BQU0sUUFBUSxHQUFHO0lBQ2YsUUFBUSxFQUFFLFVBQVU7SUFDcEIsTUFBTSxFQUFFLEVBQUU7SUFDVixLQUFLLEVBQUUsRUFBRTtDQUNWLENBQUE7QUFRRCx3RUFBOEM7QUFDOUMsaUVBQTZEO0FBQzdELDhFQUFxRDtBQUU5QyxLQUFLLFVBQVUsa0JBQWtCLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFpRDtJQUNsRywwRkFBMEY7SUFDMUYsc0NBQXNDO0lBQ3RDLHlFQUF5RTtJQUN6RSwwQkFBZSxDQUFDLElBQUksQ0FBQyxJQUFBLDZCQUFhLEdBQUUsQ0FBQyxDQUFBO0lBQ3JDLElBQUksT0FBTyxDQUFBO0lBQ1gsSUFBSSxDQUFDO1FBQ0gsT0FBTyxHQUFHLE1BQU0saUJBQU8sQ0FBQyxVQUFVLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRTtZQUMzQyw2QkFBNkIsRUFBRSxLQUFLO2dCQUNsQyxPQUFPLEVBQUUsQ0FBQTtZQUNYLENBQUM7U0FDRixDQUFDLENBQUE7SUFDSixDQUFDO0lBQUMsT0FBTyxHQUFRLEVBQUUs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LENBQUMsQ0FBQyxDQUNGLHVCQUFDLGFBQUcsSUFBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLGNBQWMsRUFBQyxRQUFRLEVBQUMsVUFBVSxFQUFDLFFBQVEsWUFDdkQsdUJBQUMsY0FBSSxJQUFDLE9BQU8sRUFBQyxXQUFXLHlFQUVsQixHQUNILENBQ1AsRUFFSixnQ0FBSyxTQUFTLEVBQUMsMkNBQTJDLFlBQ3RELHVCQUFDLG1CQUFTLElBQ04sU0FBUyxFQUFDLG9CQUFvQixFQUM5QixFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLEVBQ3hFLElBQUksRUFBRSx1QkFBQyx1QkFBYSxJQUFDLElBQUksRUFBRSx1QkFBQyxjQUFRLEtBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsYUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUksWUFFcEUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsQ0FDckIsdUJBQUMseUJBQWUsSUFFWixJQUFJLEVBQUUsTUFBTSxDQUFDLElBQUksRUFDakIsWUFBWSxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQ3pCLFFBQVEsRUFBRTs0QkFDTixPQUFPLEVBQUUsTUFBTSxDQUFDLE1BQU07eUJBQ3pCLElBTEksTUFBTSxDQUFDLElBQUksQ0FNbEIsQ0FDTCxDQUFDLEdBQ00sR0FDVixJQUNELENBQ1AsQ0FBQTtBQUNGLENBQUM7QUFFRCxrQkFBZSxvQkFBb0IsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwge1xudXNlU3RhdGUsXG51c2VFZmZlY3QsXG5EaXNwYXRjaCxcblNldFN0YXRlQWN0aW9uLFxufSBmcm9tICdyZWFjdCdcbmltcG9ydCB7XG4gIEZsYXRMaXN0LFxuICBTYWZlQXJlYVZpZXcsXG4gIFN0eWxlU2hlZXQsXG4gIFByZXNzYWJsZSxcbiAgS2V5Ym9hcmRBdm9pZGluZ1ZpZXcsXG4gIFBsYXRmb3JtLFxuICBEaW1lbnNpb25zLFxuICBBcHBlYXJhbmNlLFxufSBmcm9tICdyZWFjdC1uYXRpdmUnXG5pbXBvcnQgVGV4dEZpZWxkIGZyb20gJ0Bjb21wb25lbnRzL1RleHRGaWVsZCdcbmltcG9ydCB7XG4gIExpc3RJdGVtLFxufSBmcm9tICdAcm5ldWkvdGhlbWVkJ1xuaW1wb3J0IEZhYiBmcm9tICdAbXVpL21hdGVyaWFsL0ZhYic7XG5pbXBvcnQgQWRkSWNvbiBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsL0FkZCc7XG5pbXBvcnQgeyBTeFByb3BzLCB1c2VUaGVtZSB9IGZyb20gJ0BtdWkvbWF0ZXJpYWwvc3R5bGVzJ1xuaW1wb3J0IFpvb20gZnJvbSAnQG11aS9tYXRlcmlhbC9ab29tJ1xuaW1wb3J0IFNwZWVkRGlhbCBmcm9tICdAbXVpL21hdGVyaWFsL1NwZWVkRGlhbCc7XG5pbXBvcnQgU3BlZWREaWFsSWNvbiBmcm9tICdAbXVpL21hdGVyaWFsL1NwZWVkRGlhbEljb24nO1xuaW1wb3J0IFNwZWVkRGlhbEFjdGlvbiBmcm9tICdAbXVpL21hdGVyaWFsL1NwZWVkRGlhbEFjdGlvbic7XG5pbXBvcnQgeyBwaW5rIH0gZnJvbSAnQG11aS9tYXRlcmlhbC9jb2xvcnMnXG5pbXBvcnQgSW1wb3J0Q29udGFjdHNJY29uIGZyb20gJ0BtdWkvaWNvbnMtbWF0ZXJpYWwvSW1wb3J0Q29udGFjdHMnO1xuaW1wb3J0IEtleWJvYXJkSWNvbiBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsL0tleWJvYXJkJztcbmltcG9ydCBFZGl0SWNvbiBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsL0VkaXQnO1xuXG5pbXBvcnQgQm94IGZyb20gJ0Bjb21wb25lbnRzL2NvbW1vbi9Cb3gnXG5pbXBvcnQgVGV4dCBmcm9tICdAY29tcG9uZW50cy9jb21tb24vVGV4dCdcbmltcG9ydCBCdXR0b24gZnJvbSAnQGNvbXBvbmVudHMvQnV0dG9uJ1xuaW1wb3J0IFJlZ3VsYXJDYXJkIGZyb20gJ0Bjb21wb25lbnRzL1JlZ3VsYXJDYXJkJ1xuXG5pbXBvcnQge1xuICBsaXN0VXNlckNvbnRhY3RzSGVscGVyXG59IGZyb20gJ0BsaWIvQ29udGFjdC9Db250YWN0SGVscGVyJ1xuaW1wb3J0IHsgZW1haWwsIFBlcnNvbiB9IGZyb20gJ0BsaWIvQ2FsZW5kYXIvdHlwZXMnXG5cbmltcG9ydCB7IENvbnRhY3RUeXBlIH0gZnJvbSAnQGxpYi9kYXRhVHlwZXMvQ29udGFjdFR5cGUnXG5pbXBvcnQgeyBhZGRDb250YWN0VG9BdHRlbmRlZXMsIGFkZE9uZVRvTWFudWFsRW50cmllcywgcmVtb3ZlQ29udGFjdEZyb21BdHRlbmRlZSwgcmVtb3ZlRW50cnlGcm9tTWFudWFsRW50cmllcywgdXBkYXRlQ29udGFjdFNlbGVjdGlvbiwgdXBkYXRlRW50cnlJbk1hbnVhbEVudHJpZXMgfSBmcm9tICdAbGliL0NhbGVuZGFyL0NyZWF0ZUV2ZW50V2l6YXJkL3dpemFyZEhlbHBlcidcblxuaW1wb3J0IHsgQXBvbGxvQ2xpZW50LCBOb3JtYWxpemVkQ2FjaGVPYmplY3QgfSBmcm9tICdAYXBvbGxvL2NsaWVudCdcblxuaW1wb3J0IHsgcGFsZXR0ZSB9IGZyb20gJ0BsaWIvdGhlbWUvdGhlbWUnXG5cblxuY29uc3QgZmFiU3R5bGUgPSB7XG4gIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICBib3R0b206IDE2LFxuICByaWdodDogMTYsXG59XG5cblxuZXhwb3J0IHR5cGUgU2VsZWN0ZWRDb250YWN0VHlwZSA9IENvbnRhY3RUeXBlICYge1xuICBzZWxlY3RlZDogYm9vbGVhbixcbn1cblxuaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHN1cGVydG9rZW5zTm9kZSBmcm9tICdzdXBlcnRva2Vucy1ub2RlJ1xuaW1wb3J0IHsgYmFja2VuZENvbmZpZyB9IGZyb20gJy4uLy4uLy4uL2NvbmZpZy9iYWNrZW5kQ29uZmlnJ1xuaW1wb3J0IFNlc3Npb24gZnJvbSAnc3VwZXJ0b2tlbnMtbm9kZS9yZWNpcGUvc2Vzc2lvbidcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlcnZlclNpZGVQcm9wcyh7IHJlcSwgcmVzIH06IHsgcmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UgfSkge1xuICAvLyBOb3RpY2UgaG93IHRoZSBzZXJ2ZXIgdXNlcyBgQVBJYCBmcm9tIGB3aXRoU1NSQ29udGV4dGAsIGluc3RlYWQgb2YgdGhlIHRvcC1sZXZlbCBgQVBJYC5cbiAgLy8gY29uc3QgU1NSID0gd2l0aFNTUkNvbnRleHQoeyByZXEgfSlcbiAgLy8gdGhpcyBydW5zIG9uIHRoZSBiYWNrZW5kLCBzbyB3ZSBtdXN0IGNhbGwgaW5pdCBvbiBzdXBlcnRva2Vucy1ub2RlIFNES1xuICBzdXBlcnRva2Vuc05vZGUuaW5pdChiYWNrZW5kQ29uZmlnKCkpXG4gIGxldCBzZXNzaW9uXG4gIHRyeSB7XG4gICAgc2Vzc2lvbiA9IGF3YWl0IFNlc3Npb24uZ2V0U2Vzc2lvbihyZXEsIHJlcywge1xuICAgICAgb3ZlcnJpZGVHbG9iYWxDbGFpbVZhbGlkYXRvcnM6IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFtdXG4gICAgICB9LFxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgaWYgKGVyci50eXBlID09PSBTZXNzaW9uLkVycm9yLlRSWV9SRUZSRVNIX1RPS0VOKSB7XG4gICAgICByZXR1cm4geyBwcm9wczogeyBmcm9tU3VwZXJ0b2tlbnM6ICduZWVkcy1yZWZyZXNoJyB9IH1cbiAgICB9IGVsc2UgaWYgKGVyci50eXBlID09PSBTZXNzaW9uLkVycm9yLlVOQVVUSE9SSVNFRCkge1xuICAgICAgLy8gdGhpcyB3aWxsIGZvcmNlIHRoZSBmcm9udGVuZCB0byB0cnkgYW5kIHJlZnJlc2ggd2hpY2ggd2lsbCBmYWlsXG4gICAgICAvLyBjbGVhcmluZyBhbGwgY29va2llcyBhbmQgcmVkaXJlY3RpbmcgdGhlIHVzZXIgdG8gdGhlIGxvZ2luIHNjcmVlbi5cbiAgICAgIHJldHVybiB7IHByb3BzOiB7IGZyb21TdXBlcnRva2VuczogJ25lZWRzLXJlZnJlc2gnIH0gfVxuICAgIH1cbiAgICB0aHJvdyBlcnJcbiAgfVxuXG4gIGlmICghc2Vzc2lvbj8uZ2V0VXNlcklkKCkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVkaXJlY3Q6IHtcbiAgICAgICAgZGVzdGluYXRpb246ICcvVXNlci9Mb2dpbi9Vc2VyTG9naW4nLFxuICAgICAgICBwZXJtYW5lbnQ6IGZhbHNlLFxuICAgICAgfSxcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHByb3BzOiB7XG4gICAgICBzdWI6IHNlc3Npb24uZ2V0VXNlcklkKCksXG4gICAgfVxuICB9XG59XG50eXBlIFByb3BzID0ge1xuICBhdHRlbmRlZXM6IFBlcnNvbltdLFxuICBzZXRQYXJlbnRBdHRlbmRlZXM6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPFBlcnNvbltdPj4sXG4gIHVzZXJJZDogc3RyaW5nLFxuICBjbGllbnQ6IEFwb2xsb0NsaWVudDxOb3JtYWxpemVkQ2FjaGVPYmplY3Q+LFxufVxuXG50eXBlIHNlbGVjdGVkQ29udGFjdFByb3BzID0ge1xuICBjb250YWN0OiBTZWxlY3RlZENvbnRhY3RUeXBlLFxuICBhZGRDb250YWN0VG9BdHRlbmRlZXM6IHR5cGVvZiBhZGRDb250YWN0VG9BdHRlbmRlZXNcbiAgcmVtb3ZlQ29udGFjdEZyb21BdHRlbmRlZTogdHlwZW9mIHJlbW92ZUNvbnRhY3RGcm9tQXR0ZW5kZWUsXG4gIHVwZGF0ZUNvbnRhY3RTZWxlY3Rpb246IHR5cGVvZiB1cGRhdGVDb250YWN0U2VsZWN0aW9uLFxuICBjb250YWN0czogU2VsZWN0ZWRDb250YWN0VHlwZVtdLFxuICBzZXRDb250YWN0czogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248U2VsZWN0ZWRDb250YWN0VHlwZVtdPj4sXG4gIHNldFBhcmVudEE6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPFBlcnNvbltdPj4sXG4gIGF0dGVuZGVlczogUGVyc29uW10sXG4gIHNldEF0dGVuZGVlczogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248UGVyc29uW10+PixcbiAgaW5kZXg6IG51bWJlcixcbn1cblxudHlwZSBzZWxlY3RlZENvbnRhY3RzUHJvcHMgPSB7XG4gIGFkZENvbnRhY3RUb0F0dGVuZGVlczogdHlwZW9mIGFkZENvbnRhY3RUb0F0dGVuZGVlc1xuICByZW1vdmVDb250YWN0RnJvbUF0dGVuZGVlOiB0eXBlb2YgcmVtb3ZlQ29udGFjdEZyb21BdHRlbmRlZSxcbiAgdXBkYXRlQ29udGFjdFNlbGVjdGlvbjogdHlwZW9mIHVwZGF0ZUNvbnRhY3RTZWxlY3Rpb24sXG4gIGNvbnRhY3RzOiBTZWxlY3RlZENvbnRhY3RUeXBlW10sXG4gIHNldFBhcmVudEE6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPFBlcnNvbltdPj4sXG4gIGF0dGVuZGVlczogUGVyc29uW10sXG4gIHNldEF0dGVuZGVlczogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248UGVyc29uW10+PixcbiAgY2xvc2VDb250YWN0czogKCkgPT4gdm9pZCxcbn1cblxuZnVuY3Rpb24gQ29udGFjdHMocHJvcHM6IHNlbGVjdGVkQ29udGFjdHNQcm9wcykge1xuICBjb25zdCBbY29udGFjdHMsIHNldENvbnRhY3RzXSA9IHVzZVN0YXRlPFNlbGVjdGVkQ29udGFjdFR5cGVbXT4ocHJvcHM/LmNvbnRhY3RzKVxuICBjb25zdCBjbG9zZUNvbnRhY3RzID0gcHJvcHM/LmNsb3NlQ29udGFjdHNcbiAgcmV0dXJuIChcbiAgICA8Qm94IGZsZXg9ezF9IG1pbkhlaWdodD1cIjY1dmhcIiBtYXhIZWlnaHQ9XCI2NXZoXCI+XG4gICAgICB7XG4gICAgICAgIGNvbnRhY3RzPy5sZW5ndGggPiAwXG4gICAgICAgID8gKFxuICAgICAgICAgIDxGbGF0TGlzdFxuICAgICAgICAgICAgZGF0YT17Y29udGFjdHN9XG4gICAgICAgICAgICByZW5kZXJJdGVtPXsoeyBpdGVtLCBpbmRleCB9KSA9PiAoXG4gICAgICAgICAgICAgIDxDb250YWN0XG4gICAgICAgICAgICAgICAgY29udGFjdD17aXRlbX1cbiAgICAgICAgICAgICAgICBhZGRDb250YWN0VG9BdHRlbmRlZXM9e3Byb3BzPy5hZGRDb250YWN0VG9BdHRlbmRlZXN9XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ29udGFjdEZyb21BdHRlbmRlZT17cHJvcHM/LnJlbW92ZUNvbnRhY3RGcm9tQXR0ZW5kZWV9XG4gICAgICAgICAgICAgICAgdXBkYXRlQ29udGFjdFNlbGVjdGlvbj17cHJvcHM/LnVwZGF0ZUNvbnRhY3RTZWxlY3Rpb259XG4gICAgICAgICAgICAgICAgY29udGFjdHM9e2NvbnRhY3RzfVxuICAgICAgICAgICAgICAgIHNldENvbnRhY3RzPXtzZXRDb250YWN0c31cbiAgICAgICAgICAgICAgICBzZXRQYXJlbnRBPXtwcm9wcz8uc2V0UGFyZW50QX1cbiAgICAgICAgICAgICAgICBhdHRlbmRlZXM9e3Byb3BzPy5hdHRlbmRlZXN9XG4gICAgICAgICAgICAgICAgc2V0QXR0ZW5kZWVzPXtwcm9wcz8uc2V0QXR0ZW5kZWVzfVxuICAgICAgICAgICAgICAgIGluZGV4PXtpbmRleH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBrZXlFeHRyYWN0b3I9eyhpdGVtLCBpbmRleCkgPT4gYCR7aXRlbX0tJHtpbmRleH1gfVxuICAgICAgICAgIC8+XG4gICAgICAgICkgOiAoXG4gICAgICAgICAgPEJveCBmbGV4PXsxfSBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgIDxUZXh0IHZhcmlhbnQ9XCJzdWJoZWFkZXJcIj5cbiAgICAgICAgICAgICAgWW91IGhhdmUgbm8gY29udGFjdHMgc2F2ZWQuXG4gICAgICAgICAgICAgIEdvIHRvIHNldHRpbmdzIHRvIGVuYWJsZSBhbmQgc3luYyBDb250YWN0cyBmcm9tIHlvdXIgcGhvbmVcbiAgICAgICAgICAgICAgb3IgM3JkIHBhcnR5IHByb3ZpZGVyLlxuICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgIDwvQm94PlxuICAgICAgICApXG4gICAgICB9XG4gICAgICA8Qm94IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiIHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0+XG4gICAgICAgIDxQcmVzc2FibGUgb25QcmVzcz17Y2xvc2VDb250YWN0c30+XG4gICAgICAgICAgPFRleHQgcD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdsJyB9fSB2YXJpYW50PVwiYnV0dG9uTGlua1wiPlxuICAgICAgICAgICAgQ2xvc2VcbiAgICAgICAgICA8L1RleHQ+XG4gICAgICAgIDwvUHJlc3NhYmxlPlxuICAgICAgPC9Cb3g+XG4gICAgPC9Cb3g+XG4gIClcbn1cblxuZnVuY3Rpb24gQ29udGFjdChwcm9wczogc2VsZWN0ZWRDb250YWN0UHJvcHMpIHtcbiAgY29uc3QgW3NlbGVjdGVkLCBzZXRTZWxlY3RlZF0gPSB1c2VTdGF0ZTxib29sZWFuPihwcm9wcz8uYXR0ZW5kZWVzLmZpbmRJbmRleChpID0+IGkuaWQgPT09IHByb3BzPy5jb250YWN0LmlkKSA+IC0xKVxuXG4gIGNvbnN0IHVwZGF0ZVNlbGVjdGVkID0gKCkgPT4ge1xuICAgIGNvbnN0IHZhbHVlID0gIXNlbGVjdGVkXG4gICAgc2V0U2VsZWN0ZWQodmFsdWUpXG5cbiAgICBpZiAodmFsdWUgPT09IHRydWUpIHtcbiAgICAgIHByb3BzPy51cGRhdGVDb250YWN0U2VsZWN0aW9uKFxuICAgICAgICB2YWx1ZSxcbiAgICAgICAgcHJvcHM/LmNvbnRhY3QsXG4gICAgICAgIHByb3BzPy5jb250YWN0cyxcbiAgICAgICAgcHJvcHM/LnNldENvbnRhY3RzLFxuICAgICAgICBwcm9wcz8uaW5kZXgsXG4gICAgICApXG5cbiAgICAgIHByb3BzPy5hZGRDb250YWN0VG9BdHRlbmRlZXMoXG4gICAgICAgIHByb3BzPy5jb250YWN0LFxuICAgICAgICBwcm9wcz8uYXR0ZW5kZWVzLFxuICAgICAgICBwcm9wcz8uc2V0QXR0ZW5kZWVzLFxuICAgICAgICBwcm9wcz8uc2V0UGFyZW50QSxcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKHZhbHVlID09PSBmYWxzZSkge1xuICAgICAgcHJvcHM/LnVwZGF0ZUNvbnRhY3RTZWxlY3Rpb24oXG4gICAgICAgIHZhbHVlLFxuICAgICAgICBwcm9wcz8uY29udGFjdCxcbiAgICAgICAgcHJvcHM/LmNvbnRhY3RzLFxuICAgICAgICBwcm9wcz8uc2V0Q29udGFjdHMsXG4gICAgICAgIHByb3BzPy5pbmRleCxcbiAgICAgIClcblxuICAgICAgcHJvcHM/LnJlbW92ZUNvbnRhY3RGcm9tQXR0ZW5kZWUoXG4gICAgICAgIHByb3BzPy5jb250YWN0LFxuICAgICAgICBwcm9wcz8uYXR0ZW5kZWVzLFxuICAgICAgICBwcm9wcz8uc2V0QXR0ZW5kZWVzLFxuICAgICAgICBwcm9wcz8uc2V0UGFyZW50QSxcbiAgICAgIClcbiAgICB9XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxCb3g+XG4gICAgICA8UmVndWxhckNhcmQ+XG4gICAgICAgIDxCb3ggcD17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fT5cbiAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCI+XG4gICAgICAgICAgICB7cHJvcHM/LmNvbnRhY3Q/Lm5hbWV9XG4gICAgICAgICAgPC9UZXh0PlxuICAgICAgICA8L0JveD5cbiAgICAgICAgPEJveD5cbiAgICAgICAgICA8VGV4dCB2YXJpYW50PVwiY2FwdGlvblwiPlxuICAgICAgICAgICAge3Byb3BzPy5jb250YWN0Py5lbWFpbHM/LmZpbHRlcihpID0+IChpLnByaW1hcnkgPT09IHRydWUpKT8uWzBdPy52YWx1ZX1cbiAgICAgICAgICA8L1RleHQ+XG4gICAgICAgIDwvQm94PlxuICAgICAgICA8Qm94IHA9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgPFByZXNzYWJsZSBvblByZXNzPXt1cGRhdGVTZWxlY3RlZH0+XG4gICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwiYnV0dG9uTGlua1wiPlxuICAgICAgICAgICAgICB7c2VsZWN0ZWQgPyAnUmVtb3ZlJyA6ICdBZGQnIH1cbiAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICA8L1ByZXNzYWJsZT5cbiAgICAgICAgPC9Cb3g+XG4gICAgICA8L1JlZ3VsYXJDYXJkPlxuICAgIDwvQm94PlxuICApXG59XG5cbnR5cGUgbWFudWFsRW50cnlQcm9wcyA9IFBlcnNvbiAmIHtcbiAgdXBkYXRlRW50cnlJbk1hbnVhbEVudHJpZXM6IHR5cGVvZiB1cGRhdGVFbnRyeUluTWFudWFsRW50cmllcyxcbiAgcmVtb3ZlRW50cnlGcm9tTWFudWFsRW50cmllczogdHlwZW9mIHJlbW92ZUVudHJ5RnJvbU1hbnVhbEVudHJpZXMsXG4gIGluZGV4OiBudW1iZXIsXG4gIHNldE1hbnVhbEVudHJpZXM6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPFBlcnNvbltdPj4sXG4gIG1hbnVhbEVudHJpZXM6IFBlcnNvbltdLFxuICBzZXRQYXJlbnRBOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxQZXJzb25bXT4+LFxuICBwYXJlbnRJbmRleDogbnVtYmVyLFxuICBhdHRlbmRlZXM6IFBlcnNvbltdLFxuICBzZXRBdHRlbmRlZXM6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPFBlcnNvbltdPj4sXG59XG5cbnR5cGUgbWFudWFsRW50cmllc1Byb3BzID0ge1xuICBzZXRNYW51YWxFbnRyaWVzOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxQZXJzb25bXT4+LFxuICBtYW51YWxFbnRyaWVzOiBQZXJzb25bXSxcbiAgYXR0ZW5kZWVzOiBQZXJzb25bXSxcbiAgc2V0QXR0ZW5kZWVzOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxQZXJzb25bXT4+LFxuICBzZXRQYXJlbnRBOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxQZXJzb25bXT4+LFxuICBjbG9zZU1hbnVhbDogKCkgPT4gdm9pZCxcbiAgdXBkYXRlRW50cnlJbk1hbnVhbEVudHJpZXM6IHR5cGVvZiB1cGRhdGVFbnRyeUluTWFudWFsRW50cmllcyxcbiAgcmVtb3ZlRW50cnlGcm9tTWFudWFsRW50cmllczogdHlwZW9mIHJlbW92ZUVudHJ5RnJvbU1hbnVhbEVudHJpZXMsXG4gIGFkZE9uZVRvTWFudWFsRW50cmllczogdHlwZW9mIGFkZE9uZVRvTWFudWFsRW50cmllcyxcbn1cblxuZnVuY3Rpb24gTWFudWFsRW50cnkocHJvcHM6IG1hbnVhbEVudHJ5UHJvcHMpIHtcbiAgY29uc3QgW2VtYWlscywgc2V0RW1haWxzXSA9IHVzZVN0YXRlPGVtYWlsW10+KHByb3BzPy5lbWFpbHMpXG4gIGNvbnN0IFthZGRpdGlvbmFsR3Vlc3RzLCBzZXRBZGRpdGlvbmFsR3Vlc3RzXSA9IHVzZVN0YXRlPG51bWJlcj4ocHJvcHM/LmFkZGl0aW9uYWxHdWVzdHMgfHwgMClcblxuICBjb25zdCB1cGRhdGVFbnRyeUluTWFudWFsRW50cmllcyA9IHByb3BzPy51cGRhdGVFbnRyeUluTWFudWFsRW50cmllc1xuICBjb25zdCByZW1vdmVFbnRyeUZyb21NYW51YWxFbnRyaWVzID0gcHJvcHM/LnJlbW92ZUVudHJ5RnJvbU1hbnVhbEVudHJpZXNcbiAgY29uc3Qgc2V0TWFudWFsRW50cmllcyA9IHByb3BzPy5zZXRNYW51YWxFbnRyaWVzXG4gIGNvbnN0IG1hbnVhbEVudHJpZXMgPSBwcm9wcz8ubWFudWFsRW50cmllc1xuICBjb25zdCBpbmRleCA9IHByb3BzPy5pbmRleFxuICBjb25zdCBzZXRQYXJlbnRBID0gcHJvcHM/LnNldFBhcmVudEFcbiAgY29uc3QgcGFyZW50SW5kZXggPSBwcm9wcz8ucGFyZW50SW5kZXhcbiAgY29uc3QgYXR0ZW5kZWVzID0gcHJvcHM/LmF0dGVuZGVlc1xuICBjb25zdCBzZXRBdHRlbmRlZXMgPSBwcm9wcz8uc2V0QXR0ZW5kZWVzXG5cbiAgXG4gIGNvbnN0IG9uRW1haWxDaGFuZ2UgPSAodmFsdWU6IHN0cmluZykgPT4ge1xuICAgIHNldEVtYWlscyhbeyAuLi5lbWFpbHM/LlswXSwgcHJpbWFyeTogdHJ1ZSwgdmFsdWUsIHR5cGU6ICcnIH1dKVxuICAgIHVwZGF0ZUVudHJ5SW5NYW51YWxFbnRyaWVzKG1hbnVhbEVudHJpZXMsIHNldE1hbnVhbEVudHJpZXMsIGluZGV4LCBhdHRlbmRlZXMsIHNldEF0dGVuZGVlcywgc2V0UGFyZW50QSwgcGFyZW50SW5kZXgsIFt7IC4uLmVtYWlscz8uWzBdLCBwcmltYXJ5OiB0cnVlLCB2YWx1ZSwgdHlwZTogJycgfV0sIHVuZGVmaW5lZCwgYWRkaXRpb25hbEd1ZXN0cylcbiAgfVxuXG4gIGNvbnN0IG9uTmFtZUNoYW5nZSA9ICh2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgc2V0RW1haWxzKFt7IC4uLmVtYWlscz8uWzBdLCBwcmltYXJ5OiB0cnVlLCBkaXNwbGF5TmFtZTogdmFsdWUsIHR5cGU6ICcnIH1dKVxuICAgIHVwZGF0ZUVudHJ5SW5NYW51YWxFbnRyaWVzKG1hbnVhbEVudHJpZXMsIHNldE1hbnVhbEVudHJpZXMsIGluZGV4LCBhdHRlbmRlZXMsIHNldEF0dGVuZGVlcywgc2V0UGFyZW50QSwgcGFyZW50SW5kZXgsIFt7IC4uLmVtYWlscz8uWzBdLCBwcmltYXJ5OiB0cnVlLCBkaXNwbGF5TmFtZTogdmFsdWUsIHR5cGU6ICcnIH1dLCB2YWx1ZSwgYWRkaXRpb25hbEd1ZXN0cylcbiAgfVxuXG4gIGNvbnN0IG9uQWRkaXRpb25hbEd1ZXN0c0NoYW5nZSA9ICh0ZXh0OiBzdHJpbmcpID0+IHtcbiAgICBzZXRBZGRpdGlvbmFsR3Vlc3RzKHBhcnNlSW50KHRleHQucmVwbGFjZSgvW14wLTkuXS9nLCAnJyksIDEwKSlcbiAgICB1cGRhdGVFbnRyeUluTWFudWFsRW50cmllcyhtYW51YWxFbnRyaWVzLCBzZXRNYW51YWxFbnRyaWVzLCBpbmRleCwgYXR0ZW5kZWVzLCBzZXRBdHRlbmRlZXMsIHNldFBhcmVudEEsIHBhcmVudEluZGV4LCBlbWFpbHMsIHVuZGVmaW5lZCwgcGFyc2VJbnQodGV4dC5yZXBsYWNlKC9bXjAtOS5dL2csICcnKSwgMTApKVxuICB9XG5cbiAgcmV0dXJuIChcbiAgICAgIDxCb3g+XG4gICAgICAgIDxSZWd1bGFyQ2FyZD5cbiAgICAgICAgICA8Qm94IHA9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCI+XG4gICAgICAgICAgICAgIEVtYWlsXG4gICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICA8VGV4dEZpZWxkXG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwickByLmNvbVwiXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZTogeyB0YXJnZXQ6IHsgdmFsdWU6IHN0cmluZyB9IH0pID0+IG9uRW1haWxDaGFuZ2UoZT8udGFyZ2V0Py52YWx1ZSl9XG4gICAgICAgICAgICAgIHZhbHVlPXtlbWFpbHM/LlswXT8udmFsdWUgfHwgJyd9XG4gICAgICAgICAgICAgIHN0eWxlPXt7IHdpZHRoOiAnNjAlJ319XG4gICAgICAgICAgICAgIHZhbGlkYXRlPVwiZW1haWxcIlxuICAgICAgICAgICAgICB2YWxpZGF0aW9uTWVzc2FnZT1cIlBsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsIGFkZHJlc3NcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L0JveD5cbiAgICAgICAgICA8Qm94IHA9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCI+XG4gICAgICAgICAgICAgIERpc3BsYXkgTmFtZVxuICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgPFRleHRGaWVsZFxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIm5hbWVcIlxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGU6IHsgdGFyZ2V0OiB7IHZhbHVlOiBzdHJpbmcgfSB9KSA9PiBvbk5hbWVDaGFuZ2UoZT8udGFyZ2V0Py52YWx1ZSl9XG4gICAgICAgICAgICAgIHZhbHVlPXttYW51YWxFbnRyaWVzPy5baW5kZXhdPy5uYW1lIHx8ICcnfVxuICAgICAgICAgICAgICBzdHlsZT17eyB3aWR0aDogJzYwJSd9fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L0JveD5cbiAgICAgICAgICA8Qm94IHA9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCI+XG4gICAgICAgICAgICAgIEFkZGl0aW9uYWwgR3Vlc3RzP1xuICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgPFRleHRGaWVsZFxuICAgICAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlOiB7IHRhcmdldDogeyB2YWx1ZTogc3RyaW5nIH0gfSkgPT4gb25BZGRpdGlvbmFsR3Vlc3RzQ2hhbmdlKGU/LnRhcmdldD8udmFsdWUpfVxuICAgICAgICAgICAgICB2YWx1ZT17YCR7YWRkaXRpb25hbEd1ZXN0c31gfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjBcIlxuICAgICAgICAgICAgICBzdHlsZT17eyB3aWR0aDogJzE1JScgfX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXsoKSA9PiByZW1vdmVFbnRyeUZyb21NYW51YWxFbnRyaWVzKG1hbnVhbEVudHJpZXMsIHNldE1hbnVhbEVudHJpZXMsIGF0dGVuZGVlcywgc2V0QXR0ZW5kZWVzLCBzZXRQYXJlbnRBLCBpbmRleCwgcGFyZW50SW5kZXgpfT5cbiAgICAgICAgICAgIFJlbW92ZVxuICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICA8L1JlZ3VsYXJDYXJkPlxuICAgICAgPC9Cb3g+XG5cbiAgKVxufVxuXG5mdW5jdGlvbiBNYW51YWxFbnRyaWVzKHByb3BzOiBtYW51YWxFbnRyaWVzUHJvcHMpIHtcbiAgY29uc3QgW3BhZ2VPZmZzZXQsIHNldFBhZ2VPZmZzZXRdID0gdXNlU3RhdGU8bnVtYmVyPigwKVxuXG4gIGNvbnN0IHsgaGVpZ2h0OiBmdWxsSGVpZ2h0IH0gPSBEaW1lbnNpb25zLmdldCgnd2luZG93JylcbiAgXG4gIGNvbnN0IHRoZW1lID0gdXNlVGhlbWUoKVxuXG4gIGNvbnN0IHRyYW5zaXRpb25EdXJhdGlvbiA9IHtcbiAgICBlbnRlcjogdGhlbWUudHJhbnNpdGlvbnMuZHVyYXRpb24uZW50ZXJpbmdTY3JlZW4sXG4gICAgZXhpdDogdGhlbWUudHJhbnNpdGlvbnMuZHVyYXRpb24ubGVhdmluZ1NjcmVlbixcbiAgfVxuXG4gIGNvbnN0IGNsb3NlTWFudWFsID0gcHJvcHM/LmNsb3NlTWFudWFsXG4gIFxuICBjb25zdCBhZGROZXdFbnRyeSA9ICgpID0+IHtcbiAgICBjb25zdCBhZGRPbmVUb01hbnVhbEVudHJpZXMgPSBwcm9wcz8uYWRkT25lVG9NYW51YWxFbnRyaWVzXG4gICAgYWRkT25lVG9NYW51YWxFbnRyaWVzKFxuICAgICAgcHJvcHM/Lm1hbnVhbEVudHJpZXMsXG4gICAgICBwcm9wcz8uc2V0TWFudWFsRW50cmllcyxcbiAgICAgIHByb3BzPy5hdHRlbmRlZXMsXG4gICAgICBwcm9wcz8uc2V0QXR0ZW5kZWVzLFxuICAgICAgcHJvcHM/LnNldFBhcmVudEEsXG4gICAgKVxuICB9XG4gIHJldHVybiAoXG4gICAgPEJveCBmbGV4PXsxfSBzdHlsZT17eyB3aWR0aDogJzEwMCUnIH19IG1pbkhlaWdodD1cIjY1dmhcIiBtYXhIZWlnaHQ9XCI2NXZoXCI+XG5cbiAgICAgICAgPEJveCBmbGV4PXsxfSBzdHlsZT17eyB3aWR0aDogJzEwMCUnIH19PlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHByb3BzPy5tYW51YWxFbnRyaWVzPy5sZW5ndGggPiAwXG4gICAgICAgICAgICA/IChcbiAgICAgICAgICAgICAgPEZsYXRMaXN0XG4gICAgICAgICAgICAgICAgZGF0YT17cHJvcHM/Lm1hbnVhbEVudHJpZXN9XG4gICAgICAgICAgICAgICAgcmVuZGVySXRlbT17KHsgaXRlbSwgaW5kZXggfSkgPT4gKFxuICAgICAgICAgICAgICAgICAgPE1hbnVhbEVudHJ5XG4gICAgICAgICAgICAgICAgICAgIHsuLi5pdGVtfVxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVFbnRyeUluTWFudWFsRW50cmllcz17cHJvcHM/LnVwZGF0ZUVudHJ5SW5NYW51YWxFbnRyaWVzfVxuICAgICAgICAgICAgICAgICAgICByZW1vdmVFbnRyeUZyb21NYW51YWxFbnRyaWVzPXtwcm9wcz8ucmVtb3ZlRW50cnlGcm9tTWFudWFsRW50cmllc31cbiAgICAgICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAgICAgICBzZXRNYW51YWxFbnRyaWVzPXtwcm9wcz8uc2V0TWFudWFsRW50cmllc31cbiAgICAgICAgICAgICAgICAgICAgbWFudWFsRW50cmllcz17cHJvcHM/Lm1hbnVhbEVudHJpZXN9XG4gICAgICAgICAgICAgICAgICAgIHNldFBhcmVudEE9e3Byb3BzPy5zZXRQYXJlbnRBfVxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRJbmRleD17cHJvcHM/LmF0dGVuZGVlcy5maW5kSW5kZXgoYSA9PiAoYT8uaWQgPT09IGl0ZW0/LmlkKSl9XG4gICAgICAgICAgICAgICAgICAgIGF0dGVuZGVlcz17cHJvcHM/LmF0dGVuZGVlc31cbiAgICAgICAgICAgICAgICAgICAgc2V0QXR0ZW5kZWVzPXtwcm9wcz8uc2V0QXR0ZW5kZWVzfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIGtleUV4dHJhY3Rvcj17KGl0ZW0pID0+IGl0ZW0/LmlkfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgPEJveCBmbGV4PXsxfSBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwic3ViaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICBBZGQgYSBOZXcgRW50cnlcbiAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgKVxuICAgICAgICAgIH1cbiAgICAgICAgICA8Qm94IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiIHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0+XG4gICAgICAgICAgICA8UHJlc3NhYmxlIG9uUHJlc3M9e2Nsb3NlTWFudWFsfT5cbiAgICAgICAgICAgICAgPFRleHQgcD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdsJyB9fSB2YXJpYW50PVwiYnV0dG9uTGlua1wiPlxuICAgICAgICAgICAgICAgIENsb3NlXG4gICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgIDwvUHJlc3NhYmxlPlxuICAgICAgICAgIDwvQm94PlxuXG4gICAgICAgICAgICA8Wm9vbVxuICAgICAgICAgICAgICBpblxuICAgICAgICAgICAgICB0aW1lb3V0PXt0cmFuc2l0aW9uRHVyYXRpb259XG4gICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbkRlbGF5OiBgJHt0cmFuc2l0aW9uRHVyYXRpb24uZXhpdH1tc2AsXG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgIHVubW91bnRPbkV4aXRcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPEZhYiBzeD17ZmFiU3R5bGUgYXMgU3hQcm9wc30gYXJpYS1sYWJlbD17J0FkZCd9IGNvbG9yPVwicHJpbWFyeVwiIG9uQ2xpY2s9e2FkZE5ld0VudHJ5fT5cbiAgICAgICAgICAgICAgICA8QWRkSWNvbiBzeD17eyBjb2xvcjogcGlua1s1MDBdIH19IC8+XG4gICAgICAgICAgICAgIDwvRmFiPlxuICAgICAgICAgICAgPC9ab29tPlxuICAgICAgICAgIFxuICAgICAgICA8L0JveD5cblxuICAgIDwvQm94PlxuICApXG59XG5cbmZ1bmN0aW9uIENyZWF0ZUV2ZW50QXR0ZW5kZWVzKHByb3BzOiBQcm9wcykge1xuICBjb25zdCBbYXR0ZW5kZWVzLCBzZXRBdHRlbmRlZXNdID0gdXNlU3RhdGU8UGVyc29uW10+KHByb3BzPy5hdHRlbmRlZXMpXG4gIGNvbnN0IFtpc01hbnVhbCwgc2V0SXNNYW51YWxdID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpXG4gIGNvbnN0IFttYW51YWxFbnRyaWVzLCBzZXRNYW51YWxFbnRyaWVzXSA9IHVzZVN0YXRlPFBlcnNvbltdPihbXSlcbiAgY29uc3QgW2lzQ29udGFjdHMsIHNldElzQ29udGFjdHNdID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpXG4gIGNvbnN0IFtjb250YWN0cywgc2V0Q29udGFjdHNdID0gdXNlU3RhdGU8U2VsZWN0ZWRDb250YWN0VHlwZVtdPihbXSlcbiAgY29uc3QgW2lzT3Blbiwgc2V0SXNPcGVuXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKVxuICAvLyBjb25zdCBbY29udGFjdENoZWNrcywgc2V0Q29udGFjdENoZWNrc10gPSB1c2VTdGF0ZTxib29sZWFuW10+KFtdKVxuXG4gIGNvbnN0IHVzZXJJZCA9IHByb3BzPy51c2VySWRcbiAgLy8gY29uc3QgcGFyZW50QXR0ZW5kZWVzID0gcHJvcHM/LmF0dGVuZGVlc1xuICBjb25zdCBzZXRQYXJlbnRBdHRlbmRlZXMgPSBwcm9wcz8uc2V0UGFyZW50QXR0ZW5kZWVzXG4gIGNvbnN0IGNsaWVudCA9IHByb3BzPy5jbGllbnRcblxuICAvLyBnZXQgYW55IGNvbnRhY3RzXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgKGFzeW5jICgpID0+IHtcbiAgICAgIGlmICghY2xpZW50IHx8ICF1c2VySWQpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBjb25zdCBuZXdDb250YWN0cyA9IGF3YWl0IGxpc3RVc2VyQ29udGFjdHNIZWxwZXIoY2xpZW50LCB1c2VySWQpXG4gICAgICBpZiAobmV3Q29udGFjdHMgJiYgbmV3Q29udGFjdHM/Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgc2V0Q29udGFjdHMobmV3Q29udGFjdHNcbiAgICAgICAgICAubWFwKGMgPT4gKHsgLi4uYywgc2VsZWN0ZWQ6IGZhbHNlIH0gYXMgU2VsZWN0ZWRDb250YWN0VHlwZSkpXG4gICAgICAgICAgLmZpbHRlcihjID0+IChjPy5lbWFpbHM/LlswXT8udmFsdWUgJiYgYz8uZW1haWxzPy5bMF0/LnZhbHVlPy5sZW5ndGggPiAwKSlcbiAgICAgICAgKVxuICAgICAgfVxuICAgIH0pKClcbiAgfSwgW2NsaWVudCwgdXNlcklkXSlcblxuICBjb25zdCBvbk1hbnVhbENoYW5nZSA9ICgpID0+IHtcbiAgICBzZXRJc0NvbnRhY3RzKGlzTWFudWFsKVxuICAgIHNldElzTWFudWFsKCFpc01hbnVhbClcbiAgfVxuXG4gIGNvbnN0IG9uQ29udGFjdHNDaGFuZ2UgPSAoKSA9PiB7XG4gICAgc2V0SXNNYW51YWwoaXNDb250YWN0cylcbiAgICBzZXRJc0NvbnRhY3RzKCFpc0NvbnRhY3RzKVxuICB9XG5cbiAgY29uc3QgY2xvc2VDb250YWN0cyA9ICgpID0+IHNldElzQ29udGFjdHMoZmFsc2UpXG5cbiAgY29uc3QgY2xvc2VNYW51YWwgPSAoKSA9PiBzZXRJc01hbnVhbChmYWxzZSlcblxuICBjb25zdCBhY3Rpb25zID0gW1xuICAgIHsgaWNvbjogPEltcG9ydENvbnRhY3RzSWNvbiBjb2xvcj1cInNlY29uZGFyeVwiIC8+LCBuYW1lOiAnSW1wb3J0IENvbnRhY3RzJywgbWV0aG9kOiBvbkNvbnRhY3RzQ2hhbmdlIH0sXG4gICAgeyBpY29uOiA8S2V5Ym9hcmRJY29uIGNvbG9yPVwic2Vjb25kYXJ5XCIgLz4sIG5hbWU6ICdNYW51YWwgRW50cnknLCBtZXRob2Q6IG9uTWFudWFsQ2hhbmdlIH0sXG4gIF1cblxuICBpZiAoaXNNYW51YWwpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPE1hbnVhbEVudHJpZXNcbiAgICAgICAgc2V0TWFudWFsRW50cmllcz17c2V0TWFudWFsRW50cmllc31cbiAgICAgICAgbWFudWFsRW50cmllcz17bWFudWFsRW50cmllc31cbiAgICAgICAgYXR0ZW5kZWVzPXthdHRlbmRlZXN9XG4gICAgICAgIHNldEF0dGVuZGVlcz17c2V0QXR0ZW5kZWVzfVxuICAgICAgICBzZXRQYXJlbnRBPXtzZXRQYXJlbnRBdHRlbmRlZXN9XG4gICAgICAgIHVwZGF0ZUVudHJ5SW5NYW51YWxFbnRyaWVzPXt1cGRhdGVFbnRyeUluTWFudWFsRW50cmllc31cbiAgICAgICAgcmVtb3ZlRW50cnlGcm9tTWFudWFsRW50cmllcz17cmVtb3ZlRW50cnlGcm9tTWFudWFsRW50cmllc31cbiAgICAgICAgYWRkT25lVG9NYW51YWxFbnRyaWVzPXthZGRPbmVUb01hbnVhbEVudHJpZXN9XG4gICAgICAgIGNsb3NlTWFudWFsPXtjbG9zZU1hbnVhbH1cbiAgICAgIC8+XG4gICAgKVxuICB9XG5cbiAgaWYgKGlzQ29udGFjdHMpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPENvbnRhY3RzXG4gICAgICAgIGFkZENvbnRhY3RUb0F0dGVuZGVlcz17YWRkQ29udGFjdFRvQXR0ZW5kZWVzfVxuICAgICAgICByZW1vdmVDb250YWN0RnJvbUF0dGVuZGVlPXtyZW1vdmVDb250YWN0RnJvbUF0dGVuZGVlfVxuICAgICAgICB1cGRhdGVDb250YWN0U2VsZWN0aW9uPXt1cGRhdGVDb250YWN0U2VsZWN0aW9ufVxuICAgICAgICBjb250YWN0cz17Y29udGFjdHN9XG4gICAgICAgIHNldFBhcmVudEE9e3NldFBhcmVudEF0dGVuZGVlc31cbiAgICAgICAgYXR0ZW5kZWVzPXthdHRlbmRlZXN9XG4gICAgICAgIHNldEF0dGVuZGVlcz17c2V0QXR0ZW5kZWVzfVxuICAgICAgICBjbG9zZUNvbnRhY3RzPXtjbG9zZUNvbnRhY3RzfVxuICAgICAgLz5cbiAgICApXG4gIH1cblxuIHJldHVybiAoXG4gICA8Qm94IGZsZXg9ezF9IHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0gbWluSGVpZ2h0PVwiNjV2aFwiIG1heEhlaWdodD1cIjY1dmhcIj5cbiAgICAge1xuICAgICAgIGF0dGVuZGVlcz8ubGVuZ3RoID4gMFxuICAgICAgID8gKFxuICAgICAgICAgPEZsYXRMaXN0XG4gICAgICAgICAgIGRhdGE9e2F0dGVuZGVlc31cbiAgICAgICAgICAgcmVuZGVySXRlbT17KHsgaXRlbSB9KSA9PiAoXG4gICAgICAgICAgICAgPExpc3RJdGVtXG4gICAgICAgICAgICAgICBjb250YWluZXJTdHlsZT17eyBcbiAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHBhbGV0dGUud2hpdGUsXG4gICAgICAgICAgICAgICAgICAgYm9yZGVyQm90dG9tV2lkdGg6IFN0eWxlU2hlZXQuaGFpcmxpbmVXaWR0aCxcbiAgICAgICAgICAgICAgICAgICBib3JkZXJDb2xvcjogcGFsZXR0ZS5kYXJrR3JheVxuICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgIDxMaXN0SXRlbS5Db250ZW50PlxuICAgICAgICAgICAgICAgICA8TGlzdEl0ZW0uVGl0bGUgc3R5bGU9e3sgY29sb3I6IHBhbGV0dGUudGV4dEJsYWNrLCBmb250V2VpZ2h0OiAnYm9sZCcgfX0+XG4gICAgICAgICAgICAgICAgICAge2l0ZW0/Lm5hbWV9XG4gICAgICAgICAgICAgICAgIDwvTGlzdEl0ZW0uVGl0bGU+XG4gICAgICAgICAgICAgICAgIDxMaXN0SXRlbS5TdWJ0aXRsZSBzdHlsZT17eyBjb2xvcjogcGFsZXR0ZS50ZXh0QmxhY2ssIH19PlxuICAgICAgICAgICAgICAgICAgIHtpdGVtPy5lbWFpbHM/LlswXT8udmFsdWV9XG4gICAgICAgICAgICAgICAgIDwvTGlzdEl0ZW0uU3VidGl0bGU+XG4gICAgICAgICAgICAgICA8L0xpc3RJdGVtLkNvbnRlbnQ+XG4gICAgICAgICAgICAgPC9MaXN0SXRlbT5cbiAgICAgICAgICAgKX1cbiAgICAgICAgICAga2V5RXh0cmFjdG9yPXsoaXRlbSkgPT4gaXRlbT8uaWR9XG4gICAgICAgICAvPlxuICAgICAgICkgOiAoXG4gICAgICAgICA8Qm94IGZsZXg9ezF9IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwic3ViaGVhZGVyXCI+XG4gICAgICAgICAgICAgQWRkIGFuIGF0dGVuZGVlIGZyb20geW91ciBjb250YWN0cyBvciBtYW51YWxseSBlbnRlciBvbmVcbiAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgPC9Cb3g+XG4gICAgICAgKVxuICAgICB9XG4gICAgPGRpdiBjbGFzc05hbWU9XCJhYnNvbHV0ZSBpbnNldC0wIHotMjAgcG9pbnRlci1ldmVudHMtbm9uZVwiPlxuICAgICAgICA8U3BlZWREaWFsXG4gICAgICAgICAgICBhcmlhTGFiZWw9XCJDYWxlbmRhciBTcGVlZERpYWxcIlxuICAgICAgICAgICAgc3g9e3sgcG9zaXRpb246ICdhYnNvbHV0ZScsIGJvdHRvbTogMjQsIHJpZ2h0OiAyNCwgekluZGV4OiAnc3BlZWREaWFsJyB9fVxuICAgICAgICAgICAgaWNvbj17PFNwZWVkRGlhbEljb24gaWNvbj17PEVkaXRJY29uIC8+fSBzeD17eyBjb2xvcjogcGlua1s1MDBdIH19IC8+fVxuICAgICAgICA+XG4gICAgICAgICAgICB7YWN0aW9ucy5tYXAoKGFjdGlvbikgPT4gKFxuICAgICAgICAgICAgICAgIDxTcGVlZERpYWxBY3Rpb25cbiAgICAgICAgICAgICAgICAgICAga2V5PXthY3Rpb24ubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgaWNvbj17YWN0aW9uLmljb259XG4gICAgICAgICAgICAgICAgICAgIHRvb2x0aXBUaXRsZT17YWN0aW9uLm5hbWV9XG4gICAgICAgICAgICAgICAgICAgIEZhYlByb3BzPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrOiBhY3Rpb24ubWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApKX1cbiAgICAgICAgPC9TcGVlZERpYWw+XG4gICAgPC9kaXY+XG4gICA8L0JveD5cbiApXG59XG5cbmV4cG9ydCBkZWZhdWx0IENyZWF0ZUV2ZW50QXR0ZW5kZWVzXG4vKiogZW5kICovXG4iXX0=