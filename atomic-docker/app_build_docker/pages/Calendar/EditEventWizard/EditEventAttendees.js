"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getServerSideProps = getServerSideProps;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_native_1 = require("react-native");
const TextField_1 = __importDefault(require("@components/TextField"));
const themed_1 = require("@rneui/themed");
const Fab_1 = __importDefault(require("@mui/material/Fab"));
const Add_1 = __importDefault(require("@mui/icons-material/Add"));
const styles_1 = require("@mui/material/styles");
const Zoom_1 = __importDefault(require("@mui/material/Zoom"));
const SpeedDial_1 = __importDefault(require("@mui/material/SpeedDial"));
const SpeedDialIcon_1 = __importDefault(require("@mui/material/SpeedDialIcon"));
const SpeedDialAction_1 = __importDefault(require("@mui/material/SpeedDialAction"));
const colors_1 = require("@mui/material/colors");
const ImportContacts_1 = __importDefault(require("@mui/icons-material/ImportContacts"));
const Keyboard_1 = __importDefault(require("@mui/icons-material/Keyboard"));
const Edit_1 = __importDefault(require("@mui/icons-material/Edit"));
const Box_1 = __importDefault(require("@components/common/Box"));
const Text_1 = __importDefault(require("@components/common/Text"));
const RegularCard_1 = __importDefault(require("@components/RegularCard"));
const ContactHelper_1 = require("@lib/Contact/ContactHelper");
const wizardHelper_1 = require("@lib/Calendar/CreateEventWizard/wizardHelper");
const theme_1 = require("@lib/theme/theme");
const supertokens_node_1 = __importDefault(require("supertokens-node"));
const backendConfig_1 = require("../../../config/backendConfig");
const session_1 = __importDefault(require("supertokens-node/recipe/session"));
async function getServerSideProps({ req, res }) {
    // Notice how the server uses `API` from `withSSRContext`, instead of the top-level `API`.
    // const SSR = withSSRContext({ req })
    // this runs on the backend, so we must call init on supertokens-node SDK
    supertokens_node_1.default.init((0, backendConfig_1.backendConfig)());
    let session;
    try {
        session = await session_1.default.getSession(req, res, {
            overrideGlobalClaimValidators: async function () {
                return [];
            },
        });
    }
    catch (err) {
        if (err.type === session_1.default.Error.TRY_REFRESH_TOKEN) {
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        else if (err.type === session_1.default.Error.UNAUTHORISED) {
            // this will force the frontend to try and refresh which will fail
            // clearing all cookies and redirecting the user to the login screen.
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        throw err;
    }
    if (!session?.getUserId()) {
        return {
            redirect: {
                destination: '/User/Login/UserLogin',
                permanent: false,
            },
        };
    }
    return {
        props: {
            sub: session.getUserId(),
        }
    };
}
const styles = {
    safeArea: {
        alignItems: 'flex-end',
    },
    container: {
        ...react_native_1.StyleSheet.absoluteFillObject,
        justifyContent: 'flex-end',
    },
    fab: {
        margin: 16,
        marginTop: 0,
    },
    container2: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
    },
};
const fabStyle = {
    position: 'absolute',
    bottom: 16,
    right: 16,
};
function Contacts(props) {
    const [contacts, setContacts] = (0, react_1.useState)(props?.contacts);
    const closeContacts = props?.closeContacts;
    return ((0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, style: { width: '100%' }, minHeight: "65vh", maxHeight: "65vh", children: [contacts?.length > 0
                ? ((0, jsx_runtime_1.jsx)(react_native_1.FlatList, { data: contacts, renderItem: ({ item, index }) => ((0, jsx_runtime_1.jsx)(Contact, { contact: item, addContactToAttendees: props?.addContactToAttendees, removeContactFromAttendee: props?.removeContactFromAttendee, updateContactSelection: props?.updateContactSelection, contacts: contacts, setContacts: setContacts, setParentA: props?.setParentA, attendees: props?.attendees, setAttendees: props?.setAttendees, index: index })), keyExtractor: (item, index) => `${item}-${index}` })) : ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Box_1.default, { style: { width: '95%' }, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "subheaderNormal", children: "You have no contacts saved. Go to settings to enable and sync Contacts from your phone or 3rd party provider." }) }) })), (0, jsx_runtime_1.jsx)(Box_1.default, { justifyContent: "center", alignItems: "center", style: { width: '100%' }, children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: closeContacts, children: (0, jsx_runtime_1.jsx)(Text_1.default, { p: { phone: 'm', tablet: 'l' }, variant: "buttonLink", children: "Close" }) }) })] }));
}
function Contact(props) {
    const [selected, setSelected] = (0, react_1.useState)(props?.attendees.findIndex(i => i.id === props?.contact.id) > -1);
    const updateSelected = () => {
        const value = !selected;
        setSelected(value);
        if (value === true) {
            props?.updateContactSelection(value, props?.contact, props?.contacts, props?.setContacts, props?.index);
            props?.addContactToAttendees(props?.contact, props?.attendees, props?.setAttendees, props?.setParentA);
        }
        else if (value === false) {
            props?.updateContactSelection(value, props?.contact, props?.contacts, props?.setContacts, props?.index);
            props?.removeContactFromAttendee(props?.contact, props?.attendees, props?.setAttendees, props?.setParentA);
        }
    };
    return ((0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsxs)(RegularCard_1.default, { children: [(0, jsx_runtime_1.jsx)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: props?.contact?.name }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "caption", children: props?.contact?.emails?.filter(i => (i.primary === true))?.[0]?.value }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: updateSelected, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", children: selected ? 'Remove' : 'Add' }) }) })] }) }));
}
/**
const newValue: Person = {
  id: uuid(),
  emails: [{ primary: false, value: '', type: '', displayName: ''}],
  additionalGuests: 0,
}
*/
function ManualEntry(props) {
    const [emails, setEmails] = (0, react_1.useState)(props?.emails || [{ primary: true, value: '', displayName: '', type: '' }]);
    const [additionalGuests, setAdditionalGuests] = (0, react_1.useState)(props?.additionalGuests || 0);
    const updateEntryInManualEntries = props?.updateEntryInManualEntries;
    const removeEntryFromManualEntries = props?.removeEntryFromManualEntries;
    const setManualEntries = props?.setManualEntries;
    const manualEntries = props?.manualEntries;
    const index = props?.index;
    const setParentA = props?.setParentA;
    const parentIndex = props?.parentIndex;
    const attendees = props?.attendees;
    const setAttendees = props?.setAttendees;
    const onEmailChange = (value) => {
        setEmails([{ ...emails?.[0], primary: true, value, type: '' }]);
        updateEntryInManualEntries(manualEntries, setManualEntries, index, attendees, setAttendees, setParentA, parentIndex, [{ ...emails?.[0], primary: true, value, type: '' }], undefined, additionalGuests);
    };
    const onNameChange = (value) => {
        setEmails([{ ...emails?.[0], primary: true, displayName: value, type: '' }]);
        updateEntryInManualEntries(manualEntries, setManualEntries, index, attendees, setAttendees, setParentA, parentIndex, [{ ...emails?.[0], primary: true, displayName: value, type: '' }], value, additionalGuests);
    };
    const onAdditionalGuestsChange = (text) => {
        setAdditionalGuests(parseInt(text.replace(/[^0-9.]/g, ''), 10));
        updateEntryInManualEntries(manualEntries, setManualEntries, index, attendees, setAttendees, setParentA, parentIndex, emails, undefined, parseInt(text.replace(/[^0-9.]/g, ''), 10));
    };
    return ((0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsxs)(RegularCard_1.default, { children: [(0, jsx_runtime_1.jsxs)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Email" }), (0, jsx_runtime_1.jsx)(TextField_1.default, { placeholder: "r@r.com", onChange: (e) => onEmailChange(e?.target?.value), value: emails?.[0]?.value || '', style: { width: '60%' }, validate: "email", validationMessage: "Please input a valid email address" })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Display Name" }), (0, jsx_runtime_1.jsx)(TextField_1.default, { placeholder: "name", onChange: (e) => onNameChange(e?.target?.value), value: manualEntries?.[index]?.name || '', style: { width: '60%' } })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Additional Guests?" }), (0, jsx_runtime_1.jsx)(TextField_1.default, { type: "number", onChange: (e) => onAdditionalGuestsChange(e?.target?.value), value: `${additionalGuests}`, placeholder: "0", style: { width: '15%' } })] }), (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: () => removeEntryFromManualEntries(manualEntries, setManualEntries, attendees, setAttendees, setParentA, index, parentIndex), children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", children: "Remove" }) })] }) }));
}
function ManualEntries(props) {
    const [pageOffset, setPageOffset] = (0, react_1.useState)(0);
    const { height: fullHeight } = react_native_1.Dimensions.get('window');
    const theme = (0, styles_1.useTheme)();
    const transitionDuration = {
        enter: theme.transitions.duration.enteringScreen,
        exit: theme.transitions.duration.leavingScreen,
    };
    const closeManual = props?.closeManual;
    const addNewEntry = () => {
        const addOneToManualEntries = props?.addOneToManualEntries;
        addOneToManualEntries(props?.manualEntries, props?.setManualEntries, props?.attendees, props?.setAttendees, props?.setParentA);
    };
    return ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, style: { width: '100%' }, minHeight: "65vh", maxHeight: "65vh", children: (0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, style: { width: '100%' }, children: [props?.manualEntries?.length > 0
                    ? ((0, jsx_runtime_1.jsx)(react_native_1.FlatList, { data: props?.manualEntries, renderItem: ({ item, index }) => ((0, jsx_runtime_1.jsx)(ManualEntry, { ...item, updateEntryInManualEntries: props?.updateEntryInManualEntries, removeEntryFromManualEntries: props?.removeEntryFromManualEntries, index: index, setManualEntries: props?.setManualEntries, manualEntries: props?.manualEntries, setParentA: props?.setParentA, parentIndex: props?.attendees.findIndex(a => (a?.id === item?.id)), attendees: props?.attendees, setAttendees: props?.setAttendees })), keyExtractor: (item) => item?.id })) : ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "subheader", children: "Add a New Entry" }) })), (0, jsx_runtime_1.jsx)(Box_1.default, { justifyContent: "center", alignItems: "center", style: { width: '100%' }, children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: closeManual, children: (0, jsx_runtime_1.jsx)(Text_1.default, { p: { phone: 'm', tablet: 'l' }, variant: "buttonLink", children: "Close" }) }) }), (0, jsx_runtime_1.jsx)(Zoom_1.default, { in: true, timeout: transitionDuration, style: {
                        transitionDelay: `${transitionDuration.exit}ms`,
                    }, unmountOnExit: true, children: (0, jsx_runtime_1.jsx)(Fab_1.default, { sx: fabStyle, "aria-label": 'Add', color: "primary", onClick: addNewEntry, children: (0, jsx_runtime_1.jsx)(Add_1.default, { sx: { color: colors_1.pink[500] } }) }) })] }) }));
}
function EditEventAttendees(props) {
    const [attendees, setAttendees] = (0, react_1.useState)(props?.attendees);
    const [isManual, setIsManual] = (0, react_1.useState)(false);
    const [manualEntries, setManualEntries] = (0, react_1.useState)([]);
    const [isContacts, setIsContacts] = (0, react_1.useState)(false);
    const [contacts, setContacts] = (0, react_1.useState)([]);
    const [isOpen, setIsOpen] = (0, react_1.useState)(false);
    // const [contactChecks, setContactChecks] = useState<boolean[]>([])
    const userId = props?.userId;
    // const parentAttendees = props?.attendees
    const setParentAttendees = props?.setParentAttendees;
    const client = props?.client;
    // get any contacts
    (0, react_1.useEffect)(() => {
        (async () => {
            if (!client || !userId) {
                return;
            }
            const newContacts = await (0, ContactHelper_1.listUserContactsHelper)(client, userId);
            console.log(newContacts, ' newContacts');
            if (newContacts?.length > 0) {
                setContacts(newContacts
                    .map(c => ({ ...c, selected: false }))
                    .filter(c => (c?.emails?.[0]?.value?.length > 0)));
            }
        })();
    }, [client, userId]);
    const onManualChange = () => {
        setIsContacts(isManual);
        setIsManual(!isManual);
    };
    const onContactsChange = () => {
        setIsManual(isContacts);
        setIsContacts(!isContacts);
    };
    const closeContacts = () => setIsContacts(false);
    const closeManual = () => setIsManual(false);
    const actions = [
        { icon: (0, jsx_runtime_1.jsx)(ImportContacts_1.default, { color: "secondary" }), name: 'Import Contacts', method: onContactsChange },
        { icon: (0, jsx_runtime_1.jsx)(Keyboard_1.default, { color: "secondary" }), name: 'Manual Entry', method: onManualChange },
    ];
    if (isManual) {
        return ((0, jsx_runtime_1.jsx)(ManualEntries, { setManualEntries: setManualEntries, manualEntries: manualEntries, attendees: attendees, setAttendees: setAttendees, setParentA: setParentAttendees, updateEntryInManualEntries: wizardHelper_1.updateEntryInManualEntries, removeEntryFromManualEntries: wizardHelper_1.removeEntryFromManualEntries, addOneToManualEntries: wizardHelper_1.addOneToManualEntries, closeManual: closeManual }));
    }
    if (isContacts) {
        return ((0, jsx_runtime_1.jsx)(Contacts, { addContactToAttendees: wizardHelper_1.addContactToAttendees, removeContactFromAttendee: wizardHelper_1.removeContactFromAttendee, updateContactSelection: wizardHelper_1.updateContactSelection, contacts: contacts, setParentA: setParentAttendees, attendees: attendees, setAttendees: setAttendees, closeContacts: closeContacts }));
    }
    return ((0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, style: { width: '100%' }, minHeight: "65vh", maxHeight: "65vh", children: [attendees?.length > 0
                ? ((0, jsx_runtime_1.jsx)(react_native_1.FlatList, { data: attendees, renderItem: ({ item }) => ((0, jsx_runtime_1.jsx)(themed_1.ListItem, { containerStyle: {
                            backgroundColor: theme_1.palette.white,
                            borderBottomWidth: react_native_1.StyleSheet.hairlineWidth,
                            borderColor: theme_1.palette.darkGray
                        }, children: (0, jsx_runtime_1.jsxs)(themed_1.ListItem.Content, { children: [(0, jsx_runtime_1.jsx)(themed_1.ListItem.Title, { style: { color: theme_1.palette.textBlack, fontWeight: 'bold' }, children: item?.name }), (0, jsx_runtime_1.jsx)(themed_1.ListItem.Subtitle, { style: { color: theme_1.palette.textBlack, }, children: item?.emails?.[0]?.value })] }) })), keyExtractor: (item) => item?.id })) : ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Box_1.default, { style: { width: '90%' }, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "subheaderNormal", children: "Add an attendee from your contacts or manually enter one" }) }) })), (0, jsx_runtime_1.jsx)("div", { className: "absolute inset-0 z-20 pointer-events-none", children: (0, jsx_runtime_1.jsx)(SpeedDial_1.default, { ariaLabel: "Calendar SpeedDial", sx: { position: 'absolute', bottom: 24, right: 24, zIndex: 'speedDial' }, icon: (0, jsx_runtime_1.jsx)(SpeedDialIcon_1.default, { icon: (0, jsx_runtime_1.jsx)(Edit_1.default, {}), sx: { color: colors_1.pink[500] } }), children: actions.map((action) => ((0, jsx_runtime_1.jsx)(SpeedDialAction_1.default, { icon: action.icon, tooltipTitle: action.name, FabProps: {
                            onClick: action.method,
                        } }, action.name))) }) })] }));
}
exports.default = EditEventAttendees;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRWRpdEV2ZW50QXR0ZW5kZWVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiRWRpdEV2ZW50QXR0ZW5kZWVzLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQXFEQSxnREFxQ0M7O0FBMUZELGlDQUtjO0FBQ2QsK0NBT3FCO0FBQ3JCLHNFQUE2QztBQUM3QywwQ0FJdUI7QUFDdkIsNERBQW9DO0FBQ3BDLGtFQUE4QztBQUM5QyxpREFBd0Q7QUFDeEQsOERBQXFDO0FBQ3JDLHdFQUFnRDtBQUNoRCxnRkFBd0Q7QUFDeEQsb0ZBQTREO0FBQzVELGlEQUEyQztBQUMzQyx3RkFBb0U7QUFDcEUsNEVBQXdEO0FBQ3hELG9FQUErQztBQUUvQyxpRUFBd0M7QUFDeEMsbUVBQTBDO0FBQzFDLDBFQUFpRDtBQUVqRCw4REFFbUM7QUFLbkMsK0VBQXdOO0FBSXhOLDRDQUEwQztBQUUxQyx3RUFBOEM7QUFDOUMsaUVBQTZEO0FBQzdELDhFQUFxRDtBQUU5QyxLQUFLLFVBQVUsa0JBQWtCLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFpRDtJQUNsRywwRkFBMEY7SUFDMUYsc0NBQXNDO0lBQ3RDLHlFQUF5RTtJQUN6RSwwQkFBZSxDQUFDLElBQUksQ0FBQyxJQUFBLDZCQUFhLEdBQUUsQ0FBQyxDQUFBO0lBQ3JDLElBQUksT0FBTyxDQUFBO0lBQ1gsSUFBSSxDQUFDO1FBQ0gsT0FBTyxHQUFHLE1BQU0saUJBQU8sQ0FBQyxVQUFVLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRTtZQUMzQyw2QkFBNkIsRUFBRSxLQUFLO2dCQUNsQyxPQUFPLEVBQUUsQ0FBQTtZQUNYLENBQUM7U0FDRixDQUFDLENBQUE7SUFDSixDQUFDO0lBQUMsT0FBTyxHQUFRLEVBQUUsQ0FBQztRQUNsQixJQUFJLEdBQUcsQ0FBQyxJQUFJLEtBQUssaUJBQU8sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUNqRCxPQUFPLEVBQUUsS0FBSyxFQUFFLEVBQUUsZUFBZSxFQUFFLGVBQWUsRUFBRSxFQUFFLENBQUE7UUFDeEQsQ0FBQzthQUFNLElBQUksR0FBRyxDQUFDLElBQUksS0FBSyxpQkFBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsQ0FBQztZQUNuRCxrRUFBa0U7WUFDbEUscUVBQXFFO1lBQ3JFLE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBRSxlQUFlLEVBQUUsZUFBZSxFQUFFLEVBQUUsQ0FBQTtRQUN4RCxDQUFDO1FBQ0QsTUFBTSxHQUFHLENBQUE7SUFDWCxDQUFDO0lBRUQsSUFBSSxDQUFDLE9BQU8sRUFBRSxTQUFTLEVBQUUsRUFBRSxDQUFDO1FBQzFCLE9BQU87WUFDTCxRQUFRLEVBQUU7Z0JBQ1IsV0FBVyxFQUFFLHVCQUF1QjtnQkFDcEMsU0FBUyxFQUFFLEtBQUs7YUFDakI7U0FDRixDQUFBO0lBQ0gsQ0FBQztJQUVELE9BQU87UUFDTCxLQUFLLEVBQUU7WUFDTCxHQUFHLEVBQUUsT0FBTyxDQUFDLFNBQVMsRUFBRTtTQUN6QjtLQUNGLENBQUE7QUFDSCxDQUFDO0FBRUQsTUFBTSxNQUFNLEdBQUc7SUFDYixRQUFRLEVBQUU7UUFDUixVQUFVLEVBQUUsVUFBVTtLQUN2QjtJQUNELFNBQVMsRUFBRTtRQUNULEdBQUcseUJBQVUsQ0FBQyxrQkFBa0I7UUFDaEMsY0FBYyxFQUFFLFVBQVU7S0FDM0I7SUFDRCxHQUFHLEVBQUU7UUFDSCxNQUFNLEVBQUUsRUFBRTtRQUNWLFNBQVMsRUFBRSxDQUFDO0tBQ2I7SUFDRCxVQUFVLEVBQUU7UUFDUixJQUFJLEVBQUUsQ0FBQztRQUNQLGNBQWMsRUFBRSxRQUFRO1FBQ3hCLFVBQVUsRUFBRSxRQUFRO0tBQ3ZCO0NBQ0YsQ0FBQTtBQUVELE1BQU0sUUFBUSxHQUFHO0lBQ2YsUUFBUSxFQUFFLFVBQVU7SUFDcEIsTUFBTSxFQUFFLEVBQUU7SUFDVixLQUFLLEVBQUUsRUFBRTtDQUNWLENBQUE7QUF1Q0QsU0FBUyxRQUFRLENBQUMsS0FBNEI7SUFDNUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxXQUFXLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQXdCLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQTtJQUNoRixNQUFNLGFBQWEsR0FBRyxLQUFLLEVBQUUsYUFBYSxDQUFBO0lBRTFDLE9BQU8sQ0FDTCx3QkFBQyxhQUFHLElBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUUsU0FBUyxFQUFDLE1BQU0sRUFBQyxTQUFTLEVBQUMsTUFBTSxhQUVyRSxRQUFRLEVBQUUsTUFBTSxHQUFHLENBQUM7Z0JBQ3BCLENBQUMsQ0FBQyxDQUNBLHVCQUFDLHVCQUFRLElBQ1AsSUFBSSxFQUFFLFFBQVEsRUFDZCxVQUFVLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FDL0IsdUJBQUMsT0FBTyxJQUNOLE9BQU8sRUFBRSxJQUFJLEVBQ2IscUJBQXFCLEVBQUUsS0FBSyxFQUFFLHFCQUFxQixFQUNuRCx5QkFBeUIsRUFBRSxLQUFLLEVBQUUseUJBQXlCLEVBQzNELHNCQUFzQixFQUFFLEtBQUssRUFBRSxzQkFBc0IsRUFDckQsUUFBUSxFQUFFLFFBQVEsRUFDbEIsV0FBVyxFQUFFLFdBQVcsRUFDeEIsVUFBVSxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQzdCLFNBQVMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUMzQixZQUFZLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFDakMsS0FBSyxFQUFFLEtBQUssR0FDWixDQUNILEVBQ0QsWUFBWSxFQUFFLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUMsR0FBRyxJQUFJLElBQUksS0FBSyxFQUFFLEdBQ2pELENBQ0gsQ0FBQyxDQUFDLENBQUMsQ0FDRix1QkFBQyxhQUFHLElBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxjQUFjLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBQyxRQUFRLFlBQ3ZELHVCQUFDLGFBQUcsSUFBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsY0FBYyxFQUFDLFFBQVEsRUFBQyxVQUFVLEVBQUMsUUFBUSxZQUN2RSx1QkFBQyxjQUFJLElBQUMsT0FBTyxFQUFDLGlCQUFpQiw4SEFJeEIsR0FDSCxHQUNGLENBQ1AsRUFFSCx1QkFBQyxhQUFHLElBQUMsY0FBYyxFQUFDLFFBQVEsRUFBQyxVQUFVLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFDdkUsdUJBQUMsd0JBQVMsSUFBQyxPQUFPLEVBQUUsYUFBYSxZQUMvQix1QkFBQyxjQUFJLElBQUMsQ0FBQyxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEVBQUUsT0FBTyxFQUFDLFlBQVksc0JBRW5ELEdBQ0csR0FDUixJQUNGLENBQ1AsQ0FBQTtBQUNILENBQUM7QUFFRCxTQUFTLE9BQU8sQ0FBQyxLQUEyQjtJQUMxQyxNQUFNLENBQUMsUUFBUSxFQUFFLFdBQVcsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBVSxLQUFLLEVBQUUsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssS0FBSyxFQUFFLE9BQU8sQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBRW5ILE1BQU0sY0FBYyxHQUFHLEdBQUcsRUFBRTtRQUMxQixNQUFNLEtBQUssR0FBRyxDQUFDLFFBQVEsQ0FBQTtRQUN2QixXQUFXLENBQUMsS0FBSyxDQUFDLENBQUE7UUFFbEIsSUFBSSxLQUFLLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDbkIsS0FBSyxFQUFFLHNCQUFzQixDQUMzQixLQUFLLEVBQ0wsS0FBSyxFQUFFLE9BQU8sRUFDZCxLQUFLLEVBQUUsUUFBUSxFQUNmLEtBQUssRUFBRSxXQUFXLEVBQ2xCLEtBQUssRUFBRSxLQUFLLENBQ2IsQ0FBQTtZQUVELEtBQUssRUFBRSxxQkFBcUIsQ0FDMUIsS0FBSyxFQUFFLE9BQU8sRUFDZCxLQUFLLEVBQUUsU0FBUyxFQUNoQixLQUFLLEVBQUUsWUFBWSxFQUNuQixLQUFLLEVBQUUsVUFBVSxDQUNsQixDQUFBO1FBQ0gsQ0FBQzthQUFNLElBQUksS0FBSyxLQUFLLEtBQUssRUFBRSxDQUFDO1lBQzNCLEtBQUssRUFBRSxzQkFBc0IsQ0FDM0IsS0FBSyxFQUNMLEtBQUssRUFBRSxPQUFPLEVBQ2QsS0FBSyxFQUFFLFFBQVEsRUFDZixLQUFLLEVBQUUsV0FBVyxFQUNsQixLQUFLLEVBQUUsS0FBSyxDQUNiLENBQUE7WUFFRCxLQUFLLEVBQUUseUJBQXlCLENBQzlCLEtBQUssRUFBRSxPQUFPLEVBQ2QsS0FBSyxFQUFFLFNBQVMsRUFDaEIsS0FBSyxFQUFFLFlBQVksRUFDbkIsS0FBSyxFQUFFLFVBQVUsQ0FDbEIsQ0FBQTtRQUNILENBQUM7SUFDSCxDQUFDLENBQUE7SUFFRCxPQUFPLENBQ0wsdUJBQUMsYUFBRyxjQUNGLHdCQUFDLHFCQUFXLGVBQ1YsdUJBQUMsYUFBRyxJQUFDLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxZQUNqQyx1QkFBQyxjQUFJLElBQUMsT0FBTyxFQUFDLGNBQWMsWUFDekIsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLEdBQ2hCLEdBQ0gsRUFDTix1QkFBQyxhQUFHLGNBQ0YsdUJBQUMsY0FBSSxJQUFDLE9BQU8sRUFBQyxTQUFTLFlBQ3BCLEtBQUssRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sS0FBSyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxHQUNqRSxHQUNILEVBQ04sdUJBQUMsYUFBRyxJQUFDLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxZQUNqQyx1QkFBQyx3QkFBUyxJQUFDLE9BQU8sRUFBRSxjQUFjLFlBQ2hDLHVCQUFDLGNBQUksSUFBQyxPQUFPLEVBQUMsWUFBWSxZQUN2QixRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUN2QixHQUNHLEdBQ1IsSUFDTSxHQUNWLENBQ1AsQ0FBQTtBQUNILENBQUM7QUEwQkQ7Ozs7OztFQU1FO0FBQ0YsU0FBUyxXQUFXLENBQUMsS0FBdUI7SUFDMUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxTQUFTLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQVUsS0FBSyxFQUFFLE1BQU0sSUFBSSxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLFdBQVcsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQTtJQUN6SCxNQUFNLENBQUMsZ0JBQWdCLEVBQUUsbUJBQW1CLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQVMsS0FBSyxFQUFFLGdCQUFnQixJQUFJLENBQUMsQ0FBQyxDQUFBO0lBRTlGLE1BQU0sMEJBQTBCLEdBQUcsS0FBSyxFQUFFLDBCQUEwQixDQUFBO0lBQ3BFLE1BQU0sNEJBQTRCLEdBQUcsS0FBSyxFQUFFLDRCQUE0QixDQUFBO0lBQ3hFLE1BQU0sZ0JBQWdCLEdBQUcsS0FBSyxFQUFFLGdCQUFnQixDQUFBO0lBQ2hELE1BQU0sYUFBYSxHQUFHLEtBQUssRUFBRSxhQUFhLENBQUE7SUFDMUMsTUFBTSxLQUFLLEdBQUcsS0FBSyxFQUFFLEtBQUssQ0FBQTtJQUMxQixNQUFNLFVBQVUsR0FBRyxLQUFLLEVBQUUsVUFBVSxDQUFBO0lBQ3BDLE1BQU0sV0FBVyxHQUFHLEtBQUssRUFBRSxXQUFXLENBQUE7SUFDdEMsTUFBTSxTQUFTLEdBQUcsS0FBSyxFQUFFLFNBQVMsQ0FBQTtJQUNsQyxNQUFNLFlBQVksR0FBRyxLQUFLLEVBQUUsWUFBWSxDQUFBO0lBR3hDLE1BQU0sYUFBYSxHQUFHLENBQUMsS0FBYSxFQUFFLEVBQUU7UUFDdEMsU0FBUyxDQUFDLENBQUMsRUFBRSxHQUFHLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUE7UUFDL0QsMEJBQTBCLENBQUMsYUFBYSxFQUFFLGdCQUFnQixFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFFLEdBQUcsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFLGdCQUFnQixDQUFDLENBQUE7SUFDek0sQ0FBQyxDQUFBO0lBRUQsTUFBTSxZQUFZLEdBQUcsQ0FBQyxLQUFhLEVBQUUsRUFBRTtRQUNyQyxTQUFTLENBQUMsQ0FBQyxFQUFFLEdBQUcsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUE7UUFDNUUsMEJBQTBCLENBQUMsYUFBYSxFQUFFLGdCQUFnQixFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFFLEdBQUcsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxnQkFBZ0IsQ0FBQyxDQUFBO0lBQ2xOLENBQUMsQ0FBQTtJQUVELE1BQU0sd0JBQXdCLEdBQUcsQ0FBQyxJQUFZLEVBQUUsRUFBRTtRQUNoRCxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQTtRQUMvRCwwQkFBMEIsQ0FBQyxhQUFhLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFBO0lBQ3JMLENBQUMsQ0FBQTtJQUVELE9BQU8sQ0FFSCx1QkFBQyxhQUFHLGNBQ0Ysd0JBQUMscUJBQVcsZUFDVix3QkFBQyxhQUFHLElBQUMsQ0FBQyxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLGFBQ2pDLHVCQUFDLGNBQUksSUFBQyxPQUFPLEVBQUMsY0FBYyxzQkFFckIsRUFDUCx1QkFBQyxtQkFBUyxJQUNSLFdBQVcsRUFBQyxTQUFTLEVBQ3JCLFFBQVEsRUFBRSxDQUFDLENBQWdDLEVBQUUsRUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQyxFQUMvRSxLQUFLLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxJQUFJLEVBQUUsRUFDL0IsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBQyxFQUN0QixRQUFRLEVBQUMsT0FBTyxFQUNoQixpQkFBaUIsRUFBQyxvQ0FBb0MsR0FDdEQsSUFDRSxFQUNOLHdCQUFDLGFBQUcsSUFBQyxDQUFDLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsYUFDakMsdUJBQUMsY0FBSSxJQUFDLE9BQU8sRUFBQyxjQUFjLDZCQUVyQixFQUNQLHVCQUFDLG1CQUFTLElBQ1IsV0FBVyxFQUFDLE1BQU0sRUFDbEIsUUFBUSxFQUFFLENBQUMsQ0FBZ0MsRUFBRSxFQUFFLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxDQUFDLEVBQzlFLEtBQUssRUFBRSxhQUFhLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRSxJQUFJLElBQUksRUFBRSxFQUN6QyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFDLEdBQ3RCLElBQ0UsRUFDTix3QkFBQyxhQUFHLElBQUMsQ0FBQyxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLGFBQ2pDLHVCQUFDLGNBQUksSUFBQyxPQUFPLEVBQUMsY0FBYyxtQ0FFckIsRUFDUCx1QkFBQyxtQkFBUyxJQUNSLElBQUksRUFBQyxRQUFRLEVBQ2IsUUFBUSxFQUFFLENBQUMsQ0FBZ0MsRUFBRSxFQUFFLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUMsRUFDMUYsS0FBSyxFQUFFLEdBQUcsZ0JBQWdCLEVBQUUsRUFDNUIsV0FBVyxFQUFDLEdBQUcsRUFDZixLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEdBQ3ZCLElBQ0UsRUFDTix1QkFBQyx3QkFBUyxJQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyw0QkFBNEIsQ0FBQyxhQUFhLEVBQUUsZ0JBQWdCLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLFdBQVcsQ0FBQyxZQUM5SSx1QkFBQyxjQUFJLElBQUMsT0FBTyxFQUFDLFlBQVksdUJBRW5CLEdBQ0csSUFDQSxHQUNSLENBRVgsQ0FBQTtBQUNILENBQUM7QUFFRCxTQUFTLGFBQWEsQ0FBQyxLQUF5QjtJQUM5QyxNQUFNLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBUyxDQUFDLENBQUMsQ0FBQTtJQUV2RCxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxHQUFHLHlCQUFVLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFBO0lBRXZELE1BQU0sS0FBSyxHQUFHLElBQUEsaUJBQVEsR0FBRSxDQUFBO0lBRXhCLE1BQU0sa0JBQWtCLEdBQUc7UUFDekIsS0FBSyxFQUFFLEtBQUssQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLGNBQWM7UUFDaEQsSUFBSSxFQUFFLEtBQUssQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLGFBQWE7S0FDL0MsQ0FBQTtJQUVELE1BQU0sV0FBVyxHQUFHLEtBQUssRUFBRSxXQUFXLENBQUE7SUFFdEMsTUFBTSxXQUFXLEdBQUcsR0FBRyxFQUFFO1FBQ3ZCLE1BQU0scUJBQXFCLEdBQUcsS0FBSyxFQUFFLHFCQUFxQixDQUFBO1FBQzFELHFCQUFxQixDQUNuQixLQUFLLEVBQUUsYUFBYSxFQUNwQixLQUFLLEVBQUUsZ0JBQWdCLEVBQ3ZCLEtBQUssRUFBRSxTQUFTLEVBQ2hCLEtBQUssRUFBRSxZQUFZLEVBQ25CLEtBQUssRUFBRSxVQUFVLENBQ2xCLENBQUE7SUFDSCxDQUFDLENBQUE7SUFFRCxPQUFPLENBQ0wsdUJBQUMsYUFBRyxJQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFLFNBQVMsRUFBQyxNQUFNLEVBQUMsU0FBUyxFQUFDLE1BQU0sWUFFckUsd0JBQUMsYUFBRyxJQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxhQUVsQyxLQUFLLEVBQUUsYUFBYSxFQUFFLE1BQU0sR0FBRyxDQUFDO29CQUNoQyxDQUFDLENBQUMsQ0FDQSx1QkFBQyx1QkFBUSxJQUNQLElBQUksRUFBRSxLQUFLLEVBQUUsYUFBYSxFQUMxQixVQUFVLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FDL0IsdUJBQUMsV0FBVyxPQUNOLElBQUksRUFDUiwwQkFBMEIsRUFBRSxLQUFLLEVBQUUsMEJBQTBCLEVBQzdELDRCQUE0QixFQUFFLEtBQUssRUFBRSw0QkFBNEIsRUFDakUsS0FBSyxFQUFFLEtBQUssRUFDWixnQkFBZ0IsRUFBRSxLQUFLLEVBQUUsZ0JBQWdCLEVBQ3pDLGFBQWEsRUFBRSxLQUFLLEVBQUUsYUFBYSxFQUNuQyxVQUFVLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFDN0IsV0FBVyxFQUFFLEtBQUssRUFBRSxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxLQUFLLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUNsRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFDM0IsWUFBWSxFQUFFLEtBQUssRUFBRSxZQUFZLEdBQ2pDLENBQ0gsRUFDRCxZQUFZLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFLEdBQ2hDLENBQ0gsQ0FBQyxDQUFDLENBQUMsQ0FDRix1QkFBQyxhQUFHLElBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxjQUFjLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBQyxRQUFRLFlBQ3ZELHVCQUFDLGNBQUksSUFBQyxPQUFPLEVBQUMsV0FBVyxnQ0FFbEIsR0FDSCxDQUNQLEVBRUgsdUJBQUMsYUFBRyxJQUFDLGNBQWMsRUFBQyxRQUFRLEVBQUMsVUFBVSxFQUFDLFFBQVEsRUFBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQ3ZFLHVCQUFDLHdCQUFTLElBQUMsT0FBTyxFQUFFLFdBQVcsWUFDN0IsdUJBQUMsY0FBSSxJQUFDLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxFQUFFLE9BQU8sRUFBQyxZQUFZLHNCQUVuRCxHQUNHLEdBQ1IsRUFFSix1QkFBQyxjQUFJLElBQ0gsRUFBRSxRQUNGLE9BQU8sRUFBRSxrQkFBa0IsRUFDM0IsS0FBSyxFQUFFO3dCQUNMLGVBQWUsRUFBRSxHQUFHLGtCQUFrQixDQUFDLElBQUksSUFBSTtxQkFDaEQsRUFDRCxhQUFhLGtCQUViLHVCQUFDLGFBQUcsSUFBQyxFQUFFLEVBQUUsUUFBbUIsZ0JBQWMsS0FBSyxFQUFFLEtBQUssRUFBQyxTQUFTLEVBQUMsT0FBTyxFQUFFLFdBQVcsWUFDbkYsdUJBQUMsYUFBTyxJQUFDLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxhQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsR0FBSSxHQUNqQyxHQUNELElBQ0wsR0FDSixDQUNQLENBQUE7QUFDSCxDQUFDO0FBRUQsU0FBUyxrQkFBa0IsQ0FBQyxLQUFZO0lBQ3RDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFXLEtBQUssRUFBRSxTQUFTLENBQUMsQ0FBQTtJQUN0RSxNQUFNLENBQUMsUUFBUSxFQUFFLFdBQVcsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBVSxLQUFLLENBQUMsQ0FBQTtJQUN4RCxNQUFNLENBQUMsYUFBYSxFQUFFLGdCQUFnQixDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFXLEVBQUUsQ0FBQyxDQUFBO0lBQ2hFLE1BQU0sQ0FBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFVLEtBQUssQ0FBQyxDQUFBO0lBQzVELE1BQU0sQ0FBQyxRQUFRLEVBQUUsV0FBVyxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUF3QixFQUFFLENBQUMsQ0FBQTtJQUNuRSxNQUFNLENBQUMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBVSxLQUFLLENBQUMsQ0FBQTtJQUNwRCxvRUFBb0U7SUFFcEUsTUFBTSxNQUFNLEdBQUcsS0FBSyxFQUFFLE1BQU0sQ0FBQTtJQUM1QiwyQ0FBMkM7SUFDM0MsTUFBTSxrQkFBa0IsR0FBRyxLQUFLLEVBQUUsa0JBQWtCLENBQUE7SUFDcEQsTUFBTSxNQUFNLEdBQUcsS0FBSyxFQUFFLE1BQU0sQ0FBQTtJQUU1QixtQkFBbUI7SUFDbkIsSUFBQSxpQkFBUyxFQUFDLEdBQUcsRUFBRTtRQUNiLENBQUMsS0FBSyxJQUFJLEVBQUU7WUFDVixJQUFJLENBQUMsTUFBTSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7Z0JBQ3ZCLE9BQU07WUFDUixDQUFDO1lBQ0QsTUFBTSxXQUFXLEdBQUcsTUFBTSxJQUFBLHNDQUFzQixFQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQTtZQUNoRSxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxjQUFjLENBQUMsQ0FBQTtZQUN4QyxJQUFJLFdBQVcsRUFBRSxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7Z0JBQzVCLFdBQVcsQ0FBQyxXQUFXO3FCQUNwQixHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBMEIsQ0FBQSxDQUFDO3FCQUM1RCxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQ2xELENBQUE7WUFDSCxDQUFDO1FBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtJQUNOLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFBO0lBRXBCLE1BQU0sY0FBYyxHQUFHLEdBQUcsRUFBRTtRQUMxQixhQUFhLENBQUMsUUFBUSxDQUFDLENBQUE7UUFDdkIsV0FBVyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUE7SUFDeEIsQ0FBQyxDQUFBO0lBRUQsTUFBTSxnQkFBZ0IsR0FBRyxHQUFHLEVBQUU7UUFDNUIsV0FBVyxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQ3ZCLGFBQWEsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFBO0lBQzVCLENBQUMsQ0FBQTtJQUVELE1BQU0sYUFBYSxHQUFHLEdBQUcsRUFBRSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUVoRCxNQUFNLFdBQVcsR0FBRyxHQUFHLEVBQUUsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUE7SUFFNUMsTUFBTSxPQUFPLEdBQUc7UUFDZCxFQUFFLElBQUksRUFBRSx1QkFBQyx3QkFBa0IsSUFBQyxLQUFLLEVBQUMsV0FBVyxHQUFHLEVBQUUsSUFBSSxFQUFFLGlCQUFpQixFQUFFLE1BQU0sRUFBRSxnQkFBZ0IsRUFBRTtRQUNyRyxFQUFFLElBQUksRUFBRSx1QkFBQyxrQkFBWSxJQUFDLEtBQUssRUFBQyxXQUFXLEdBQUcsRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUU7S0FDM0YsQ0FBQTtJQUVELElBQUksUUFBUSxFQUFFLENBQUM7UUFDYixPQUFPLENBQ0wsdUJBQUMsYUFBYSxJQUNaLGdCQUFnQixFQUFFLGdCQUFnQixFQUNsQyxhQUFhLEVBQUUsYUFBYSxFQUM1QixTQUFTLEVBQUUsU0FBUyxFQUNwQixZQUFZLEVBQUUsWUFBWSxFQUMxQixVQUFVLEVBQUUsa0JBQWtCLEVBQzlCLDBCQUEwQixFQUFFLHlDQUEwQixFQUN0RCw0QkFBNEIsRUFBRSwyQ0FBNEIsRUFDMUQscUJBQXFCLEVBQUUsb0NBQXFCLEVBQzVDLFdBQVcsRUFBRSxXQUFXLEdBQ3hCLENBQ0gsQ0FBQTtJQUNILENBQUM7SUFFRCxJQUFJLFVBQVUsRUFBRSxDQUFDO1FBQ2YsT0FBTyxDQUNMLHVCQUFDLFFBQVEsSUFDUCxxQkFBcUIsRUFBRSxvQ0FBcUIsRUFDNUMseUJBQXlCLEVBQUUsd0NBQXlCLEVBQ3BELHNCQUFzQixFQUFFLHFDQUFzQixFQUM5QyxRQUFRLEVBQUUsUUFBUSxFQUNsQixVQUFVLEVBQUUsa0JBQWtCLEVBQzlCLFNBQVMsRUFBRSxTQUFTLEVBQ3BCLFlBQVksRUFBRSxZQUFZLEVBQzFCLGFBQWEsRUFBRSxhQUFhLEdBQzVCLENBQ0gsQ0FBQTtJQUNILENBQUM7SUFHRixPQUFPLENBQ0wsd0JBQUMsYUFBRyxJQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFLFNBQVMsRUFBQyxNQUFNLEVBQUMsU0FBUyxFQUFDLE1BQU0sYUFFcEUsU0FBUyxFQUFFLE1BQU0sR0FBRyxDQUFDO2dCQUNyQixDQUFDLENBQUMsQ0FDQSx1QkFBQyx1QkFBUSxJQUNQLElBQUksRUFBRSxTQUFTLEVBQ2YsVUFBVSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FDeEIsdUJBQUMsaUJBQVEsSUFDTCxjQUFjLEVBQUU7NEJBQ2QsZUFBZSxFQUFFLGVBQU8sQ0FBQyxLQUFLOzRCQUM5QixpQkFBaUIsRUFBRSx5QkFBVSxDQUFDLGFBQWE7NEJBQzNDLFdBQVcsRUFBRSxlQUFPLENBQUMsUUFBUTt5QkFDOUIsWUFFSCx3QkFBQyxpQkFBUSxDQUFDLE9BQU8sZUFDZix1QkFBQyxpQkFBUSxDQUFDLEtBQUssSUFBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsZUFBTyxDQUFDLFNBQVMsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLFlBQ3BFLElBQUksRUFBRSxJQUFJLEdBQ0ksRUFDakIsdUJBQUMsaUJBQVEsQ0FBQyxRQUFRLElBQUMsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLGVBQU8sQ0FBQyxTQUFTLEdBQUcsWUFDcEQsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssR0FDUCxJQUNILEdBQ1YsQ0FDWixFQUNELFlBQVksRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUUsR0FDaEMsQ0FDSCxDQUFDLENBQUMsQ0FBQyxDQUNGLHVCQUFDLGFBQUcsSUFBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLGNBQWMsRUFBQyxRQUFRLEVBQUMsVUFBVSxFQUFDLFFBQVEsWUFDdkQsdUJBQUMsYUFBRyxJQUFDLEtBQUssRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUMsRUFBRSxjQUFjLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBQyxRQUFRLFlBQ3RFLHVCQUFDLGNBQUksSUFBQyxPQUFPLEVBQUMsaUJBQWlCLHlFQUV4QixHQUNILEdBQ0YsQ0FDUCxFQUVILGdDQUFLLFNBQVMsRUFBQywyQ0FBMkMsWUFDeEQsdUJBQUMsbUJBQVMsSUFDTixTQUFTLEVBQUMsb0JBQW9CLEVBQzlCLEVBQUUsRUFBRSxFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsRUFDeEUsSUFBSSxFQUFFLHVCQUFDLHVCQUFhLElBQUMsSUFBSSxFQUFFLHVCQUFDLGNBQVEsS0FBRyxFQUFFLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxhQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsR0FBSSxZQUVwRSxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxDQUNyQix1QkFBQyx5QkFBZSxJQUVaLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSSxFQUNqQixZQUFZLEVBQUUsTUFBTSxDQUFDLElBQUksRUFDekIsUUFBUSxFQUFFOzRCQUNOLE9BQU8sRUFBRSxNQUFNLENBQUMsTUFBTTt5QkFDekIsSUFMSSxNQUFNLENBQUMsSUFBSSxDQU1sQixDQUNMLENBQUMsR0FDTSxHQUNSLElBQ0gsQ0FDUCxDQUFBO0FBQ0YsQ0FBQztBQUVELGtCQUFlLGtCQUFrQixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7XG4gICAgdXNlU3RhdGUsXG4gICAgdXNlRWZmZWN0LFxuICAgIERpc3BhdGNoLFxuICAgIFNldFN0YXRlQWN0aW9uLFxufSBmcm9tICdyZWFjdCdcbmltcG9ydCB7XG4gIEZsYXRMaXN0LFxuICBTYWZlQXJlYVZpZXcsXG4gIFN0eWxlU2hlZXQsXG4gIFByZXNzYWJsZSxcbiAgRGltZW5zaW9ucyxcbiAgQXBwZWFyYW5jZSxcbn0gZnJvbSAncmVhY3QtbmF0aXZlJ1xuaW1wb3J0IFRleHRGaWVsZCBmcm9tICdAY29tcG9uZW50cy9UZXh0RmllbGQnXG5pbXBvcnQge1xuXG4gIExpc3RJdGVtLFxuXG4gfSBmcm9tICdAcm5ldWkvdGhlbWVkJ1xuaW1wb3J0IEZhYiBmcm9tICdAbXVpL21hdGVyaWFsL0ZhYic7XG5pbXBvcnQgQWRkSWNvbiBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsL0FkZCc7XG5pbXBvcnQgeyBTeFByb3BzLCB1c2VUaGVtZSB9IGZyb20gJ0BtdWkvbWF0ZXJpYWwvc3R5bGVzJ1xuaW1wb3J0IFpvb20gZnJvbSAnQG11aS9tYXRlcmlhbC9ab29tJ1xuaW1wb3J0IFNwZWVkRGlhbCBmcm9tICdAbXVpL21hdGVyaWFsL1NwZWVkRGlhbCc7XG5pbXBvcnQgU3BlZWREaWFsSWNvbiBmcm9tICdAbXVpL21hdGVyaWFsL1NwZWVkRGlhbEljb24nO1xuaW1wb3J0IFNwZWVkRGlhbEFjdGlvbiBmcm9tICdAbXVpL21hdGVyaWFsL1NwZWVkRGlhbEFjdGlvbic7XG5pbXBvcnQgeyBwaW5rIH0gZnJvbSAnQG11aS9tYXRlcmlhbC9jb2xvcnMnXG5pbXBvcnQgSW1wb3J0Q29udGFjdHNJY29uIGZyb20gJ0BtdWkvaWNvbnMtbWF0ZXJpYWwvSW1wb3J0Q29udGFjdHMnO1xuaW1wb3J0IEtleWJvYXJkSWNvbiBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsL0tleWJvYXJkJztcbmltcG9ydCBFZGl0SWNvbiBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsL0VkaXQnXG5cbmltcG9ydCBCb3ggZnJvbSAnQGNvbXBvbmVudHMvY29tbW9uL0JveCdcbmltcG9ydCBUZXh0IGZyb20gJ0Bjb21wb25lbnRzL2NvbW1vbi9UZXh0J1xuaW1wb3J0IFJlZ3VsYXJDYXJkIGZyb20gJ0Bjb21wb25lbnRzL1JlZ3VsYXJDYXJkJ1xuXG5pbXBvcnQge1xuICBsaXN0VXNlckNvbnRhY3RzSGVscGVyXG59IGZyb20gJ0BsaWIvQ29udGFjdC9Db250YWN0SGVscGVyJ1xuaW1wb3J0IHsgZW1haWwsIFBlcnNvbiB9IGZyb20gJ0BsaWIvQ2FsZW5kYXIvdHlwZXMnXG5cblxuaW1wb3J0IHsgQ29udGFjdFR5cGUgfSBmcm9tICdAbGliL2RhdGFUeXBlcy9Db250YWN0VHlwZSdcbmltcG9ydCB7IGFkZENvbnRhY3RUb0F0dGVuZGVlcywgYWRkT25lVG9NYW51YWxFbnRyaWVzLCByZW1vdmVDb250YWN0RnJvbUF0dGVuZGVlLCByZW1vdmVFbnRyeUZyb21NYW51YWxFbnRyaWVzLCB1cGRhdGVDb250YWN0U2VsZWN0aW9uLCB1cGRhdGVFbnRyeUluTWFudWFsRW50cmllcyB9IGZyb20gJ0BsaWIvQ2FsZW5kYXIvQ3JlYXRlRXZlbnRXaXphcmQvd2l6YXJkSGVscGVyJ1xuXG5pbXBvcnQgeyBBcG9sbG9DbGllbnQsIE5vcm1hbGl6ZWRDYWNoZU9iamVjdCB9IGZyb20gJ0BhcG9sbG8vY2xpZW50J1xuXG5pbXBvcnQgeyBwYWxldHRlIH0gZnJvbSAnQGxpYi90aGVtZS90aGVtZSdcbmltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCBzdXBlcnRva2Vuc05vZGUgZnJvbSAnc3VwZXJ0b2tlbnMtbm9kZSdcbmltcG9ydCB7IGJhY2tlbmRDb25maWcgfSBmcm9tICcuLi8uLi8uLi9jb25maWcvYmFja2VuZENvbmZpZydcbmltcG9ydCBTZXNzaW9uIGZyb20gJ3N1cGVydG9rZW5zLW5vZGUvcmVjaXBlL3Nlc3Npb24nXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXJ2ZXJTaWRlUHJvcHMoeyByZXEsIHJlcyB9OiB7IHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlIH0pIHtcbiAgLy8gTm90aWNlIGhvdyB0aGUgc2VydmVyIHVzZXMgYEFQSWAgZnJvbSBgd2l0aFNTUkNvbnRleHRgLCBpbnN0ZWFkIG9mIHRoZSB0b3AtbGV2ZWwgYEFQSWAuXG4gIC8vIGNvbnN0IFNTUiA9IHdpdGhTU1JDb250ZXh0KHsgcmVxIH0pXG4gIC8vIHRoaXMgcnVucyBvbiB0aGUgYmFja2VuZCwgc28gd2UgbXVzdCBjYWxsIGluaXQgb24gc3VwZXJ0b2tlbnMtbm9kZSBTREtcbiAgc3VwZXJ0b2tlbnNOb2RlLmluaXQoYmFja2VuZENvbmZpZygpKVxuICBsZXQgc2Vzc2lvblxuICB0cnkge1xuICAgIHNlc3Npb24gPSBhd2FpdCBTZXNzaW9uLmdldFNlc3Npb24ocmVxLCByZXMsIHtcbiAgICAgIG92ZXJyaWRlR2xvYmFsQ2xhaW1WYWxpZGF0b3JzOiBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBbXVxuICAgICAgfSxcbiAgICB9KVxuICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgIGlmIChlcnIudHlwZSA9PT0gU2Vzc2lvbi5FcnJvci5UUllfUkVGUkVTSF9UT0tFTikge1xuICAgICAgcmV0dXJuIHsgcHJvcHM6IHsgZnJvbVN1cGVydG9rZW5zOiAnbmVlZHMtcmVmcmVzaCcgfSB9XG4gICAgfSBlbHNlIGlmIChlcnIudHlwZSA9PT0gU2Vzc2lvbi5FcnJvci5VTkFVVEhPUklTRUQpIHtcbiAgICAgIC8vIHRoaXMgd2lsbCBmb3JjZSB0aGUgZnJvbnRlbmQgdG8gdHJ5IGFuZCByZWZyZXNoIHdoaWNoIHdpbGwgZmFpbFxuICAgICAgLy8gY2xlYXJpbmcgYWxsIGNvb2tpZXMgYW5kIHJlZGlyZWN0aW5nIHRoZSB1c2VyIHRvIHRoZSBsb2dpbiBzY3JlZW4uXG4gICAgICByZXR1cm4geyBwcm9wczogeyBmcm9tU3VwZXJ0b2tlbnM6ICduZWVkcy1yZWZyZXNoJyB9IH1cbiAgICB9XG4gICAgdGhyb3cgZXJyXG4gIH1cblxuICBpZiAoIXNlc3Npb24/LmdldFVzZXJJZCgpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlZGlyZWN0OiB7XG4gICAgICAgIGRlc3RpbmF0aW9uOiAnL1VzZXIvTG9naW4vVXNlckxvZ2luJyxcbiAgICAgICAgcGVybWFuZW50OiBmYWxzZSxcbiAgICAgIH0sXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBwcm9wczoge1xuICAgICAgc3ViOiBzZXNzaW9uLmdldFVzZXJJZCgpLFxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBzdHlsZXMgPSB7XG4gIHNhZmVBcmVhOiB7XG4gICAgYWxpZ25JdGVtczogJ2ZsZXgtZW5kJyxcbiAgfSxcbiAgY29udGFpbmVyOiB7XG4gICAgLi4uU3R5bGVTaGVldC5hYnNvbHV0ZUZpbGxPYmplY3QsXG4gICAganVzdGlmeUNvbnRlbnQ6ICdmbGV4LWVuZCcsXG4gIH0sXG4gIGZhYjoge1xuICAgIG1hcmdpbjogMTYsXG4gICAgbWFyZ2luVG9wOiAwLFxuICB9LFxuICBjb250YWluZXIyOiB7XG4gICAgICBmbGV4OiAxLFxuICAgICAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLFxuICAgICAgYWxpZ25JdGVtczogJ2NlbnRlcicsXG4gIH0sXG59XG5cbmNvbnN0IGZhYlN0eWxlID0ge1xuICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgYm90dG9tOiAxNixcbiAgcmlnaHQ6IDE2LFxufVxuXG5leHBvcnQgdHlwZSBTZWxlY3RlZENvbnRhY3RUeXBlID0gQ29udGFjdFR5cGUgJiB7XG4gIHNlbGVjdGVkOiBib29sZWFuLFxufVxuXG50eXBlIFByb3BzID0ge1xuICBhdHRlbmRlZXM6IFBlcnNvbltdLFxuICBzZXRQYXJlbnRBdHRlbmRlZXM6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPFBlcnNvbltdPj4sXG4gIHVzZXJJZDogc3RyaW5nLFxuICBjbGllbnQ6IEFwb2xsb0NsaWVudDxOb3JtYWxpemVkQ2FjaGVPYmplY3Q+LFxufVxuXG50eXBlIHNlbGVjdGVkQ29udGFjdFByb3BzID0ge1xuICBjb250YWN0OiBTZWxlY3RlZENvbnRhY3RUeXBlLFxuICBhZGRDb250YWN0VG9BdHRlbmRlZXM6IHR5cGVvZiBhZGRDb250YWN0VG9BdHRlbmRlZXNcbiAgcmVtb3ZlQ29udGFjdEZyb21BdHRlbmRlZTogdHlwZW9mIHJlbW92ZUNvbnRhY3RGcm9tQXR0ZW5kZWUsXG4gIHVwZGF0ZUNvbnRhY3RTZWxlY3Rpb246IHR5cGVvZiB1cGRhdGVDb250YWN0U2VsZWN0aW9uLFxuICBjb250YWN0czogU2VsZWN0ZWRDb250YWN0VHlwZVtdLFxuICBzZXRDb250YWN0czogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248U2VsZWN0ZWRDb250YWN0VHlwZVtdPj4sXG4gIHNldFBhcmVudEE6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPFBlcnNvbltdPj4sXG4gIGF0dGVuZGVlczogUGVyc29uW10sXG4gIHNldEF0dGVuZGVlczogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248UGVyc29uW10+PixcbiAgaW5kZXg6IG51bWJlcixcbn1cblxuXG5cbnR5cGUgc2VsZWN0ZWRDb250YWN0c1Byb3BzID0ge1xuICBhZGRDb250YWN0VG9BdHRlbmRlZXM6IHR5cGVvZiBhZGRDb250YWN0VG9BdHRlbmRlZXNcbiAgcmVtb3ZlQ29udGFjdEZyb21BdHRlbmRlZTogdHlwZW9mIHJlbW92ZUNvbnRhY3RGcm9tQXR0ZW5kZWUsXG4gIHVwZGF0ZUNvbnRhY3RTZWxlY3Rpb246IHR5cGVvZiB1cGRhdGVDb250YWN0U2VsZWN0aW9uLFxuICBjb250YWN0czogU2VsZWN0ZWRDb250YWN0VHlwZVtdLFxuICBzZXRQYXJlbnRBOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxQZXJzb25bXT4+LFxuICBhdHRlbmRlZXM6IFBlcnNvbltdLFxuICBzZXRBdHRlbmRlZXM6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPFBlcnNvbltdPj4sXG4gIGNsb3NlQ29udGFjdHM6ICgpID0+IHZvaWQsXG59XG5cbmZ1bmN0aW9uIENvbnRhY3RzKHByb3BzOiBzZWxlY3RlZENvbnRhY3RzUHJvcHMpIHtcbiAgY29uc3QgW2NvbnRhY3RzLCBzZXRDb250YWN0c10gPSB1c2VTdGF0ZTxTZWxlY3RlZENvbnRhY3RUeXBlW10+KHByb3BzPy5jb250YWN0cylcbiAgY29uc3QgY2xvc2VDb250YWN0cyA9IHByb3BzPy5jbG9zZUNvbnRhY3RzXG5cbiAgcmV0dXJuIChcbiAgICA8Qm94IGZsZXg9ezF9IHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0gbWluSGVpZ2h0PVwiNjV2aFwiIG1heEhlaWdodD1cIjY1dmhcIj5cbiAgICAgIHtcbiAgICAgICAgY29udGFjdHM/Lmxlbmd0aCA+IDBcbiAgICAgICAgPyAoXG4gICAgICAgICAgPEZsYXRMaXN0XG4gICAgICAgICAgICBkYXRhPXtjb250YWN0c31cbiAgICAgICAgICAgIHJlbmRlckl0ZW09eyh7IGl0ZW0sIGluZGV4IH0pID0+IChcbiAgICAgICAgICAgICAgPENvbnRhY3RcbiAgICAgICAgICAgICAgICBjb250YWN0PXtpdGVtfVxuICAgICAgICAgICAgICAgIGFkZENvbnRhY3RUb0F0dGVuZGVlcz17cHJvcHM/LmFkZENvbnRhY3RUb0F0dGVuZGVlc31cbiAgICAgICAgICAgICAgICByZW1vdmVDb250YWN0RnJvbUF0dGVuZGVlPXtwcm9wcz8ucmVtb3ZlQ29udGFjdEZyb21BdHRlbmRlZX1cbiAgICAgICAgICAgICAgICB1cGRhdGVDb250YWN0U2VsZWN0aW9uPXtwcm9wcz8udXBkYXRlQ29udGFjdFNlbGVjdGlvbn1cbiAgICAgICAgICAgICAgICBjb250YWN0cz17Y29udGFjdHN9XG4gICAgICAgICAgICAgICAgc2V0Q29udGFjdHM9e3NldENvbnRhY3RzfVxuICAgICAgICAgICAgICAgIHNldFBhcmVudEE9e3Byb3BzPy5zZXRQYXJlbnRBfVxuICAgICAgICAgICAgICAgIGF0dGVuZGVlcz17cHJvcHM/LmF0dGVuZGVlc31cbiAgICAgICAgICAgICAgICBzZXRBdHRlbmRlZXM9e3Byb3BzPy5zZXRBdHRlbmRlZXN9XG4gICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGtleUV4dHJhY3Rvcj17KGl0ZW0sIGluZGV4KSA9PiBgJHtpdGVtfS0ke2luZGV4fWB9XG4gICAgICAgICAgLz5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICA8Qm94IGZsZXg9ezF9IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgPEJveCBzdHlsZT17eyB3aWR0aDogJzk1JScgfX0ganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgIDxUZXh0IHZhcmlhbnQ9XCJzdWJoZWFkZXJOb3JtYWxcIj5cbiAgICAgICAgICAgICAgICBZb3UgaGF2ZSBubyBjb250YWN0cyBzYXZlZC5cbiAgICAgICAgICAgICAgICBHbyB0byBzZXR0aW5ncyB0byBlbmFibGUgYW5kIHN5bmMgQ29udGFjdHMgZnJvbSB5b3VyIHBob25lXG4gICAgICAgICAgICAgICAgb3IgM3JkIHBhcnR5IHByb3ZpZGVyLlxuICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICA8L0JveD5cbiAgICAgICAgKVxuICAgICAgfVxuICAgICAgPEJveCBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIiBzdHlsZT17eyB3aWR0aDogJzEwMCUnIH19PlxuICAgICAgICA8UHJlc3NhYmxlIG9uUHJlc3M9e2Nsb3NlQ29udGFjdHN9PlxuICAgICAgICAgIDxUZXh0IHA9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAnbCcgfX0gdmFyaWFudD1cImJ1dHRvbkxpbmtcIj5cbiAgICAgICAgICAgIENsb3NlXG4gICAgICAgICAgPC9UZXh0PlxuICAgICAgICA8L1ByZXNzYWJsZT5cbiAgICAgIDwvQm94PlxuICAgIDwvQm94PlxuICApXG59XG5cbmZ1bmN0aW9uIENvbnRhY3QocHJvcHM6IHNlbGVjdGVkQ29udGFjdFByb3BzKSB7XG4gIGNvbnN0IFtzZWxlY3RlZCwgc2V0U2VsZWN0ZWRdID0gdXNlU3RhdGU8Ym9vbGVhbj4ocHJvcHM/LmF0dGVuZGVlcy5maW5kSW5kZXgoaSA9PiBpLmlkID09PSBwcm9wcz8uY29udGFjdC5pZCkgPiAtMSlcblxuICBjb25zdCB1cGRhdGVTZWxlY3RlZCA9ICgpID0+IHtcbiAgICBjb25zdCB2YWx1ZSA9ICFzZWxlY3RlZFxuICAgIHNldFNlbGVjdGVkKHZhbHVlKVxuXG4gICAgaWYgKHZhbHVlID09PSB0cnVlKSB7XG4gICAgICBwcm9wcz8udXBkYXRlQ29udGFjdFNlbGVjdGlvbihcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIHByb3BzPy5jb250YWN0LFxuICAgICAgICBwcm9wcz8uY29udGFjdHMsXG4gICAgICAgIHByb3BzPy5zZXRDb250YWN0cyxcbiAgICAgICAgcHJvcHM/LmluZGV4LFxuICAgICAgKVxuXG4gICAgICBwcm9wcz8uYWRkQ29udGFjdFRvQXR0ZW5kZWVzKFxuICAgICAgICBwcm9wcz8uY29udGFjdCxcbiAgICAgICAgcHJvcHM/LmF0dGVuZGVlcyxcbiAgICAgICAgcHJvcHM/LnNldEF0dGVuZGVlcyxcbiAgICAgICAgcHJvcHM/LnNldFBhcmVudEEsXG4gICAgICApXG4gICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHtcbiAgICAgIHByb3BzPy51cGRhdGVDb250YWN0U2VsZWN0aW9uKFxuICAgICAgICB2YWx1ZSxcbiAgICAgICAgcHJvcHM/LmNvbnRhY3QsXG4gICAgICAgIHByb3BzPy5jb250YWN0cyxcbiAgICAgICAgcHJvcHM/LnNldENvbnRhY3RzLFxuICAgICAgICBwcm9wcz8uaW5kZXgsXG4gICAgICApXG5cbiAgICAgIHByb3BzPy5yZW1vdmVDb250YWN0RnJvbUF0dGVuZGVlKFxuICAgICAgICBwcm9wcz8uY29udGFjdCxcbiAgICAgICAgcHJvcHM/LmF0dGVuZGVlcyxcbiAgICAgICAgcHJvcHM/LnNldEF0dGVuZGVlcyxcbiAgICAgICAgcHJvcHM/LnNldFBhcmVudEEsXG4gICAgICApXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8Qm94PlxuICAgICAgPFJlZ3VsYXJDYXJkPlxuICAgICAgICA8Qm94IHA9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPlxuICAgICAgICAgICAge3Byb3BzPy5jb250YWN0Py5uYW1lfVxuICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgPC9Cb3g+XG4gICAgICAgIDxCb3g+XG4gICAgICAgICAgPFRleHQgdmFyaWFudD1cImNhcHRpb25cIj5cbiAgICAgICAgICAgIHtwcm9wcz8uY29udGFjdD8uZW1haWxzPy5maWx0ZXIoaSA9PiAoaS5wcmltYXJ5ID09PSB0cnVlKSk/LlswXT8udmFsdWV9XG4gICAgICAgICAgPC9UZXh0PlxuICAgICAgICA8L0JveD5cbiAgICAgICAgPEJveCBwPXt7IHBob25lOiAncycsIHRhYmxldDogJ20nIH19PlxuICAgICAgICAgIDxQcmVzc2FibGUgb25QcmVzcz17dXBkYXRlU2VsZWN0ZWR9PlxuICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cImJ1dHRvbkxpbmtcIj5cbiAgICAgICAgICAgICAge3NlbGVjdGVkID8gJ1JlbW92ZScgOiAnQWRkJyB9XG4gICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgPC9QcmVzc2FibGU+XG4gICAgICAgIDwvQm94PlxuICAgICAgPC9SZWd1bGFyQ2FyZD5cbiAgICA8L0JveD5cbiAgKVxufVxuXG50eXBlIG1hbnVhbEVudHJ5UHJvcHMgPSBQZXJzb24gJiB7XG4gIHVwZGF0ZUVudHJ5SW5NYW51YWxFbnRyaWVzOiB0eXBlb2YgdXBkYXRlRW50cnlJbk1hbnVhbEVudHJpZXMsXG4gIHJlbW92ZUVudHJ5RnJvbU1hbnVhbEVudHJpZXM6IHR5cGVvZiByZW1vdmVFbnRyeUZyb21NYW51YWxFbnRyaWVzLFxuICBpbmRleDogbnVtYmVyLFxuICBzZXRNYW51YWxFbnRyaWVzOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxQZXJzb25bXT4+LFxuICBtYW51YWxFbnRyaWVzOiBQZXJzb25bXSxcbiAgc2V0UGFyZW50QTogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248UGVyc29uW10+PixcbiAgcGFyZW50SW5kZXg6IG51bWJlcixcbiAgYXR0ZW5kZWVzOiBQZXJzb25bXSxcbiAgc2V0QXR0ZW5kZWVzOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxQZXJzb25bXT4+LFxufVxuXG50eXBlIG1hbnVhbEVudHJpZXNQcm9wcyA9IHtcbiAgc2V0TWFudWFsRW50cmllczogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248UGVyc29uW10+PixcbiAgbWFudWFsRW50cmllczogUGVyc29uW10sXG4gIGF0dGVuZGVlczogUGVyc29uW10sXG4gIHNldEF0dGVuZGVlczogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248UGVyc29uW10+PixcbiAgc2V0UGFyZW50QTogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248UGVyc29uW10+PixcbiAgY2xvc2VNYW51YWw6ICgpID0+IHZvaWQsXG4gIHVwZGF0ZUVudHJ5SW5NYW51YWxFbnRyaWVzOiB0eXBlb2YgdXBkYXRlRW50cnlJbk1hbnVhbEVudHJpZXMsXG4gIHJlbW92ZUVudHJ5RnJvbU1hbnVhbEVudHJpZXM6IHR5cGVvZiByZW1vdmVFbnRyeUZyb21NYW51YWxFbnRyaWVzLFxuICBhZGRPbmVUb01hbnVhbEVudHJpZXM6IHR5cGVvZiBhZGRPbmVUb01hbnVhbEVudHJpZXMsXG59XG5cbi8qKlxuY29uc3QgbmV3VmFsdWU6IFBlcnNvbiA9IHtcbiAgaWQ6IHV1aWQoKSxcbiAgZW1haWxzOiBbeyBwcmltYXJ5OiBmYWxzZSwgdmFsdWU6ICcnLCB0eXBlOiAnJywgZGlzcGxheU5hbWU6ICcnfV0sXG4gIGFkZGl0aW9uYWxHdWVzdHM6IDAsXG59XG4qL1xuZnVuY3Rpb24gTWFudWFsRW50cnkocHJvcHM6IG1hbnVhbEVudHJ5UHJvcHMpIHtcbiAgY29uc3QgW2VtYWlscywgc2V0RW1haWxzXSA9IHVzZVN0YXRlPGVtYWlsW10+KHByb3BzPy5lbWFpbHMgfHwgW3sgcHJpbWFyeTogdHJ1ZSwgdmFsdWU6ICcnLCBkaXNwbGF5TmFtZTogJycsIHR5cGU6ICcnIH1dKVxuICBjb25zdCBbYWRkaXRpb25hbEd1ZXN0cywgc2V0QWRkaXRpb25hbEd1ZXN0c10gPSB1c2VTdGF0ZTxudW1iZXI+KHByb3BzPy5hZGRpdGlvbmFsR3Vlc3RzIHx8IDApXG5cbiAgY29uc3QgdXBkYXRlRW50cnlJbk1hbnVhbEVudHJpZXMgPSBwcm9wcz8udXBkYXRlRW50cnlJbk1hbnVhbEVudHJpZXNcbiAgY29uc3QgcmVtb3ZlRW50cnlGcm9tTWFudWFsRW50cmllcyA9IHByb3BzPy5yZW1vdmVFbnRyeUZyb21NYW51YWxFbnRyaWVzXG4gIGNvbnN0IHNldE1hbnVhbEVudHJpZXMgPSBwcm9wcz8uc2V0TWFudWFsRW50cmllc1xuICBjb25zdCBtYW51YWxFbnRyaWVzID0gcHJvcHM/Lm1hbnVhbEVudHJpZXNcbiAgY29uc3QgaW5kZXggPSBwcm9wcz8uaW5kZXhcbiAgY29uc3Qgc2V0UGFyZW50QSA9IHByb3BzPy5zZXRQYXJlbnRBXG4gIGNvbnN0IHBhcmVudEluZGV4ID0gcHJvcHM/LnBhcmVudEluZGV4XG4gIGNvbnN0IGF0dGVuZGVlcyA9IHByb3BzPy5hdHRlbmRlZXNcbiAgY29uc3Qgc2V0QXR0ZW5kZWVzID0gcHJvcHM/LnNldEF0dGVuZGVlc1xuXG5cbiAgY29uc3Qgb25FbWFpbENoYW5nZSA9ICh2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgc2V0RW1haWxzKFt7IC4uLmVtYWlscz8uWzBdLCBwcmltYXJ5OiB0cnVlLCB2YWx1ZSwgdHlwZTogJycgfV0pXG4gICAgdXBkYXRlRW50cnlJbk1hbnVhbEVudHJpZXMobWFudWFsRW50cmllcywgc2V0TWFudWFsRW50cmllcywgaW5kZXgsIGF0dGVuZGVlcywgc2V0QXR0ZW5kZWVzLCBzZXRQYXJlbnRBLCBwYXJlbnRJbmRleCwgW3sgLi4uZW1haWxzPy5bMF0sIHByaW1hcnk6IHRydWUsIHZhbHVlLCB0eXBlOiAnJyB9XSwgdW5kZWZpbmVkLCBhZGRpdGlvbmFsR3Vlc3RzKVxuICB9XG5cbiAgY29uc3Qgb25OYW1lQ2hhbmdlID0gKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICBzZXRFbWFpbHMoW3sgLi4uZW1haWxzPy5bMF0sIHByaW1hcnk6IHRydWUsIGRpc3BsYXlOYW1lOiB2YWx1ZSwgdHlwZTogJycgfV0pXG4gICAgdXBkYXRlRW50cnlJbk1hbnVhbEVudHJpZXMobWFudWFsRW50cmllcywgc2V0TWFudWFsRW50cmllcywgaW5kZXgsIGF0dGVuZGVlcywgc2V0QXR0ZW5kZWVzLCBzZXRQYXJlbnRBLCBwYXJlbnRJbmRleCwgW3sgLi4uZW1haWxzPy5bMF0sIHByaW1hcnk6IHRydWUsIGRpc3BsYXlOYW1lOiB2YWx1ZSwgdHlwZTogJycgfV0sIHZhbHVlLCBhZGRpdGlvbmFsR3Vlc3RzKVxuICB9XG5cbiAgY29uc3Qgb25BZGRpdGlvbmFsR3Vlc3RzQ2hhbmdlID0gKHRleHQ6IHN0cmluZykgPT4ge1xuICAgIHNldEFkZGl0aW9uYWxHdWVzdHMocGFyc2VJbnQodGV4dC5yZXBsYWNlKC9bXjAtOS5dL2csICcnKSwgMTApKVxuICAgIHVwZGF0ZUVudHJ5SW5NYW51YWxFbnRyaWVzKG1hbnVhbEVudHJpZXMsIHNldE1hbnVhbEVudHJpZXMsIGluZGV4LCBhdHRlbmRlZXMsIHNldEF0dGVuZGVlcywgc2V0UGFyZW50QSwgcGFyZW50SW5kZXgsIGVtYWlscywgdW5kZWZpbmVkLCBwYXJzZUludCh0ZXh0LnJlcGxhY2UoL1teMC05Ll0vZywgJycpLCAxMCkpXG4gIH1cblxuICByZXR1cm4gKFxuXG4gICAgICA8Qm94PlxuICAgICAgICA8UmVndWxhckNhcmQ+XG4gICAgICAgICAgPEJveCBwPXt7IHBob25lOiAncycsIHRhYmxldDogJ20nIH19PlxuICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPlxuICAgICAgICAgICAgICBFbWFpbFxuICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgPFRleHRGaWVsZFxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cInJAci5jb21cIlxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGU6IHsgdGFyZ2V0OiB7IHZhbHVlOiBzdHJpbmcgfSB9KSA9PiBvbkVtYWlsQ2hhbmdlKGU/LnRhcmdldD8udmFsdWUpfVxuICAgICAgICAgICAgICB2YWx1ZT17ZW1haWxzPy5bMF0/LnZhbHVlIHx8ICcnfVxuICAgICAgICAgICAgICBzdHlsZT17eyB3aWR0aDogJzYwJSd9fVxuICAgICAgICAgICAgICB2YWxpZGF0ZT1cImVtYWlsXCJcbiAgICAgICAgICAgICAgdmFsaWRhdGlvbk1lc3NhZ2U9XCJQbGVhc2UgaW5wdXQgYSB2YWxpZCBlbWFpbCBhZGRyZXNzXCJcbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPEJveCBwPXt7IHBob25lOiAncycsIHRhYmxldDogJ20nIH19PlxuICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPlxuICAgICAgICAgICAgICBEaXNwbGF5IE5hbWVcbiAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgIDxUZXh0RmllbGRcbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJuYW1lXCJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlOiB7IHRhcmdldDogeyB2YWx1ZTogc3RyaW5nIH0gfSkgPT4gb25OYW1lQ2hhbmdlKGU/LnRhcmdldD8udmFsdWUpfVxuICAgICAgICAgICAgICB2YWx1ZT17bWFudWFsRW50cmllcz8uW2luZGV4XT8ubmFtZSB8fCAnJ31cbiAgICAgICAgICAgICAgc3R5bGU9e3sgd2lkdGg6ICc2MCUnfX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPEJveCBwPXt7IHBob25lOiAncycsIHRhYmxldDogJ20nIH19PlxuICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPlxuICAgICAgICAgICAgICBBZGRpdGlvbmFsIEd1ZXN0cz9cbiAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgIDxUZXh0RmllbGRcbiAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZTogeyB0YXJnZXQ6IHsgdmFsdWU6IHN0cmluZyB9IH0pID0+IG9uQWRkaXRpb25hbEd1ZXN0c0NoYW5nZShlPy50YXJnZXQ/LnZhbHVlKX1cbiAgICAgICAgICAgICAgdmFsdWU9e2Ake2FkZGl0aW9uYWxHdWVzdHN9YH1cbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCIwXCJcbiAgICAgICAgICAgICAgc3R5bGU9e3sgd2lkdGg6ICcxNSUnIH19XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvQm94PlxuICAgICAgICAgIDxQcmVzc2FibGUgb25QcmVzcz17KCkgPT4gcmVtb3ZlRW50cnlGcm9tTWFudWFsRW50cmllcyhtYW51YWxFbnRyaWVzLCBzZXRNYW51YWxFbnRyaWVzLCBhdHRlbmRlZXMsIHNldEF0dGVuZGVlcywgc2V0UGFyZW50QSwgaW5kZXgsIHBhcmVudEluZGV4KX0+XG4gICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwiYnV0dG9uTGlua1wiPlxuICAgICAgICAgICAgICBSZW1vdmVcbiAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICA8L1ByZXNzYWJsZT5cbiAgICAgICAgPC9SZWd1bGFyQ2FyZD5cbiAgICAgICAgPC9Cb3g+XG4gIFxuICApXG59XG5cbmZ1bmN0aW9uIE1hbnVhbEVudHJpZXMocHJvcHM6IG1hbnVhbEVudHJpZXNQcm9wcykge1xuICBjb25zdCBbcGFnZU9mZnNldCwgc2V0UGFnZU9mZnNldF0gPSB1c2VTdGF0ZTxudW1iZXI+KDApXG5cbiAgY29uc3QgeyBoZWlnaHQ6IGZ1bGxIZWlnaHQgfSA9IERpbWVuc2lvbnMuZ2V0KCd3aW5kb3cnKVxuICBcbiAgY29uc3QgdGhlbWUgPSB1c2VUaGVtZSgpXG5cbiAgY29uc3QgdHJhbnNpdGlvbkR1cmF0aW9uID0ge1xuICAgIGVudGVyOiB0aGVtZS50cmFuc2l0aW9ucy5kdXJhdGlvbi5lbnRlcmluZ1NjcmVlbixcbiAgICBleGl0OiB0aGVtZS50cmFuc2l0aW9ucy5kdXJhdGlvbi5sZWF2aW5nU2NyZWVuLFxuICB9XG5cbiAgY29uc3QgY2xvc2VNYW51YWwgPSBwcm9wcz8uY2xvc2VNYW51YWxcbiAgXG4gIGNvbnN0IGFkZE5ld0VudHJ5ID0gKCkgPT4ge1xuICAgIGNvbnN0IGFkZE9uZVRvTWFudWFsRW50cmllcyA9IHByb3BzPy5hZGRPbmVUb01hbnVhbEVudHJpZXNcbiAgICBhZGRPbmVUb01hbnVhbEVudHJpZXMoXG4gICAgICBwcm9wcz8ubWFudWFsRW50cmllcyxcbiAgICAgIHByb3BzPy5zZXRNYW51YWxFbnRyaWVzLFxuICAgICAgcHJvcHM/LmF0dGVuZGVlcyxcbiAgICAgIHByb3BzPy5zZXRBdHRlbmRlZXMsXG4gICAgICBwcm9wcz8uc2V0UGFyZW50QSxcbiAgICApXG4gIH1cbiAgXG4gIHJldHVybiAoXG4gICAgPEJveCBmbGV4PXsxfSBzdHlsZT17eyB3aWR0aDogJzEwMCUnIH19IG1pbkhlaWdodD1cIjY1dmhcIiBtYXhIZWlnaHQ9XCI2NXZoXCI+XG5cbiAgICAgICAgPEJveCBmbGV4PXsxfSBzdHlsZT17eyB3aWR0aDogJzEwMCUnIH19PlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHByb3BzPy5tYW51YWxFbnRyaWVzPy5sZW5ndGggPiAwXG4gICAgICAgICAgICA/IChcbiAgICAgICAgICAgICAgPEZsYXRMaXN0XG4gICAgICAgICAgICAgICAgZGF0YT17cHJvcHM/Lm1hbnVhbEVudHJpZXN9XG4gICAgICAgICAgICAgICAgcmVuZGVySXRlbT17KHsgaXRlbSwgaW5kZXggfSkgPT4gKFxuICAgICAgICAgICAgICAgICAgPE1hbnVhbEVudHJ5XG4gICAgICAgICAgICAgICAgICAgIHsuLi5pdGVtfVxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVFbnRyeUluTWFudWFsRW50cmllcz17cHJvcHM/LnVwZGF0ZUVudHJ5SW5NYW51YWxFbnRyaWVzfVxuICAgICAgICAgICAgICAgICAgICByZW1vdmVFbnRyeUZyb21NYW51YWxFbnRyaWVzPXtwcm9wcz8ucmVtb3ZlRW50cnlGcm9tTWFudWFsRW50cmllc31cbiAgICAgICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAgICAgICBzZXRNYW51YWxFbnRyaWVzPXtwcm9wcz8uc2V0TWFudWFsRW50cmllc31cbiAgICAgICAgICAgICAgICAgICAgbWFudWFsRW50cmllcz17cHJvcHM/Lm1hbnVhbEVudHJpZXN9XG4gICAgICAgICAgICAgICAgICAgIHNldFBhcmVudEE9e3Byb3BzPy5zZXRQYXJlbnRBfVxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRJbmRleD17cHJvcHM/LmF0dGVuZGVlcy5maW5kSW5kZXgoYSA9PiAoYT8uaWQgPT09IGl0ZW0/LmlkKSl9XG4gICAgICAgICAgICAgICAgICAgIGF0dGVuZGVlcz17cHJvcHM/LmF0dGVuZGVlc31cbiAgICAgICAgICAgICAgICAgICAgc2V0QXR0ZW5kZWVzPXtwcm9wcz8uc2V0QXR0ZW5kZWVzfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIGtleUV4dHJhY3Rvcj17KGl0ZW0pID0+IGl0ZW0/LmlkfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgPEJveCBmbGV4PXsxfSBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwic3ViaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICBBZGQgYSBOZXcgRW50cnlcbiAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgKVxuICAgICAgICAgIH1cbiAgICAgICAgICA8Qm94IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiIHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0+XG4gICAgICAgICAgICA8UHJlc3NhYmxlIG9uUHJlc3M9e2Nsb3NlTWFudWFsfT5cbiAgICAgICAgICAgICAgPFRleHQgcD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdsJyB9fSB2YXJpYW50PVwiYnV0dG9uTGlua1wiPlxuICAgICAgICAgICAgICAgIENsb3NlXG4gICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgIDwvUHJlc3NhYmxlPlxuICAgICAgICAgIDwvQm94PlxuXG4gICAgICAgICAgICA8Wm9vbVxuICAgICAgICAgICAgICBpblxuICAgICAgICAgICAgICB0aW1lb3V0PXt0cmFuc2l0aW9uRHVyYXRpb259XG4gICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbkRlbGF5OiBgJHt0cmFuc2l0aW9uRHVyYXRpb24uZXhpdH1tc2AsXG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgIHVubW91bnRPbkV4aXRcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPEZhYiBzeD17ZmFiU3R5bGUgYXMgU3hQcm9wc30gYXJpYS1sYWJlbD17J0FkZCd9IGNvbG9yPVwicHJpbWFyeVwiIG9uQ2xpY2s9e2FkZE5ld0VudHJ5fT5cbiAgICAgICAgICAgICAgICA8QWRkSWNvbiBzeD17eyBjb2xvcjogcGlua1s1MDBdIH19IC8+XG4gICAgICAgICAgICAgIDwvRmFiPlxuICAgICAgICAgICAgPC9ab29tPlxuICAgICAgICA8L0JveD5cbiAgICA8L0JveD5cbiAgKVxufVxuXG5mdW5jdGlvbiBFZGl0RXZlbnRBdHRlbmRlZXMocHJvcHM6IFByb3BzKSB7XG4gIGNvbnN0IFthdHRlbmRlZXMsIHNldEF0dGVuZGVlc10gPSB1c2VTdGF0ZTxQZXJzb25bXT4ocHJvcHM/LmF0dGVuZGVlcylcbiAgY29uc3QgW2lzTWFudWFsLCBzZXRJc01hbnVhbF0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSlcbiAgY29uc3QgW21hbnVhbEVudHJpZXMsIHNldE1hbnVhbEVudHJpZXNdID0gdXNlU3RhdGU8UGVyc29uW10+KFtdKVxuICBjb25zdCBbaXNDb250YWN0cywgc2V0SXNDb250YWN0c10gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSlcbiAgY29uc3QgW2NvbnRhY3RzLCBzZXRDb250YWN0c10gPSB1c2VTdGF0ZTxTZWxlY3RlZENvbnRhY3RUeXBlW10+KFtdKVxuICBjb25zdCBbaXNPcGVuLCBzZXRJc09wZW5dID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpXG4gIC8vIGNvbnN0IFtjb250YWN0Q2hlY2tzLCBzZXRDb250YWN0Q2hlY2tzXSA9IHVzZVN0YXRlPGJvb2xlYW5bXT4oW10pXG5cbiAgY29uc3QgdXNlcklkID0gcHJvcHM/LnVzZXJJZFxuICAvLyBjb25zdCBwYXJlbnRBdHRlbmRlZXMgPSBwcm9wcz8uYXR0ZW5kZWVzXG4gIGNvbnN0IHNldFBhcmVudEF0dGVuZGVlcyA9IHByb3BzPy5zZXRQYXJlbnRBdHRlbmRlZXNcbiAgY29uc3QgY2xpZW50ID0gcHJvcHM/LmNsaWVudFxuXG4gIC8vIGdldCBhbnkgY29udGFjdHNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCFjbGllbnQgfHwgIXVzZXJJZCkge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGNvbnN0IG5ld0NvbnRhY3RzID0gYXdhaXQgbGlzdFVzZXJDb250YWN0c0hlbHBlcihjbGllbnQsIHVzZXJJZClcbiAgICAgIGNvbnNvbGUubG9nKG5ld0NvbnRhY3RzLCAnIG5ld0NvbnRhY3RzJylcbiAgICAgIGlmIChuZXdDb250YWN0cz8ubGVuZ3RoID4gMCkge1xuICAgICAgICBzZXRDb250YWN0cyhuZXdDb250YWN0c1xuICAgICAgICAgIC5tYXAoYyA9PiAoeyAuLi5jLCBzZWxlY3RlZDogZmFsc2UgfSBhcyBTZWxlY3RlZENvbnRhY3RUeXBlKSlcbiAgICAgICAgICAuZmlsdGVyKGMgPT4gKGM/LmVtYWlscz8uWzBdPy52YWx1ZT8ubGVuZ3RoID4gMCkpXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9KSgpXG4gIH0sIFtjbGllbnQsIHVzZXJJZF0pXG5cbiAgY29uc3Qgb25NYW51YWxDaGFuZ2UgPSAoKSA9PiB7XG4gICAgc2V0SXNDb250YWN0cyhpc01hbnVhbClcbiAgICBzZXRJc01hbnVhbCghaXNNYW51YWwpXG4gIH1cblxuICBjb25zdCBvbkNvbnRhY3RzQ2hhbmdlID0gKCkgPT4ge1xuICAgIHNldElzTWFudWFsKGlzQ29udGFjdHMpXG4gICAgc2V0SXNDb250YWN0cyghaXNDb250YWN0cylcbiAgfVxuXG4gIGNvbnN0IGNsb3NlQ29udGFjdHMgPSAoKSA9PiBzZXRJc0NvbnRhY3RzKGZhbHNlKVxuXG4gIGNvbnN0IGNsb3NlTWFudWFsID0gKCkgPT4gc2V0SXNNYW51YWwoZmFsc2UpXG5cbiAgY29uc3QgYWN0aW9ucyA9IFtcbiAgICB7IGljb246IDxJbXBvcnRDb250YWN0c0ljb24gY29sb3I9XCJzZWNvbmRhcnlcIiAvPiwgbmFtZTogJ0ltcG9ydCBDb250YWN0cycsIG1ldGhvZDogb25Db250YWN0c0NoYW5nZSB9LFxuICAgIHsgaWNvbjogPEtleWJvYXJkSWNvbiBjb2xvcj1cInNlY29uZGFyeVwiIC8+LCBuYW1lOiAnTWFudWFsIEVudHJ5JywgbWV0aG9kOiBvbk1hbnVhbENoYW5nZSB9LFxuICBdXG5cbiAgaWYgKGlzTWFudWFsKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxNYW51YWxFbnRyaWVzXG4gICAgICAgIHNldE1hbnVhbEVudHJpZXM9e3NldE1hbnVhbEVudHJpZXN9XG4gICAgICAgIG1hbnVhbEVudHJpZXM9e21hbnVhbEVudHJpZXN9XG4gICAgICAgIGF0dGVuZGVlcz17YXR0ZW5kZWVzfVxuICAgICAgICBzZXRBdHRlbmRlZXM9e3NldEF0dGVuZGVlc31cbiAgICAgICAgc2V0UGFyZW50QT17c2V0UGFyZW50QXR0ZW5kZWVzfVxuICAgICAgICB1cGRhdGVFbnRyeUluTWFudWFsRW50cmllcz17dXBkYXRlRW50cnlJbk1hbnVhbEVudHJpZXN9XG4gICAgICAgIHJlbW92ZUVudHJ5RnJvbU1hbnVhbEVudHJpZXM9e3JlbW92ZUVudHJ5RnJvbU1hbnVhbEVudHJpZXN9XG4gICAgICAgIGFkZE9uZVRvTWFudWFsRW50cmllcz17YWRkT25lVG9NYW51YWxFbnRyaWVzfVxuICAgICAgICBjbG9zZU1hbnVhbD17Y2xvc2VNYW51YWx9XG4gICAgICAvPlxuICAgIClcbiAgfVxuXG4gIGlmIChpc0NvbnRhY3RzKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxDb250YWN0c1xuICAgICAgICBhZGRDb250YWN0VG9BdHRlbmRlZXM9e2FkZENvbnRhY3RUb0F0dGVuZGVlc31cbiAgICAgICAgcmVtb3ZlQ29udGFjdEZyb21BdHRlbmRlZT17cmVtb3ZlQ29udGFjdEZyb21BdHRlbmRlZX1cbiAgICAgICAgdXBkYXRlQ29udGFjdFNlbGVjdGlvbj17dXBkYXRlQ29udGFjdFNlbGVjdGlvbn1cbiAgICAgICAgY29udGFjdHM9e2NvbnRhY3RzfVxuICAgICAgICBzZXRQYXJlbnRBPXtzZXRQYXJlbnRBdHRlbmRlZXN9XG4gICAgICAgIGF0dGVuZGVlcz17YXR0ZW5kZWVzfVxuICAgICAgICBzZXRBdHRlbmRlZXM9e3NldEF0dGVuZGVlc31cbiAgICAgICAgY2xvc2VDb250YWN0cz17Y2xvc2VDb250YWN0c31cbiAgICAgIC8+XG4gICAgKVxuICB9XG5cblxuIHJldHVybiAoXG4gICA8Qm94IGZsZXg9ezF9IHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0gbWluSGVpZ2h0PVwiNjV2aFwiIG1heEhlaWdodD1cIjY1dmhcIj5cbiAgICAgIHtcbiAgICAgICAgYXR0ZW5kZWVzPy5sZW5ndGggPiAwXG4gICAgICAgID8gKFxuICAgICAgICAgIDxGbGF0TGlzdFxuICAgICAgICAgICAgZGF0YT17YXR0ZW5kZWVzfVxuICAgICAgICAgICAgcmVuZGVySXRlbT17KHsgaXRlbSB9KSA9PiAoXG4gICAgICAgICAgICAgIDxMaXN0SXRlbVxuICAgICAgICAgICAgICAgICAgY29udGFpbmVyU3R5bGU9e3sgXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogcGFsZXR0ZS53aGl0ZSxcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQm90dG9tV2lkdGg6IFN0eWxlU2hlZXQuaGFpcmxpbmVXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6IHBhbGV0dGUuZGFya0dyYXlcbiAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8TGlzdEl0ZW0uQ29udGVudD5cbiAgICAgICAgICAgICAgICAgIDxMaXN0SXRlbS5UaXRsZSBzdHlsZT17eyBjb2xvcjogcGFsZXR0ZS50ZXh0QmxhY2ssIGZvbnRXZWlnaHQ6ICdib2xkJyB9fT5cbiAgICAgICAgICAgICAgICAgICAge2l0ZW0/Lm5hbWV9XG4gICAgICAgICAgICAgICAgICA8L0xpc3RJdGVtLlRpdGxlPlxuICAgICAgICAgICAgICAgICAgPExpc3RJdGVtLlN1YnRpdGxlIHN0eWxlPXt7IGNvbG9yOiBwYWxldHRlLnRleHRCbGFjaywgfX0+XG4gICAgICAgICAgICAgICAgICAgIHtpdGVtPy5lbWFpbHM/LlswXT8udmFsdWV9XG4gICAgICAgICAgICAgICAgICA8L0xpc3RJdGVtLlN1YnRpdGxlPlxuICAgICAgICAgICAgICAgIDwvTGlzdEl0ZW0uQ29udGVudD5cbiAgICAgICAgICAgICAgPC9MaXN0SXRlbT5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBrZXlFeHRyYWN0b3I9eyhpdGVtKSA9PiBpdGVtPy5pZH1cbiAgICAgICAgICAvPlxuICAgICAgICApIDogKFxuICAgICAgICAgIDxCb3ggZmxleD17MX0ganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICA8Qm94IHN0eWxlPXt7IHdpZHRoOiAnOTAlJ319IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwic3ViaGVhZGVyTm9ybWFsXCI+XG4gICAgICAgICAgICAgICAgQWRkIGFuIGF0dGVuZGVlIGZyb20geW91ciBjb250YWN0cyBvciBtYW51YWxseSBlbnRlciBvbmVcbiAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPC9Cb3g+XG4gICAgICAgIClcbiAgICAgIH1cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWJzb2x1dGUgaW5zZXQtMCB6LTIwIHBvaW50ZXItZXZlbnRzLW5vbmVcIj5cbiAgICAgICAgPFNwZWVkRGlhbFxuICAgICAgICAgICAgYXJpYUxhYmVsPVwiQ2FsZW5kYXIgU3BlZWREaWFsXCJcbiAgICAgICAgICAgIHN4PXt7IHBvc2l0aW9uOiAnYWJzb2x1dGUnLCBib3R0b206IDI0LCByaWdodDogMjQsIHpJbmRleDogJ3NwZWVkRGlhbCcgfX1cbiAgICAgICAgICAgIGljb249ezxTcGVlZERpYWxJY29uIGljb249ezxFZGl0SWNvbiAvPn0gc3g9e3sgY29sb3I6IHBpbmtbNTAwXSB9fSAvPn1cbiAgICAgICAgPlxuICAgICAgICAgICAge2FjdGlvbnMubWFwKChhY3Rpb24pID0+IChcbiAgICAgICAgICAgICAgICA8U3BlZWREaWFsQWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIGtleT17YWN0aW9uLm5hbWV9XG4gICAgICAgICAgICAgICAgICAgIGljb249e2FjdGlvbi5pY29ufVxuICAgICAgICAgICAgICAgICAgICB0b29sdGlwVGl0bGU9e2FjdGlvbi5uYW1lfVxuICAgICAgICAgICAgICAgICAgICBGYWJQcm9wcz17e1xuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljazogYWN0aW9uLm1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKSl9XG4gICAgICAgIDwvU3BlZWREaWFsPlxuICAgICAgPC9kaXY+XG4gICA8L0JveD5cbiApXG59XG5cbmV4cG9ydCBkZWZhdWx0IEVkaXRFdmVudEF0dGVuZGVlc1xuLyoqIGVuZCAqL1xuIl19