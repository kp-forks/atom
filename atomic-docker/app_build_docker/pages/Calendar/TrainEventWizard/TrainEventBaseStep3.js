"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getServerSideProps = getServerSideProps;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_2 = require("@chakra-ui/react");
const Switch_1 = __importDefault(require("@components/Switch"));
const Box_1 = __importDefault(require("@components/common/Box"));
const Text_1 = __importDefault(require("@components/common/Text"));
const supertokens_node_1 = __importDefault(require("supertokens-node"));
const backendConfig_1 = require("../../../config/backendConfig");
const session_1 = __importDefault(require("supertokens-node/recipe/session"));
async function getServerSideProps({ req, res }) {
    // Notice how the server uses `API` from `withSSRContext`, instead of the top-level `API`.
    // const SSR = withSSRContext({ req })
    // this runs on the backend, so we must call init on supertokens-node SDK
    supertokens_node_1.default.init((0, backendConfig_1.backendConfig)());
    let session;
    try {
        session = await session_1.default.getSession(req, res, {
            overrideGlobalClaimValidators: async function () {
                return [];
            },
        });
    }
    catch (err) {
        if (err.type === session_1.default.Error.TRY_REFRESH_TOKEN) {
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        else if (err.type === session_1.default.Error.UNAUTHORISED) {
            // this will force the frontend to try and refresh which will fail
            // clearing all cookies and redirecting the user to the login screen.
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        throw err;
    }
    if (!session?.getUserId()) {
        return {
            redirect: {
                destination: '/User/Login/UserLogin',
                permanent: false,
            },
        };
    }
    return {
        props: {
            sub: session.getUserId(),
        }
    };
}
function TrainEventBaseStep3(props) {
    const [copyIsMeeting, setCopyIsMeeting] = (0, react_1.useState)(props?.copyIsMeeting ?? false);
    const [copyIsExternalMeeting, setCopyIsExternalMeeting] = (0, react_1.useState)(props?.copyIsExternalMeeting ?? false);
    const [copyDuration, setCopyDuration] = (0, react_1.useState)(props?.copyDuration ?? false);
    const [copyColor, setCopyColor] = (0, react_1.useState)(props?.copyColor ?? false);
    const [isMessage1, setIsMessage1] = (0, react_1.useState)(false);
    const [isMessage2, setIsMessage2] = (0, react_1.useState)(false);
    const [isMessage3, setIsMessage3] = (0, react_1.useState)(false);
    const [isMessage4, setIsMessage4] = (0, react_1.useState)(false);
    const setParentCopyIsExternalMeeting = props?.setParentCopyIsExternalMeeting;
    const setParentCopyDuration = props?.setParentCopyDuration;
    const setParentCopyIsMeeting = props?.setParentCopyIsMeeting;
    const setParentCopyColor = props?.setParentCopyColor;
    const changeCopyIsExternalMeeting = (value) => {
        setCopyIsExternalMeeting(value);
        setParentCopyIsExternalMeeting(value);
    };
    const changeCopyDuration = (value) => {
        setCopyDuration(value);
        setParentCopyDuration(value);
    };
    const changeCopyIsMeeting = (value) => {
        setCopyIsMeeting(value);
        setParentCopyIsMeeting(value);
    };
    const changeCopyColor = (value) => {
        setCopyColor(value);
        setParentCopyColor(value);
    };
    return ((0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", style: { width: '100%' }, children: [(0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, style: { width: '90%' }, p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_2.Tooltip, { hasArrow: true, label: 'Event will be tagged with Meeting topic and settings for the tag will be applied to the event. Note: training settings override tag settings for schedule assists in case of overlap.', bg: 'purple.700', color: 'white', children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", children: "Classify any new events whose details are similar as a 'Meeting type' event? (Hint) " }) }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { checked: copyIsMeeting, onValueChange: changeCopyIsMeeting, style: { marginBottom: 20 } }) })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, style: { width: '90%' }, p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_2.Tooltip, { hasArrow: true, label: 'Tag with External Meeting topic is a meeting with contact outside the organization. Event will be tagged with external meeting topic and settings for the tag will be applied to the event. Note: training settings override tag settings for schedule assists in case of overlap.', bg: 'purple.700', color: 'white', children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", children: "Classify any new events whose details have similar context as an 'External Meeting type' event? (Hint) " }) }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { checked: copyIsExternalMeeting, onValueChange: changeCopyIsExternalMeeting }) })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, style: { width: '90%' }, p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_2.Tooltip, { hasArrow: true, label: 'New events whose details are similar will change their end time to match the duration to this event. Usually useful to sync task events from 3rd party apps.', bg: 'purple.700', color: 'white', children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", children: "Copy over duration value to any new events whose details have similar context? (Hint)" }) }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { checked: copyDuration, onValueChange: changeCopyDuration }) })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, style: { width: '90%' }, p: { phone: 's', tablet: 'm' }, children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Copy over background color to any new events whose details have similar context? " }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { checked: copyColor, onValueChange: changeCopyColor }) })] })] }));
}
exports.default = TrainEventBaseStep3;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVHJhaW5FdmVudEJhc2VTdGVwMy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlRyYWluRXZlbnRCYXNlU3RlcDMudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBY0EsZ0RBcUNDOztBQW5ERCxpQ0FJYztBQUNkLDRDQUEwQztBQUMxQyxnRUFBd0M7QUFDeEMsaUVBQXdDO0FBQ3hDLG1FQUEwQztBQUUxQyx3RUFBOEM7QUFDOUMsaUVBQTZEO0FBQzdELDhFQUFxRDtBQUU5QyxLQUFLLFVBQVUsa0JBQWtCLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFpRDtJQUNsRywwRkFBMEY7SUFDMUYsc0NBQXNDO0lBQ3RDLHlFQUF5RTtJQUN6RSwwQkFBZSxDQUFDLElBQUksQ0FBQyxJQUFBLDZCQUFhLEdBQUUsQ0FBQyxDQUFBO0lBQ3JDLElBQUksT0FBTyxDQUFBO0lBQ1gsSUFBSSxDQUFDO1FBQ0gsT0FBTyxHQUFHLE1BQU0saUJBQU8sQ0FBQyxVQUFVLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRTtZQUMzQyw2QkFBNkIsRUFBRSxLQUFLO2dCQUNsQyxPQUFPLEVBQUUsQ0FBQTtZQUNYLENBQUM7U0FDRixDQUFDLENBQUE7SUFDSixDQUFDO0lBQUMsT0FBTyxHQUFRLEVBQUUsQ0FBQztRQUNsQixJQUFJLEdBQUcsQ0FBQyxJQUFJLEtBQUssaUJBQU8sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUNqRCxPQUFPLEVBQUUsS0FBSyxFQUFFLEVBQUUsZUFBZSxFQUFFLGVBQWUsRUFBRSxFQUFFLENBQUE7UUFDeEQsQ0FBQzthQUFNLElBQUksR0FBRyxDQUFDLElBQUksS0FBSyxpQkFBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsQ0FBQztZQUNuRCxrRUFBa0U7WUFDbEUscUVBQXFFO1lBQ3JFLE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBRSxlQUFlLEVBQUUsZUFBZSxFQUFFLEVBQUUsQ0FBQTtRQUN4RCxDQUFDO1FBQ0Qs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QUMsS0FBSyxFQUFDLGNBQWMsRUFBQyxZQUFZLEVBQUMsVUFBVSxFQUFDLFFBQVEsWUFDcEUsdUJBQUMsY0FBSSxJQUFDLE9BQU8sRUFBQyxjQUFjLGtHQUF5RixHQUNuSCxFQUNOLHVCQUFDLGFBQUcsSUFBQyxhQUFhLEVBQUMsS0FBSyxFQUFDLGNBQWMsRUFBQyxVQUFVLEVBQUMsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFlBQzlFLHVCQUFDLGdCQUFPLElBQ0osT0FBTyxFQUFFLFNBQVMsRUFDbEIsYUFBYSxFQUFFLGVBQWUsR0FDaEMsR0FDQSxJQUNKLElBQ0osQ0FDVCxDQUFBO0FBQ0wsQ0FBQztBQUVELGtCQUFlLG1CQUFtQixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7XG4gIHVzZVN0YXRlLFxuICBEaXNwYXRjaCxcbiAgU2V0U3RhdGVBY3Rpb24sXG59IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgVG9vbHRpcCB9IGZyb20gJ0BjaGFrcmEtdWkvcmVhY3QnXG5pbXBvcnQgU3dpdGNoMSBmcm9tICdAY29tcG9uZW50cy9Td2l0Y2gnXG5pbXBvcnQgQm94IGZyb20gJ0Bjb21wb25lbnRzL2NvbW1vbi9Cb3gnXG5pbXBvcnQgVGV4dCBmcm9tICdAY29tcG9uZW50cy9jb21tb24vVGV4dCdcbmltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCBzdXBlcnRva2Vuc05vZGUgZnJvbSAnc3VwZXJ0b2tlbnMtbm9kZSdcbmltcG9ydCB7IGJhY2tlbmRDb25maWcgfSBmcm9tICcuLi8uLi8uLi9jb25maWcvYmFja2VuZENvbmZpZydcbmltcG9ydCBTZXNzaW9uIGZyb20gJ3N1cGVydG9rZW5zLW5vZGUvcmVjaXBlL3Nlc3Npb24nXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXJ2ZXJTaWRlUHJvcHMoeyByZXEsIHJlcyB9OiB7IHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlIH0pIHtcbiAgLy8gTm90aWNlIGhvdyB0aGUgc2VydmVyIHVzZXMgYEFQSWAgZnJvbSBgd2l0aFNTUkNvbnRleHRgLCBpbnN0ZWFkIG9mIHRoZSB0b3AtbGV2ZWwgYEFQSWAuXG4gIC8vIGNvbnN0IFNTUiA9IHdpdGhTU1JDb250ZXh0KHsgcmVxIH0pXG4gIC8vIHRoaXMgcnVucyBvbiB0aGUgYmFja2VuZCwgc28gd2UgbXVzdCBjYWxsIGluaXQgb24gc3VwZXJ0b2tlbnMtbm9kZSBTREtcbiAgc3VwZXJ0b2tlbnNOb2RlLmluaXQoYmFja2VuZENvbmZpZygpKVxuICBsZXQgc2Vzc2lvblxuICB0cnkge1xuICAgIHNlc3Npb24gPSBhd2FpdCBTZXNzaW9uLmdldFNlc3Npb24ocmVxLCByZXMsIHtcbiAgICAgIG92ZXJyaWRlR2xvYmFsQ2xhaW1WYWxpZGF0b3JzOiBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBbXVxuICAgICAgfSxcbiAgICB9KVxuICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgIGlmIChlcnIudHlwZSA9PT0gU2Vzc2lvbi5FcnJvci5UUllfUkVGUkVTSF9UT0tFTikge1xuICAgICAgcmV0dXJuIHsgcHJvcHM6IHsgZnJvbVN1cGVydG9rZW5zOiAnbmVlZHMtcmVmcmVzaCcgfSB9XG4gICAgfSBlbHNlIGlmIChlcnIudHlwZSA9PT0gU2Vzc2lvbi5FcnJvci5VTkFVVEhPUklTRUQpIHtcbiAgICAgIC8vIHRoaXMgd2lsbCBmb3JjZSB0aGUgZnJvbnRlbmQgdG8gdHJ5IGFuZCByZWZyZXNoIHdoaWNoIHdpbGwgZmFpbFxuICAgICAgLy8gY2xlYXJpbmcgYWxsIGNvb2tpZXMgYW5kIHJlZGlyZWN0aW5nIHRoZSB1c2VyIHRvIHRoZSBsb2dpbiBzY3JlZW4uXG4gICAgICByZXR1cm4geyBwcm9wczogeyBmcm9tU3VwZXJ0b2tlbnM6ICduZWVkcy1yZWZyZXNoJyB9IH1cbiAgICB9XG4gICAgdGhyb3cgZXJyXG4gIH1cblxuICBpZiAoIXNlc3Npb24/LmdldFVzZXJJZCgpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlZGlyZWN0OiB7XG4gICAgICAgIGRlc3RpbmF0aW9uOiAnL1VzZXIvTG9naW4vVXNlckxvZ2luJyxcbiAgICAgICAgcGVybWFuZW50OiBmYWxzZSxcbiAgICAgIH0sXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBwcm9wczoge1xuICAgICAgc3ViOiBzZXNzaW9uLmdldFVzZXJJZCgpLFxuICAgIH1cbiAgfVxufVxuXG50eXBlIFByb3BzID0ge1xuICAgIGNvcHlJc01lZXRpbmc6IGJvb2xlYW4sXG4gICAgc2V0UGFyZW50Q29weUlzTWVldGluZzogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248Ym9vbGVhbj4+LFxuICAgIGNvcHlJc0V4dGVybmFsTWVldGluZzogYm9vbGVhbixcbiAgICBzZXRQYXJlbnRDb3B5SXNFeHRlcm5hbE1lZXRpbmc6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPGJvb2xlYW4+PixcbiAgICBjb3B5RHVyYXRpb246IGJvb2xlYW4sXG4gICAgc2V0UGFyZW50Q29weUR1cmF0aW9uOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxib29sZWFuPj4sXG4gICAgY29weUNvbG9yOiBib29sZWFuLFxuICAgIHNldFBhcmVudENvcHlDb2xvcjogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248Ym9vbGVhbj4+LFxufVxuXG5mdW5jdGlvbiBUcmFpbkV2ZW50QmFzZVN0ZXAzKHByb3BzOiBQcm9wcykge1xuICAgIGNvbnN0IFtjb3B5SXNNZWV0aW5nLCBzZXRDb3B5SXNNZWV0aW5nXSA9IHVzZVN0YXRlPGJvb2xlYW4+KHByb3BzPy5jb3B5SXNNZWV0aW5nID8/IGZhbHNlKVxuICAgIGNvbnN0IFtjb3B5SXNFeHRlcm5hbE1lZXRpbmcsIHNldENvcHlJc0V4dGVybmFsTWVldGluZ10gPSB1c2VTdGF0ZTxib29sZWFuPihwcm9wcz8uY29weUlzRXh0ZXJuYWxNZWV0aW5nID8/IGZhbHNlKVxuICAgIGNvbnN0IFtjb3B5RHVyYXRpb24sIHNldENvcHlEdXJhdGlvbl0gPSB1c2VTdGF0ZTxib29sZWFuPihwcm9wcz8uY29weUR1cmF0aW9uID8/IGZhbHNlKVxuICAgIGNvbnN0IFtjb3B5Q29sb3IsIHNldENvcHlDb2xvcl0gPSB1c2VTdGF0ZTxib29sZWFuPihwcm9wcz8uY29weUNvbG9yID8/IGZhbHNlKVxuICAgIGNvbnN0IFtpc01lc3NhZ2UxLCBzZXRJc01lc3NhZ2UxXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKVxuICAgIGNvbnN0IFtpc01lc3NhZ2UyLCBzZXRJc01lc3NhZ2UyXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKVxuICAgIGNvbnN0IFtpc01lc3NhZ2UzLCBzZXRJc01lc3NhZ2UzXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKVxuICAgIGNvbnN0IFtpc01lc3NhZ2U0LCBzZXRJc01lc3NhZ2U0XSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKVxuXG4gICAgY29uc3Qgc2V0UGFyZW50Q29weUlzRXh0ZXJuYWxNZWV0aW5nID0gcHJvcHM/LnNldFBhcmVudENvcHlJc0V4dGVybmFsTWVldGluZ1xuICAgIGNvbnN0IHNldFBhcmVudENvcHlEdXJhdGlvbiA9IHByb3BzPy5zZXRQYXJlbnRDb3B5RHVyYXRpb25cbiAgICBjb25zdCBzZXRQYXJlbnRDb3B5SXNNZWV0aW5nID0gcHJvcHM/LnNldFBhcmVudENvcHlJc01lZXRpbmdcbiAgICBjb25zdCBzZXRQYXJlbnRDb3B5Q29sb3IgPSBwcm9wcz8uc2V0UGFyZW50Q29weUNvbG9yXG4gICAgXG4gICAgY29uc3QgY2hhbmdlQ29weUlzRXh0ZXJuYWxNZWV0aW5nID0gKHZhbHVlOiBib29sZWFuKSA9PiB7XG4gICAgICAgIHNldENvcHlJc0V4dGVybmFsTWVldGluZyh2YWx1ZSlcbiAgICAgICAgc2V0UGFyZW50Q29weUlzRXh0ZXJuYWxNZWV0aW5nKHZhbHVlKVxuICAgIH1cblxuICAgIGNvbnN0IGNoYW5nZUNvcHlEdXJhdGlvbiA9ICh2YWx1ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICBzZXRDb3B5RHVyYXRpb24odmFsdWUpXG4gICAgICAgIHNldFBhcmVudENvcHlEdXJhdGlvbih2YWx1ZSlcbiAgICB9XG5cbiAgICAgY29uc3QgY2hhbmdlQ29weUlzTWVldGluZyA9ICh2YWx1ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICBzZXRDb3B5SXNNZWV0aW5nKHZhbHVlKVxuICAgICAgICBzZXRQYXJlbnRDb3B5SXNNZWV0aW5nKHZhbHVlKVxuICAgICB9XG4gICAgXG4gICAgY29uc3QgY2hhbmdlQ29weUNvbG9yID0gKHZhbHVlOiBib29sZWFuKSA9PiB7XG4gICAgICAgIHNldENvcHlDb2xvcih2YWx1ZSlcbiAgICAgICAgc2V0UGFyZW50Q29weUNvbG9yKHZhbHVlKVxuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICAgIDxCb3ggZmxleD17MX0ganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgc3R5bGU9e3sgd2lkdGg6ICcxMDAlJ319PlxuICAgICAgICAgICAgPEJveCBmbGV4PXsxfSBzdHlsZT17eyB3aWR0aDogJzkwJScgfX0gcD17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fT5cbiAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxUb29sdGlwIGhhc0Fycm93IGxhYmVsPSdFdmVudCB3aWxsIGJlIHRhZ2dlZCB3aXRoIE1lZXRpbmcgdG9waWMgYW5kIHNldHRpbmdzIGZvciB0aGUgdGFnIHdpbGwgYmUgYXBwbGllZCB0byB0aGUgZXZlbnQuIE5vdGU6IHRyYWluaW5nIHNldHRpbmdzIG92ZXJyaWRlIHRhZyBzZXR0aW5ncyBmb3Igc2NoZWR1bGUgYXNzaXN0cyBpbiBjYXNlIG9mIG92ZXJsYXAuJyBiZz0ncHVycGxlLjcwMCcgY29sb3I9J3doaXRlJz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0IHZhcmlhbnQ9XCJidXR0b25MaW5rXCI+Q2xhc3NpZnkgYW55IG5ldyBldmVudHMgd2hvc2UgZGV0YWlscyBhcmUgc2ltaWxhciBhcyBhICZhcG9zO01lZXRpbmcgdHlwZSZhcG9zOyBldmVudD8gKEhpbnQpIDwvVGV4dD5cbiAgICAgICAgICAgICAgICAgICAgPC9Ub29sdGlwPlxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPEJveCBmbGV4RGlyZWN0aW9uPVwicm93XCIganVzdGlmeUNvbnRlbnQ9XCJmbGV4LWVuZFwiIHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19PlxuICAgICAgICAgICAgICAgICAgICA8U3dpdGNoMVxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17Y29weUlzTWVldGluZ31cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9e2NoYW5nZUNvcHlJc01lZXRpbmd9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBtYXJnaW5Cb3R0b206IDIwIH19XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgIDxCb3ggZmxleD17MX0gc3R5bGU9e3sgd2lkdGg6ICc5MCUnIH19IHA9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgICAgICAgPEJveCBmbGV4RGlyZWN0aW9uPVwicm93XCIganVzdGlmeUNvbnRlbnQ9XCJmbGV4LXN0YXJ0XCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcCBoYXNBcnJvdyBsYWJlbD0nVGFnIHdpdGggRXh0ZXJuYWwgTWVldGluZyB0b3BpYyBpcyBhIG1lZXRpbmcgd2l0aCBjb250YWN0IG91dHNpZGUgdGhlIG9yZ2FuaXphdGlvbi4gRXZlbnQgd2lsbCBiZSB0YWdnZWQgd2l0aCBleHRlcm5hbCBtZWV0aW5nIHRvcGljIGFuZCBzZXR0aW5ncyBmb3IgdGhlIHRhZyB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGV2ZW50LiBOb3RlOiB0cmFpbmluZyBzZXR0aW5ncyBvdmVycmlkZSB0YWcgc2V0dGluZ3MgZm9yIHNjaGVkdWxlIGFzc2lzdHMgaW4gY2FzZSBvZiBvdmVybGFwLicgYmc9J3B1cnBsZS43MDAnIGNvbG9yPSd3aGl0ZSc+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwiYnV0dG9uTGlua1wiPkNsYXNzaWZ5IGFueSBuZXcgZXZlbnRzIHdob3NlIGRldGFpbHMgaGF2ZSBzaW1pbGFyIGNvbnRleHQgYXMgYW4gJmFwb3M7RXh0ZXJuYWwgTWVldGluZyB0eXBlJmFwb3M7IGV2ZW50PyAoSGludCkgPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPEJveCBmbGV4RGlyZWN0aW9uPVwicm93XCIganVzdGlmeUNvbnRlbnQ9XCJmbGV4LWVuZFwiIHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19PlxuICAgICAgICAgICAgICAgICAgICA8U3dpdGNoMVxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17Y29weUlzRXh0ZXJuYWxNZWV0aW5nfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25WYWx1ZUNoYW5nZT17Y2hhbmdlQ29weUlzRXh0ZXJuYWxNZWV0aW5nfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICA8Qm94IGZsZXg9ezF9IHN0eWxlPXt7IHdpZHRoOiAnOTAlJyB9fSBwPXt7IHBob25lOiAncycsIHRhYmxldDogJ20nIH19PlxuICAgICAgICAgICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1zdGFydFwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj4gXG4gICAgICAgICAgICAgICAgICAgIDxUb29sdGlwIGhhc0Fycm93IGxhYmVsPSdOZXcgZXZlbnRzIHdob3NlIGRldGFpbHMgYXJlIHNpbWlsYXIgd2lsbCBjaGFuZ2UgdGhlaXIgZW5kIHRpbWUgdG8gbWF0Y2ggdGhlIGR1cmF0aW9uIHRvIHRoaXMgZXZlbnQuIFVzdWFsbHkgdXNlZnVsIHRvIHN5bmMgdGFzayBldmVudHMgZnJvbSAzcmQgcGFydHkgYXBwcy4nIGJnPSdwdXJwbGUuNzAwJyBjb2xvcj0nd2hpdGUnPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cImJ1dHRvbkxpbmtcIj5Db3B5IG92ZXIgZHVyYXRpb24gdmFsdWUgdG8gYW55IG5ldyBldmVudHMgd2hvc2UgZGV0YWlscyBoYXZlIHNpbWlsYXIgY29udGV4dD8gKEhpbnQpPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+XG4gICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1lbmRcIiBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgPFN3aXRjaDFcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NvcHlEdXJhdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9e2NoYW5nZUNvcHlEdXJhdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgPEJveCBmbGV4PXsxfSBzdHlsZT17eyB3aWR0aDogJzkwJScgfX0gcD17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fT5cbiAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+IFxuICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCI+Q29weSBvdmVyIGJhY2tncm91bmQgY29sb3IgdG8gYW55IG5ldyBldmVudHMgd2hvc2UgZGV0YWlscyBoYXZlIHNpbWlsYXIgY29udGV4dD8gPC9UZXh0PlxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1lbmRcIiBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgPFN3aXRjaDFcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NvcHlDb2xvcn1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9e2NoYW5nZUNvcHlDb2xvcn1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgIDwvQm94PlxuICAgICAgICA8L0JveD5cbiAgICApXG59XG5cbmV4cG9ydCBkZWZhdWx0IFRyYWluRXZlbnRCYXNlU3RlcDMiXX0=