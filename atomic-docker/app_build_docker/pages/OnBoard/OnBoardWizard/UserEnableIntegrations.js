"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getServerSideProps = getServerSideProps;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_native_1 = require("react-native");
const image_1 = __importDefault(require("next/image"));
const Switch_1 = __importDefault(require("@components/Switch"));
const react_2 = require("@chakra-ui/react");
const themed_1 = require("@rneui/themed");
const Box_1 = __importDefault(require("@components/common/Box"));
const Text_1 = __importDefault(require("@components/common/Text"));
const Button_1 = __importDefault(require("@components/Button"));
const theme_1 = require("@lib/theme/theme");
const calendar_integrationHelper_1 = require("@lib/Settings/calendar_integrationHelper");
const constants_1 = require("@lib/calendarLib/constants");
const constants_2 = require("@lib/contactLib/constants");
const constants_3 = require("@lib/zoom/constants");
const calendarDbHelper_1 = require("@lib/calendarLib/calendarDbHelper");
const client_1 = require("@apollo/client");
const getCalendarWithResource_1 = __importDefault(require("@lib/apollo/gql/getCalendarWithResource"));
const getCalendarIntegrationByResourceAndName_1 = __importDefault(require("@lib/apollo/gql/getCalendarIntegrationByResourceAndName"));
const listCalendarIntegrations_1 = __importDefault(require("@lib/apollo/gql/listCalendarIntegrations"));
const OnBoardHelper2_1 = require("../../../lib/OnBoard/OnBoardHelper2");
const AttendeeHelper_1 = require("@lib/Calendar/Attendee/AttendeeHelper");
const ConferenceHelper_1 = require("@lib/Calendar/Conference/ConferenceHelper");
const ReminderHelper_1 = require("@lib/Calendar/Reminder/ReminderHelper");
const googleCalendarHelper_1 = require("@lib/calendarLib/googleCalendarHelper");
const router_1 = require("next/router");
const google_signin_normal_png_1 = __importDefault(require("@assets/images/google-signin-normal.png"));
const google_signin_pressed_png_1 = __importDefault(require("@assets/images/google-signin-pressed.png"));
// const dark = Appearance.getColorScheme() === 'dark'
// const googleButtonPressed = dark ? googleButtonPressedDarkNormal : googleButtonPressedLightNormal
// const googleButtonNormal = dark ? googleButtonDarkNormal : googleButtonLightNormal
const googleButtonPressed = google_signin_pressed_png_1.default;
const googleButtonNormal = google_signin_normal_png_1.default;
const supertokens_node_1 = __importDefault(require("supertokens-node"));
const backendConfig_1 = require("@config/backendConfig");
const session_1 = __importDefault(require("supertokens-node/recipe/session"));
async function getServerSideProps({ req, res }) {
    // Notice how the server uses `API` from `withSSRContext`, instead of the top-level `API`.
    // const SSR = withSSRContext({ req })
    // this runs on the backend, so we must call init on supertokens-node SDK
    supertokens_node_1.default.init((0, backendConfig_1.backendConfig)());
    let session;
    try {
        session = await session_1.default.getSession(req, res, {
            overrideGlobalClaimValidators: async function () {
                return [];
            },
        });
    }
    catch (err) {
        if (err.type === session_1.default.Error.TRY_REFRESH_TOKEN) {
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        else if (err.type === session_1.default.Error.UNAUTHORISED) {
            // this will force the frontend to try and refresh which will fail
            // clearing all cookies and redirecting the user to the login screen.
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        throw err;
    }
    if (!session?.getUserId()) {
        return {
            redirect: {
                destination: '/User/Login/UserLogin',
                permanent: false,
            },
        };
    }
    return {
        props: {
            sub: session.getUserId(),
        }
    };
}
// eslint-disable-next-line react/display-name
const IntegrationCheckBox = (0, react_1.forwardRef)((props, ref) => {
    const { enabled: oldEnabled, updateEnabledValue, index, name, 
    //   dark,
    id, } = props;
    const [enabled, setEnabled] = (0, react_1.useState)(oldEnabled);
    const [pressed, setPressed] = (0, react_1.useState)(false);
    const updateEnabled = async (value) => {
        setEnabled(value);
        return updateEnabledValue(index, value, id);
    };
    const disableEnabled = async () => {
        setEnabled(false);
        return updateEnabledValue(index, false, id);
    };
    (0, react_1.useImperativeHandle)(ref, () => ({
        disableEnabled,
    }));
    const onPressIn = () => setPressed(true);
    const onPressOut = () => setPressed(false);
    const onPress = async () => updateEnabled(!enabled);
    if ((name === constants_1.googleCalendarName) || (name === constants_2.googlePeopleName)) {
        return ((0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, pt: { phone: 'm', tablet: 'l' }, justifyContent: "center", alignItems: "stretch", children: [(0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, flexDirection: "row", justifyContent: "space-between", alignItems: "center", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { mr: { phone: 's', tablet: 'm' }, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", style: { color: theme_1.palette.darkGray }, children: name }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { ml: { phone: 's', tablet: 'm' }, children: enabled
                                ? (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "On" })
                                : (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Off" }) })] }), (0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, pt: { phone: 'm', tablet: 's' }, children: enabled
                        ? ((0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: onPress, children: (0, jsx_runtime_1.jsx)(Text_1.default, { textAlign: "center", variant: "buttonLink", children: "Disable" }) })) : ((0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPressIn: onPressIn, onPressOut: onPressOut, onPress: onPress, children: (0, jsx_runtime_1.jsx)(image_1.default, { src: pressed ? googleButtonPressed : googleButtonNormal, style: { width: 240, height: 50 }, alt: 'google button' }) })) })] }));
    }
    return ((0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, pt: { phone: 'm', tablet: 'l' }, flexDirection: "row", justifyContent: "space-between", alignItems: "center", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { mr: { phone: 's', tablet: 'm' }, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", style: { color: theme_1.palette.darkGray }, children: name }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { ml: { phone: 's', tablet: 'm' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { onValueChange: updateEnabled, checked: enabled }) })] }));
});
function CalendarCheckBox(props) {
    const { enabled: oldEnabled, updateEnabledValue, index, name, 
    // dark,
    id, calendars, } = props;
    const [enabled, setEnabled] = (0, react_1.useState)(oldEnabled);
    (0, react_1.useEffect)(() => {
        (async () => {
            try {
                const index = calendars.findIndex(i => (i?.id === id));
                if (index !== -1) {
                    setEnabled(true);
                }
            }
            catch (e) {
                console.log(e, ' error in calendar checkbox');
            }
        })();
    }, [calendars, calendars.length, id]);
    const updateEnabled = async (value) => {
        setEnabled(value);
        return updateEnabledValue(index, value, id);
    };
    return ((0, jsx_runtime_1.jsxs)(Box_1.default, { mb: { phone: 's', tablet: 'm' }, flex: 1, style: { width: '90%' }, flexDirection: "row", justifyContent: "space-between", alignItems: "center", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", style: { color: theme_1.palette.darkGray }, children: name }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { style: { width: '30%' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { onValueChange: updateEnabled, checked: enabled }) })] }));
}
function UserViewGoogleCalendarList(props) {
    const { sub } = props;
    const client = props?.client;
    // const calendar_integrationCollection = useRxCollection<calendar_integrationCollection>('calendar_integration')
    const [calendarList, setCalendarList] = (0, react_1.useState)([]);
    const [loading, setLoading] = (0, react_1.useState)(false);
    // const [integration, setIntegration] = useState<CalendarIntegrationType>()
    // const [calendars, setCalendars] = useState<CalendarType[]>([])
    const [enabledCalendars, setEnabledCalendars] = (0, react_1.useState)([]);
    const [enableAllCalendars, setEnableAllCalendars] = (0, react_1.useState)(false);
    const [disableLoading, setDisableLoading] = (0, react_1.useState)(false);
    const token = props?.token;
    const toast = (0, react_2.useToast)();
    const { loading: existingCalendarLoading, error: existingCalendarError, data } = (0, client_1.useQuery)(getCalendarWithResource_1.default, {
        variables: { userId: sub, resource: constants_1.googleResourceName },
    });
    const { loading: integrationLoading, error: integrationError, data: integrationData } = (0, client_1.useQuery)(getCalendarIntegrationByResourceAndName_1.default, {
        variables: {
            name: constants_1.googleCalendarName,
            resource: constants_1.googleResourceName,
            userId: sub,
        }
    });
    if (existingCalendarError) {
        toast({
            status: 'error',
            title: 'Error getting calendars',
            description: existingCalendarError.toString(),
            duration: 9000,
            isClosable: true,
        });
    }
    if (integrationError) {
        toast({
            status: 'error',
            title: 'Error getting calendar integrations',
            description: integrationError.toString(),
            duration: 9000,
            isClosable: true,
        });
    }
    const calendars = data?.Calendar;
    const calendarIntegrations = integrationData?.Calendar_Integration;
    // get calendar list
    (0, react_1.useEffect)(() => {
        if (!token)
            return;
        (async () => {
            try {
                setLoading(true);
                const results = await (0, calendar_integrationHelper_1.listGoogleCalendars)(token);
                console.log(results, ' results from listGoogleCalendars');
                const existingEnabledCalendars = results.map(calendar => {
                    const calendarId = calendar.id;
                    const calendarName = calendar.summary;
                    const calendarIndex = calendars?.findIndex(c => c.id === calendarId);
                    return {
                        id: calendarId,
                        name: calendarName,
                        enabled: (calendarIndex > -1),
                    };
                });
                setCalendarList(results);
                setEnabledCalendars(existingEnabledCalendars);
                setLoading(false);
                setDisableLoading(true);
            }
            catch (e) {
                console.log(e, ' error getting calendars');
                setLoading(false);
                toast({
                    status: 'error',
                    title: 'Error getting calendars',
                    description: e.toString(),
                    duration: 9000,
                    isClosable: true,
                });
                setDisableLoading(true);
            }
        })();
    }, [token, calendars?.length, calendars, toast]);
    // const dark = useColorScheme() === 'dark'
    const updateEnabledCalendarValue = async (index, value) => {
        try {
            const newEnabledCalendars = enabledCalendars.map((c, idx) => {
                if (idx === index) {
                    return {
                        ...c,
                        enabled: value,
                    };
                }
                return c;
            });
            setEnabledCalendars(newEnabledCalendars);
        }
        catch (e) {
            console.log(e, ' error updating enabled value');
            toast({
                status: 'error',
                title: 'Error updating enabled value',
                description: e.toString(),
                duration: 9000,
                isClosable: true,
            });
        }
    };
    const upsertCalendarInDb = async (index) => {
        try {
            console.log(calendarList?.[index], sub, ' calendarList?.[index], sub inside  upsertCalendarInDb');
            return (0, calendarDbHelper_1.upsertGoogleCalendarInDb)(client, calendarList?.[index], sub);
        }
        catch (e) {
            console.log(e, ' error creating calendar');
        }
    };
    const deleteCalendarInDb = async (index) => {
        try {
            await (0, calendarDbHelper_1.deleteGoogleCalendarInDb)(client, calendarList?.[index]?.id);
        }
        catch (e) {
            console.log(e, ' error deleting calendar');
        }
    };
    // delete event trigger in db
    const deleteEventTriggerInDb = async (index) => {
        try {
            await (0, calendar_integrationHelper_1.deleteEventTriggerByResourceId)(calendarList?.[index]?.id);
        }
        catch (e) {
            console.log(e, ' error deleting event trigger');
        }
    };
    const triggerCalendarSync = async (index) => {
        try {
            return (0, calendar_integrationHelper_1.triggerGoogleCalendarSync)(calendarIntegrations?.[0]?.id, calendarList?.[index]?.id, sub);
        }
        catch (e) {
            console.log(e, ' error triggering calendar sync');
        }
    };
    const addCalendarToSync = async (index) => {
        try {
            updateEnabledCalendarValue(index, true);
            await Promise.all([
                upsertCalendarInDb(index),
                triggerCalendarSync(index),
            ]);
            toast({
                status: 'success',
                title: 'Pick a Primary Calendar',
                description: 'Make sure to pick a primary calendar in the next step (or under settings) or Atomic will not work properly ',
                duration: 9000,
                isClosable: true,
            });
        }
        catch (e) {
            console.log(e, ' error adding calendar to sync');
        }
    };
    const removeCalendarFromSync = async (index) => {
        try {
            updateEnabledCalendarValue(index, false);
            const eventsToDelete = await (0, OnBoardHelper2_1.listEventsForCalendar)(client, calendarList?.[index]?.id);
            await (0, AttendeeHelper_1.deleteAttendeesForEvents)(client, eventsToDelete.map(e => e.id));
            const conferenceIds = eventsToDelete.map(e => e.conferenceId)
                .filter(id => !!id);
            await (0, ReminderHelper_1.deleteRemindersForEvents)(client, eventsToDelete.map(e => e.id), sub);
            await Promise.all([
                deleteEventTriggerInDb(index),
                (0, calendarDbHelper_1.deleteEventsByCalendarId)(client, calendarList?.[index]?.id),
            ]);
            if (conferenceIds?.length > 0) {
                await (0, ConferenceHelper_1.deleteConferencesWithIds)(client, conferenceIds);
            }
            await deleteCalendarInDb(index);
            // await deleteCalendarWebhook(client, calendarList?.[index]?.id)
        }
        catch (e) {
            console.log(e, ' error removing calendar from sync');
        }
    };
    const addAllCalendarsToSync = async () => {
        try {
            const promises = [];
            for (let i = 0; i < calendarList.length; i++) {
                promises.push(addCalendarToSync(i));
            }
            await Promise.all(promises);
        }
        catch (e) {
            console.log(e, ' error adding calendar to sync all');
        }
    };
    const removeAllCalendarFromSync = async () => {
        try {
            const promises = [];
            for (let i = 0; i < calendarList.length; i++) {
                promises.push(removeCalendarFromSync(i));
            }
            await Promise.all(promises);
        }
        catch (e) {
            console.log(e, ' error removing calendar from sync all');
        }
    };
    const updateEnabledValue = async (index, value) => {
        try {
            const newEnabledCalendars = enabledCalendars
                ?.slice(0, index)
                ?.concat([{ ...(enabledCalendars?.[index]), enabled: value }])
                ?.concat(enabledCalendars?.slice(index + 1) || [])
                ?.filter(f => !!f);
            setEnabledCalendars(newEnabledCalendars);
            if (value) {
                return addCalendarToSync(index);
            }
            else {
                return removeCalendarFromSync(index);
            }
        }
        catch (e) {
            console.log(e, ' error updating enabled value');
            toast({
                status: 'error',
                title: 'Error updating enabled value',
                description: e.toString(),
            });
        }
    };
    const updateAllCalendars = async (value) => {
        try {
            if (value) {
                setEnableAllCalendars(true);
                return addAllCalendarsToSync();
            }
            setEnableAllCalendars(false);
            return removeAllCalendarFromSync();
        }
        catch (e) {
            console.log(e, ' error updating all calendars');
            toast({
                status: 'error',
                title: 'Error updating all calendars',
                description: e.toString(),
                duration: 9000,
                isClosable: true,
            });
        }
    };
    const closeGoogleCalendarList = () => props.setParentIsGoogleCalendarList(false);
    const renderItem = ({ item, index }) => {
        // console.log(item, ' item inside renderItem') // Reduced console noise
        return ((0, jsx_runtime_1.jsx)(CalendarCheckBox, { updateEnabledValue: updateEnabledValue, index: index, enabled: item?.enabled, name: item?.name, id: item?.id, calendars: calendars }));
    };
    if (loading || existingCalendarLoading || integrationLoading || !disableLoading) {
        return ((0, jsx_runtime_1.jsx)(Box_1.default, { backgroundColor: "primaryCardBackground", flex: 1, justifyContent: "center", alignItems: "center", style: { width: '100%' }, minHeight: "80vh", children: (0, jsx_runtime_1.jsx)(react_native_1.ActivityIndicator, { size: "large", color: theme_1.palette.white }) }));
    }
    if (!(calendarIntegrations?.length > 0)) {
        toast({
            status: 'error',
            title: 'Google Not Enabled',
            description: 'Google calendar integration is not enabled',
            duration: 9000,
            isClosable: true,
        });
    }
    return ((0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, justifyContent: "space-around", alignItems: "center", style: { width: '100%' }, minHeight: "70vh", children: [(0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, style: { width: '80%' }, flexDirection: "row", justifyContent: "space-around", alignItems: "center", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", style: { color: theme_1.palette.darkGray }, children: "All Google Calendars" }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsx)(Switch_1.default, { onValueChange: updateAllCalendars, checked: enableAllCalendars }) })] }), (0, jsx_runtime_1.jsx)(Box_1.default, { style: { width: '90%' }, flex: 3, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_native_1.FlatList, { style: { flex: 1 }, data: enabledCalendars, keyExtractor: item => item.id, renderItem: renderItem, extraData: `${enabledCalendars.map(i => i?.id)}` }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, mt: "m", children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: closeGoogleCalendarList, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", textAlign: "center", children: "Confirm Calendar Selection" }) }) })] }));
}
function UserEnableIntegrations(props) {
    const [loading, setLoading] = (0, react_1.useState)(false);
    const [isWarning, setIsWarning] = (0, react_1.useState)(false);
    const [selectedIndex, setSelectedIndex] = (0, react_1.useState)(-1);
    const [selectedId, setSelectedId] = (0, react_1.useState)();
    const [selectedValue, setSelectedValue] = (0, react_1.useState)(false);
    const [isGoogleCalendarList, setIsGoogleCalendarList] = (0, react_1.useState)(false); // Initial state is false
    const [googleToken, setGoogleToken] = (0, react_1.useState)();
    const googleCalendarElement = (0, react_1.useRef)();
    // const dark = useColorScheme() === 'dark'
    const router = (0, router_1.useRouter)();
    const { sub: userId } = props;
    const client = props?.client;
    const toast = (0, react_2.useToast)();
    const { loading: googleIntegrationLoading, error: googleIntegrationError, data: googleIntegrationData, refetch: googleIntRefetch } = (0, client_1.useQuery)(getCalendarIntegrationByResourceAndName_1.default, {
        variables: {
            name: constants_1.googleCalendarName,
            resource: constants_1.googleResourceName,
            userId: userId,
        }
    });
    const { loading: integrationLoading, error: integrationError, data: integrationData, refetch } = (0, client_1.useQuery)(listCalendarIntegrations_1.default, {
        variables: {
            userId: userId,
        }
    });
    const googleCalendarEnabled = googleIntegrationData?.Calendar_Integration?.[0]?.enabled;
    const integrations = integrationData?.Calendar_Integration;
    // Automatically display calendar list when Google Calendar is enabled and token is available
    (0, react_1.useEffect)(() => {
        if (googleCalendarEnabled && googleToken) {
            setIsGoogleCalendarList(true);
        }
    }, [googleCalendarEnabled, googleToken]);
    //  just in case oldIntegrations are not loaded
    (0, react_1.useEffect)(() => {
        (async () => {
            if (!(integrations?.length > 0)) {
                await refetch();
                await googleIntRefetch();
            }
        })();
    }, [googleIntRefetch, integrations?.length, refetch]);
    const disableGoogleCalendarCheckBox = () => {
        setSelectedIndex(-1);
        setSelectedId('');
        setSelectedValue(false);
        setIsWarning(false);
        googleCalendarElement?.current?.disableEnabled();
    };
    const enableGoogleCalendarCheckBox = async () => {
        try {
            setIsWarning(false);
            // const newIntegrations = integrations
            // .slice(0, selectedIndex)
            // .concat([{ ...(integrations?.[selectedIndex]), enabled: selectedValue }])
            // .concat(integrations.slice(selectedIndex + 1))
            // setIntegrations(newIntegrations)
            await submitIntegration(selectedIndex, selectedValue, selectedId);
            await refetch();
            await googleIntRefetch();
            setSelectedIndex(-1);
            setSelectedId('');
            setSelectedValue(false);
        }
        catch (e) {
            setIsWarning(false);
            console.log(e, ' this is error for enable google calendar checkbox');
            toast({
                status: 'error',
                title: 'Error',
                description: 'Something went wrong',
                duration: 9000,
                isClosable: true,
            });
        }
    };
    const updateEnabledValue = async (index, value, id) => {
        const selectedIntegration = integrations[index];
        if ((selectedIntegration.name === constants_1.googleCalendarName)
            && (value === false)) {
            setSelectedIndex(index);
            setSelectedId(id);
            setSelectedValue(value);
            setIsWarning(true);
        }
        else {
            // const newIntegrations = integrations
            //     .slice(0, index)
            //     .concat([{ ...(integrations?.[index]), enabled: value }])
            //     .concat(integrations.slice(index + 1))
            // setIntegrations(newIntegrations)
            await submitIntegration(index, value, id);
            await refetch();
            await googleIntRefetch();
        }
    };
    const disableGoogleCalendarSync = async (integrationId) => {
        try {
            await (0, calendar_integrationHelper_1.updateIntegration)(client, integrationId, false, null, undefined, null);
            await (0, calendar_integrationHelper_1.deleteEventTriggers)(userId, constants_1.googleResourceName, constants_1.googleCalendarName);
            const itemsToRemove = await (0, calendarDbHelper_1.getItemsToRemove)(client, userId, constants_1.googleResourceName);
            await (0, calendarDbHelper_1.bulkRemoveCalendarsInDb)(client, itemsToRemove.map(i => (i?.id)));
            // bulk remove events from db
            const eventsToRemovePromise = [];
            for (const item of itemsToRemove) {
                if (item?.id) {
                    eventsToRemovePromise.push((0, calendarDbHelper_1.deleteEventsByCalendarId)(client, item.id));
                }
            }
            await Promise.all(eventsToRemovePromise);
            await refetch();
            await googleIntRefetch();
        }
        catch (e) {
            console.log(e, ' this is e for disable google calendarsync');
            await refetch();
            await googleIntRefetch();
        }
    };
    const disableZoomAuth = async (integrationId) => {
        try {
            await (0, calendar_integrationHelper_1.updateIntegration)(client, integrationId, false, null, null, null, undefined, undefined, null, null);
        }
        catch (e) {
            console.log(e, ' unable to disable zoom auth');
        }
    };
    const disableGoogleContactSync = async (integrationId) => {
        try {
            await (0, calendar_integrationHelper_1.updateIntegration)(client, integrationId, false, null, undefined, null, undefined, undefined, null, null);
            // delete event triggers
            await (0, calendar_integrationHelper_1.deleteEventTriggerByResourceId)(integrationId);
        }
        catch (e) {
            console.log(e, ' error in disableGoogleContactSync');
        }
    };
    const submitIntegration = async (index, newEnabled, id) => {
        try {
            if (newEnabled === false) {
                // delete triggers
                if (integrations?.[index]?.name === constants_2.googlePeopleName) {
                    return disableGoogleContactSync(integrations?.[index]?.id);
                }
                else if (integrations?.[index]?.name === constants_1.googleCalendarName) {
                    return disableGoogleCalendarSync(integrations?.[index]?.id);
                }
                else if (integrations?.[index]?.resource === constants_3.zoomResourceName) {
                    return disableZoomAuth(integrations?.[index]?.id);
                }
                return (0, calendar_integrationHelper_1.updateIntegration)(client, id, newEnabled, undefined, undefined, undefined, false, undefined, undefined, undefined, integrations?.[index]?.resource === constants_1.googleResourceName ? 'atomic-web' : 'web');
            }
            console.log(integrations?.[index]?.name, ' integrations?.[index]?.name inside submitIntegration');
        }
        catch (e) {
            console.log(e, ' unable to submit integrations');
            setLoading(false);
            toast({
                status: 'error',
                title: 'Unable to submit integration',
                description: 'Please try again',
                duration: 9000,
                isClosable: true,
            });
        }
    };
    const navigateToGoogleCalendars = async () => {
        try {
            const newAccessToken = await (0, googleCalendarHelper_1.getGoogleToken)(client, userId);
            // return navigation.navigate('UserViewGoogleCalendarList', { token: newAccessToken })
            setGoogleToken(newAccessToken);
            return setIsGoogleCalendarList(true);
        }
        catch (e) {
            console.log(e, ' unable to navigate to google calendars');
        }
    };
    const renderItem2 = ({ item, index }) => {
        if ((item?.resource === constants_3.zoomResourceName) && !item?.enabled) {
            return ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, mt: { phone: 's', tablet: 'm' }, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsxs)("a", { target: "_blank", href: constants_3.zoomOAuthStartUrl, rel: "noopener noreferrer", children: [(0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, flexDirection: "row", justifyContent: "space-between", alignItems: "center", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { mr: { phone: 's', tablet: 'm' }, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", style: { color: theme_1.palette.darkGray }, children: item?.name }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { ml: { phone: 's', tablet: 'm' }, children: item?.enabled
                                        ? (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "On" })
                                        : (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Off" }) })] }), (0, jsx_runtime_1.jsx)("span", { className: "btn btn-link no-underline hover:no-underline", children: "Enable Zoom" })] }) }));
        }
        if ((item?.resource === constants_3.zoomResourceName) && item?.enabled) {
            return ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, children: (0, jsx_runtime_1.jsx)(IntegrationCheckBox, { updateEnabledValue: updateEnabledValue, index: index, enabled: item?.enabled, name: item?.name, id: item?.id }) }));
        }
        if ((item?.resource === constants_1.googleResourceName) && !item?.enabled) {
            return ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, children: (0, jsx_runtime_1.jsx)("a", { target: "_blank", href: constants_1.googleOAuthStartUrl, rel: "noopener noreferrer", children: (0, jsx_runtime_1.jsx)(IntegrationCheckBox, { updateEnabledValue: updateEnabledValue, index: index, enabled: item?.enabled, name: item?.name, id: item?.id, ref: googleCalendarElement }) }) }));
        }
        if ((item?.resource === constants_1.googleResourceName) && item?.enabled) {
            return ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, children: (0, jsx_runtime_1.jsx)(IntegrationCheckBox, { updateEnabledValue: updateEnabledValue, index: index, enabled: item?.enabled, name: item?.name, id: item?.id, ref: googleCalendarElement }) }));
        }
        return ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, children: (0, jsx_runtime_1.jsx)(IntegrationCheckBox, { updateEnabledValue: updateEnabledValue, index: index, enabled: item?.enabled, name: item?.name, id: item?.id }) }));
    };
    if (loading || integrationLoading || googleIntegrationLoading) {
        return ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", style: { width: '100%' }, backgroundColor: "lightRegularCardBackground", children: (0, jsx_runtime_1.jsx)(react_native_1.ActivityIndicator, { size: "large", color: theme_1.palette.white }) }));
    }
    if (isGoogleCalendarList) {
        return ((0, jsx_runtime_1.jsx)(UserViewGoogleCalendarList, { client: client, token: googleToken, sub: userId, setParentIsGoogleCalendarList: setIsGoogleCalendarList }));
    }
    return ((0, jsx_runtime_1.jsxs)(Box_1.default, { justifyContent: "center", alignItems: "center", minHeight: "70vh", children: [integrations?.length > 0
                ? ((0, jsx_runtime_1.jsxs)(Box_1.default, { justifyContent: "center", alignItems: "center", minHeight: "70vh", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_native_1.FlatList, { data: integrations, keyExtractor: item => item.id, renderItem: renderItem2 }) }), googleCalendarEnabled
                            ? ({ /* "View Google Calendars" button is hidden if list is already shown or will be shown automatically */})
                            :
                        , (googleCalendarEnabled && !isGoogleCalendarList && !googleToken) && // Show button only if enabled but list not yet shown (e.g. token fetch in progress)
                            (0, jsx_runtime_1.jsx)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: navigateToGoogleCalendars, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", children: "View Google Calendars" }) }) }), (googleCalendarEnabled && googleToken && !isGoogleCalendarList) && // Case where token is fetched but useEffect for auto-show hasn't run yet or user closed it.
                            (0, jsx_runtime_1.jsx)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { onPress: navigateToGoogleCalendars, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", children: "Manage Google Calendars" }) }) }), !googleCalendarEnabled && (null // No button if Google Calendar is not enabled
                        )] })) : ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "subheader", style: { color: theme_1.palette.darkGray }, children: "Still loading ..." }) })), (0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsx)(themed_1.Overlay, { isVisible: isWarning, onBackdropPress: disableGoogleCalendarCheckBox, overlayStyle: { backgroundColor: theme_1.palette.white }, children: (0, jsx_runtime_1.jsxs)(Box_1.default, { justifyContent: "center", alignItems: "center", style: { width: '80%', backgroundColor: theme_1.palette.white }, children: [(0, jsx_runtime_1.jsx)(Box_1.default, { p: { phone: 's', tablet: 'm' }, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Disabling Google Calendar will delete all google related events from your calendar" }) }), (0, jsx_runtime_1.jsxs)(Box_1.default, { justifyContent: "center", alignItems: "center", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { p: { phone: 's', tablet: 'm' }, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Button_1.default, { onClick: enableGoogleCalendarCheckBox, children: "Okay" }) }), (0, jsx_runtime_1.jsx)(Button_1.default, { disabled: true, onClick: disableGoogleCalendarCheckBox, children: "Cancel" })] })] }) }) })] }));
}
exports.default = UserEnableIntegrations;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVXNlckVuYWJsZUludGVncmF0aW9ucy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlVzZXJFbmFibGVJbnRlZ3JhdGlvbnMudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBeUpBLGdEQXFDQzs7QUE5TEQsaUNBUWdCO0FBRWhCLCtDQUlxQjtBQUNyQix1REFBOEI7QUFDOUIsZ0VBQXdDO0FBQ3hDLDRDQUEyQztBQUMzQywwQ0FBdUM7QUFFdkMsaUVBQXdDO0FBQ3hDLG1FQUEwQztBQUMxQyxnRUFBdUM7QUFDdkMsNENBQTBDO0FBSTFDLHlGQU1pRDtBQUVqRCwwREFJbUM7QUFFbkMseURBRWtDO0FBR2xDLG1EQUc0QjtBQUc1Qix3RUFNMkM7QUFJM0MsMkNBQThFO0FBQzlFLHNHQUE4RTtBQUM5RSxzSUFBNkc7QUFDN0csd0dBQStFO0FBQy9FLHdFQUE0RTtBQUM1RSwwRUFBZ0Y7QUFDaEYsZ0ZBQW9GO0FBQ3BGLDBFQUFnRjtBQUNoRixnRkFBc0U7QUFFdEUsd0NBQXVDO0FBQ3ZDLHVHQUE2RTtBQUM3RSx5R0FBcUY7QUFtRXJGLHNEQUFzRDtBQUV0RCxvR0FBb0c7QUFDcEcscUZBQXFGO0FBRXJGLE1BQU0sbUJBQW1CLEdBQUcsbUNBQThCLENBQUE7QUFDMUQsTUFBTSxrQkFBa0IsR0FBRyxrQ0FBdUIsQ0FBQTtBQUVsRCx3RUFBOEM7QUFDOUMseURBQXFEO0FBQ3JELDhFQUFxRDtBQUU5QyxLQUFLLFVBQVUsa0JBQWtCLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFpRDtJQUNsRywwRkFBMEY7SUFDMUYsc0NBQXNDO0lBQ3RDLHlFQUF5RTtJQUN6RSwwQkFBZSxDQUFDLElBQUksQ0FBQyxJQUFBLDZCQUFhLEdBQUUsQ0FBQyxDQUFBO0lBQ3JDLElBQUksT0FBTyxDQUFBO0lBQ1gsSUFBSSxDQUFDO1FBQ0gsT0FBTyxHQUFHLE1BQU0saUJBQU8sQ0FBQyxVQUFVLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRTtZQUMzQyw2QkFB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QUFjLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBQyxRQUFRLFlBQzVFLHVCQUFDLGNBQUksSUFBQyxPQUFPLEVBQUMsY0FBYyxtR0FFckIsR0FDTCxFQUNOLHdCQUFDLGFBQUcsSUFBQyxjQUFjLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBQyxRQUFRLGFBQ2hELHVCQUFDLGFBQUcsSUFBQyxDQUFDLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsRUFBRSxjQUFjLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBQyxRQUFRLFlBQzVFLHVCQUFDLGdCQUFNLElBQUMsT0FBTyxFQUFFLDRCQUE0QixxQkFFcEMsR0FDUCxFQUVOLHVCQUFDLGdCQUFNLElBQUMsUUFBUSxRQUFDLE9BQU8sRUFBRSw2QkFBNkIsdUJBRTlDLElBQ0gsSUFDSixHQUNBLEdBQ04sSUFDRixDQUNQLENBQUM7QUFDUixDQUFDO0FBRUQsa0JBQWUsc0JBQXNCLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHtcbiAgICB1c2VTdGF0ZSxcbiAgICBmb3J3YXJkUmVmLFxuICAgIHVzZUltcGVyYXRpdmVIYW5kbGUsXG4gICAgdXNlUmVmLFxuICAgIHVzZUVmZmVjdCxcbiAgICBEaXNwYXRjaCxcbiAgICBTZXRTdGF0ZUFjdGlvbixcbiAgfSBmcm9tICdyZWFjdCdcblxuaW1wb3J0IHtcbiAgICBGbGF0TGlzdCxcbiAgICBQcmVzc2FibGUsXG4gICAgQWN0aXZpdHlJbmRpY2F0b3IsXG59IGZyb20gJ3JlYWN0LW5hdGl2ZSdcbmltcG9ydCBJbWFnZSBmcm9tICduZXh0L2ltYWdlJ1xuaW1wb3J0IFN3aXRjaDEgZnJvbSAnQGNvbXBvbmVudHMvU3dpdGNoJ1xuaW1wb3J0IHsgdXNlVG9hc3QgfSBmcm9tICdAY2hha3JhLXVpL3JlYWN0J1xuaW1wb3J0IHsgT3ZlcmxheSB9IGZyb20gJ0BybmV1aS90aGVtZWQnXG5cbmltcG9ydCBCb3ggZnJvbSAnQGNvbXBvbmVudHMvY29tbW9uL0JveCdcbmltcG9ydCBUZXh0IGZyb20gJ0Bjb21wb25lbnRzL2NvbW1vbi9UZXh0J1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdAY29tcG9uZW50cy9CdXR0b24nXG5pbXBvcnQgeyBwYWxldHRlIH0gZnJvbSAnQGxpYi90aGVtZS90aGVtZSdcblxuaW1wb3J0IHsgQ2FsZW5kYXJJbnRlZ3JhdGlvblR5cGUgfSBmcm9tICdAbGliL2RhdGFUeXBlcy9DYWxlbmRhcl9JbnRlZ3JhdGlvblR5cGUnXG5pbXBvcnQgeyBDYWxlbmRhclR5cGUgfSBmcm9tICdAbGliL2RhdGFUeXBlcy9DYWxlbmRhclR5cGUnXG5pbXBvcnQge1xuICAgIHVwZGF0ZUludGVncmF0aW9uLFxuICAgIGRlbGV0ZUV2ZW50VHJpZ2dlcnMsXG4gICAgZGVsZXRlRXZlbnRUcmlnZ2VyQnlSZXNvdXJjZUlkLFxuICAgIHRyaWdnZXJHb29nbGVDYWxlbmRhclN5bmMsXG4gICAgbGlzdEdvb2dsZUNhbGVuZGFycyxcbn0gZnJvbSAnQGxpYi9TZXR0aW5ncy9jYWxlbmRhcl9pbnRlZ3JhdGlvbkhlbHBlcidcblxuaW1wb3J0IHtcbiAgICBnb29nbGVDYWxlbmRhck5hbWUsXG4gICAgZ29vZ2xlUmVzb3VyY2VOYW1lLFxuICAgIGdvb2dsZU9BdXRoU3RhcnRVcmwsXG59IGZyb20gJ0BsaWIvY2FsZW5kYXJMaWIvY29uc3RhbnRzJ1xuXG5pbXBvcnQge1xuICAgIGdvb2dsZVBlb3BsZU5hbWUsXG59IGZyb20gJ0BsaWIvY29udGFjdExpYi9jb25zdGFudHMnXG5cbiAgXG5pbXBvcnQge1xuICAgIHpvb21PQXV0aFN0YXJ0VXJsLFxuICAgIHpvb21SZXNvdXJjZU5hbWVcbn0gZnJvbSAnQGxpYi96b29tL2NvbnN0YW50cydcblxuXG5pbXBvcnQgeyBcbiAgICBidWxrUmVtb3ZlQ2FsZW5kYXJzSW5EYiwgXG4gICAgZGVsZXRlRXZlbnRzQnlDYWxlbmRhcklkLCBcbiAgICBnZXRJdGVtc1RvUmVtb3ZlLFxuICAgIGRlbGV0ZUdvb2dsZUNhbGVuZGFySW5EYiwgXG4gICAgdXBzZXJ0R29vZ2xlQ2FsZW5kYXJJbkRiLFxuIH0gZnJvbSAnQGxpYi9jYWxlbmRhckxpYi9jYWxlbmRhckRiSGVscGVyJ1xuXG5pbXBvcnQgeyBDYWxlbmRhckxpc3RJdGVtUmVzcG9uc2VUeXBlIH0gZnJvbSAnQGxpYi9jYWxlbmRhckxpYi90eXBlcydcbmltcG9ydCB7IGVuYWJsZWRDYWxlbmRhclR5cGUgfSBmcm9tICdAbGliL1NldHRpbmdzL3R5cGVzJ1xuaW1wb3J0IHsgQXBvbGxvQ2xpZW50LCBOb3JtYWxpemVkQ2FjaGVPYmplY3QsIHVzZVF1ZXJ5IH0gZnJvbSAnQGFwb2xsby9jbGllbnQnXG5pbXBvcnQgZ2V0Q2FsZW5kYXJXaXRoUmVzb3VyY2UgZnJvbSAnQGxpYi9hcG9sbG8vZ3FsL2dldENhbGVuZGFyV2l0aFJlc291cmNlJztcbmltcG9ydCBnZXRDYWxlbmRhckludGVncmF0aW9uQnlSZXNvdXJjZUFuZE5hbWUgZnJvbSAnQGxpYi9hcG9sbG8vZ3FsL2dldENhbGVuZGFySW50ZWdyYXRpb25CeVJlc291cmNlQW5kTmFtZSdcbmltcG9ydCBsaXN0Q2FsZW5kYXJJbnRlZ3JhdGlvbnMgZnJvbSAnQGxpYi9hcG9sbG8vZ3FsL2xpc3RDYWxlbmRhckludGVncmF0aW9ucydcbmltcG9ydCB7IGxpc3RFdmVudHNGb3JDYWxlbmRhciB9IGZyb20gJy4uLy4uLy4uL2xpYi9PbkJvYXJkL09uQm9hcmRIZWxwZXIyJztcbmltcG9ydCB7IGRlbGV0ZUF0dGVuZGVlc0ZvckV2ZW50cyB9IGZyb20gJ0BsaWIvQ2FsZW5kYXIvQXR0ZW5kZWUvQXR0ZW5kZWVIZWxwZXInXG5pbXBvcnQgeyBkZWxldGVDb25mZXJlbmNlc1dpdGhJZHMgfSBmcm9tICdAbGliL0NhbGVuZGFyL0NvbmZlcmVuY2UvQ29uZmVyZW5jZUhlbHBlcidcbmltcG9ydCB7IGRlbGV0ZVJlbWluZGVyc0ZvckV2ZW50cyB9IGZyb20gJ0BsaWIvQ2FsZW5kYXIvUmVtaW5kZXIvUmVtaW5kZXJIZWxwZXInXG5pbXBvcnQgeyBnZXRHb29nbGVUb2tlbiB9IGZyb20gJ0BsaWIvY2FsZW5kYXJMaWIvZ29vZ2xlQ2FsZW5kYXJIZWxwZXInXG5cbmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJ1xuaW1wb3J0IGdvb2dsZUJ1dHRvbkxpZ2h0Tm9ybWFsIGZyb20gJ0Bhc3NldHMvaW1hZ2VzL2dvb2dsZS1zaWduaW4tbm9ybWFsLnBuZydcbmltcG9ydCBnb29nbGVCdXR0b25QcmVzc2VkTGlnaHROb3JtYWwgZnJvbSAnQGFzc2V0cy9pbWFnZXMvZ29vZ2xlLXNpZ25pbi1wcmVzc2VkLnBuZydcbi8qKlxuICogWydodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NhbGVuZGFyLnJlYWRvbmx5JyxcbiAgICAgICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NhbGVuZGFyLmV2ZW50cycsXG4gICAgICAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jb250YWN0cy5yZWFkb25seSddLCAvLyB3aGF0IEFQSSB5b3Ugd2FudCB0byBhY2Nlc3Mgb24gYmVoYWxmIG9mIHRoZSB1c2VyLCBkZWZhdWx0IGlzIGVtYWlsIGFuZCBwcm9maWxlXG4gIHdlYkNsaWVudElkOiBnb29nbGVDbGllbnRJZFdlYixcbiAgPGEgdGFyZ2V0PVwiX2JsYW5rXCIgaHJlZj1cImh0dHBzOi8vdHdpdHRlci5jb20vXCIgcmVsPVwibm9vcGVuZXIgbm9yZWZlcnJlclwiPlxuICovXG5cbi8vIEdvb2dsZVNpZ25pbi5jb25maWd1cmUoe1xuLy8gICBzY29wZXM6IFsnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jYWxlbmRhci5yZWFkb25seScsXG4vLyAgICAgICAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jYWxlbmRhci5ldmVudHMnLFxuLy8gICAgICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY29udGFjdHMucmVhZG9ubHknXSwgLy8gd2hhdCBBUEkgeW91IHdhbnQgdG8gYWNjZXNzIG9uIGJlaGFsZiBvZiB0aGUgdXNlciwgZGVmYXVsdCBpcyBlbWFpbCBhbmQgcHJvZmlsZVxuLy8gICB3ZWJDbGllbnRJZDogZ29vZ2xlQ2xpZW50SWRXZWIsIC8vIGNsaWVudCBJRCBvZiB0eXBlIFdFQiBmb3IgeW91ciBzZXJ2ZXIgKG5lZWRlZCB0byB2ZXJpZnkgdXNlciBJRCBhbmQgb2ZmbGluZSBhY2Nlc3MpXG4vLyAgIG9mZmxpbmVBY2Nlc3M6IHRydWUsIC8vIGlmIHlvdSB3YW50IHRvIGFjY2VzcyBHb29nbGUgQVBJIG9uIGJlaGFsZiBvZiB0aGUgdXNlciBGUk9NIFlPVVIgU0VSVkVSXG4vLyAgIGZvcmNlQ29kZUZvclJlZnJlc2hUb2tlbjogdHJ1ZSwgLy8gW0FuZHJvaWRdIHJlbGF0ZWQgdG8gYHNlcnZlckF1dGhDb2RlYCwgcmVhZCB0aGUgZG9jcyBsaW5rIGJlbG93ICouXG4vLyB9KVxuXG4vLyBkYXlqcy5leHRlbmQodXRjKVxuXG50eXBlIENoZWNrQm94UHJvcHNUeXBlID0ge1xuICAgIHVwZGF0ZUVuYWJsZWRWYWx1ZTogKGluZGV4OiBudW1iZXIsIHZhbHVlOiBib29sZWFuLCBpZDogc3RyaW5nKSA9PiBQcm9taXNlPGFueT4sXG4gICAgaW5kZXg6IG51bWJlcixcbiAgICBlbmFibGVkOiBib29sZWFuLFxuICAgIG5hbWU6IHN0cmluZyxcbiAgICAvLyBkYXJrOiBib29sZWFuLFxuICAgIGlkOiBzdHJpbmcsXG59XG5cbnR5cGUgY2hlY2tCb3hQcm9wczIgPSB7XG4gICAgdXBkYXRlRW5hYmxlZFZhbHVlOiAoaW5kZXg6IG51bWJlciwgdmFsdWU6IGJvb2xlYW4sIGlkOiBzdHJpbmcpID0+IFByb21pc2U8YW55PixcbiAgICBpbmRleDogbnVtYmVyLFxuICAgIGVuYWJsZWQ6IGJvb2xlYW4sXG4gICAgbmFtZTogc3RyaW5nLFxuICAgIC8vIGRhcms6IGJvb2xlYW4sXG4gICAgaWQ6IHN0cmluZyxcbiAgICBjYWxlbmRhcnM6IENhbGVuZGFyVHlwZVtdLFxufVxuXG50eXBlIFJlbmRlckl0ZW1UeXBlID0ge1xuICAgIGl0ZW06IGVuYWJsZWRDYWxlbmRhclR5cGUsXG4gICAgaW5kZXg6IG51bWJlcixcbn1cbnR5cGUgUmVuZGVySXRlbVR5cGUyID0ge1xuICAgIGl0ZW06IENhbGVuZGFySW50ZWdyYXRpb25UeXBlLFxuICAgIGluZGV4OiBudW1iZXIsXG59XG5cbnR5cGUgZ29vZ2xlUmVuZGVySXRlbSA9IHtcbiAgICBpdGVtOiBlbmFibGVkQ2FsZW5kYXJUeXBlLFxuICAgIGluZGV4OiBudW1iZXIsXG4gIH1cblxudHlwZSBnb29nbGVDaGVja0JveFByb3BzID0ge1xuICAgIHVwZGF0ZUVuYWJsZWRWYWx1ZTogKGluZGV4OiBudW1iZXIsIHZhbHVlOiBib29sZWFuLCBpZDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQgfCB2b2lkW10+LFxuICAgIGluZGV4OiBudW1iZXIsXG4gICAgZW5hYmxlZDogYm9vbGVhbixcbiAgICBuYW1lOiBzdHJpbmcsXG4gICAgLy8gZGFyazogYm9vbGVhbixcbiAgICBpZDogc3RyaW5nLFxufVxuXG50eXBlIFByb3BzID0ge1xuICAgIHN1Yjogc3RyaW5nLFxuICAgIGNsaWVudDogQXBvbGxvQ2xpZW50PE5vcm1hbGl6ZWRDYWNoZU9iamVjdD4sXG5cbn1cbi8vIGNvbnN0IGRhcmsgPSBBcHBlYXJhbmNlLmdldENvbG9yU2NoZW1lKCkgPT09ICdkYXJrJ1xuXG4vLyBjb25zdCBnb29nbGVCdXR0b25QcmVzc2VkID0gZGFyayA/IGdvb2dsZUJ1dHRvblByZXNzZWREYXJrTm9ybWFsIDogZ29vZ2xlQnV0dG9uUHJlc3NlZExpZ2h0Tm9ybWFsXG4vLyBjb25zdCBnb29nbGVCdXR0b25Ob3JtYWwgPSBkYXJrID8gZ29vZ2xlQnV0dG9uRGFya05vcm1hbCA6IGdvb2dsZUJ1dHRvbkxpZ2h0Tm9ybWFsXG5cbmNvbnN0IGdvb2dsZUJ1dHRvblByZXNzZWQgPSBnb29nbGVCdXR0b25QcmVzc2VkTGlnaHROb3JtYWxcbmNvbnN0IGdvb2dsZUJ1dHRvbk5vcm1hbCA9IGdvb2dsZUJ1dHRvbkxpZ2h0Tm9ybWFsXG5pbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgc3VwZXJ0b2tlbnNOb2RlIGZyb20gJ3N1cGVydG9rZW5zLW5vZGUnXG5pbXBvcnQgeyBiYWNrZW5kQ29uZmlnIH0gZnJvbSAnQGNvbmZpZy9iYWNrZW5kQ29uZmlnJ1xuaW1wb3J0IFNlc3Npb24gZnJvbSAnc3VwZXJ0b2tlbnMtbm9kZS9yZWNpcGUvc2Vzc2lvbidcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlcnZlclNpZGVQcm9wcyh7IHJlcSwgcmVzIH06IHsgcmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UgfSkge1xuICAvLyBOb3RpY2UgaG93IHRoZSBzZXJ2ZXIgdXNlcyBgQVBJYCBmcm9tIGB3aXRoU1NSQ29udGV4dGAsIGluc3RlYWQgb2YgdGhlIHRvcC1sZXZlbCBgQVBJYC5cbiAgLy8gY29uc3QgU1NSID0gd2l0aFNTUkNvbnRleHQoeyByZXEgfSlcbiAgLy8gdGhpcyBydW5zIG9uIHRoZSBiYWNrZW5kLCBzbyB3ZSBtdXN0IGNhbGwgaW5pdCBvbiBzdXBlcnRva2Vucy1ub2RlIFNES1xuICBzdXBlcnRva2Vuc05vZGUuaW5pdChiYWNrZW5kQ29uZmlnKCkpXG4gIGxldCBzZXNzaW9uXG4gIHRyeSB7XG4gICAgc2Vzc2lvbiA9IGF3YWl0IFNlc3Npb24uZ2V0U2Vzc2lvbihyZXEsIHJlcywge1xuICAgICAgb3ZlcnJpZGVHbG9iYWxDbGFpbVZhbGlkYXRvcnM6IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFtdXG4gICAgICB9LFxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgaWYgKGVyci50eXBlID09PSBTZXNzaW9uLkVycm9yLlRSWV9SRUZSRVNIX1RPS0VOKSB7XG4gICAgICByZXR1cm4geyBwcm9wczogeyBmcm9tU3VwZXJ0b2tlbnM6ICduZWVkcy1yZWZyZXNoJyB9IH1cbiAgICB9IGVsc2UgaWYgKGVyci50eXBlID09PSBTZXNzaW9uLkVycm9yLlVOQVVUSE9SSVNFRCkge1xuICAgICAgLy8gdGhpcyB3aWxsIGZvcmNlIHRoZSBmcm9udGVuZCB0byB0cnkgYW5kIHJlZnJlc2ggd2hpY2ggd2lsbCBmYWlsXG4gICAgICAvLyBjbGVhcmluZyBhbGwgY29va2llcyBhbmQgcmVkaXJlY3RpbmcgdGhlIHVzZXIgdG8gdGhlIGxvZ2luIHNjcmVlbi5cbiAgICAgIHJldHVybiB7IHByb3BzOiB7IGZyb21TdXBlcnRva2VuczogJ25lZWRzLXJlZnJlc2gnIH0gfVxuICAgIH1cbiAgICB0aHJvdyBlcnJcbiAgfVxuXG4gIGlmICghc2Vzc2lvbj8uZ2V0VXNlcklkKCkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVkaXJlY3Q6IHtcbiAgICAgICAgZGVzdGluYXRpb246ICcvVXNlci9Mb2dpbi9Vc2VyTG9naW4nLFxuICAgICAgICBwZXJtYW5lbnQ6IGZhbHNlLFxuICAgICAgfSxcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHByb3BzOiB7XG4gICAgICBzdWI6IHNlc3Npb24uZ2V0VXNlcklkKCksXG4gICAgfVxuICB9XG59XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9kaXNwbGF5LW5hbWVcbmNvbnN0IEludGVncmF0aW9uQ2hlY2tCb3ggPSBmb3J3YXJkUmVmKChwcm9wczogQ2hlY2tCb3hQcm9wc1R5cGUsIHJlZikgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgIGVuYWJsZWQ6IG9sZEVuYWJsZWQsXG4gICAgICB1cGRhdGVFbmFibGVkVmFsdWUsXG4gICAgICBpbmRleCxcbiAgICAgIG5hbWUsXG4gICAgLy8gICBkYXJrLFxuICAgICAgaWQsXG4gICAgfSA9IHByb3BzXG4gICAgY29uc3QgW2VuYWJsZWQsIHNldEVuYWJsZWRdID0gdXNlU3RhdGU8Ym9vbGVhbj4ob2xkRW5hYmxlZClcbiAgICBjb25zdCBbcHJlc3NlZCwgc2V0UHJlc3NlZF0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSlcbiAgXG4gICAgY29uc3QgdXBkYXRlRW5hYmxlZCA9IGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xuICAgICAgc2V0RW5hYmxlZCh2YWx1ZSlcbiAgICAgIHJldHVybiB1cGRhdGVFbmFibGVkVmFsdWUoaW5kZXgsIHZhbHVlLCBpZClcbiAgICB9XG4gIFxuICAgIGNvbnN0IGRpc2FibGVFbmFibGVkID0gYXN5bmMgKCkgPT4ge1xuICAgICAgc2V0RW5hYmxlZChmYWxzZSlcbiAgICAgIHJldHVybiB1cGRhdGVFbmFibGVkVmFsdWUoaW5kZXgsIGZhbHNlLCBpZClcbiAgICB9XG4gIFxuICAgIHVzZUltcGVyYXRpdmVIYW5kbGUocmVmLCAoKSA9PiAoe1xuICAgICAgICBkaXNhYmxlRW5hYmxlZCxcbiAgICB9KSlcblxuICAgIGNvbnN0IG9uUHJlc3NJbiA9ICgpID0+IHNldFByZXNzZWQodHJ1ZSlcbiAgICBjb25zdCBvblByZXNzT3V0ID0gKCkgPT4gc2V0UHJlc3NlZChmYWxzZSlcblxuICAgIGNvbnN0IG9uUHJlc3MgPSBhc3luYyAoKSA9PiB1cGRhdGVFbmFibGVkKCFlbmFibGVkKVxuICAgICAgICBcblxuICAgIGlmICgobmFtZSA9PT0gZ29vZ2xlQ2FsZW5kYXJOYW1lKSB8fCAobmFtZSA9PT0gZ29vZ2xlUGVvcGxlTmFtZSkpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxCb3ggZmxleD17MX0gcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAnbCcgfX0ganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwic3RyZXRjaFwiPlxuICAgICAgICAgICAgICAgIDxCb3ggZmxleD17MX0gZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwic3BhY2UtYmV0d2VlblwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPEJveCBtcj17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiIHN0eWxlPXt7IGNvbG9yOiBwYWxldHRlLmRhcmtHcmF5IH19PlxuICAgICAgICAgICAgICAgICAgICAgICAge25hbWV9XG4gICAgICAgICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgIDxCb3ggbWw9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICB7ZW5hYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPk9uPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPk9mZjwvVGV4dD5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICA8Qm94IGZsZXg9ezF9IHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19PlxuICAgICAgICAgICAgICAgICAgICB7ZW5hYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByZXNzYWJsZSBvblByZXNzPXtvblByZXNzfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHQgdGV4dEFsaWduPVwiY2VudGVyXCIgdmFyaWFudD1cImJ1dHRvbkxpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERpc2FibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvUHJlc3NhYmxlPlxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8UHJlc3NhYmxlIG9uUHJlc3NJbj17b25QcmVzc0lufSBvblByZXNzT3V0PXtvblByZXNzT3V0fSBvblByZXNzPXtvblByZXNzfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEltYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM9e3ByZXNzZWQgPyBnb29nbGVCdXR0b25QcmVzc2VkIDogZ29vZ2xlQnV0dG9uTm9ybWFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgd2lkdGg6IDI0MCwgaGVpZ2h0OiA1MCB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWx0PXsnZ29vZ2xlIGJ1dHRvbid9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9QcmVzc2FibGU+XG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgIClcbiAgICB9XG4gIFxuICAgIHJldHVybiAoXG4gICAgICA8Qm94IGZsZXg9ezF9IHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ2wnIH19IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cInNwYWNlLWJldHdlZW5cIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgIDxCb3ggbXI9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiIHN0eWxlPXt7IGNvbG9yOiBwYWxldHRlLmRhcmtHcmF5IH19PlxuICAgICAgICAgICAge25hbWV9XG4gICAgICAgICAgPC9UZXh0PlxuICAgICAgICA8L0JveD5cbiAgICAgICAgPEJveCBtbD17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fT5cbiAgICAgICAgICA8U3dpdGNoMVxuICAgICAgICAgICAgb25WYWx1ZUNoYW5nZT17dXBkYXRlRW5hYmxlZH1cbiAgICAgICAgICAgIGNoZWNrZWQ9e2VuYWJsZWR9XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9Cb3g+XG4gIFxuICAgICAgPC9Cb3g+XG4gICAgKVxufSlcblxuZnVuY3Rpb24gQ2FsZW5kYXJDaGVja0JveChwcm9wczogY2hlY2tCb3hQcm9wczIpIHtcbiAgICBjb25zdCB7XG4gICAgICBlbmFibGVkOiBvbGRFbmFibGVkLFxuICAgICAgdXBkYXRlRW5hYmxlZFZhbHVlLFxuICAgIGluZGV4LFxuICAgIG5hbWUsXG4gICAgLy8gZGFyayxcbiAgICBpZCxcbiAgICBjYWxlbmRhcnMsXG4gICAgfSA9IHByb3BzXG4gICAgY29uc3QgW2VuYWJsZWQsIHNldEVuYWJsZWRdID0gdXNlU3RhdGU8Ym9vbGVhbj4ob2xkRW5hYmxlZClcblxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBjYWxlbmRhcnMuZmluZEluZGV4KGkgPT4gKGk/LmlkID09PSBpZCkpXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRFbmFibGVkKHRydWUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUsICcgZXJyb3IgaW4gY2FsZW5kYXIgY2hlY2tib3gnKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSgpXG4gICAgfSwgW2NhbGVuZGFycywgY2FsZW5kYXJzLmxlbmd0aCwgaWRdKVxuICBcbiAgICBjb25zdCB1cGRhdGVFbmFibGVkID0gYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XG4gICAgICBzZXRFbmFibGVkKHZhbHVlKVxuICAgICAgcmV0dXJuIHVwZGF0ZUVuYWJsZWRWYWx1ZShpbmRleCwgdmFsdWUsIGlkKVxuICAgIH1cbiAgXG4gICAgcmV0dXJuIChcbiAgICAgIDxCb3ggbWI9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0gZmxleD17MX0gc3R5bGU9e3sgd2lkdGg6ICc5MCUnfX0gZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwic3BhY2UtYmV0d2VlblwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgPEJveD5cbiAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCIgc3R5bGU9e3sgY29sb3I6IHBhbGV0dGUuZGFya0dyYXkgfX0+XG4gICAgICAgICAgICB7bmFtZX1cbiAgICAgICAgICA8L1RleHQ+XG4gICAgICAgIDwvQm94PlxuICAgICAgICA8Qm94IHN0eWxlPXt7IHdpZHRoOiAnMzAlJ319PlxuICAgICAgICAgIDxTd2l0Y2gxXG4gICAgICAgICAgICBvblZhbHVlQ2hhbmdlPXt1cGRhdGVFbmFibGVkfVxuICAgICAgICAgICAgY2hlY2tlZD17ZW5hYmxlZH1cbiAgICAgICAgICAvPlxuICAgICAgICA8L0JveD5cbiAgXG4gICAgICA8L0JveD5cbiAgICApXG59XG5cbnR5cGUgR29vZ2xlUHJvcHMgPSB7XG4gICAgc3ViOiBzdHJpbmcsIFxuICAgIHRva2VuOiBzdHJpbmcsXG4gICAgc2V0UGFyZW50SXNHb29nbGVDYWxlbmRhckxpc3Q6IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPGJvb2xlYW4+PixcbiAgICBjbGllbnQ6IEFwb2xsb0NsaWVudDxOb3JtYWxpemVkQ2FjaGVPYmplY3Q+LFxuXG59XG5cbmZ1bmN0aW9uIFVzZXJWaWV3R29vZ2xlQ2FsZW5kYXJMaXN0KHByb3BzOiBHb29nbGVQcm9wcykge1xuICAgIGNvbnN0IHsgc3ViIH0gPSBwcm9wc1xuICAgIGNvbnN0IGNsaWVudCA9IHByb3BzPy5jbGllbnRcbiAgICAvLyBjb25zdCBjYWxlbmRhcl9pbnRlZ3JhdGlvbkNvbGxlY3Rpb24gPSB1c2VSeENvbGxlY3Rpb248Y2FsZW5kYXJfaW50ZWdyYXRpb25Db2xsZWN0aW9uPignY2FsZW5kYXJfaW50ZWdyYXRpb24nKVxuICAgIFxuICAgIGNvbnN0IFtjYWxlbmRhckxpc3QsIHNldENhbGVuZGFyTGlzdF0gPSB1c2VTdGF0ZTxDYWxlbmRhckxpc3RJdGVtUmVzcG9uc2VUeXBlW10+KFtdKVxuICAgIGNvbnN0IFtsb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKVxuICAgIC8vIGNvbnN0IFtpbnRlZ3JhdGlvbiwgc2V0SW50ZWdyYXRpb25dID0gdXNlU3RhdGU8Q2FsZW5kYXJJbnRlZ3JhdGlvblR5cGU+KClcbiAgICAvLyBjb25zdCBbY2FsZW5kYXJzLCBzZXRDYWxlbmRhcnNdID0gdXNlU3RhdGU8Q2FsZW5kYXJUeXBlW10+KFtdKVxuICAgIGNvbnN0IFtlbmFibGVkQ2FsZW5kYXJzLCBzZXRFbmFibGVkQ2FsZW5kYXJzXSA9IHVzZVN0YXRlPGVuYWJsZWRDYWxlbmRhclR5cGVbXT4oW10pXG4gICAgY29uc3QgW2VuYWJsZUFsbENhbGVuZGFycywgc2V0RW5hYmxlQWxsQ2FsZW5kYXJzXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKVxuICAgIGNvbnN0IFtkaXNhYmxlTG9hZGluZywgc2V0RGlzYWJsZUxvYWRpbmddID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpXG5cbiAgICBjb25zdCB0b2tlbiA9IHByb3BzPy50b2tlblxuXG4gICAgY29uc3QgdG9hc3QgPSB1c2VUb2FzdCgpXG5cbiAgICBjb25zdCB7IGxvYWRpbmc6IGV4aXN0aW5nQ2FsZW5kYXJMb2FkaW5nLCBlcnJvcjogZXhpc3RpbmdDYWxlbmRhckVycm9yLCBkYXRhIH0gPSB1c2VRdWVyeTx7IENhbGVuZGFyOiBDYWxlbmRhclR5cGVbXSB9PihnZXRDYWxlbmRhcldpdGhSZXNvdXJjZSwge1xuICAgICAgICB2YXJpYWJsZXM6IHsgdXNlcklkOiBzdWIsIHJlc291cmNlOiBnb29nbGVSZXNvdXJjZU5hbWUgfSxcbiAgICB9KVxuXG4gICAgY29uc3QgeyBsb2FkaW5nOiBpbnRlZ3JhdGlvbkxvYWRpbmcsIGVycm9yOiBpbnRlZ3JhdGlvbkVycm9yLCBkYXRhOiBpbnRlZ3JhdGlvbkRhdGEgfSA9IHVzZVF1ZXJ5PHsgQ2FsZW5kYXJfSW50ZWdyYXRpb246IENhbGVuZGFySW50ZWdyYXRpb25UeXBlW10gfT4oZ2V0Q2FsZW5kYXJJbnRlZ3JhdGlvbkJ5UmVzb3VyY2VBbmROYW1lLCB7XG4gICAgICAgIHZhcmlhYmxlczoge1xuICAgICAgICAgICAgbmFtZTogZ29vZ2xlQ2FsZW5kYXJOYW1lLFxuICAgICAgICAgICAgcmVzb3VyY2U6IGdvb2dsZVJlc291cmNlTmFtZSxcbiAgICAgICAgICAgIHVzZXJJZDogc3ViLFxuICAgICAgICB9XG4gICAgfSlcblxuICAgIGlmIChleGlzdGluZ0NhbGVuZGFyRXJyb3IpIHtcbiAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICAgICAgdGl0bGU6ICdFcnJvciBnZXR0aW5nIGNhbGVuZGFycycsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogZXhpc3RpbmdDYWxlbmRhckVycm9yLnRvU3RyaW5nKCksXG4gICAgICAgICAgICBkdXJhdGlvbjogOTAwMCxcbiAgICAgICAgICAgIGlzQ2xvc2FibGU6IHRydWUsXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgaWYgKGludGVncmF0aW9uRXJyb3IpIHtcbiAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICAgICAgdGl0bGU6ICdFcnJvciBnZXR0aW5nIGNhbGVuZGFyIGludGVncmF0aW9ucycsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogaW50ZWdyYXRpb25FcnJvci50b1N0cmluZygpLFxuICAgICAgICAgICAgZHVyYXRpb246IDkwMDAsXG4gICAgICAgICAgICBpc0Nsb3NhYmxlOiB0cnVlLFxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGNvbnN0IGNhbGVuZGFycyA9IGRhdGE/LkNhbGVuZGFyXG4gICAgY29uc3QgY2FsZW5kYXJJbnRlZ3JhdGlvbnMgPSBpbnRlZ3JhdGlvbkRhdGE/LkNhbGVuZGFyX0ludGVncmF0aW9uXG4gICAgXG4gICAgLy8gZ2V0IGNhbGVuZGFyIGxpc3RcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIXRva2VuKSByZXR1cm5cbiAgICAgICAgKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgc2V0TG9hZGluZyh0cnVlKVxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBsaXN0R29vZ2xlQ2FsZW5kYXJzKHRva2VuKVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdHMsICcgcmVzdWx0cyBmcm9tIGxpc3RHb29nbGVDYWxlbmRhcnMnKVxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRW5hYmxlZENhbGVuZGFycyA9IHJlc3VsdHMubWFwKGNhbGVuZGFyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FsZW5kYXJJZCA9IGNhbGVuZGFyLmlkXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbGVuZGFyTmFtZSA9IGNhbGVuZGFyLnN1bW1hcnlcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FsZW5kYXJJbmRleCA9IGNhbGVuZGFycz8uZmluZEluZGV4KGMgPT4gYy5pZCA9PT0gY2FsZW5kYXJJZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjYWxlbmRhcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogY2FsZW5kYXJOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogKGNhbGVuZGFySW5kZXggPiAtMSksXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIHNldENhbGVuZGFyTGlzdChyZXN1bHRzKVxuICAgICAgICAgICAgICAgIHNldEVuYWJsZWRDYWxlbmRhcnMoZXhpc3RpbmdFbmFibGVkQ2FsZW5kYXJzKVxuICAgICAgICAgICAgICAgIHNldExvYWRpbmcoZmFsc2UpXG4gICAgICAgICAgICAgICAgc2V0RGlzYWJsZUxvYWRpbmcodHJ1ZSlcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlLCAnIGVycm9yIGdldHRpbmcgY2FsZW5kYXJzJylcbiAgICAgICAgICAgICAgICBzZXRMb2FkaW5nKGZhbHNlKVxuICAgICAgICAgICAgICAgIHRvYXN0KHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0Vycm9yIGdldHRpbmcgY2FsZW5kYXJzJyxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGUudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDkwMDAsXG4gICAgICAgICAgICAgICAgICAgIGlzQ2xvc2FibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBzZXREaXNhYmxlTG9hZGluZyh0cnVlKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSgpXG4gICAgfSwgW3Rva2VuLCBjYWxlbmRhcnM/Lmxlbmd0aCwgY2FsZW5kYXJzLCB0b2FzdF0pXG5cbiAgICAvLyBjb25zdCBkYXJrID0gdXNlQ29sb3JTY2hlbWUoKSA9PT0gJ2RhcmsnXG4gICAgY29uc3QgdXBkYXRlRW5hYmxlZENhbGVuZGFyVmFsdWUgPSBhc3luYyAoaW5kZXg6IG51bWJlciwgdmFsdWU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0VuYWJsZWRDYWxlbmRhcnMgPSBlbmFibGVkQ2FsZW5kYXJzLm1hcCgoYywgaWR4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGlkeCA9PT0gaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmMsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gY1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHNldEVuYWJsZWRDYWxlbmRhcnMobmV3RW5hYmxlZENhbGVuZGFycylcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZSwgJyBlcnJvciB1cGRhdGluZyBlbmFibGVkIHZhbHVlJylcbiAgICAgICAgICAgIHRvYXN0KHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdFcnJvciB1cGRhdGluZyBlbmFibGVkIHZhbHVlJyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZS50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA5MDAwLFxuICAgICAgICAgICAgICAgIGlzQ2xvc2FibGU6IHRydWUsXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgdXBzZXJ0Q2FsZW5kYXJJbkRiID0gYXN5bmMgKGluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNhbGVuZGFyTGlzdD8uW2luZGV4XSwgc3ViLCAnIGNhbGVuZGFyTGlzdD8uW2luZGV4XSwgc3ViIGluc2lkZSAgdXBzZXJ0Q2FsZW5kYXJJbkRiJylcbiAgICAgICAgICAgIHJldHVybiB1cHNlcnRHb29nbGVDYWxlbmRhckluRGIoXG4gICAgICAgICAgICAgICAgY2xpZW50LFxuICAgICAgICAgICAgICAgIGNhbGVuZGFyTGlzdD8uW2luZGV4XSxcbiAgICAgICAgICAgICAgICBzdWIsXG4gICAgICAgICAgICApXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUsICcgZXJyb3IgY3JlYXRpbmcgY2FsZW5kYXInKVxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGRlbGV0ZUNhbGVuZGFySW5EYiA9IGFzeW5jIChpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBkZWxldGVHb29nbGVDYWxlbmRhckluRGIoY2xpZW50LCBjYWxlbmRhckxpc3Q/LltpbmRleF0/LmlkKVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlLCAnIGVycm9yIGRlbGV0aW5nIGNhbGVuZGFyJylcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGRlbGV0ZSBldmVudCB0cmlnZ2VyIGluIGRiXG4gICAgY29uc3QgZGVsZXRlRXZlbnRUcmlnZ2VySW5EYiA9IGFzeW5jIChpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBkZWxldGVFdmVudFRyaWdnZXJCeVJlc291cmNlSWQoY2FsZW5kYXJMaXN0Py5baW5kZXhdPy5pZClcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZSwgJyBlcnJvciBkZWxldGluZyBldmVudCB0cmlnZ2VyJylcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zdCB0cmlnZ2VyQ2FsZW5kYXJTeW5jID0gYXN5bmMgKFxuICAgICAgICBpbmRleDogbnVtYmVyLFxuICAgICkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIHRyaWdnZXJHb29nbGVDYWxlbmRhclN5bmMoY2FsZW5kYXJJbnRlZ3JhdGlvbnM/LlswXT8uaWQsIGNhbGVuZGFyTGlzdD8uW2luZGV4XT8uaWQsIHN1YilcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZSwgJyBlcnJvciB0cmlnZ2VyaW5nIGNhbGVuZGFyIHN5bmMnKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgYWRkQ2FsZW5kYXJUb1N5bmMgPSBhc3luYyAoaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdXBkYXRlRW5hYmxlZENhbGVuZGFyVmFsdWUoaW5kZXgsIHRydWUpXG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgICAgICAgICAgdXBzZXJ0Q2FsZW5kYXJJbkRiKGluZGV4KSxcbiAgICAgICAgICAgICAgICB0cmlnZ2VyQ2FsZW5kYXJTeW5jKGluZGV4KSxcbiAgICAgICAgICAgIF0pXG5cbiAgICAgICAgICAgIHRvYXN0KHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdzdWNjZXNzJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1BpY2sgYSBQcmltYXJ5IENhbGVuZGFyJyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ01ha2Ugc3VyZSB0byBwaWNrIGEgcHJpbWFyeSBjYWxlbmRhciBpbiB0aGUgbmV4dCBzdGVwIChvciB1bmRlciBzZXR0aW5ncykgb3IgQXRvbWljIHdpbGwgbm90IHdvcmsgcHJvcGVybHkgJyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogOTAwMCxcbiAgICAgICAgICAgICAgICBpc0Nsb3NhYmxlOiB0cnVlLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZSwgJyBlcnJvciBhZGRpbmcgY2FsZW5kYXIgdG8gc3luYycpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCByZW1vdmVDYWxlbmRhckZyb21TeW5jID0gYXN5bmMgKGluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHVwZGF0ZUVuYWJsZWRDYWxlbmRhclZhbHVlKGluZGV4LCBmYWxzZSlcblxuICAgICAgICAgICAgY29uc3QgZXZlbnRzVG9EZWxldGUgPSBhd2FpdCBsaXN0RXZlbnRzRm9yQ2FsZW5kYXIoY2xpZW50LCBjYWxlbmRhckxpc3Q/LltpbmRleF0/LmlkKVxuICAgICAgICAgICAgYXdhaXQgZGVsZXRlQXR0ZW5kZWVzRm9yRXZlbnRzKGNsaWVudCwgZXZlbnRzVG9EZWxldGUubWFwKGUgPT4gZS5pZCkpXG4gICAgICAgICAgICBjb25zdCBjb25mZXJlbmNlSWRzID0gZXZlbnRzVG9EZWxldGUubWFwKGUgPT4gZS5jb25mZXJlbmNlSWQpXG4gICAgICAgICAgICAgICAgLmZpbHRlcihpZCA9PiAhIWlkKVxuXG4gICAgICAgICAgICBhd2FpdCBkZWxldGVSZW1pbmRlcnNGb3JFdmVudHMoY2xpZW50LCBldmVudHNUb0RlbGV0ZS5tYXAoZSA9PiBlLmlkKSwgc3ViKVxuICAgICAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgICAgIGRlbGV0ZUV2ZW50VHJpZ2dlckluRGIoaW5kZXgpLFxuICAgICAgICAgICAgICAgIGRlbGV0ZUV2ZW50c0J5Q2FsZW5kYXJJZChjbGllbnQsIGNhbGVuZGFyTGlzdD8uW2luZGV4XT8uaWQpLFxuICAgICAgICAgICAgXSlcblxuICAgICAgICAgICAgaWYgKGNvbmZlcmVuY2VJZHM/Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBhd2FpdCBkZWxldGVDb25mZXJlbmNlc1dpdGhJZHMoY2xpZW50LCBjb25mZXJlbmNlSWRzKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhd2FpdCBkZWxldGVDYWxlbmRhckluRGIoaW5kZXgpXG4gICAgICAgICAgICAvLyBhd2FpdCBkZWxldGVDYWxlbmRhcldlYmhvb2soY2xpZW50LCBjYWxlbmRhckxpc3Q/LltpbmRleF0/LmlkKVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlLCAnIGVycm9yIHJlbW92aW5nIGNhbGVuZGFyIGZyb20gc3luYycpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBhZGRBbGxDYWxlbmRhcnNUb1N5bmMgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBwcm9taXNlcyA9IFtdXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNhbGVuZGFyTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goYWRkQ2FsZW5kYXJUb1N5bmMoaSkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcylcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZSwgJyBlcnJvciBhZGRpbmcgY2FsZW5kYXIgdG8gc3luYyBhbGwnKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcmVtb3ZlQWxsQ2FsZW5kYXJGcm9tU3luYyA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHByb21pc2VzID0gW11cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2FsZW5kYXJMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChyZW1vdmVDYWxlbmRhckZyb21TeW5jKGkpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUsICcgZXJyb3IgcmVtb3ZpbmcgY2FsZW5kYXIgZnJvbSBzeW5jIGFsbCcpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB1cGRhdGVFbmFibGVkVmFsdWUgPSBhc3luYyAoaW5kZXg6IG51bWJlciwgdmFsdWU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgbmV3RW5hYmxlZENhbGVuZGFycyA9IGVuYWJsZWRDYWxlbmRhcnNcbiAgICAgICAgICAgICAgICA/LnNsaWNlKDAsIGluZGV4KVxuICAgICAgICAgICAgICAgID8uY29uY2F0KFt7IC4uLihlbmFibGVkQ2FsZW5kYXJzPy5baW5kZXhdKSwgZW5hYmxlZDogdmFsdWUgfV0pXG4gICAgICAgICAgICAgICAgPy5jb25jYXQoZW5hYmxlZENhbGVuZGFycz8uc2xpY2UoaW5kZXggKyAxKSB8fCBbXSlcbiAgICAgICAgICAgICAgICA/LmZpbHRlcihmID0+ICEhZilcblxuICAgICAgICAgICAgc2V0RW5hYmxlZENhbGVuZGFycyhuZXdFbmFibGVkQ2FsZW5kYXJzKVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWRkQ2FsZW5kYXJUb1N5bmMoaW5kZXgpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiByZW1vdmVDYWxlbmRhckZyb21TeW5jKGluZGV4KVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlLCAnIGVycm9yIHVwZGF0aW5nIGVuYWJsZWQgdmFsdWUnKVxuICAgICAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogJ0Vycm9yIHVwZGF0aW5nIGVuYWJsZWQgdmFsdWUnLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBlLnRvU3RyaW5nKCksXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgdXBkYXRlQWxsQ2FsZW5kYXJzID0gYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBzZXRFbmFibGVBbGxDYWxlbmRhcnModHJ1ZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gYWRkQWxsQ2FsZW5kYXJzVG9TeW5jKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldEVuYWJsZUFsbENhbGVuZGFycyhmYWxzZSlcbiAgICAgICAgICAgIHJldHVybiByZW1vdmVBbGxDYWxlbmRhckZyb21TeW5jKClcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZSwgJyBlcnJvciB1cGRhdGluZyBhbGwgY2FsZW5kYXJzJylcbiAgICAgICAgICAgIHRvYXN0KHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdFcnJvciB1cGRhdGluZyBhbGwgY2FsZW5kYXJzJyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZS50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA5MDAwLFxuICAgICAgICAgICAgICAgIGlzQ2xvc2FibGU6IHRydWUsXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgY2xvc2VHb29nbGVDYWxlbmRhckxpc3QgPSAoKSA9PiBwcm9wcy5zZXRQYXJlbnRJc0dvb2dsZUNhbGVuZGFyTGlzdChmYWxzZSlcblxuICAgIGNvbnN0IHJlbmRlckl0ZW0gPSAoeyBpdGVtLCBpbmRleCB9OiBSZW5kZXJJdGVtVHlwZSkgPT4ge1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhpdGVtLCAnIGl0ZW0gaW5zaWRlIHJlbmRlckl0ZW0nKSAvLyBSZWR1Y2VkIGNvbnNvbGUgbm9pc2VcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxDYWxlbmRhckNoZWNrQm94XG4gICAgICAgICAgICAgICAgdXBkYXRlRW5hYmxlZFZhbHVlPXt1cGRhdGVFbmFibGVkVmFsdWV9XG4gICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAgIGVuYWJsZWQ9e2l0ZW0/LmVuYWJsZWR9XG4gICAgICAgICAgICAgICAgbmFtZT17aXRlbT8ubmFtZX1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZD17aXRlbT8uaWR9XG4gICAgICAgICAgICAgICAgY2FsZW5kYXJzPXtjYWxlbmRhcnN9XG4gICAgICAgICAgICAvPlxuICAgICAgICApXG4gICAgfVxuIFxuICAgIGlmIChsb2FkaW5nIHx8IGV4aXN0aW5nQ2FsZW5kYXJMb2FkaW5nIHx8IGludGVncmF0aW9uTG9hZGluZyB8fCAhZGlzYWJsZUxvYWRpbmcpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgIDxCb3ggYmFja2dyb3VuZENvbG9yPVwicHJpbWFyeUNhcmRCYWNrZ3JvdW5kXCIgZmxleD17MX0ganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgc3R5bGU9e3sgd2lkdGg6ICcxMDAlJ319IG1pbkhlaWdodD1cIjgwdmhcIj5cbiAgICAgICAgICAgICAgPEFjdGl2aXR5SW5kaWNhdG9yIHNpemU9XCJsYXJnZVwiIGNvbG9yPXtwYWxldHRlLndoaXRlfSAvPlxuICAgICAgICAgIDwvQm94PlxuICAgICAgICApXG4gICAgfVxuXG4gICAgaWYgKCEoY2FsZW5kYXJJbnRlZ3JhdGlvbnM/Lmxlbmd0aCA+IDApKSB7XG4gICAgICAgIHRvYXN0KHtcbiAgICAgICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgICAgIHRpdGxlOiAnR29vZ2xlIE5vdCBFbmFibGVkJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnR29vZ2xlIGNhbGVuZGFyIGludGVncmF0aW9uIGlzIG5vdCBlbmFibGVkJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiA5MDAwLFxuICAgICAgICAgICAgaXNDbG9zYWJsZTogdHJ1ZSxcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgICA8Qm94IGZsZXg9ezF9IGp1c3RpZnlDb250ZW50PVwic3BhY2UtYXJvdW5kXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiIHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0gbWluSGVpZ2h0PVwiNzB2aFwiPlxuICAgICAgICAgICAgPEJveCBmbGV4PXsxfSBzdHlsZT17eyB3aWR0aDogJzgwJScgfX0gZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwic3BhY2UtYXJvdW5kXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgICAgICAgIDxUZXh0IHZhcmlhbnQ9XCJvcHRpb25IZWFkZXJcIiBzdHlsZT17eyBjb2xvcjogcGFsZXR0ZS5kYXJrR3JheSB9fT5cbiAgICAgICAgICAgICAgICAgICAgQWxsIEdvb2dsZSBDYWxlbmRhcnNcbiAgICAgICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgICAgICAgIDxTd2l0Y2gxXG4gICAgICAgICAgICAgICAgICAgICAgICBvblZhbHVlQ2hhbmdlPXt1cGRhdGVBbGxDYWxlbmRhcnN9XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtlbmFibGVBbGxDYWxlbmRhcnN9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgIDxCb3ggc3R5bGU9e3sgd2lkdGg6ICc5MCUnIH19IGZsZXg9ezN9IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgPEZsYXRMaXN0XG4gICAgICAgICAgICAgICAgc3R5bGU9e3sgZmxleDogMSB9fVxuICAgICAgICAgICAgICAgIGRhdGE9e2VuYWJsZWRDYWxlbmRhcnN9XG4gICAgICAgICAgICAgICAga2V5RXh0cmFjdG9yPXtpdGVtID0+IGl0ZW0uaWR9XG4gICAgICAgICAgICAgICAgcmVuZGVySXRlbT17cmVuZGVySXRlbX1cbiAgICAgICAgICAgICAgICBleHRyYURhdGE9e2Ake2VuYWJsZWRDYWxlbmRhcnMubWFwKGkgPT4gaT8uaWQpfWB9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICA8Qm94IGZsZXg9ezF9IG10PVwibVwiPlxuICAgICAgICAgICAgICAgIDxQcmVzc2FibGUgb25QcmVzcz17Y2xvc2VHb29nbGVDYWxlbmRhckxpc3R9PlxuICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwiYnV0dG9uTGlua1wiIHRleHRBbGlnbj1cImNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgQ29uZmlybSBDYWxlbmRhciBTZWxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICAgIDwvUHJlc3NhYmxlPlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgIDwvQm94PlxuICAgIClcbn1cblxuZnVuY3Rpb24gVXNlckVuYWJsZUludGVncmF0aW9ucyhwcm9wczogUHJvcHMpIHtcbiAgICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSlcbiAgICBjb25zdCBbaXNXYXJuaW5nLCBzZXRJc1dhcm5pbmddID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpXG4gICAgY29uc3QgW3NlbGVjdGVkSW5kZXgsIHNldFNlbGVjdGVkSW5kZXhdID0gdXNlU3RhdGU8bnVtYmVyPigtMSlcbiAgICBjb25zdCBbc2VsZWN0ZWRJZCwgc2V0U2VsZWN0ZWRJZF0gPSB1c2VTdGF0ZTxzdHJpbmc+KClcbiAgICBjb25zdCBbc2VsZWN0ZWRWYWx1ZSwgc2V0U2VsZWN0ZWRWYWx1ZV0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSlcbiAgICBjb25zdCBbaXNHb29nbGVDYWxlbmRhckxpc3QsIHNldElzR29vZ2xlQ2FsZW5kYXJMaXN0XSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKSAvLyBJbml0aWFsIHN0YXRlIGlzIGZhbHNlXG4gICAgY29uc3QgW2dvb2dsZVRva2VuLCBzZXRHb29nbGVUb2tlbl0gPSB1c2VTdGF0ZTxzdHJpbmc+KClcblxuICAgIGNvbnN0IGdvb2dsZUNhbGVuZGFyRWxlbWVudCA9IHVzZVJlZjxhbnk+KClcblxuICAgIC8vIGNvbnN0IGRhcmsgPSB1c2VDb2xvclNjaGVtZSgpID09PSAnZGFyaydcbiAgICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKVxuICAgIGNvbnN0IHsgc3ViOiB1c2VySWQgfSA9IHByb3BzXG4gICAgY29uc3QgY2xpZW50ID0gcHJvcHM/LmNsaWVudFxuXG4gICAgY29uc3QgdG9hc3QgPSB1c2VUb2FzdCgpXG4gICBcblxuICAgIGNvbnN0IHsgbG9hZGluZzogZ29vZ2xlSW50ZWdyYXRpb25Mb2FkaW5nLCBlcnJvcjogZ29vZ2xlSW50ZWdyYXRpb25FcnJvciwgZGF0YTogZ29vZ2xlSW50ZWdyYXRpb25EYXRhLCByZWZldGNoOiBnb29nbGVJbnRSZWZldGNoIH0gPSB1c2VRdWVyeTx7IENhbGVuZGFyX0ludGVncmF0aW9uOiBDYWxlbmRhckludGVncmF0aW9uVHlwZVtdIH0+KGdldENhbGVuZGFySW50ZWdyYXRpb25CeVJlc291cmNlQW5kTmFtZSwge1xuICAgICAgICB2YXJpYWJsZXM6IHtcbiAgICAgICAgICAgIG5hbWU6IGdvb2dsZUNhbGVuZGFyTmFtZSxcbiAgICAgICAgICAgIHJlc291cmNlOiBnb29nbGVSZXNvdXJjZU5hbWUsXG4gICAgICAgICAgICB1c2VySWQ6IHVzZXJJZCxcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICBjb25zdCB7IGxvYWRpbmc6IGludGVncmF0aW9uTG9hZGluZywgZXJyb3I6IGludGVncmF0aW9uRXJyb3IsIGRhdGE6IGludGVncmF0aW9uRGF0YSwgcmVmZXRjaCB9ID0gdXNlUXVlcnk8eyBDYWxlbmRhcl9JbnRlZ3JhdGlvbjogQ2FsZW5kYXJJbnRlZ3JhdGlvblR5cGVbXSB9PihsaXN0Q2FsZW5kYXJJbnRlZ3JhdGlvbnMsIHtcbiAgICAgICAgdmFyaWFibGVzOiB7XG4gICAgICAgICAgICB1c2VySWQ6IHVzZXJJZCxcbiAgICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgY29uc3QgZ29vZ2xlQ2FsZW5kYXJFbmFibGVkID0gZ29vZ2xlSW50ZWdyYXRpb25EYXRhPy5DYWxlbmRhcl9JbnRlZ3JhdGlvbj8uWzBdPy5lbmFibGVkXG4gICAgXG4gICAgY29uc3QgaW50ZWdyYXRpb25zID0gaW50ZWdyYXRpb25EYXRhPy5DYWxlbmRhcl9JbnRlZ3JhdGlvblxuXG4gICAgLy8gQXV0b21hdGljYWxseSBkaXNwbGF5IGNhbGVuZGFyIGxpc3Qgd2hlbiBHb29nbGUgQ2FsZW5kYXIgaXMgZW5hYmxlZCBhbmQgdG9rZW4gaXMgYXZhaWxhYmxlXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKGdvb2dsZUNhbGVuZGFyRW5hYmxlZCAmJiBnb29nbGVUb2tlbikge1xuICAgICAgICAgICAgc2V0SXNHb29nbGVDYWxlbmRhckxpc3QodHJ1ZSlcbiAgICAgICAgfVxuICAgIH0sIFtnb29nbGVDYWxlbmRhckVuYWJsZWQsIGdvb2dsZVRva2VuXSlcblxuICAgIC8vICBqdXN0IGluIGNhc2Ugb2xkSW50ZWdyYXRpb25zIGFyZSBub3QgbG9hZGVkXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmICghKGludGVncmF0aW9ucz8ubGVuZ3RoID4gMCkpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCByZWZldGNoKClcbiAgICAgICAgICAgICAgICBhd2FpdCBnb29nbGVJbnRSZWZldGNoKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKVxuICAgIH0sIFtnb29nbGVJbnRSZWZldGNoLCBpbnRlZ3JhdGlvbnM/Lmxlbmd0aCwgcmVmZXRjaF0pXG5cbiAgIFxuICAgIFxuICAgIGNvbnN0IGRpc2FibGVHb29nbGVDYWxlbmRhckNoZWNrQm94ID0gKCkgPT4ge1xuICAgICAgICBzZXRTZWxlY3RlZEluZGV4KC0xKVxuICAgICAgICBzZXRTZWxlY3RlZElkKCcnKVxuICAgICAgICBzZXRTZWxlY3RlZFZhbHVlKGZhbHNlKVxuICAgICAgICBzZXRJc1dhcm5pbmcoZmFsc2UpXG4gICAgICAgIGdvb2dsZUNhbGVuZGFyRWxlbWVudD8uY3VycmVudD8uZGlzYWJsZUVuYWJsZWQoKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBlbmFibGVHb29nbGVDYWxlbmRhckNoZWNrQm94ID0gYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIHNldElzV2FybmluZyhmYWxzZSlcbiAgICAgICAgLy8gY29uc3QgbmV3SW50ZWdyYXRpb25zID0gaW50ZWdyYXRpb25zXG4gICAgICAgIC8vIC5zbGljZSgwLCBzZWxlY3RlZEluZGV4KVxuICAgICAgICAvLyAuY29uY2F0KFt7IC4uLihpbnRlZ3JhdGlvbnM/LltzZWxlY3RlZEluZGV4XSksIGVuYWJsZWQ6IHNlbGVjdGVkVmFsdWUgfV0pXG4gICAgICAgIC8vIC5jb25jYXQoaW50ZWdyYXRpb25zLnNsaWNlKHNlbGVjdGVkSW5kZXggKyAxKSlcblxuICAgICAgICAvLyBzZXRJbnRlZ3JhdGlvbnMobmV3SW50ZWdyYXRpb25zKVxuXG4gICAgICAgIGF3YWl0IHN1Ym1pdEludGVncmF0aW9uKFxuICAgICAgICAgICAgc2VsZWN0ZWRJbmRleCxcbiAgICAgICAgICAgIHNlbGVjdGVkVmFsdWUsXG4gICAgICAgICAgICBzZWxlY3RlZElkLFxuICAgICAgICApXG4gICAgICAgIGF3YWl0IHJlZmV0Y2goKVxuICAgICAgICBhd2FpdCBnb29nbGVJbnRSZWZldGNoKClcbiAgICAgICAgc2V0U2VsZWN0ZWRJbmRleCgtMSlcbiAgICAgICAgc2V0U2VsZWN0ZWRJZCgnJylcbiAgICAgICAgc2V0U2VsZWN0ZWRWYWx1ZShmYWxzZSlcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHNldElzV2FybmluZyhmYWxzZSlcbiAgICAgICAgY29uc29sZS5sb2coZSwgJyB0aGlzIGlzIGVycm9yIGZvciBlbmFibGUgZ29vZ2xlIGNhbGVuZGFyIGNoZWNrYm94JylcbiAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICAgICAgdGl0bGU6ICdFcnJvcicsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1NvbWV0aGluZyB3ZW50IHdyb25nJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiA5MDAwLFxuICAgICAgICAgICAgaXNDbG9zYWJsZTogdHJ1ZSxcbiAgICAgICAgfSlcbiAgICB9XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHVwZGF0ZUVuYWJsZWRWYWx1ZSA9IGFzeW5jIChpbmRleDogbnVtYmVyLCB2YWx1ZTogYm9vbGVhbiwgaWQ6IHN0cmluZykgPT4ge1xuICAgICAgICBjb25zdCBzZWxlY3RlZEludGVncmF0aW9uID0gaW50ZWdyYXRpb25zW2luZGV4XVxuICAgICAgICBpZiAoXG4gICAgICAgICAgICAoc2VsZWN0ZWRJbnRlZ3JhdGlvbi5uYW1lID09PSBnb29nbGVDYWxlbmRhck5hbWUpXG4gICAgICAgICAgICAmJiAodmFsdWUgPT09IGZhbHNlKVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHNldFNlbGVjdGVkSW5kZXgoaW5kZXgpXG4gICAgICAgICAgICBzZXRTZWxlY3RlZElkKGlkKVxuICAgICAgICAgICAgc2V0U2VsZWN0ZWRWYWx1ZSh2YWx1ZSlcbiAgICAgICAgICAgIHNldElzV2FybmluZyh0cnVlKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gY29uc3QgbmV3SW50ZWdyYXRpb25zID0gaW50ZWdyYXRpb25zXG4gICAgICAgICAgICAvLyAgICAgLnNsaWNlKDAsIGluZGV4KVxuICAgICAgICAgICAgLy8gICAgIC5jb25jYXQoW3sgLi4uKGludGVncmF0aW9ucz8uW2luZGV4XSksIGVuYWJsZWQ6IHZhbHVlIH1dKVxuICAgICAgICAgICAgLy8gICAgIC5jb25jYXQoaW50ZWdyYXRpb25zLnNsaWNlKGluZGV4ICsgMSkpXG5cbiAgICAgICAgICAgIC8vIHNldEludGVncmF0aW9ucyhuZXdJbnRlZ3JhdGlvbnMpXG5cbiAgICAgICAgICAgIGF3YWl0IHN1Ym1pdEludGVncmF0aW9uKFxuICAgICAgICAgICAgICAgIGluZGV4LFxuICAgICAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICBhd2FpdCByZWZldGNoKClcbiAgICAgICAgICAgIGF3YWl0IGdvb2dsZUludFJlZmV0Y2goKVxuICAgICAgICB9XG4gICAgXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGRpc2FibGVHb29nbGVDYWxlbmRhclN5bmMgPSBhc3luYyAoXG4gICAgICAgIGludGVncmF0aW9uSWQ6IHN0cmluZ1xuICAgICkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHVwZGF0ZUludGVncmF0aW9uKFxuICAgICAgICBjbGllbnQsXG4gICAgICAgIGludGVncmF0aW9uSWQsXG4gICAgICAgIGZhbHNlLFxuICAgICAgICBudWxsLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIG51bGwsXG4gICAgICAgIClcbiAgICAgICAgXG4gICAgICAgIGF3YWl0IGRlbGV0ZUV2ZW50VHJpZ2dlcnModXNlcklkLCBnb29nbGVSZXNvdXJjZU5hbWUsIGdvb2dsZUNhbGVuZGFyTmFtZSlcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGl0ZW1zVG9SZW1vdmUgPSBhd2FpdCBnZXRJdGVtc1RvUmVtb3ZlKGNsaWVudCwgdXNlcklkLCBnb29nbGVSZXNvdXJjZU5hbWUpXG4gICAgICAgIFxuICAgICAgICBhd2FpdCBidWxrUmVtb3ZlQ2FsZW5kYXJzSW5EYihjbGllbnQsIGl0ZW1zVG9SZW1vdmUubWFwKGkgPT4gKGk/LmlkKSkpXG5cbiAgICAgICAgLy8gYnVsayByZW1vdmUgZXZlbnRzIGZyb20gZGJcbiAgICAgICAgY29uc3QgZXZlbnRzVG9SZW1vdmVQcm9taXNlID0gW11cblxuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXNUb1JlbW92ZSkge1xuICAgICAgICBpZiAoaXRlbT8uaWQpIHtcbiAgICAgICAgICAgIGV2ZW50c1RvUmVtb3ZlUHJvbWlzZS5wdXNoKFxuICAgICAgICAgICAgZGVsZXRlRXZlbnRzQnlDYWxlbmRhcklkKGNsaWVudCwgaXRlbS5pZClcbiAgICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoZXZlbnRzVG9SZW1vdmVQcm9taXNlKVxuICAgICAgICBcbiAgICAgICAgYXdhaXQgcmVmZXRjaCgpXG4gICAgICAgIGF3YWl0IGdvb2dsZUludFJlZmV0Y2goKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSwgJyB0aGlzIGlzIGUgZm9yIGRpc2FibGUgZ29vZ2xlIGNhbGVuZGFyc3luYycpXG4gICAgICAgIGF3YWl0IHJlZmV0Y2goKVxuICAgICAgICBhd2FpdCBnb29nbGVJbnRSZWZldGNoKClcbiAgICB9XG4gICAgfVxuXG5cbiAgICBjb25zdCBkaXNhYmxlWm9vbUF1dGggPSBhc3luYyAoXG4gICAgICAgIGludGVncmF0aW9uSWQ6IHN0cmluZyxcbiAgICApID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZUludGVncmF0aW9uKFxuICAgICAgICAgICAgICAgIGNsaWVudCxcbiAgICAgICAgICAgICAgICBpbnRlZ3JhdGlvbklkLFxuICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgKVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlLCAnIHVuYWJsZSB0byBkaXNhYmxlIHpvb20gYXV0aCcpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBkaXNhYmxlR29vZ2xlQ29udGFjdFN5bmMgPSBhc3luYyAoXG4gICAgICAgIGludGVncmF0aW9uSWQ6IHN0cmluZyxcbiAgICApID0+IHtcbiAgICB0cnkge1xuICAgICAgICBhd2FpdCB1cGRhdGVJbnRlZ3JhdGlvbihcbiAgICAgICAgICAgIGNsaWVudCxcbiAgICAgICAgICAgIGludGVncmF0aW9uSWQsXG4gICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgIG51bGwsXG4gICAgICAgIClcbiAgICAgICAgLy8gZGVsZXRlIGV2ZW50IHRyaWdnZXJzXG4gICAgICAgIGF3YWl0IGRlbGV0ZUV2ZW50VHJpZ2dlckJ5UmVzb3VyY2VJZChpbnRlZ3JhdGlvbklkKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSwgJyBlcnJvciBpbiBkaXNhYmxlR29vZ2xlQ29udGFjdFN5bmMnKVxuICAgIH1cbiAgICB9XG4gICAgXG4gICAgXG4gICAgXG4gICAgY29uc3Qgc3VibWl0SW50ZWdyYXRpb24gPSBhc3luYyAoaW5kZXg6IG51bWJlciwgbmV3RW5hYmxlZDogYm9vbGVhbiwgaWQ6IHN0cmluZykgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKG5ld0VuYWJsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAvLyBkZWxldGUgdHJpZ2dlcnNcbiAgICAgICAgICAgIGlmIChpbnRlZ3JhdGlvbnM/LltpbmRleF0/Lm5hbWUgPT09IGdvb2dsZVBlb3BsZU5hbWUpIHtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkaXNhYmxlR29vZ2xlQ29udGFjdFN5bmMoaW50ZWdyYXRpb25zPy5baW5kZXhdPy5pZClcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW50ZWdyYXRpb25zPy5baW5kZXhdPy5uYW1lID09PSBnb29nbGVDYWxlbmRhck5hbWUpIHtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkaXNhYmxlR29vZ2xlQ2FsZW5kYXJTeW5jKGludGVncmF0aW9ucz8uW2luZGV4XT8uaWQpXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGludGVncmF0aW9ucz8uW2luZGV4XT8ucmVzb3VyY2UgPT09IHpvb21SZXNvdXJjZU5hbWUpIHtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiBkaXNhYmxlWm9vbUF1dGgoaW50ZWdyYXRpb25zPy5baW5kZXhdPy5pZClcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVJbnRlZ3JhdGlvbihcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50LFxuICAgICAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICAgICAgbmV3RW5hYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGludGVncmF0aW9ucz8uW2luZGV4XT8ucmVzb3VyY2UgPT09IGdvb2dsZVJlc291cmNlTmFtZSA/ICdhdG9taWMtd2ViJyA6ICd3ZWInLFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGludGVncmF0aW9ucz8uW2luZGV4XT8ubmFtZSwgJyBpbnRlZ3JhdGlvbnM/LltpbmRleF0/Lm5hbWUgaW5zaWRlIHN1Ym1pdEludGVncmF0aW9uJylcblxuICAgICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUsICcgdW5hYmxlIHRvIHN1Ym1pdCBpbnRlZ3JhdGlvbnMnKVxuICAgICAgICAgICAgc2V0TG9hZGluZyhmYWxzZSlcbiAgICAgICAgICAgIHRvYXN0KHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdVbmFibGUgdG8gc3VibWl0IGludGVncmF0aW9uJyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1BsZWFzZSB0cnkgYWdhaW4nLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA5MDAwLFxuICAgICAgICAgICAgICAgIGlzQ2xvc2FibGU6IHRydWUsXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbmF2aWdhdGVUb0dvb2dsZUNhbGVuZGFycyA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0FjY2Vzc1Rva2VuID0gYXdhaXQgZ2V0R29vZ2xlVG9rZW4oY2xpZW50LCB1c2VySWQpXG5cbiAgICAgICAgICAgIC8vIHJldHVybiBuYXZpZ2F0aW9uLm5hdmlnYXRlKCdVc2VyVmlld0dvb2dsZUNhbGVuZGFyTGlzdCcsIHsgdG9rZW46IG5ld0FjY2Vzc1Rva2VuIH0pXG4gICAgICAgICAgICBzZXRHb29nbGVUb2tlbihuZXdBY2Nlc3NUb2tlbilcbiAgICAgICAgICAgIHJldHVybiBzZXRJc0dvb2dsZUNhbGVuZGFyTGlzdCh0cnVlKVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlLCAnIHVuYWJsZSB0byBuYXZpZ2F0ZSB0byBnb29nbGUgY2FsZW5kYXJzJylcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgY29uc3QgcmVuZGVySXRlbTIgPSAoeyBpdGVtLCBpbmRleCB9OiBSZW5kZXJJdGVtVHlwZTIpID0+IHtcbiAgICBpZiAoKGl0ZW0/LnJlc291cmNlID09PSB6b29tUmVzb3VyY2VOYW1lKSAmJiAhaXRlbT8uZW5hYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8Qm94IGZsZXg9ezF9IG10PXt7IHBob25lOiAncycsIHRhYmxldDogJ20nIH19IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPXt6b29tT0F1dGhTdGFydFVybH0gcmVsPVwibm9vcGVuZXIgbm9yZWZlcnJlclwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxCb3ggZmxleD17MX0gZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwic3BhY2UtYmV0d2VlblwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPEJveCBtcj17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCIgc3R5bGU9e3sgY29sb3I6IHBhbGV0dGUuZGFya0dyYXkgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpdGVtPy5uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxCb3ggbWw9e3sgcGhvbmU6ICdzJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXRlbT8uZW5hYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPk9uPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPk9mZjwvVGV4dD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJidG4gYnRuLWxpbmsgbm8tdW5kZXJsaW5lIGhvdmVyOm5vLXVuZGVybGluZVwiPkVuYWJsZSBab29tPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICApXG4gICAgfVxuXG4gICAgaWYgKChpdGVtPy5yZXNvdXJjZSA9PT0gem9vbVJlc291cmNlTmFtZSkgJiYgaXRlbT8uZW5hYmxlZCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPEJveCBmbGV4PXsxfT5cblxuICAgICAgICAgICAgICAgICAgICA8SW50ZWdyYXRpb25DaGVja0JveFxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRW5hYmxlZFZhbHVlPXt1cGRhdGVFbmFibGVkVmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleD17aW5kZXh9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkPXtpdGVtPy5lbmFibGVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17aXRlbT8ubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ9e2l0ZW0/LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICA8L0JveD5cbiAgICAgICAgKVxuICAgIH1cblxuICAgIGlmICgoaXRlbT8ucmVzb3VyY2UgPT09IGdvb2dsZVJlc291cmNlTmFtZSkgJiYgIWl0ZW0/LmVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxCb3ggZmxleD17MX0+XG4gICAgICAgICAgICAgICAgPGEgdGFyZ2V0PVwiX2JsYW5rXCIgaHJlZj17Z29vZ2xlT0F1dGhTdGFydFVybH0gcmVsPVwibm9vcGVuZXIgbm9yZWZlcnJlclwiPlxuICAgICAgICAgICAgICAgICAgICA8SW50ZWdyYXRpb25DaGVja0JveFxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRW5hYmxlZFZhbHVlPXt1cGRhdGVFbmFibGVkVmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleD17aW5kZXh9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkPXtpdGVtPy5lbmFibGVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17aXRlbT8ubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ9e2l0ZW0/LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXtnb29nbGVDYWxlbmRhckVsZW1lbnR9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgIClcbiAgICB9XG5cbiAgICBpZiAoKGl0ZW0/LnJlc291cmNlID09PSBnb29nbGVSZXNvdXJjZU5hbWUpICYmIGl0ZW0/LmVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxCb3ggZmxleD17MX0+XG5cbiAgICAgICAgICAgICAgICA8SW50ZWdyYXRpb25DaGVja0JveFxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVFbmFibGVkVmFsdWU9e3VwZGF0ZUVuYWJsZWRWYWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAgICAgICBlbmFibGVkPXtpdGVtPy5lbmFibGVkfVxuICAgICAgICAgICAgICAgICAgICBuYW1lPXtpdGVtPy5uYW1lfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWQ9e2l0ZW0/LmlkfVxuICAgICAgICAgICAgICAgICAgICByZWY9e2dvb2dsZUNhbGVuZGFyRWxlbWVudH1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgIClcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPEJveCBmbGV4PXsxfT5cbiAgICAgICAgPEludGVncmF0aW9uQ2hlY2tCb3hcbiAgICAgICAgICB1cGRhdGVFbmFibGVkVmFsdWU9e3VwZGF0ZUVuYWJsZWRWYWx1ZX1cbiAgICAgICAgICBpbmRleD17aW5kZXh9XG4gICAgICAgICAgZW5hYmxlZD17aXRlbT8uZW5hYmxlZH1cbiAgICAgICAgICBuYW1lPXtpdGVtPy5uYW1lfVxuICAgICAgICAgIFxuICAgICAgICAgIGlkPXtpdGVtPy5pZH1cbiAgICAgICAgICAvPlxuICAgICAgPC9Cb3g+XG4gICAgKVxuICB9XG5cbiAgICBpZiAobG9hZGluZyB8fCBpbnRlZ3JhdGlvbkxvYWRpbmcgfHwgZ29vZ2xlSW50ZWdyYXRpb25Mb2FkaW5nKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8Qm94IGZsZXg9ezF9IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiIHN0eWxlPXt7IHdpZHRoOiAnMTAwJSd9fSBiYWNrZ3JvdW5kQ29sb3I9XCJsaWdodFJlZ3VsYXJDYXJkQmFja2dyb3VuZFwiPlxuICAgICAgICAgICAgICAgIDxBY3Rpdml0eUluZGljYXRvciBzaXplPVwibGFyZ2VcIiBjb2xvcj17cGFsZXR0ZS53aGl0ZX0gLz5cbiAgICAgICAgICAgIDwvQm94PlxuICAgICAgICApXG4gICAgfVxuXG4gICAgaWYgKGlzR29vZ2xlQ2FsZW5kYXJMaXN0KXtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxVc2VyVmlld0dvb2dsZUNhbGVuZGFyTGlzdCBcbiAgICAgICAgICAgICAgICBjbGllbnQ9e2NsaWVudH0gXG4gICAgICAgICAgICAgICAgdG9rZW49e2dvb2dsZVRva2VufSBcbiAgICAgICAgICAgICAgICBzdWI9e3VzZXJJZH0gXG4gICAgICAgICAgICAgICAgc2V0UGFyZW50SXNHb29nbGVDYWxlbmRhckxpc3Q9e3NldElzR29vZ2xlQ2FsZW5kYXJMaXN0fSBcblxuICAgICAgICAgICAgLz5cbiAgICAgICAgKVxuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICAgIDxCb3gganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgbWluSGVpZ2h0PVwiNzB2aFwiPlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGludGVncmF0aW9ucz8ubGVuZ3RoID4gMFxuICAgICAgICAgICAgICA/IChcbiAgICAgICAgICAgICAgICA8Qm94IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiIG1pbkhlaWdodD1cIjcwdmhcIj5cbiAgICAgICAgICAgICAgICAgICAgPEJveCBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxGbGF0TGlzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE9e2ludGVncmF0aW9uc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlFeHRyYWN0b3I9e2l0ZW0gPT4gaXRlbS5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJJdGVtPXtyZW5kZXJJdGVtMn1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgICAge2dvb2dsZUNhbGVuZGFyRW5hYmxlZFxuICAgICAgICAgICAgICAgICAgICA/IChcbiAgICAgICAgICAgICAgICAgICAgey8qIFwiVmlldyBHb29nbGUgQ2FsZW5kYXJzXCIgYnV0dG9uIGlzIGhpZGRlbiBpZiBsaXN0IGlzIGFscmVhZHkgc2hvd24gb3Igd2lsbCBiZSBzaG93biBhdXRvbWF0aWNhbGx5ICovfVxuICAgICAgICAgICAgICAgICAgICB7IChnb29nbGVDYWxlbmRhckVuYWJsZWQgJiYgIWlzR29vZ2xlQ2FsZW5kYXJMaXN0ICYmICFnb29nbGVUb2tlbikgJiYgLy8gU2hvdyBidXR0b24gb25seSBpZiBlbmFibGVkIGJ1dCBsaXN0IG5vdCB5ZXQgc2hvd24gKGUuZy4gdG9rZW4gZmV0Y2ggaW4gcHJvZ3Jlc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICA8Qm94IHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxQcmVzc2FibGUgb25QcmVzcz17bmF2aWdhdGVUb0dvb2dsZUNhbGVuZGFyc30+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cImJ1dHRvbkxpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlldyBHb29nbGUgQ2FsZW5kYXJzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvUHJlc3NhYmxlPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgeyAoZ29vZ2xlQ2FsZW5kYXJFbmFibGVkICYmIGdvb2dsZVRva2VuICYmICFpc0dvb2dsZUNhbGVuZGFyTGlzdCkgJiYgLy8gQ2FzZSB3aGVyZSB0b2tlbiBpcyBmZXRjaGVkIGJ1dCB1c2VFZmZlY3QgZm9yIGF1dG8tc2hvdyBoYXNuJ3QgcnVuIHlldCBvciB1c2VyIGNsb3NlZCBpdC5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxCb3ggcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0ganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFByZXNzYWJsZSBvblByZXNzPXtuYXZpZ2F0ZVRvR29vZ2xlQ2FsZW5kYXJzfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0IHZhcmlhbnQ9XCJidXR0b25MaW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hbmFnZSBHb29nbGUgQ2FsZW5kYXJzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9QcmVzc2FibGU+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB7ICFnb29nbGVDYWxlbmRhckVuYWJsZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCAvLyBObyBidXR0b24gaWYgR29vZ2xlIENhbGVuZGFyIGlzIG5vdCBlbmFibGVkXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICA8Qm94IGZsZXg9ezF9IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgICAgIDxUZXh0IHZhcmlhbnQ9XCJzdWJoZWFkZXJcIiBzdHlsZT17eyBjb2xvcjogcGFsZXR0ZS5kYXJrR3JheSB9fT5cbiAgICAgICAgICAgICAgICAgIFN0aWxsIGxvYWRpbmcgLi4uXG4gICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgIClcbiAgICAgICAgICB9XG4gICAgICAgICAgPEJveD5cbiAgICAgICAgICAgIDxPdmVybGF5IGlzVmlzaWJsZT17aXNXYXJuaW5nfSBvbkJhY2tkcm9wUHJlc3M9e2Rpc2FibGVHb29nbGVDYWxlbmRhckNoZWNrQm94fSBvdmVybGF5U3R5bGU9e3sgYmFja2dyb3VuZENvbG9yOiBwYWxldHRlLndoaXRlIH19PlxuICAgICAgICAgICAgICAgIDxCb3gganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgc3R5bGU9e3sgd2lkdGg6ICc4MCUnLCBiYWNrZ3JvdW5kQ29sb3I6IHBhbGV0dGUud2hpdGUgfX0+XG4gICAgICAgICAgICAgICAgICAgIDxCb3ggcD17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fSBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0IHZhcmlhbnQ9XCJvcHRpb25IZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIERpc2FibGluZyBHb29nbGUgQ2FsZW5kYXIgd2lsbCBkZWxldGUgYWxsIGdvb2dsZSByZWxhdGVkIGV2ZW50cyBmcm9tIHlvdXIgY2FsZW5kYXJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgIDxCb3gganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxCb3ggcD17eyBwaG9uZTogJ3MnLCB0YWJsZXQ6ICdtJyB9fSBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17ZW5hYmxlR29vZ2xlQ2FsZW5kYXJDaGVja0JveH0+XG4gICAgICAgICAgICAgICAgICAgICAgICBPa2F5XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj4gXG4gICAgICAgICAgICAgICAgICAgIDwvQm94PlxuXG4gICAgICAgICAgICAgICAgICAgIDxCdXR0b24gZGlzYWJsZWQgb25DbGljaz17ZGlzYWJsZUdvb2dsZUNhbGVuZGFyQ2hlY2tCb3h9PlxuICAgICAgICAgICAgICAgICAgICBDYW5jZWxcbiAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+ICAgXG4gICAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgPC9PdmVybGF5PlxuICAgICAgICAgIDwvQm94PlxuICAgICAgICA8L0JveD5cbiAgICAgICk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVzZXJFbmFibGVJbnRlZ3JhdGlvbnNcblxuXG5cblxuXG5cbiJdfQ==