"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getServerSideProps = getServerSideProps;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_native_1 = require("react-native");
const Switch_1 = __importDefault(require("@components/Switch"));
const themed_1 = require("@rneui/themed");
const Fab_1 = __importDefault(require("@mui/material/Fab"));
const Add_1 = __importDefault(require("@mui/icons-material/Add"));
const styles_1 = require("@mui/material/styles");
const Zoom_1 = __importDefault(require("@mui/material/Zoom"));
const TextField_1 = __importDefault(require("@components/TextField"));
const Box_1 = __importDefault(require("@components/common/Box"));
const Text_1 = __importDefault(require("@components/common/Text"));
const Button_1 = __importDefault(require("@components/Button"));
const RegularCard_1 = __importDefault(require("@components/RegularCard"));
const react_2 = require("@chakra-ui/react");
const io_1 = require("react-icons/io");
const theme_1 = require("@lib/theme/theme");
const ContactHelper_1 = require("@lib/Contact/ContactHelper");
const lodash_1 = __importDefault(require("lodash"));
const date_utils_1 = require("@lib/date-utils");
const user_context_1 = require("@lib/user-context");
const colors_1 = require("@mui/material/colors");
const supertokens_node_1 = __importDefault(require("supertokens-node"));
const backendConfig_1 = require("../../config/backendConfig");
const session_1 = __importDefault(require("supertokens-node/recipe/session"));
async function getServerSideProps({ req, res }) {
    // Notice how the server uses `API` from `withSSRContext`, instead of the top-level `API`.
    // const SSR = withSSRContext({ req })
    // this runs on the backend, so we must call init on supertokens-node SDK
    supertokens_node_1.default.init((0, backendConfig_1.backendConfig)());
    let session;
    try {
        session = await session_1.default.getSession(req, res, {
            overrideGlobalClaimValidators: async function () {
                return [];
            },
        });
    }
    catch (err) {
        if (err.type === session_1.default.Error.TRY_REFRESH_TOKEN) {
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        else if (err.type === session_1.default.Error.UNAUTHORISED) {
            // this will force the frontend to try and refresh which will fail
            // clearing all cookies and redirecting the user to the login screen.
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        throw err;
    }
    if (!session?.getUserId()) {
        return {
            redirect: {
                destination: '/User/Login/UserLogin',
                permanent: false,
            },
        };
    }
    return {
        props: {
            sub: session.getUserId(),
        }
    };
}
const fabStyle = {
    position: 'absolute',
    bottom: 16,
    right: 16,
};
const typeOptions = [
    { label: 'Email', value: 'email' },
    { label: 'Phone', value: 'phone' }
];
function InfoItem(props) {
    const [id, setId] = (0, react_1.useState)(props?.item?.id);
    const [name, setName] = (0, react_1.useState)(props?.item?.name);
    const [type, setType] = (0, react_1.useState)(props?.item?.type);
    const [primary, setPrimary] = (0, react_1.useState)(props?.item?.primary);
    (0, react_1.useEffect)(() => {
        if (id !== props?.item?.id) {
            if (props?.item?.id) {
                setId(props?.item?.id);
            }
        }
    }, [id, props?.item?.id]);
    (0, react_1.useEffect)(() => {
        if (name !== props?.item?.name) {
            if (props?.item?.name) {
                setName(props?.item?.name);
            }
        }
    }, [name, props?.item?.name]);
    const changeId = (value) => {
        setId(value);
    };
    const onEndChangeId = () => (0, ContactHelper_1.updateInfoItemIdValue)(props?.item, props?.index, id, props?.infoItems, props?.setInfoItems);
    const changeName = (value) => {
        setName(value);
    };
    const onEndChangeName = () => (0, ContactHelper_1.updateInfoItemNameValue)(props?.item, props?.index, name, props?.infoItems, props?.setInfoItems);
    const changeType = (value) => {
        setType(value);
        (0, ContactHelper_1.updateInfoItemTypeValue)(props?.item, props?.index, value, props?.infoItems, props?.setInfoItems);
    };
    const changePrimary = (value) => {
        setPrimary(value);
        (0, ContactHelper_1.updateInfoItemPrimaryValue)(props?.item, props?.index, value, props?.infoItems, props?.setInfoItems);
    };
    const removeItem = async () => {
        const newInfoItems = (0, ContactHelper_1.removeInfoItemToItems)(props?.index, props?.infoItems, props?.setInfoItems);
        await props?.submitItemsWithNewItem(newInfoItems);
    };
    return ((0, jsx_runtime_1.jsxs)(RegularCard_1.default, { children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, pt: { phone: 'm', tablet: 's' }, flexDirection: "row", justifyContent: "flex-start", alignItems: "center", style: { width: '60%' }, children: (0, jsx_runtime_1.jsx)(TextField_1.default, { label: "Email or Phone", placeholder: "r@r.r", onChange: (e) => changeId(e?.target?.value), value: id, style: { width: '100%' }, type: "email", onBlur: onEndChangeId }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, pt: { phone: 'm', tablet: 's' }, flexDirection: "row", justifyContent: "flex-start", alignItems: "center", style: { width: '60%' }, children: (0, jsx_runtime_1.jsx)(TextField_1.default, { label: "Name", placeholder: "John Doe", onChange: (e) => changeName(e?.target?.value), value: name, style: { width: '100%' }, onBlur: onEndChangeName }) }), (0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, pt: { phone: 'm', tablet: 's' }, justifyContent: "center", alignItems: "center", children: [(0, jsx_runtime_1.jsx)(Text_1.default, { pt: { phone: 'm', tablet: 's' }, variant: "optionHeader", children: "Is this a phone or email?" }), (0, jsx_runtime_1.jsxs)("select", { value: type, onChange: (e) => changeType(e?.target?.value), className: "select select-primary w-full max-w-xs", children: [(0, jsx_runtime_1.jsx)("option", { disabled: true, selected: true, children: "Send updates to..." }), lodash_1.default.map(typeOptions, option => ((0, jsx_runtime_1.jsx)("option", { value: option.value, children: option.label }, option.value)))] })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, style: { width: '90%' }, children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", pt: { phone: 'm', tablet: 's' }, style: { width: '100%' }, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "Is this your primary? (Also used for Zoom)" }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", style: { width: '90%' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { checked: primary, onValueChange: changePrimary, style: { marginBottom: 20 } }) })] }), (0, jsx_runtime_1.jsx)(Box_1.default, { alignItems: "flex-end", style: { width: '100%' }, children: (0, jsx_runtime_1.jsx)(Box_1.default, { mr: { phone: 'm', tablet: 'l' }, children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { hitSlop: 15, onPress: removeItem, children: (0, jsx_runtime_1.jsx)(io_1.IoIosTrash, { size: "3em", color: theme_1.palette.red }) }) }) })] }));
}
function ListUserContactInfo() {
    const [infoItems, setInfoItems] = (0, react_1.useState)();
    const [oldInfoItems, setOldInfoItems] = (0, react_1.useState)();
    const [newId, setNewId] = (0, react_1.useState)('');
    const [newName, setNewName] = (0, react_1.useState)('');
    const [newType, setNewType] = (0, react_1.useState)('email');
    const [isNewItem, setIsNewItem] = (0, react_1.useState)(false);
    const [pageOffset, setPageOffset] = (0, react_1.useState)(0);
    const { height: fullHeight } = react_native_1.Dimensions.get('window');
    const { sub, client } = (0, user_context_1.useAppContext)();
    const theme = (0, styles_1.useTheme)();
    const toast = (0, react_2.useToast)();
    const transitionDuration = {
        enter: theme.transitions.duration.enteringScreen,
        exit: theme.transitions.duration.leavingScreen,
    };
    const userId = sub;
    // list old info items
    (0, react_1.useEffect)(() => {
        (async () => {
            try {
                const oldDbInfoItems = await (0, ContactHelper_1.listUserContactInfosGivenUserId)(client, userId);
                if (oldDbInfoItems?.length > 0) {
                    setInfoItems(oldDbInfoItems);
                    setOldInfoItems(oldDbInfoItems);
                }
            }
            catch (e) {
                console.log(e, ' unable to list user contact info items');
            }
        })();
    }, [client, userId]);
    const addNewEntry = () => {
        showNewItem();
    };
    const onSubmitNewEntry = async () => {
        const newInfoItem = {
            id: newId,
            name: newName,
            type: newType,
            userId,
            primary: false,
            updatedAt: (0, date_utils_1.dayjs)().format(),
            createdDate: (0, date_utils_1.dayjs)().format(),
        };
        const newInfoItems = infoItems.concat(newInfoItem);
        console.log(newInfoItems?.map(c => (lodash_1.default.omit(c, ['__typename']))), ' newInfoItems');
        (0, ContactHelper_1.addInfoItemToItems)(newInfoItem, infoItems, setInfoItems);
        hideNewItem();
        await submitItemsWithNewItem(newInfoItems);
    };
    const showNewItem = () => setIsNewItem(true);
    const hideNewItem = () => setIsNewItem(false);
    const onCancelEntry = () => {
        setNewId('');
        setNewName('');
        setNewType('email');
        hideNewItem();
    };
    const submitItemsWithNewItem = async (newInfoItems) => {
        try {
            if (!lodash_1.default.isEqual(oldInfoItems, newInfoItems)) {
                const itemIdsToDelete = oldInfoItems
                    ?.filter(o => !lodash_1.default.isEqual(o, newInfoItems?.find(i => (i?.id == o?.id))))
                    ?.map(o => (o?.id));
                if (itemIdsToDelete?.length > 0) {
                    await (0, ContactHelper_1.deleteContactInfoItems)(client, itemIdsToDelete);
                }
                if (newInfoItems?.length > 0) {
                    await (0, ContactHelper_1.upsertContactInfoItems)(client, newInfoItems);
                    setOldInfoItems(newInfoItems);
                    toast({
                        status: 'success',
                        title: 'Success!',
                        description: 'Successfully updated your contact info items',
                        duration: 9000,
                        isClosable: true,
                    });
                }
            }
        }
        catch (e) {
            console.log(e, ' unable to submit items inside list user contact info');
            toast({
                status: 'error',
                title: 'Oops...',
                description: 'Something went wrong with updating your contact infos. Let us know.',
                duration: 9000,
                isClosable: true,
            });
        }
    };
    const submitItems = async () => {
        try {
            if (!lodash_1.default.isEqual(oldInfoItems, infoItems)) {
                const itemIdsToDelete = oldInfoItems?.map(o => (o?.id));
                if (itemIdsToDelete?.length > 0) {
                    await (0, ContactHelper_1.deleteContactInfoItems)(client, itemIdsToDelete);
                }
                if (infoItems?.length > 0) {
                    await (0, ContactHelper_1.upsertContactInfoItems)(client, infoItems);
                    setOldInfoItems(infoItems);
                    toast({
                        status: 'success',
                        title: 'Success!',
                        description: 'Successfully updated your contact info items',
                        duration: 9000,
                        isClosable: true,
                    });
                }
            }
        }
        catch (e) {
            console.log(e, ' unable to submit items inside list user contact info');
            toast({
                status: 'error',
                title: 'Oops...',
                description: 'Something went wrong with updating your contact infos. Let us know.',
                duration: 9000,
                isClosable: true,
            });
        }
    };
    return ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, style: { width: '100%' }, children: (0, jsx_runtime_1.jsxs)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", style: { width: '100%' }, children: [(0, jsx_runtime_1.jsx)(Text_1.default, { variant: "subheaderNormal", textAlign: "center", pt: { phone: 'm', tablet: 's' }, children: "Your Contact Info to verify future meeting invites" }), infoItems?.length > 0
                    ? ((0, jsx_runtime_1.jsx)(react_native_1.FlatList, { data: infoItems, renderItem: ({ item, index }) => ((0, jsx_runtime_1.jsx)(InfoItem, { item: item, index: index, infoItems: infoItems, setInfoItems: setInfoItems, removeInfoItemToItems: ContactHelper_1.removeInfoItemToItems, submitItemsWithNewItem: submitItemsWithNewItem })) })) : ((0, jsx_runtime_1.jsx)(Box_1.default, { flex: 1, justifyContent: "center", alignItems: "center", p: { phone: 'l', tablet: 'm' }, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "subheaderNormal", children: "Add atleast 1 Contact entry to verify against for future meeting invites with Atomic" }) })), (0, jsx_runtime_1.jsx)(Zoom_1.default, { in: true, timeout: transitionDuration, style: {
                        transitionDelay: `${transitionDuration.exit}ms`,
                    }, unmountOnExit: true, children: (0, jsx_runtime_1.jsx)(Fab_1.default, { sx: fabStyle, "aria-label": 'Add', color: "primary", onClick: addNewEntry, children: (0, jsx_runtime_1.jsx)(Add_1.default, { sx: { color: colors_1.pink[500] } }) }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { children: (0, jsx_runtime_1.jsx)(themed_1.Overlay, { overlayStyle: { backgroundColor: theme_1.palette.white, justifyContent: 'center', alignItems: 'center' }, isVisible: isNewItem, onBackdropPress: onCancelEntry, children: (0, jsx_runtime_1.jsxs)(Box_1.default, { justifyContent: "center", alignItems: "center", style: { width: '90%', backgroundColor: theme_1.palette.white }, children: [(0, jsx_runtime_1.jsxs)(RegularCard_1.default, { children: [(0, jsx_runtime_1.jsx)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", children: "New Contact Info" }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, flexDirection: "row", justifyContent: "flex-start", alignItems: "center", style: { width: '90%' }, children: (0, jsx_runtime_1.jsx)(TextField_1.default, { label: "Email or Phone", placeholder: "r@r.r", onChange: (e) => setNewId(e?.target?.value), value: newId, style: { width: '100%' } }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, flexDirection: "row", justifyContent: "flex-start", alignItems: "center", style: { width: '90%' }, children: (0, jsx_runtime_1.jsx)(TextField_1.default, { label: "Name", placeholder: "John Doe", onChange: (e) => setNewName(e?.target?.value), value: newName, style: { width: '100%' } }) }), (0, jsx_runtime_1.jsxs)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, justifyContent: "center", alignItems: "center", children: [(0, jsx_runtime_1.jsx)(Text_1.default, { pt: { phone: 'm', tablet: 's' }, variant: "optionHeader", children: "Is this a phone or email?" }), (0, jsx_runtime_1.jsxs)("select", { value: newType, onChange: (e) => setNewType(e?.target?.value), className: "select select-primary w-full max-w-xs", children: [(0, jsx_runtime_1.jsx)("option", { disabled: true, selected: true, children: "Send updates to..." }), lodash_1.default.map(typeOptions, option => ((0, jsx_runtime_1.jsx)("option", { value: option.value, children: option.label }, option.value)))] })] })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { justifyContent: "center", alignItems: "center", children: [(0, jsx_runtime_1.jsx)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, justifyContent: "center", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { hitSlop: 15, onPress: onSubmitNewEntry, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", children: '+ Add Info' }) }) }), (0, jsx_runtime_1.jsx)(react_native_1.Pressable, { hitSlop: 15, onPress: onCancelEntry, children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "greyLink", children: "Cancel" }) })] })] }) }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Button_1.default, { onClick: submitItems, children: "Submit Info" }) })] }) }));
}
exports.default = ListUserContactInfo;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTGlzdFVzZXJDb250YWN0SW5mby5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkxpc3RVc2VyQ29udGFjdEluZm8udHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBeUNBLGdEQXFDQzs7QUE5RUQsaUNBS2M7QUFDZCwrQ0FJcUI7QUFFckIsZ0VBQXdDO0FBQ3hDLDBDQUVzQjtBQUN0Qiw0REFBb0M7QUFDcEMsa0VBQThDO0FBQzlDLGlEQUF3RDtBQUN4RCw4REFBcUM7QUFDckMsc0VBQTZDO0FBQzdDLGlFQUF3QztBQUN4QyxtRUFBMEM7QUFDMUMsZ0VBQXVDO0FBQ3ZDLDBFQUFpRDtBQUNqRCw0Q0FBMkM7QUFDM0MsdUNBQTRDO0FBQzVDLDRDQUEwQztBQUUxQyw4REFBNFE7QUFDNVEsb0RBQXNCO0FBQ3RCLGdEQUF1QztBQUN2QyxvREFBaUQ7QUFHakQsaURBQTJDO0FBRTNDLHdFQUE4QztBQUM5Qyw4REFBMEQ7QUFDMUQsOEVBQXFEO0FBRTlDLEtBQUssVUFBVSxrQkFBa0IsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQWlEO0lBQ2xHLDBGQUEwRjtJQUMxRixzQ0FBc0M7SUFDdEMseUVBQXlFO0lBQ3pFLDBCQUFlLENBQUMsSUFBSSxDQUFDLElBQUEsNkJBQWEsR0FBRSxDQUFDLENBQUE7SUFDckMsSUFBSSxPQUFPLENBQUE7SUFDWCxJQUFJLENBQUM7UUFDSCxPQUFPLEdBQUcsTUFBTSxpQkFBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFO1lBQzNDLDZCQUE2QixFQUFFLEtBQUs7Z0JBQ2xDLE9BQU8sRUFBRSxDQUFBO1lBQ1gsQ0FBQztTQUNGLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFBQyxPQUFPLEdBQVEsRUFBRSxDQUFDO1FBQ2xCLElBQUksR0FBRyxDQUFDLElBQUksS0FBSyxpQkFBTyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1lBQ2pELE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBRSxlQUFlLEVBQUUsZUFBZSxFQUFFLEVBQUUsQ0FBQTtRQUN4RCxDQUFDO2FBQU0sSUFBSSxHQUFHLENBQUMsSUFBSSxLQUFLLGlCQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ25ELGtFQUFrRTtZQUNsRSxxRUFBcUU7WUFDckUsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQUUsRUFBRSxDQUFBO1FBQ3hELENBQUM7UUFDRCxNQUFNLEdBQUcsQ0FBQTtJQUNYLENBQUM7SUFFRCxJQUFJLENBQUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxFQUFFLENBQUM7UUFDMUIsT0FBTztZQUNMLFFBQVEsRUFBRTtnQkFDUixXQUFXLEVBQUUsdUJBQXVCO2dCQUNwQyxTQUFTLEVBQUUsS0FBSzthQUNqQjtTQUNGLENBQUE7SUFDSCxDQUFDO0lBRUQsT0FBTztRQUNMLEtBQUssRUFBRTtZQUNMLEdBQUcsRUFBRSxPQUFPLENBQUMsU0FBUyxFQUFFO1NBQ3pCO0tBQ0YsQ0FBQTtBQUNILENBQUM7QUFFRCxNQUFNLFFBQVEsR0FBRztJQUNmLFFBQVEsRUFBRSxVQUFVO0lBQ3BCLE1BQU0sRUFBRSxFQUFFO0lBQ1YsS0FBSyxFQUFFLEVBQUU7Q0FDVixDQUFBO0FBaUJELE1BQU0sV0FBVyxHQUFHO0lBQ2hCLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFO0lBQ2xDLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFDO0NBQ3BDLENBQUE7QUFFRCxTQUFTLFFBQVEsQ0FBQyxLQUFtQjtJQUNqQyxNQUFNLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBUyxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFBO0lBQ3JELE1BQU0sQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFTLEtBQUssRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUE7SUFDM0QsTUFBTSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQW9CLEtBQUssRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUE7SUFDdEUsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQVUsS0FBSyxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQTtJQUlyRSxJQUFBLGlCQUFTLEVBQUMsR0FBRyxFQUFFO1FBQ1gsSUFBSSxFQUFFLEtBQUssS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsQ0FBQztZQUN6QixJQUFJLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLENBQUM7Z0JBQ2xCLEtBQUssQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFBO1lBQzFCLENBQUM7UUFDTCxDQUFDO0lBQ0wsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQTtJQUV6QixJQUFBLGlCQUFTLEVBQUMsR0FBRyxFQUFFO1FBQ1gsSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQztZQUM3QixJQUFJLEtBQUssRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUM7Z0JBQ3BCLE9BQU8sQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFBO1lBQzlCLENBQUM7UUFDTCxDQUFDO0lBQ0wsQ0FBQyxFQUFFLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQTtJQUU3QixNQUFNLFFBQVEsR0FBRyxDQUFDLEtBQWEsRUFBRSxFQUFFO1FBQy9CLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUNoQixDQUFDLENBQUE7SUFFRCxNQUFNLGFBQWEsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFBLHFDQUFxQixFQUN6QyxLQUFLLEVBQUUsSUFBSSxFQUNYLEtBQUssRUFBRSxLQUFLLEVBQ1osRUFBRSxFQUNGLEtBQUssRUFBRSxTQUFTLEVBQ2hCLEtBQUssRUFBRSxZQUFZLENBQ3RCLENBQUE7SUFFTCxNQUFNLFVBQVUsR0FBRyxDQUFDLEtBQWEsRUFBRSxFQUFFO1FBQ2pDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUVsQixDQUFDLENBQUE7SUFFRCxNQUFNLGVBQWUsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFBLHVDQUF1QixFQUM3QyxLQUFLLEVBQUUsSUFBSSxFQUNYLEtBQUssRUFBRSxLQUFLLEVBQ1osSUFBSSxFQUNKLEtBQUssRUFBRSxTQUFTLEVBQ2hCLEtBQUssRUFBRSxZQUFZLENBQ3RCLENBQUE7SUFFTCxNQUFNLFVBQVUsR0FBRyxDQUFDLEtBQXdCLEVBQUUsRUFBRTtRQUM1QyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDZCxJQUFBLHVDQUF1QixFQUNuQixLQUFLLEVBQUUsSUFBSSxFQUNYLEtBQUssRUFBRSxLQUFLLEVBQ1osS0FBSyxFQUNMLEtBQUssRUFBRSxTQUFTLEVBQ2hCLEtBQUssRUFBRSxZQUFZLENBQ3RCLENBQUE7SUFDTCxDQUFDLENBQUE7SUFFRCxNQUFNLGFBQWEsR0FBRyxDQUFDLEtBQWMsRUFBRSxFQUFFO1FBQ3JDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUNqQixJQUFBLDBDQUEwQixFQUN0QixLQUFLLEVBQUUsSUFBSSxFQUNYLEtBQUssRUFBRSxLQUFLLEVBQ1osS0FBSyxFQUNMLEtBQUssRUFBRSxTQUFTLEVBQ2hCLEtBQUssRUFBRSxZQUFZLENBQ3RCLENBQUE7SUFDTCxDQUFDLENBQUE7SUFFRCxNQUFNLFVBQVUsR0FBRyxLQUFLLElBQUksRUFBRTtRQUMxQixNQUFNLFlBQVksR0FBRyxJQUFBLHFDQUFxQixFQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsWUFBWSxDQUFDLENBQUE7UUFDL0YsTUFBTSxLQUFLLEVBQUUsc0JBQXNCLENBQUMsWUFBWSxDQUFDLENBQUE7SUFDckQsQ0FBQyxDQUFBO0lBRUQsT0FBTyxDQUVILHdCQUFDLHFCQUFXLGVBQ1IsdUJBQUMsYUFBRyxJQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEVBQUUsYUFBYSxFQUFDLEtBQUssRUFBQyxjQUFjLEVBQUMsWUFBWSxFQUFDLFVBQVUsRUFBQyxRQUFRLEVBQUMsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBQyxZQUNySSx1QkFBQyxtQkFBUyxJQUNWLEtBQUssRUFBQyxnQkFBZ0IsRUFDdEIsV0FBVyxFQUFDLE9BQU8sRUFDbkIsUUFBUSxFQUFFLENBQUMsQ0FBZ0MsRUFBRSxFQUFFLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxDQUFDLEVBQzFFLEtBQUssRUFBRSxFQUFFLEVBQ1QsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUN4QixJQUFJLEVBQUMsT0FBTyxFQUVaLE1BQU0sRUFBRSxhQUFhLEdBQ3ZCLEdBQ0EsRUFDTix1QkFBQyxhQUFHLElBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsRUFBRSxhQUFhLEVBQUMsS0FBSyxFQUFDLGNBQWMsRUFBQyxZQUFZLEVBQUMsVUFBVSxFQUFDLFFBQVEsRUFBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFDLFlBQ3JJLHVCQUFDLG1CQUFTLElBQ04sS0FBSyxFQUFDLE1BQU0sRUFDWixXQUFXLEVBQUMsVUFBVSxFQUN0QixRQUFRLEVBQUUsQ0FBQyxDQUFnQyxFQUFFLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUMsRUFDNUUsS0FBSyxFQUFFLElBQUksRUFDWCxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFDLEVBQ3ZCLE1BQU0sRUFBRSxlQUFlLEdBQ3pCLEdBQ0EsRUFDTix3QkFBQyxhQUFHLElBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsRUFBRSxjQUFjLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBQyxRQUFRLGFBQ3RGLHVCQUFDLGNBQUksSUFBQyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsRUFBRSxPQUFPLEVBQUMsY0FBYywwQ0FFdEQsRUFDUCxvQ0FBUSxLQUFLLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsVUFBVSxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBMEIsQ0FBQyxFQUFFLFNBQVMsRUFBQyx1Q0FBdUMsYUFDdEksbUNBQVEsUUFBUSxRQUFDLFFBQVEseUNBQTRCLEVBQ3BELGdCQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLENBQzFCLG1DQUVJLEtBQUssRUFBRSxNQUFNLENBQUMsS0FBSyxZQUNyQixNQUFNLENBQUMsS0FBSyxJQUZMLE1BQU0sQ0FBQyxLQUFLLENBRUcsQ0FDdkIsQ0FBQyxJQUNELElBRVAsRUFDTix3QkFBQyxhQUFHLElBQUMsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxhQUN6RCx1QkFBQyxhQUFHLElBQUMsYUFBYSxFQUFDLEtBQUssRUFBQyxjQUFjLEVBQUMsWUFBWSxFQUFDLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFDMUcsdUJBQUMsY0FBSSxJQUFDLE9BQU8sRUFBQyxjQUFjLDJEQUVyQixHQUNMLEVBQ04sdUJBQUMsYUFBRyxJQUFDLGFBQWEsRUFBQyxLQUFLLEVBQUMsY0FBYyxFQUFDLFVBQVUsRUFBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFlBQ3RFLHVCQUFDLGdCQUFPLElBQ0osT0FBTyxFQUFFLE9BQU8sRUFDaEIsYUFBYSxFQUFFLGFBQWEsRUFDNUIsS0FBSyxFQUFFLEVBQUMsWUFBWSxFQUFFLEVBQUUsRUFBQyxHQUMzQixHQUNBLElBQ0osRUFDTix1QkFBQyxhQUFHLElBQUMsVUFBVSxFQUFDLFVBQVUsRUFBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFDLFlBQzlDLHVCQUFDLGFBQUcsSUFBQyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsWUFDaEMsdUJBQUMsd0JBQVMsSUFBQyxPQUFPLEVBQUUsRUFBRSxFQUFFLE9BQU8sRUFBRSxVQUFVLFlBQ3ZDLHVCQUFDLGVBQVUsSUFBQyxJQUFJLEVBQUMsS0FBSyxFQUFDLEtBQUssRUFBRSxlQUFPLENBQUMsR0FBRyxHQUFJLEdBQ3JDLEdBQ1YsR0FDSixJQUNRLENBRWpCLENBQUE7QUFDTCxDQUFDO0FBSUQsU0FBUyxtQkFBbUI7SUFDeEIsTUFBTSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsR0FBRyxJQUFBLGdCQUFRLEdBQXlCLENBQUE7SUFDbkUsTUFBTSxDQUFDLFlBQVksRUFBRSxlQUFlLENBQUMsR0FBRyxJQUFBLGdCQUFRLEdBQXlCLENBQUE7SUFDekUsTUFBTSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQVMsRUFBRSxDQUFDLENBQUE7SUFDOUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQVMsRUFBRSxDQUFDLENBQUE7SUFDbEQsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQW9CLE9BQU8sQ0FBQyxDQUFBO0lBQ2xFLE1BQU0sQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFVLEtBQUssQ0FBQyxDQUFBO0lBQzFELE1BQU0sQ0FBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFTLENBQUMsQ0FBQyxDQUFBO0lBRXZELE1BQU0sRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLEdBQUcseUJBQVUsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUE7SUFFdkQsTUFBTSxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxJQUFBLDRCQUFhLEdBQUUsQ0FBQTtJQUV2QyxNQUFNLEtBQUssR0FBRyxJQUFBLGlCQUFRLEdBQUUsQ0FBQTtJQUN4QixNQUFNLEtBQUssR0FBRyxJQUFBLGdCQUFRLEdBQUUsQ0FBQTtJQUUxQixNQUFNLGtCQUFrQixHQUFHO1FBQ3pCLEtBQUssRUFBRSxLQUFLLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxjQUFjO1FBQ2hELElBQUksRUFBRSxLQUFLLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxhQUFhO0tBQy9DLENBQUE7SUFFQyxNQUFNLE1BQU0sR0FBRyxHQUFHLENBQUE7SUFFbEIsc0JBQXNCO0lBQ3RCLElBQUEsaUJBQVMsRUFBQyxHQUFHLEVBQUU7UUFDWCxDQUFDLEtBQUssSUFBSSxFQUFFO1lBQ1IsSUFBSSxDQUFDO2dCQUNELE1BQU0sY0FBYyxHQUFHLE1BQU0sSUFBQSwrQ0FBK0IsRUFBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUE7Z0JBQzVFLElBQUksY0FBYyxFQUFFLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztvQkFDN0IsWUFBWSxDQUFDLGNBQWMsQ0FBQyxDQUFBO29CQUM1QixlQUFlLENBQUMsY0FBYyxDQUFDLENBQUE7Z0JBQ25DLENBQUM7WUFDTCxDQUFDO1lBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztnQkFDVCxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSx5Q0FBeUMsQ0FBQyxDQUFBO1lBQzdELENBQUM7UUFDTCxDQUFDLENBQUMsRUFBRSxDQUFBO0lBQ1IsQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUE7SUFHcEIsTUFBTSxXQUFXLEdBQUcsR0FBRyxFQUFFO1FBQ3JCLFdBQVcsRUFBRSxDQUFBO0lBQ2pCLENBQUMsQ0FBQTtJQUVELE1BQU0sZ0JBQWdCLEdBQUcsS0FBSyxJQUFJLEVBQUU7UUFFaEMsTUFBTSxXQUFXLEdBQXdCO1lBQ3JDLEVBQUUsRUFBRSxLQUFLO1lBQ1QsSUFBSSxFQUFFLE9BQU87WUFDYixJQUFJLEVBQUUsT0FBTztZQUNiLE1BQU07WUFDTixPQUFPLEVBQUUsS0FBSztZQUNkLFNBQVMsRUFBRSxJQUFBLGtCQUFLLEdBQUUsQ0FBQyxNQUFNLEVBQUU7WUFDM0IsV0FBVyxFQUFFLElBQUEsa0JBQUssR0FBRSxDQUFDLE1BQU0sRUFBRTtTQUNoQyxDQUFBO1FBRUQsTUFBTSxZQUFZLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQTtRQUVsRCxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLGdCQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLGVBQWUsQ0FBQyxDQUFBO1FBRWpGLElBQUEsa0NBQWtCLEVBQ2QsV0FBVyxFQUNYLFNBQVMsRUFDVCxZQUFZLENBQ2YsQ0FBQTtRQUVELFdBQVcsRUFBRSxDQUFBO1FBRWIsTUFBTSxzQkFBc0IsQ0FBQyxZQUFZLENBQUMsQ0FBQTtJQUM5QyxDQUFDLENBQUE7SUFFRCxNQUFNLFdBQVcsR0FBRyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUE7SUFFNUMsTUFBTSxXQUFXLEdBQUcsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFBO0lBRTdDLE1BQU0sYUFBYSxHQUFHLEdBQUcsRUFBRTtRQUN2QixRQUFRLENBQUMsRUFBRSxDQUFDLENBQUE7UUFDWixVQUFVLENBQUMsRUFBRSxDQUFDLENBQUE7UUFDZCxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUE7UUFDbkIsV0FBVyxFQUFFLENBQUE7SUFDakIsQ0FBQyxDQUFBO0lBRUQsTUFBTSxzQkFBc0IsR0FBRyxLQUFLLEVBQUUsWUFBbUMsRUFBRSxFQUFFO1FBQ3pFLElBQUksQ0FBQztZQUNELElBQUksQ0FBQyxnQkFBQyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsWUFBWSxDQUFDLEVBQUUsQ0FBQztnQkFDekMsTUFBTSxlQUFlLEdBQUcsWUFBWTtvQkFDaEMsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLGdCQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ3ZFLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQTtnQkFFdkIsSUFBSSxlQUFlLEVBQUUsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO29CQUM5QixNQUFNLElBQUEsc0NBQXNCLEVBQ3hCLE1BQU0sRUFDTixlQUFlLENBQ2xCLENBQUE7Z0JBQ0wsQ0FBQztnQkFFRCxJQUFJLFlBQVksRUFBRSxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7b0JBRTNCLE1BQU0sSUFBQSxzQ0FBc0IsRUFDeEIsTUFBTSxFQUNOLFlBQVksQ0FDZixDQUFBO29CQUVELGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQTtvQkFFN0IsS0FBSyxDQUFDO3dCQUNGLE1BQU0sRUFBRSxTQUFTO3dCQUNqQixLQUFLLEVBQUUsVUFBVTt3QkFDakIsV0FBVyxFQUFFLDhDQUE4Qzt3QkFDM0QsUUFBUSxFQUFFLElBQUk7d0JBQ2QsVUFBVSxFQUFFLElBQUk7cUJBQ25CLENBQUMsQ0FBQTtnQkFDTixDQUFDO1lBQ0wsQ0FBQztRQUVMLENBQUM7UUFBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1lBQ1QsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsdURBQXVELENBQUMsQ0FBQTtZQUN2RSxLQUFLLENBQUM7Z0JBQ0YsTUFBTSxFQUFFLE9BQU87Z0JBQ2YsS0FBSyxFQUFFLFNBQVM7Z0JBQ2hCLFdBQVcsRUFBRSxxRUFBcUU7Z0JBQ2xGLFFBQVEsRUFBRSxJQUFJO2dCQUNkLFVBQVUsRUFBRSxJQUFJO2FBQ25CLENBQUMsQ0FBQTtRQUNOLENBQUM7SUFDTCxDQUFDLENBQUE7SUFFRCxNQUFNLFdBQVcsR0FBRyxLQUFLLElBQUksRUFBRTtRQUMzQixJQUFJLENBQUM7WUFDRCxJQUFJLENBQUMsZ0JBQUMsQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLFNBQVMsQ0FBQyxFQUFFLENBQUM7Z0JBQ3RDLE1BQU0sZUFBZSxHQUFHLFlBQVksRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFBO2dCQUV2RCxJQUFJLGVBQWUsRUFBRSxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7b0JBQzlCLE1BQU0sSUFBQSxzQ0FBc0IsRUFDeEIsTUFBTSxFQUNOLGVBQWUsQ0FDbEIsQ0FBQTtnQkFDTCxDQUFDO2dCQUVELElBQUksU0FBUyxFQUFFLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztvQkFDeEIsTUFBTSxJQUFBLHNDQUFzQixFQUN4QixNQUFNLEVBQ04sU0FBUyxDQUNaLENBQUE7b0JBRUQsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFBO29CQUUxQixLQUFLLENBQUM7d0JBQ0YsTUFBTSxFQUFFLFNBQVM7d0JBQ2pCLEtBQUssRUFBRSxVQUFVO3dCQUNqQixXQUFXLEVBQUUsOENBQThDO3dCQUMzRCxRQUFRLEVBQUUsSUFBSTt3QkFDZCxVQUFVLEVBQUUsSUFBSTtxQkFDbkIsQ0FBQyxDQUFBO2dCQUNOLENBQUM7WUFDTCxDQUFDO1FBRUwsQ0FBQztRQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7WUFDVCxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSx1REFBdUQsQ0FBQyxDQUFBO1lBQ3ZFLEtBQUssQ0FBQztnQkFDRixNQUFNLEVBQUUsT0FBTztnQkFDZixLQUFLLEVBQUUsU0FBUztnQkFDaEIsV0FBVyxFQUFFLHFFQUFxRTtnQkFDbEYsUUFBUSxFQUFFLElBQUk7Z0JBQ2QsVUFBVSxFQUFFLElBQUk7YUFDbkIsQ0FBQyxDQUFBO1FBQ04sQ0FBQztJQUNMLENBQUMsQ0FBQTtJQUVELE9BQU8sQ0FDSCx1QkFBQyxhQUFHLElBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQ2xDLHdCQUFDLGFBQUcsSUFBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLGNBQWMsRUFBQyxRQUFRLEVBQUMsVUFBVSxFQUFDLFFBQVEsRUFBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLGFBQzlFLHVCQUFDLGNBQUksSUFBQyxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsU0FBUyxFQUFDLFFBQVEsRUFBQyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsbUVBRTNFLEVBRUgsU0FBUyxFQUFFLE1BQU0sR0FBRyxDQUFDO29CQUNyQixDQUFDLENBQUMsQ0FDRSx1QkFBQyx1QkFBUSxJQUNMLElBQUksRUFBRSxTQUFTLEVBQ2YsVUFBVSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQzdCLHVCQUFDLFFBQVEsSUFDTCxJQUFJLEVBQUUsSUFBSSxFQUNWLEtBQUssRUFBRSxLQUFLLEVBQ1osU0FBUyxFQUFFLFNBQVMsRUFDcEIsWUFBWSxFQUFFLFlBQVksRUFDMUIscUJBQXFCLEVBQUUscUNBQXFCLEVBQzVDLHNCQUFzQixFQUFFLHNCQUFzQixHQUNoRCxDQUNMLEdBQ0gsQ0FDTCxDQUFDLENBQUMsQ0FBQyxDQUNBLHVCQUFDLGFBQUcsSUFBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLGNBQWMsRUFBQyxRQUFRLEVBQUMsVUFBVSxFQUFDLFFBQVEsRUFBQyxDQUFDLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsWUFDcEYsdUJBQUMsY0FBSSxJQUFDLE9BQU8sRUFBQyxpQkFBaUIscUdBRXhCLEdBQ0wsQ0FDVCxFQUdHLHVCQUFDLGNBQUksSUFDTCxFQUFFLFFBQ0YsT0FBTyxFQUFFLGtCQUFrQixFQUMzQixLQUFLLEVBQUU7d0JBQ0gsZUFBZSxFQUFFLEdBQUcsa0JBQWtCLENBQUMsSUFBSSxJQUFJO3FCQUNsRCxFQUNELGFBQWEsa0JBRWIsdUJBQUMsYUFBRyxJQUFDLEVBQUUsRUFBRSxRQUFtQixnQkFBYyxLQUFLLEVBQUUsS0FBSyxFQUFDLFNBQVMsRUFBQyxPQUFPLEVBQUUsV0FBVyxZQUNqRix1QkFBQyxhQUFPLElBQUMsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLGFBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxHQUFJLEdBQ25DLEdBQ0MsRUFDZix1QkFBQyxhQUFHLGNBQ0EsdUJBQUMsZ0JBQU8sSUFBQyxZQUFZLEVBQUUsRUFBRSxlQUFlLEVBQUUsZUFBTyxDQUFDLEtBQUssRUFBRSxjQUFjLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLGVBQWUsRUFBRSxhQUFhLFlBQzNKLHdCQUFDLGFBQUcsSUFBQyxjQUFjLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBQyxRQUFRLEVBQUMsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxlQUFlLEVBQUUsZUFBTyxDQUFDLEtBQUssRUFBQyxhQUMvRix3QkFBQyxxQkFBVyxlQUNSLHVCQUFDLGFBQUcsSUFBQyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsRUFBRSxjQUFjLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBQyxRQUFRLFlBQzdFLHVCQUFDLGNBQUksSUFBQyxPQUFPLEVBQUMsY0FBYyxpQ0FFckIsR0FDTCxFQUNWLHVCQUFDLGFBQUcsSUFBQyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsRUFBRSxhQUFhLEVBQUMsS0FBSyxFQUFDLGNBQWMsRUFBQyxZQUFZLEVBQUMsVUFBVSxFQUFDLFFBQVEsRUFDckcsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxZQUNuQix1QkFBQyxtQkFBUyxJQUE2QixLQUFLLEVBQUMsZ0JBQWdCLEVBQW1DLFdBQVcsRUFBQyxPQUFPLEVBRW5ILFFBQVEsRUFBRSxDQUFDLENBQWdDLEVBQUUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQyxFQUMxRSxLQUFLLEVBQUUsS0FBSyxFQUNaLEtBQUssRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsR0FDdEIsR0FDQSxFQUNOLHVCQUFDLGFBQUcsSUFBQyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsRUFBRSxhQUFhLEVBQUMsS0FBSyxFQUFDLGNBQWMsRUFBQyxZQUFZLEVBQUMsVUFBVSxFQUFDLFFBQVEsRUFBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFDLFlBQzVILHVCQUFDLG1CQUFTLElBQ04sS0FBSyxFQUFDLE1BQU0sRUFDWixXQUFXLEVBQUMsVUFBVSxFQUN0QixRQUFRLEVBQUUsQ0FBQyxDQUFnQyxFQUFFLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUMsRUFDNUUsS0FBSyxFQUFFLE9BQU8sRUFDZCxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFDLEdBQ3pCLEdBQ0EsRUFDTix3QkFBQyxhQUFHLElBQUMsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEVBQUUsY0FBYyxFQUFDLFFBQVEsRUFBQyxVQUFVLEVBQUMsUUFBUSxhQUM3RSx1QkFBQyxjQUFJLElBQUMsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEVBQUUsT0FBTyxFQUFDLGNBQWMsMENBRXRELEVBQ1Asb0NBQVEsS0FBSyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEVBQUUsTUFBTSxFQUFFLEtBQTBCLENBQUMsRUFBRSxTQUFTLEVBQUMsdUNBQXVDLGFBQ3pJLG1DQUFRLFFBQVEsUUFBQyxRQUFRLHlDQUE0QixFQUNwRCxnQkFBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUMxQixtQ0FFSSxLQUFLLEVBQUUsTUFBTSxDQUFDLEtBQUssWUFDckIsTUFBTSxDQUFDLEtBQUssSUFGTCxNQUFNLENBQUMsS0FBSyxDQUVHLENBQ3ZCLENBQUMsSUFDRCxJQUVQLElBQ0ksRUFDZCx3QkFBQyxhQUFHLElBQUMsY0FBYyxFQUFDLFFBQVEsRUFBQyxVQUFVLEVBQUMsUUFBUSxhQUM1Qyx1QkFBQyxhQUFHLElBQUMsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEVBQUUsY0FBYyxFQUFDLFFBQVEsRUFBQyxVQUFVLEVBQUMsUUFBUSxZQUM3RSx1QkFBQyx3QkFBUyxJQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLGdCQUFnQixZQUM3Qyx1QkFBQyxjQUFJLElBQUMsT0FBTyxFQUFDLFlBQVksWUFDckIsWUFBWSxHQUNWLEdBQ0MsR0FDVixFQUNOLHVCQUFDLHdCQUFTLElBQUMsT0FBTyxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsYUFBYSxZQUMxQyx1QkFBQyxjQUFJLElBQUMsT0FBTyxFQUFDLFVBQVUsdUJBRWpCLEdBQ0MsSUFDVixJQUNKLEdBRUosR0FDUixFQUNOLHVCQUFDLGFBQUcsSUFBQyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsWUFDaEMsdUJBQUMsZ0JBQU0sSUFBQyxPQUFPLEVBQUUsV0FBVyw0QkFFbkIsR0FDUCxJQUNKLEdBQ0osQ0FDVCxDQUFBO0FBQ0wsQ0FBQztBQUdELGtCQUFlLG1CQUFtQixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7XG4gICAgdXNlU3RhdGUsXG4gICAgdXNlRWZmZWN0LFxuICAgIERpc3BhdGNoLFxuICAgIFNldFN0YXRlQWN0aW9uLFxufSBmcm9tICdyZWFjdCdcbmltcG9ydCB7XG4gICAgRmxhdExpc3QsXG4gICAgUHJlc3NhYmxlLFxuICAgIERpbWVuc2lvbnMsXG59IGZyb20gJ3JlYWN0LW5hdGl2ZSdcblxuaW1wb3J0IFN3aXRjaDEgZnJvbSAnQGNvbXBvbmVudHMvU3dpdGNoJ1xuaW1wb3J0IHtcbiAgICBPdmVybGF5LFxufSBmcm9tICdAcm5ldWkvdGhlbWVkJ1xuaW1wb3J0IEZhYiBmcm9tICdAbXVpL21hdGVyaWFsL0ZhYic7XG5pbXBvcnQgQWRkSWNvbiBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsL0FkZCc7XG5pbXBvcnQgeyBTeFByb3BzLCB1c2VUaGVtZSB9IGZyb20gJ0BtdWkvbWF0ZXJpYWwvc3R5bGVzJ1xuaW1wb3J0IFpvb20gZnJvbSAnQG11aS9tYXRlcmlhbC9ab29tJ1xuaW1wb3J0IFRleHRGaWVsZCBmcm9tICdAY29tcG9uZW50cy9UZXh0RmllbGQnXG5pbXBvcnQgQm94IGZyb20gJ0Bjb21wb25lbnRzL2NvbW1vbi9Cb3gnXG5pbXBvcnQgVGV4dCBmcm9tICdAY29tcG9uZW50cy9jb21tb24vVGV4dCdcbmltcG9ydCBCdXR0b24gZnJvbSAnQGNvbXBvbmVudHMvQnV0dG9uJ1xuaW1wb3J0IFJlZ3VsYXJDYXJkIGZyb20gJ0Bjb21wb25lbnRzL1JlZ3VsYXJDYXJkJ1xuaW1wb3J0IHsgdXNlVG9hc3QgfSBmcm9tICdAY2hha3JhLXVpL3JlYWN0J1xuaW1wb3J0IHsgSW9Jb3NUcmFzaCB9IGZyb20gXCJyZWFjdC1pY29ucy9pb1wiO1xuaW1wb3J0IHsgcGFsZXR0ZSB9IGZyb20gJ0BsaWIvdGhlbWUvdGhlbWUnXG5pbXBvcnQgeyBVc2VyQ29udGFjdEluZm9UeXBlIH0gZnJvbSAnQGxpYi9kYXRhVHlwZXMvVXNlckNvbnRhY3RJbmZvVHlwZSdcbmltcG9ydCB7IGFkZEluZm9JdGVtVG9JdGVtcywgZGVsZXRlQ29udGFjdEluZm9JdGVtcywgbGlzdFVzZXJDb250YWN0SW5mb3NHaXZlblVzZXJJZCwgcmVtb3ZlSW5mb0l0ZW1Ub0l0ZW1zLCB1cGRhdGVJbmZvSXRlbUlkVmFsdWUsIHVwZGF0ZUluZm9JdGVtTmFtZVZhbHVlLCB1cGRhdGVJbmZvSXRlbVByaW1hcnlWYWx1ZSwgdXBkYXRlSW5mb0l0ZW1UeXBlVmFsdWUsIHVwc2VydENvbnRhY3RJbmZvSXRlbXMgfSBmcm9tICdAbGliL0NvbnRhY3QvQ29udGFjdEhlbHBlcidcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCB7IGRheWpzIH0gZnJvbSAnQGxpYi9kYXRlLXV0aWxzJ1xuaW1wb3J0IHsgdXNlQXBwQ29udGV4dCB9IGZyb20gJ0BsaWIvdXNlci1jb250ZXh0J1xuXG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcidcbmltcG9ydCB7IHBpbmsgfSBmcm9tICdAbXVpL21hdGVyaWFsL2NvbG9ycydcbmltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCBzdXBlcnRva2Vuc05vZGUgZnJvbSAnc3VwZXJ0b2tlbnMtbm9kZSdcbmltcG9ydCB7IGJhY2tlbmRDb25maWcgfSBmcm9tICcuLi8uLi9jb25maWcvYmFja2VuZENvbmZpZydcbmltcG9ydCBTZXNzaW9uIGZyb20gJ3N1cGVydG9rZW5zLW5vZGUvcmVjaXBlL3Nlc3Npb24nXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXJ2ZXJTaWRlUHJvcHMoeyByZXEsIHJlcyB9OiB7IHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlIH0pIHtcbiAgLy8gTm90aWNlIGhvdyB0aGUgc2VydmVyIHVzZXMgYEFQSWAgZnJvbSBgd2l0aFNTUkNvbnRleHRgLCBpbnN0ZWFkIG9mIHRoZSB0b3AtbGV2ZWwgYEFQSWAuXG4gIC8vIGNvbnN0IFNTUiA9IHdpdGhTU1JDb250ZXh0KHsgcmVxIH0pXG4gIC8vIHRoaXMgcnVucyBvbiB0aGUgYmFja2VuZCwgc28gd2UgbXVzdCBjYWxsIGluaXQgb24gc3VwZXJ0b2tlbnMtbm9kZSBTREtcbiAgc3VwZXJ0b2tlbnNOb2RlLmluaXQoYmFja2VuZENvbmZpZygpKVxuICBsZXQgc2Vzc2lvblxuICB0cnkge1xuICAgIHNlc3Npb24gPSBhd2FpdCBTZXNzaW9uLmdldFNlc3Npb24ocmVxLCByZXMsIHtcbiAgICAgIG92ZXJyaWRlR2xvYmFsQ2xhaW1WYWxpZGF0b3JzOiBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBbXVxuICAgICAgfSxcbiAgICB9KVxuICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgIGlmIChlcnIudHlwZSA9PT0gU2Vzc2lvbi5FcnJvci5UUllfUkVGUkVTSF9UT0tFTikge1xuICAgICAgcmV0dXJuIHsgcHJvcHM6IHsgZnJvbVN1cGVydG9rZW5zOiAnbmVlZHMtcmVmcmVzaCcgfSB9XG4gICAgfSBlbHNlIGlmIChlcnIudHlwZSA9PT0gU2Vzc2lvbi5FcnJvci5VTkFVVEhPUklTRUQpIHtcbiAgICAgIC8vIHRoaXMgd2lsbCBmb3JjZSB0aGUgZnJvbnRlbmQgdG8gdHJ5IGFuZCByZWZyZXNoIHdoaWNoIHdpbGwgZmFpbFxuICAgICAgLy8gY2xlYXJpbmcgYWxsIGNvb2tpZXMgYW5kIHJlZGlyZWN0aW5nIHRoZSB1c2VyIHRvIHRoZSBsb2dpbiBzY3JlZW4uXG4gICAgICByZXR1cm4geyBwcm9wczogeyBmcm9tU3VwZXJ0b2tlbnM6ICduZWVkcy1yZWZyZXNoJyB9IH1cbiAgICB9XG4gICAgdGhyb3cgZXJyXG4gIH1cblxuICBpZiAoIXNlc3Npb24/LmdldFVzZXJJZCgpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlZGlyZWN0OiB7XG4gICAgICAgIGRlc3RpbmF0aW9uOiAnL1VzZXIvTG9naW4vVXNlckxvZ2luJyxcbiAgICAgICAgcGVybWFuZW50OiBmYWxzZSxcbiAgICAgIH0sXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBwcm9wczoge1xuICAgICAgc3ViOiBzZXNzaW9uLmdldFVzZXJJZCgpLFxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBmYWJTdHlsZSA9IHtcbiAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gIGJvdHRvbTogMTYsXG4gIHJpZ2h0OiAxNixcbn1cblxuXG5cbnR5cGUgSW5mb0l0ZW1Qcm9wID0ge1xuICAgIGl0ZW06IFVzZXJDb250YWN0SW5mb1R5cGUsXG4gICAgaW5mb0l0ZW1zOiBVc2VyQ29udGFjdEluZm9UeXBlW10sXG4gICAgc2V0SW5mb0l0ZW1zOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxVc2VyQ29udGFjdEluZm9UeXBlW10+PixcbiAgICBpbmRleDogbnVtYmVyLFxuICAgIHJlbW92ZUluZm9JdGVtVG9JdGVtczogKFxuICAgICAgICBpbmRleDogbnVtYmVyLFxuICAgICAgICBpbmZvSXRlbXM6IFVzZXJDb250YWN0SW5mb1R5cGVbXSxcbiAgICAgICAgc2V0SW5mb0l0ZW1zOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxVc2VyQ29udGFjdEluZm9UeXBlW10+PixcbiAgICApID0+IFVzZXJDb250YWN0SW5mb1R5cGVbXSxcbiAgICBzdWJtaXRJdGVtc1dpdGhOZXdJdGVtOiAobmV3SW5mb0l0ZW1zOiBVc2VyQ29udGFjdEluZm9UeXBlW10pID0+IFByb21pc2U8dm9pZD4sXG59XG5cbmNvbnN0IHR5cGVPcHRpb25zID0gW1xuICAgIHsgbGFiZWw6ICdFbWFpbCcsIHZhbHVlOiAnZW1haWwnIH0sXG4gICAgeyBsYWJlbDogJ1Bob25lJywgdmFsdWU6ICdwaG9uZSd9XG5dXG5cbmZ1bmN0aW9uIEluZm9JdGVtKHByb3BzOiBJbmZvSXRlbVByb3ApIHtcbiAgICBjb25zdCBbaWQsIHNldElkXSA9IHVzZVN0YXRlPHN0cmluZz4ocHJvcHM/Lml0ZW0/LmlkKVxuICAgIGNvbnN0IFtuYW1lLCBzZXROYW1lXSA9IHVzZVN0YXRlPHN0cmluZz4ocHJvcHM/Lml0ZW0/Lm5hbWUpXG4gICAgY29uc3QgW3R5cGUsIHNldFR5cGVdID0gdXNlU3RhdGU8J2VtYWlsJyB8ICdwaG9uZSc+KHByb3BzPy5pdGVtPy50eXBlKVxuICAgIGNvbnN0IFtwcmltYXJ5LCBzZXRQcmltYXJ5XSA9IHVzZVN0YXRlPGJvb2xlYW4+KHByb3BzPy5pdGVtPy5wcmltYXJ5KVxuICAgIFxuXG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoaWQgIT09IHByb3BzPy5pdGVtPy5pZCkge1xuICAgICAgICAgICAgaWYgKHByb3BzPy5pdGVtPy5pZCkge1xuICAgICAgICAgICAgICAgIHNldElkKHByb3BzPy5pdGVtPy5pZClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIFtpZCwgcHJvcHM/Lml0ZW0/LmlkXSlcblxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChuYW1lICE9PSBwcm9wcz8uaXRlbT8ubmFtZSkge1xuICAgICAgICAgICAgaWYgKHByb3BzPy5pdGVtPy5uYW1lKSB7XG4gICAgICAgICAgICAgICAgc2V0TmFtZShwcm9wcz8uaXRlbT8ubmFtZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIFtuYW1lLCBwcm9wcz8uaXRlbT8ubmFtZV0pXG5cbiAgICBjb25zdCBjaGFuZ2VJZCA9ICh2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIHNldElkKHZhbHVlKVxuICAgIH1cblxuICAgIGNvbnN0IG9uRW5kQ2hhbmdlSWQgPSAoKSA9PiB1cGRhdGVJbmZvSXRlbUlkVmFsdWUoXG4gICAgICAgICAgICBwcm9wcz8uaXRlbSxcbiAgICAgICAgICAgIHByb3BzPy5pbmRleCxcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgcHJvcHM/LmluZm9JdGVtcyxcbiAgICAgICAgICAgIHByb3BzPy5zZXRJbmZvSXRlbXMsXG4gICAgICAgIClcblxuICAgIGNvbnN0IGNoYW5nZU5hbWUgPSAodmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgICBzZXROYW1lKHZhbHVlKVxuICAgICAgICBcbiAgICB9XG5cbiAgICBjb25zdCBvbkVuZENoYW5nZU5hbWUgPSAoKSA9PiB1cGRhdGVJbmZvSXRlbU5hbWVWYWx1ZShcbiAgICAgICAgICAgIHByb3BzPy5pdGVtLFxuICAgICAgICAgICAgcHJvcHM/LmluZGV4LFxuICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgIHByb3BzPy5pbmZvSXRlbXMsXG4gICAgICAgICAgICBwcm9wcz8uc2V0SW5mb0l0ZW1zLFxuICAgICAgICApXG5cbiAgICBjb25zdCBjaGFuZ2VUeXBlID0gKHZhbHVlOiAnZW1haWwnIHwgJ3Bob25lJykgPT4ge1xuICAgICAgICBzZXRUeXBlKHZhbHVlKVxuICAgICAgICB1cGRhdGVJbmZvSXRlbVR5cGVWYWx1ZShcbiAgICAgICAgICAgIHByb3BzPy5pdGVtLFxuICAgICAgICAgICAgcHJvcHM/LmluZGV4LFxuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICBwcm9wcz8uaW5mb0l0ZW1zLFxuICAgICAgICAgICAgcHJvcHM/LnNldEluZm9JdGVtcyxcbiAgICAgICAgKVxuICAgIH1cblxuICAgIGNvbnN0IGNoYW5nZVByaW1hcnkgPSAodmFsdWU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgc2V0UHJpbWFyeSh2YWx1ZSlcbiAgICAgICAgdXBkYXRlSW5mb0l0ZW1QcmltYXJ5VmFsdWUoXG4gICAgICAgICAgICBwcm9wcz8uaXRlbSxcbiAgICAgICAgICAgIHByb3BzPy5pbmRleCxcbiAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgcHJvcHM/LmluZm9JdGVtcyxcbiAgICAgICAgICAgIHByb3BzPy5zZXRJbmZvSXRlbXMsXG4gICAgICAgIClcbiAgICB9XG5cbiAgICBjb25zdCByZW1vdmVJdGVtID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBuZXdJbmZvSXRlbXMgPSByZW1vdmVJbmZvSXRlbVRvSXRlbXMocHJvcHM/LmluZGV4LCBwcm9wcz8uaW5mb0l0ZW1zLCBwcm9wcz8uc2V0SW5mb0l0ZW1zKVxuICAgICAgICBhd2FpdCBwcm9wcz8uc3VibWl0SXRlbXNXaXRoTmV3SXRlbShuZXdJbmZvSXRlbXMpXG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgICAgXG4gICAgICAgIDxSZWd1bGFyQ2FyZD5cbiAgICAgICAgICAgIDxCb3ggZmxleD17MX0gcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0gZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1zdGFydFwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIiBzdHlsZT17eyB3aWR0aDogJzYwJSd9fT5cbiAgICAgICAgICAgICAgICA8VGV4dEZpZWxkXG4gICAgICAgICAgICAgICAgbGFiZWw9XCJFbWFpbCBvciBQaG9uZVwiXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJyQHIuclwiXG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlOiB7IHRhcmdldDogeyB2YWx1ZTogc3RyaW5nIH0gfSkgPT4gY2hhbmdlSWQoZT8udGFyZ2V0Py52YWx1ZSl9XG4gICAgICAgICAgICAgICAgdmFsdWU9e2lkfVxuICAgICAgICAgICAgICAgIHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX1cbiAgICAgICAgICAgICAgICB0eXBlPVwiZW1haWxcIlxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIG9uQmx1cj17b25FbmRDaGFuZ2VJZH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgIDwvQm94PlxuICAgICAgICA8Qm94IGZsZXg9ezF9IHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgc3R5bGU9e3sgd2lkdGg6ICc2MCUnfX0+XG4gICAgICAgICAgICA8VGV4dEZpZWxkXG4gICAgICAgICAgICAgICAgbGFiZWw9XCJOYW1lXCJcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkpvaG4gRG9lXCJcbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGU6IHsgdGFyZ2V0OiB7IHZhbHVlOiBzdHJpbmcgfSB9KSA9PiBjaGFuZ2VOYW1lKGU/LnRhcmdldD8udmFsdWUpfVxuICAgICAgICAgICAgICAgIHZhbHVlPXtuYW1lfVxuICAgICAgICAgICAgICAgIHN0eWxlPXt7IHdpZHRoOiAnMTAwJSd9fVxuICAgICAgICAgICAgICAgIG9uQmx1cj17b25FbmRDaGFuZ2VOYW1lfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgPC9Cb3g+XG4gICAgICAgIDxCb3ggZmxleD17MX0gcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0ganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICA8VGV4dCBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fSB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgSXMgdGhpcyBhIHBob25lIG9yIGVtYWlsP1xuICAgICAgICAgICAgPC9UZXh0PiBcbiAgICAgICAgICAgIDxzZWxlY3QgdmFsdWU9e3R5cGV9IG9uQ2hhbmdlPXsoZSkgPT4gY2hhbmdlVHlwZShlPy50YXJnZXQ/LnZhbHVlIGFzICdlbWFpbCcgfCAncGhvbmUnKX0gY2xhc3NOYW1lPVwic2VsZWN0IHNlbGVjdC1wcmltYXJ5IHctZnVsbCBtYXgtdy14c1wiPlxuICAgICAgICAgICAgICAgIDxvcHRpb24gZGlzYWJsZWQgc2VsZWN0ZWQ+U2VuZCB1cGRhdGVzIHRvLi4uPC9vcHRpb24+XG4gICAgICAgICAgICAgICAge18ubWFwKHR5cGVPcHRpb25zLCBvcHRpb24gPT4gKFxuICAgICAgICAgICAgICAgICAgICA8b3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9e29wdGlvbi52YWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtvcHRpb24udmFsdWV9XG4gICAgICAgICAgICAgICAgICAgID57b3B0aW9uLmxhYmVsfTwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgIDwvc2VsZWN0PiAgIFxuICAgICAgICAgICAgXG4gICAgICAgIDwvQm94PlxuICAgICAgICA8Qm94IHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19IHN0eWxlPXt7IHdpZHRoOiAnOTAlJyB9fT5cbiAgICAgICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1zdGFydFwiIHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19IHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0+XG4gICAgICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICBJcyB0aGlzIHlvdXIgcHJpbWFyeT8gKEFsc28gdXNlZCBmb3IgWm9vbSlcbiAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1lbmRcIiBzdHlsZT17eyB3aWR0aDogJzkwJScgfX0+XG4gICAgICAgICAgICAgICAgPFN3aXRjaDFcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17cHJpbWFyeX1cbiAgICAgICAgICAgICAgICAgICAgb25WYWx1ZUNoYW5nZT17Y2hhbmdlUHJpbWFyeX1cbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5Cb3R0b206IDIwfX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgIDwvQm94PlxuICAgICAgICA8Qm94IGFsaWduSXRlbXM9XCJmbGV4LWVuZFwiIHN0eWxlPXt7IHdpZHRoOiAnMTAwJSd9fT5cbiAgICAgICAgICAgIDxCb3ggbXI9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAnbCcgfX0+XG4gICAgICAgICAgICAgICAgPFByZXNzYWJsZSBoaXRTbG9wPXsxNX0gb25QcmVzcz17cmVtb3ZlSXRlbX0+XG4gICAgICAgICAgICAgICAgICAgIDxJb0lvc1RyYXNoIHNpemU9XCIzZW1cIiBjb2xvcj17cGFsZXR0ZS5yZWR9IC8+XG4gICAgICAgICAgICAgICAgPC9QcmVzc2FibGU+XG4gICAgICAgICAgICA8L0JveD5cbiAgICAgICAgPC9Cb3g+XG4gICAgICAgIDwvUmVndWxhckNhcmQ+XG4gICAgICAgIFxuICAgIClcbn1cblxuXG5cbmZ1bmN0aW9uIExpc3RVc2VyQ29udGFjdEluZm8oKSB7XG4gICAgY29uc3QgW2luZm9JdGVtcywgc2V0SW5mb0l0ZW1zXSA9IHVzZVN0YXRlPFVzZXJDb250YWN0SW5mb1R5cGVbXT4oKVxuICAgIGNvbnN0IFtvbGRJbmZvSXRlbXMsIHNldE9sZEluZm9JdGVtc10gPSB1c2VTdGF0ZTxVc2VyQ29udGFjdEluZm9UeXBlW10+KClcbiAgICBjb25zdCBbbmV3SWQsIHNldE5ld0lkXSA9IHVzZVN0YXRlPHN0cmluZz4oJycpXG4gICAgY29uc3QgW25ld05hbWUsIHNldE5ld05hbWVdID0gdXNlU3RhdGU8c3RyaW5nPignJylcbiAgICBjb25zdCBbbmV3VHlwZSwgc2V0TmV3VHlwZV0gPSB1c2VTdGF0ZTwnZW1haWwnIHwgJ3Bob25lJz4oJ2VtYWlsJylcbiAgICBjb25zdCBbaXNOZXdJdGVtLCBzZXRJc05ld0l0ZW1dID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpXG4gICAgY29uc3QgW3BhZ2VPZmZzZXQsIHNldFBhZ2VPZmZzZXRdID0gdXNlU3RhdGU8bnVtYmVyPigwKVxuXG4gICAgY29uc3QgeyBoZWlnaHQ6IGZ1bGxIZWlnaHQgfSA9IERpbWVuc2lvbnMuZ2V0KCd3aW5kb3cnKVxuXG4gICAgY29uc3QgeyBzdWIsIGNsaWVudCB9ID0gdXNlQXBwQ29udGV4dCgpXG5cbiAgICBjb25zdCB0aGVtZSA9IHVzZVRoZW1lKClcbiAgICBjb25zdCB0b2FzdCA9IHVzZVRvYXN0KClcblxuICBjb25zdCB0cmFuc2l0aW9uRHVyYXRpb24gPSB7XG4gICAgZW50ZXI6IHRoZW1lLnRyYW5zaXRpb25zLmR1cmF0aW9uLmVudGVyaW5nU2NyZWVuLFxuICAgIGV4aXQ6IHRoZW1lLnRyYW5zaXRpb25zLmR1cmF0aW9uLmxlYXZpbmdTY3JlZW4sXG4gIH1cblxuICAgIGNvbnN0IHVzZXJJZCA9IHN1YlxuXG4gICAgLy8gbGlzdCBvbGQgaW5mbyBpdGVtc1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9sZERiSW5mb0l0ZW1zID0gYXdhaXQgbGlzdFVzZXJDb250YWN0SW5mb3NHaXZlblVzZXJJZChjbGllbnQsIHVzZXJJZClcbiAgICAgICAgICAgICAgICBpZiAob2xkRGJJbmZvSXRlbXM/Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0SW5mb0l0ZW1zKG9sZERiSW5mb0l0ZW1zKVxuICAgICAgICAgICAgICAgICAgICBzZXRPbGRJbmZvSXRlbXMob2xkRGJJbmZvSXRlbXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUsICcgdW5hYmxlIHRvIGxpc3QgdXNlciBjb250YWN0IGluZm8gaXRlbXMnKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSgpXG4gICAgfSwgW2NsaWVudCwgdXNlcklkXSlcblxuXG4gICAgY29uc3QgYWRkTmV3RW50cnkgPSAoKSA9PiB7XG4gICAgICAgIHNob3dOZXdJdGVtKClcbiAgICB9XG5cbiAgICBjb25zdCBvblN1Ym1pdE5ld0VudHJ5ID0gYXN5bmMgKCkgPT4ge1xuXG4gICAgICAgIGNvbnN0IG5ld0luZm9JdGVtOiBVc2VyQ29udGFjdEluZm9UeXBlID0ge1xuICAgICAgICAgICAgaWQ6IG5ld0lkLFxuICAgICAgICAgICAgbmFtZTogbmV3TmFtZSxcbiAgICAgICAgICAgIHR5cGU6IG5ld1R5cGUsXG4gICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICBwcmltYXJ5OiBmYWxzZSxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogZGF5anMoKS5mb3JtYXQoKSxcbiAgICAgICAgICAgIGNyZWF0ZWREYXRlOiBkYXlqcygpLmZvcm1hdCgpLFxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbmV3SW5mb0l0ZW1zID0gaW5mb0l0ZW1zLmNvbmNhdChuZXdJbmZvSXRlbSlcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKG5ld0luZm9JdGVtcz8ubWFwKGMgPT4gKF8ub21pdChjLCBbJ19fdHlwZW5hbWUnXSkpKSwgJyBuZXdJbmZvSXRlbXMnKVxuXG4gICAgICAgIGFkZEluZm9JdGVtVG9JdGVtcyhcbiAgICAgICAgICAgIG5ld0luZm9JdGVtLFxuICAgICAgICAgICAgaW5mb0l0ZW1zLFxuICAgICAgICAgICAgc2V0SW5mb0l0ZW1zLFxuICAgICAgICApXG5cbiAgICAgICAgaGlkZU5ld0l0ZW0oKVxuXG4gICAgICAgIGF3YWl0IHN1Ym1pdEl0ZW1zV2l0aE5ld0l0ZW0obmV3SW5mb0l0ZW1zKVxuICAgIH1cblxuICAgIGNvbnN0IHNob3dOZXdJdGVtID0gKCkgPT4gc2V0SXNOZXdJdGVtKHRydWUpXG5cbiAgICBjb25zdCBoaWRlTmV3SXRlbSA9ICgpID0+IHNldElzTmV3SXRlbShmYWxzZSlcblxuICAgIGNvbnN0IG9uQ2FuY2VsRW50cnkgPSAoKSA9PiB7XG4gICAgICAgIHNldE5ld0lkKCcnKVxuICAgICAgICBzZXROZXdOYW1lKCcnKVxuICAgICAgICBzZXROZXdUeXBlKCdlbWFpbCcpXG4gICAgICAgIGhpZGVOZXdJdGVtKClcbiAgICB9XG5cbiAgICBjb25zdCBzdWJtaXRJdGVtc1dpdGhOZXdJdGVtID0gYXN5bmMgKG5ld0luZm9JdGVtczogVXNlckNvbnRhY3RJbmZvVHlwZVtdKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIV8uaXNFcXVhbChvbGRJbmZvSXRlbXMsIG5ld0luZm9JdGVtcykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtSWRzVG9EZWxldGUgPSBvbGRJbmZvSXRlbXNcbiAgICAgICAgICAgICAgICAgICAgPy5maWx0ZXIobyA9PiAhXy5pc0VxdWFsKG8sIG5ld0luZm9JdGVtcz8uZmluZChpID0+IChpPy5pZCA9PSBvPy5pZCkpKSlcbiAgICAgICAgICAgICAgICAgICAgPy5tYXAobyA9PiAobz8uaWQpKVxuXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW1JZHNUb0RlbGV0ZT8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBkZWxldGVDb250YWN0SW5mb0l0ZW1zKFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbUlkc1RvRGVsZXRlLFxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG5ld0luZm9JdGVtcz8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdXBzZXJ0Q29udGFjdEluZm9JdGVtcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0luZm9JdGVtcyxcbiAgICAgICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgICAgIHNldE9sZEluZm9JdGVtcyhuZXdJbmZvSXRlbXMpXG5cbiAgICAgICAgICAgICAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAnc3VjY2VzcycsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1N1Y2Nlc3MhJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnU3VjY2Vzc2Z1bGx5IHVwZGF0ZWQgeW91ciBjb250YWN0IGluZm8gaXRlbXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDkwMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0Nsb3NhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlLCAnIHVuYWJsZSB0byBzdWJtaXQgaXRlbXMgaW5zaWRlIGxpc3QgdXNlciBjb250YWN0IGluZm8nKVxuICAgICAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogJ09vcHMuLi4nLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnU29tZXRoaW5nIHdlbnQgd3Jvbmcgd2l0aCB1cGRhdGluZyB5b3VyIGNvbnRhY3QgaW5mb3MuIExldCB1cyBrbm93LicsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDkwMDAsXG4gICAgICAgICAgICAgICAgaXNDbG9zYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzdWJtaXRJdGVtcyA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghXy5pc0VxdWFsKG9sZEluZm9JdGVtcywgaW5mb0l0ZW1zKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1JZHNUb0RlbGV0ZSA9IG9sZEluZm9JdGVtcz8ubWFwKG8gPT4gKG8/LmlkKSlcblxuICAgICAgICAgICAgICAgIGlmIChpdGVtSWRzVG9EZWxldGU/Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZGVsZXRlQ29udGFjdEluZm9JdGVtcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1JZHNUb0RlbGV0ZSxcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpbmZvSXRlbXM/Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdXBzZXJ0Q29udGFjdEluZm9JdGVtcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZm9JdGVtcyxcbiAgICAgICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgICAgIHNldE9sZEluZm9JdGVtcyhpbmZvSXRlbXMpXG5cbiAgICAgICAgICAgICAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAnc3VjY2VzcycsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1N1Y2Nlc3MhJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnU3VjY2Vzc2Z1bGx5IHVwZGF0ZWQgeW91ciBjb250YWN0IGluZm8gaXRlbXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDkwMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0Nsb3NhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlLCAnIHVuYWJsZSB0byBzdWJtaXQgaXRlbXMgaW5zaWRlIGxpc3QgdXNlciBjb250YWN0IGluZm8nKVxuICAgICAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogJ09vcHMuLi4nLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnU29tZXRoaW5nIHdlbnQgd3Jvbmcgd2l0aCB1cGRhdGluZyB5b3VyIGNvbnRhY3QgaW5mb3MuIExldCB1cyBrbm93LicsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDkwMDAsXG4gICAgICAgICAgICAgICAgaXNDbG9zYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgICA8Qm94IGZsZXg9ezF9IHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0+XG4gICAgICAgICAgICA8Qm94IGZsZXg9ezF9IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiIHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX0+XG4gICAgICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cInN1YmhlYWRlck5vcm1hbFwiIHRleHRBbGlnbj1cImNlbnRlclwiIHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19PlxuICAgICAgICAgICAgICAgICAgICBZb3VyIENvbnRhY3QgSW5mbyB0byB2ZXJpZnkgZnV0dXJlIG1lZXRpbmcgaW52aXRlc1xuICAgICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGluZm9JdGVtcz8ubGVuZ3RoID4gMFxuICAgICAgICAgICAgICAgICAgICA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxGbGF0TGlzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE9e2luZm9JdGVtc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJJdGVtPXsoeyBpdGVtLCBpbmRleCB9KSA9PiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxJbmZvSXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbT17aXRlbX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4PXtpbmRleH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9JdGVtcz17aW5mb0l0ZW1zfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0SW5mb0l0ZW1zPXtzZXRJbmZvSXRlbXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVJbmZvSXRlbVRvSXRlbXM9e3JlbW92ZUluZm9JdGVtVG9JdGVtc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdEl0ZW1zV2l0aE5ld0l0ZW09e3N1Ym1pdEl0ZW1zV2l0aE5ld0l0ZW19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXg9ezF9IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiIHA9e3sgcGhvbmU6ICdsJywgdGFibGV0OiAnbScgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cInN1YmhlYWRlck5vcm1hbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBZGQgYXRsZWFzdCAxIENvbnRhY3QgZW50cnkgdG8gdmVyaWZ5IGFnYWluc3QgZm9yIGZ1dHVyZSBtZWV0aW5nIGludml0ZXMgd2l0aCBBdG9taWNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgPFpvb21cbiAgICAgICAgICAgICAgICAgICAgICAgIGluXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0PXt0cmFuc2l0aW9uRHVyYXRpb259XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb25EZWxheTogYCR7dHJhbnNpdGlvbkR1cmF0aW9uLmV4aXR9bXNgLFxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHVubW91bnRPbkV4aXRcbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxGYWIgc3g9e2ZhYlN0eWxlIGFzIFN4UHJvcHN9IGFyaWEtbGFiZWw9eydBZGQnfSBjb2xvcj1cInByaW1hcnlcIiBvbkNsaWNrPXthZGROZXdFbnRyeX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFkZEljb24gc3g9e3sgY29sb3I6IHBpbmtbNTAwXSB9fSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9GYWI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1pvb20+XG4gICAgICAgICAgICAgICAgPEJveD5cbiAgICAgICAgICAgICAgICAgICAgPE92ZXJsYXkgb3ZlcmxheVN0eWxlPXt7IGJhY2tncm91bmRDb2xvcjogcGFsZXR0ZS53aGl0ZSwganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLCBhbGlnbkl0ZW1zOiAnY2VudGVyJyB9fSBpc1Zpc2libGU9e2lzTmV3SXRlbX0gb25CYWNrZHJvcFByZXNzPXtvbkNhbmNlbEVudHJ5fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxCb3gganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgc3R5bGU9e3sgd2lkdGg6ICc5MCUnLCBiYWNrZ3JvdW5kQ29sb3I6IHBhbGV0dGUud2hpdGV9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFJlZ3VsYXJDYXJkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJveCBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fSBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwib3B0aW9uSGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5ldyBDb250YWN0IEluZm9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJveCBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fSBmbGV4RGlyZWN0aW9uPVwicm93XCIganVzdGlmeUNvbnRlbnQ9XCJmbGV4LXN0YXJ0XCIgYWxpZ25JdGVtcz1cImNlbnRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyB3aWR0aDogJzkwJScgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHRGaWVsZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJFbWFpbCBvciBQaG9uZVwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cInJAci5yXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlOiB7IHRhcmdldDogeyB2YWx1ZTogc3RyaW5nIH0gfSkgPT4gc2V0TmV3SWQoZT8udGFyZ2V0Py52YWx1ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e25ld0lkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IHdpZHRoOiAnMTAwJScgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Qm94IHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIgc3R5bGU9e3sgd2lkdGg6ICc5MCUnfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHRGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD1cIk5hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkpvaG4gRG9lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlOiB7IHRhcmdldDogeyB2YWx1ZTogc3RyaW5nIH0gfSkgPT4gc2V0TmV3TmFtZShlPy50YXJnZXQ/LnZhbHVlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e25ld05hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IHdpZHRoOiAnMTAwJSd9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCb3ggcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0ganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHQgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0gdmFyaWFudD1cIm9wdGlvbkhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJcyB0aGlzIGEgcGhvbmUgb3IgZW1haWw/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgdmFsdWU9e25ld1R5cGV9IG9uQ2hhbmdlPXsoZSkgPT4gc2V0TmV3VHlwZShlPy50YXJnZXQ/LnZhbHVlIGFzIFwiZW1haWxcIiB8IFwicGhvbmVcIil9IGNsYXNzTmFtZT1cInNlbGVjdCBzZWxlY3QtcHJpbWFyeSB3LWZ1bGwgbWF4LXcteHNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiBkaXNhYmxlZCBzZWxlY3RlZD5TZW5kIHVwZGF0ZXMgdG8uLi48L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge18ubWFwKHR5cGVPcHRpb25zLCBvcHRpb24gPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17b3B0aW9uLnZhbHVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtvcHRpb24udmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+e29wdGlvbi5sYWJlbH08L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0JveD4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1JlZ3VsYXJDYXJkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Qm94IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJveCBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fSBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8UHJlc3NhYmxlIGhpdFNsb3A9ezE1fSBvblByZXNzPXtvblN1Ym1pdE5ld0VudHJ5fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHQgdmFyaWFudD1cImJ1dHRvbkxpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsnKyBBZGQgSW5mbyd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1ByZXNzYWJsZT4gIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8UHJlc3NhYmxlIGhpdFNsb3A9ezE1fSBvblByZXNzPXtvbkNhbmNlbEVudHJ5fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwiZ3JleUxpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2FuY2VsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9QcmVzc2FibGU+ICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Cb3g+ICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICA8L092ZXJsYXk+XG4gICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgPEJveCBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXtzdWJtaXRJdGVtc30+XG4gICAgICAgICAgICAgICAgICAgICAgICBTdWJtaXQgSW5mb1xuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgIDwvQm94PlxuICAgICAgICA8L0JveD5cbiAgICApXG59XG5cblxuZXhwb3J0IGRlZmF1bHQgTGlzdFVzZXJDb250YWN0SW5mb1xuXG5cbiJdfQ==