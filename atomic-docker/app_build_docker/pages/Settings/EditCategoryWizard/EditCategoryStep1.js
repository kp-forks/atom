"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getServerSideProps = getServerSideProps;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_2 = require("@chakra-ui/react");
const Switch_1 = __importDefault(require("@components/Switch"));
const TextField_1 = __importDefault(require("@components/TextField"));
const Box_1 = __importDefault(require("@components/common/Box"));
const Text_1 = __importDefault(require("@components/common/Text"));
const supertokens_node_1 = __importDefault(require("supertokens-node"));
const backendConfig_1 = require("@config/backendConfig");
const session_1 = __importDefault(require("supertokens-node/recipe/session"));
const colorsPalette_1 = require("@lib/theme/colorsPalette");
async function getServerSideProps({ req, res }) {
    // Notice how the server uses `API` from `withSSRContext`, instead of the top-level `API`.
    // const SSR = withSSRContext({ req })
    // this runs on the backend, so we must call init on supertokens-node SDK
    supertokens_node_1.default.init((0, backendConfig_1.backendConfig)());
    let session;
    try {
        session = await session_1.default.getSession(req, res, {
            overrideGlobalClaimValidators: async function () {
                return [];
            },
        });
    }
    catch (err) {
        if (err.type === session_1.default.Error.TRY_REFRESH_TOKEN) {
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        else if (err.type === session_1.default.Error.UNAUTHORISED) {
            // this will force the frontend to try and refresh which will fail
            // clearing all cookies and redirecting the user to the login screen.
            return { props: { fromSupertokens: 'needs-refresh' } };
        }
        throw err;
    }
    if (!session?.getUserId()) {
        return {
            redirect: {
                destination: '/User/Login/UserLogin',
                permanent: false,
            },
        };
    }
    return {
        props: {
            sub: session.getUserId(),
        }
    };
}
function EditCategoryStep1(props) {
    const [name, setName] = (0, react_1.useState)(props.name);
    const [copyAvailability, setCopyAvailability] = (0, react_1.useState)(props?.copyAvailability ?? false);
    const [copyTimeBlocking, setCopyTimeBlocking] = (0, react_1.useState)(props?.copyTimeBlocking ?? false);
    const [isMessage1, setIsMessage1] = (0, react_1.useState)(false);
    const [isMessage2, setIsMessage2] = (0, react_1.useState)(false);
    const setParentName = props?.setParentName;
    const setParentCopyAvailability = props?.setParentCopyAvailability;
    const setParentCopyTimeBlocking = props?.setParentCopyTimeBlocking;
    (0, react_1.useEffect)(() => {
        if (name !== props?.name) {
            setName(props?.name);
        }
        if (copyAvailability !== props?.copyAvailability) {
            setCopyAvailability(props?.copyAvailability ?? false);
        }
        if (copyTimeBlocking !== props?.copyTimeBlocking) {
            setCopyTimeBlocking(props?.copyTimeBlocking ?? false);
        }
    }, [props?.name, props?.copyAvailability, props?.copyTimeBlocking, name, copyAvailability, copyTimeBlocking]);
    const changeCopyAvailability = (value) => {
        setCopyAvailability(value);
        setParentCopyAvailability(value);
    };
    const changeCopyTimeBlocking = (value) => {
        setCopyTimeBlocking(value);
        setParentCopyTimeBlocking(value);
    };
    const changeName = (value) => {
        setName(value);
        setParentName(value);
    };
    return ((0, jsx_runtime_1.jsx)(Box_1.default, { justifyContent: "center", alignItems: "center", style: { width: '100%' }, children: (0, jsx_runtime_1.jsxs)("div", { className: "flex-1 flex flex-col jsutify-start items-center", style: { minHeight: '70vh' }, children: [(0, jsx_runtime_1.jsx)(Box_1.default, { justifyContent: "center", alignItems: "flex-start", style: { width: '90%' }, pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(TextField_1.default, { label: "Name", placeholder: "social", onChange: (e) => changeName(e?.target?.value), value: name }) }), (0, jsx_runtime_1.jsxs)(Box_1.default, { style: { width: '90%' }, pt: { phone: 'm', tablet: 's' }, children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_2.Tooltip, { hasArrow: true, label: 'Event availability shown in your calendar will be copied over to any new events whose details are similar to this one. Helpful for task events that are synced or created inside Atomic.', bg: 'purple.700', color: 'white', children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "buttonLink", pt: { phone: 'm', tablet: 's' }, children: "Once you set time preferences or priority of an event, copy over transparency of event to any new events whose details are similar? (Hint)" }) }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { onColor: colorsPalette_1.colorsPalette.purple30, offColor: colorsPalette_1.colorsPalette.purple60, checked: copyAvailability, onValueChange: changeCopyAvailability, style: { marginBottom: 20 } }) })] }), (0, jsx_runtime_1.jsxs)(Box_1.default, { style: { width: '90%' }, pt: { phone: 'm', tablet: 's' }, children: [(0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-start", alignItems: "center", children: (0, jsx_runtime_1.jsx)(react_2.Tooltip, { hasArrow: true, label: 'Blocked time for before and after the event will be copied over to new events whose details are similar to this one.', bg: 'purple.700', color: 'white', children: (0, jsx_runtime_1.jsx)(Text_1.default, { variant: "optionHeader", pt: { phone: 'm', tablet: 's' }, children: "Once you set time preferences or priority of an event, copy over buffer times to any new events whose details have similar context? (Hint)" }) }) }), (0, jsx_runtime_1.jsx)(Box_1.default, { flexDirection: "row", justifyContent: "flex-end", pt: { phone: 'm', tablet: 's' }, children: (0, jsx_runtime_1.jsx)(Switch_1.default, { onColor: colorsPalette_1.colorsPalette.purple30, offColor: colorsPalette_1.colorsPalette.purple60, checked: copyTimeBlocking, onValueChange: changeCopyTimeBlocking, style: { marginBottom: 20 } }) })] })] }) }));
}
exports.default = EditCategoryStep1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRWRpdENhdGVnb3J5U3RlcDEuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJFZGl0Q2F0ZWdvcnlTdGVwMS50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFrQkEsZ0RBcUNDOztBQXZERCxpQ0FLYztBQUNkLDRDQUEwQztBQUMxQyxnRUFBd0M7QUFDeEMsc0VBQTZDO0FBQzdDLGlFQUF3QztBQUN4QyxtRUFBMEM7QUFHMUMsd0VBQThDO0FBQzlDLHlEQUFxRDtBQUNyRCw4RUFBcUQ7QUFDckQsNERBQWtFO0FBRTNELEtBQUssVUFBVSxrQkFBa0IsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQWlEO0lBQ2hHLDBGQUEwRjtJQUMxRixzQ0FBc0M7SUFDdEMseUVBQXlFO0lBQ3pFLDBCQUFlLENBQUMsSUFBSSxDQUFDLElBQUEsNkJBQWEsR0FBRSxDQUFDLENBQUE7SUFDckMsSUFBSSxPQUFPLENBQUE7SUFDWCxJQUFJLENBQUM7UUFDRCxPQUFPLEdBQUcsTUFBTSxpQkFBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFO1lBQ3pDLDZCQUE2QixFQUFFLEtBQUs7Z0JBQ2hDLE9BQU8sRUFBRSxDQUFBO1lBQ2IsQ0FBQztTQUNKLENBQUMsQ0FBQTtJQUNOLENBQUM7SUFBQyxPQUFPLEdBQVEsRUFBRSxDQUFDO1FBQ2hCLElBQUksR0FBRyxDQUFDLElBQUksS0FBSyxpQkFBTyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1lBQy9DLE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBRSxlQUFlLEVBQUUsZUFBZSxFQUFFLEVBQUUsQ0FBQTtRQUMxRCxDQUFDO2FBQU0sSUFBSSxHQUFHLENBQUMsSUFBSSxLQUFLLGlCQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ2pELGtFQUFrRTtZQUNsRSxxRUFBcUU7WUFDckUsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQUUsRUFB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LElBQ0osSUFDSixHQUNKLENBQ1QsQ0FBQTtBQUNMLENBQUM7QUFFRCxrQkFBZSxpQkFBaUIsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwge1xuICAgIHVzZVN0YXRlLFxuICAgIERpc3BhdGNoLFxuICAgIFNldFN0YXRlQWN0aW9uLFxuICAgIHVzZUVmZmVjdCxcbn0gZnJvbSAncmVhY3QnXG5pbXBvcnQgeyBUb29sdGlwIH0gZnJvbSAnQGNoYWtyYS11aS9yZWFjdCdcbmltcG9ydCBTd2l0Y2gxIGZyb20gJ0Bjb21wb25lbnRzL1N3aXRjaCdcbmltcG9ydCBUZXh0RmllbGQgZnJvbSAnQGNvbXBvbmVudHMvVGV4dEZpZWxkJ1xuaW1wb3J0IEJveCBmcm9tICdAY29tcG9uZW50cy9jb21tb24vQm94J1xuaW1wb3J0IFRleHQgZnJvbSAnQGNvbXBvbmVudHMvY29tbW9uL1RleHQnXG5pbXBvcnQgeyBQcmVzc2FibGUgfSBmcm9tICdyZWFjdC1uYXRpdmUnXG5pbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgc3VwZXJ0b2tlbnNOb2RlIGZyb20gJ3N1cGVydG9rZW5zLW5vZGUnXG5pbXBvcnQgeyBiYWNrZW5kQ29uZmlnIH0gZnJvbSAnQGNvbmZpZy9iYWNrZW5kQ29uZmlnJ1xuaW1wb3J0IFNlc3Npb24gZnJvbSAnc3VwZXJ0b2tlbnMtbm9kZS9yZWNpcGUvc2Vzc2lvbidcbmltcG9ydCB7IGNvbG9yc1BhbGV0dGUgYXMgQ29sb3JzfSBmcm9tICdAbGliL3RoZW1lL2NvbG9yc1BhbGV0dGUnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2VydmVyU2lkZVByb3BzKHsgcmVxLCByZXMgfTogeyByZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSB9KSB7XG4gICAgLy8gTm90aWNlIGhvdyB0aGUgc2VydmVyIHVzZXMgYEFQSWAgZnJvbSBgd2l0aFNTUkNvbnRleHRgLCBpbnN0ZWFkIG9mIHRoZSB0b3AtbGV2ZWwgYEFQSWAuXG4gICAgLy8gY29uc3QgU1NSID0gd2l0aFNTUkNvbnRleHQoeyByZXEgfSlcbiAgICAvLyB0aGlzIHJ1bnMgb24gdGhlIGJhY2tlbmQsIHNvIHdlIG11c3QgY2FsbCBpbml0IG9uIHN1cGVydG9rZW5zLW5vZGUgU0RLXG4gICAgc3VwZXJ0b2tlbnNOb2RlLmluaXQoYmFja2VuZENvbmZpZygpKVxuICAgIGxldCBzZXNzaW9uXG4gICAgdHJ5IHtcbiAgICAgICAgc2Vzc2lvbiA9IGF3YWl0IFNlc3Npb24uZ2V0U2Vzc2lvbihyZXEsIHJlcywge1xuICAgICAgICAgICAgb3ZlcnJpZGVHbG9iYWxDbGFpbVZhbGlkYXRvcnM6IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW11cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICAgICAgaWYgKGVyci50eXBlID09PSBTZXNzaW9uLkVycm9yLlRSWV9SRUZSRVNIX1RPS0VOKSB7XG4gICAgICAgICAgICByZXR1cm4geyBwcm9wczogeyBmcm9tU3VwZXJ0b2tlbnM6ICduZWVkcy1yZWZyZXNoJyB9IH1cbiAgICAgICAgfSBlbHNlIGlmIChlcnIudHlwZSA9PT0gU2Vzc2lvbi5FcnJvci5VTkFVVEhPUklTRUQpIHtcbiAgICAgICAgICAgIC8vIHRoaXMgd2lsbCBmb3JjZSB0aGUgZnJvbnRlbmQgdG8gdHJ5IGFuZCByZWZyZXNoIHdoaWNoIHdpbGwgZmFpbFxuICAgICAgICAgICAgLy8gY2xlYXJpbmcgYWxsIGNvb2tpZXMgYW5kIHJlZGlyZWN0aW5nIHRoZSB1c2VyIHRvIHRoZSBsb2dpbiBzY3JlZW4uXG4gICAgICAgICAgICByZXR1cm4geyBwcm9wczogeyBmcm9tU3VwZXJ0b2tlbnM6ICduZWVkcy1yZWZyZXNoJyB9IH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnJcbiAgICB9XG5cbiAgICBpZiAoIXNlc3Npb24/LmdldFVzZXJJZCgpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uOiAnL1VzZXIvTG9naW4vVXNlckxvZ2luJyxcbiAgICAgICAgICAgICAgICBwZXJtYW5lbnQ6IGZhbHNlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHByb3BzOiB7XG4gICAgICAgIHN1Yjogc2Vzc2lvbi5nZXRVc2VySWQoKSxcbiAgICAgICAgfVxuICAgIH1cbn1cblxudHlwZSBQcm9wcyA9IHtcbiAgICBuYW1lOiBzdHJpbmcsXG4gICAgc2V0UGFyZW50TmFtZTogRGlzcGF0Y2g8U2V0U3RhdGVBY3Rpb248c3RyaW5nPj4sXG4gICAgY29weUF2YWlsYWJpbGl0eTogYm9vbGVhbixcbiAgICBzZXRQYXJlbnRDb3B5QXZhaWxhYmlsaXR5OiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxib29sZWFuPj4sXG4gICAgY29weVRpbWVCbG9ja2luZzogYm9vbGVhbixcbiAgICBzZXRQYXJlbnRDb3B5VGltZUJsb2NraW5nOiBEaXNwYXRjaDxTZXRTdGF0ZUFjdGlvbjxib29sZWFuPj4sXG59XG5cbmZ1bmN0aW9uIEVkaXRDYXRlZ29yeVN0ZXAxKHByb3BzOiBQcm9wcykge1xuICAgIGNvbnN0IFtuYW1lLCBzZXROYW1lXSA9IHVzZVN0YXRlKHByb3BzLm5hbWUpXG4gICAgY29uc3QgW2NvcHlBdmFpbGFiaWxpdHksIHNldENvcHlBdmFpbGFiaWxpdHldID0gdXNlU3RhdGU8Ym9vbGVhbj4ocHJvcHM/LmNvcHlBdmFpbGFiaWxpdHkgPz8gZmFsc2UpXG4gICAgY29uc3QgW2NvcHlUaW1lQmxvY2tpbmcsIHNldENvcHlUaW1lQmxvY2tpbmddID0gdXNlU3RhdGU8Ym9vbGVhbj4ocHJvcHM/LmNvcHlUaW1lQmxvY2tpbmcgPz8gZmFsc2UpXG5cbiAgICBjb25zdCBbaXNNZXNzYWdlMSwgc2V0SXNNZXNzYWdlMV0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSlcbiAgICBjb25zdCBbaXNNZXNzYWdlMiwgc2V0SXNNZXNzYWdlMl0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSlcblxuICAgIGNvbnN0IHNldFBhcmVudE5hbWUgPSBwcm9wcz8uc2V0UGFyZW50TmFtZVxuICAgIGNvbnN0IHNldFBhcmVudENvcHlBdmFpbGFiaWxpdHkgPSBwcm9wcz8uc2V0UGFyZW50Q29weUF2YWlsYWJpbGl0eVxuICAgIGNvbnN0IHNldFBhcmVudENvcHlUaW1lQmxvY2tpbmcgPSBwcm9wcz8uc2V0UGFyZW50Q29weVRpbWVCbG9ja2luZ1xuXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKG5hbWUgIT09IHByb3BzPy5uYW1lKSB7XG4gICAgICAgICAgICBzZXROYW1lKHByb3BzPy5uYW1lKVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvcHlBdmFpbGFiaWxpdHkgIT09IHByb3BzPy5jb3B5QXZhaWxhYmlsaXR5KSB7XG4gICAgICAgICAgICBzZXRDb3B5QXZhaWxhYmlsaXR5KHByb3BzPy5jb3B5QXZhaWxhYmlsaXR5ID8/IGZhbHNlKVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvcHlUaW1lQmxvY2tpbmcgIT09IHByb3BzPy5jb3B5VGltZUJsb2NraW5nKSB7XG4gICAgICAgICAgICBzZXRDb3B5VGltZUJsb2NraW5nKHByb3BzPy5jb3B5VGltZUJsb2NraW5nID8/IGZhbHNlKVxuICAgICAgICB9XG4gICAgfSwgW3Byb3BzPy5uYW1lLCBwcm9wcz8uY29weUF2YWlsYWJpbGl0eSwgcHJvcHM/LmNvcHlUaW1lQmxvY2tpbmcsIG5hbWUsIGNvcHlBdmFpbGFiaWxpdHksIGNvcHlUaW1lQmxvY2tpbmddKVxuXG4gICAgY29uc3QgY2hhbmdlQ29weUF2YWlsYWJpbGl0eSA9ICh2YWx1ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICBzZXRDb3B5QXZhaWxhYmlsaXR5KHZhbHVlKVxuICAgICAgICBzZXRQYXJlbnRDb3B5QXZhaWxhYmlsaXR5KHZhbHVlKVxuICAgIH1cblxuICAgIGNvbnN0IGNoYW5nZUNvcHlUaW1lQmxvY2tpbmcgPSAodmFsdWU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgc2V0Q29weVRpbWVCbG9ja2luZyh2YWx1ZSlcbiAgICAgICAgc2V0UGFyZW50Q29weVRpbWVCbG9ja2luZyh2YWx1ZSlcbiAgICB9XG5cbiAgICBjb25zdCBjaGFuZ2VOYW1lID0gKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgc2V0TmFtZSh2YWx1ZSlcbiAgICAgICAgc2V0UGFyZW50TmFtZSh2YWx1ZSlcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgICA8Qm94IGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiIHN0eWxlPXt7IHdpZHRoOiAnMTAwJSd9fT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIGZsZXggZmxleC1jb2wganN1dGlmeS1zdGFydCBpdGVtcy1jZW50ZXJcIiBzdHlsZT17eyBtaW5IZWlnaHQ6ICc3MHZoJ319PlxuICAgICAgICAgICAgICAgIDxCb3gganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIiBhbGlnbkl0ZW1zPVwiZmxleC1zdGFydFwiIHN0eWxlPXt7IHdpZHRoOiAnOTAlJyB9fSBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgPFRleHRGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJOYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwic29jaWFsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZTogeyB0YXJnZXQ6IHsgdmFsdWU6IHN0cmluZyB9IH0pID0+IGNoYW5nZU5hbWUoZT8udGFyZ2V0Py52YWx1ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17bmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgIDxCb3ggc3R5bGU9e3sgd2lkdGg6ICc5MCUnIH19IHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19PiAgXG4gICAgICAgICAgICAgICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1zdGFydFwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwIGhhc0Fycm93IGxhYmVsPSdFdmVudCBhdmFpbGFiaWxpdHkgc2hvd24gaW4geW91ciBjYWxlbmRhciB3aWxsIGJlIGNvcGllZCBvdmVyIHRvIGFueSBuZXcgZXZlbnRzIHdob3NlIGRldGFpbHMgYXJlIHNpbWlsYXIgdG8gdGhpcyBvbmUuIEhlbHBmdWwgZm9yIHRhc2sgZXZlbnRzIHRoYXQgYXJlIHN5bmNlZCBvciBjcmVhdGVkIGluc2lkZSBBdG9taWMuJyBiZz0ncHVycGxlLjcwMCcgY29sb3I9J3doaXRlJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dCB2YXJpYW50PVwiYnV0dG9uTGlua1wiIHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19Pk9uY2UgeW91IHNldCB0aW1lIHByZWZlcmVuY2VzIG9yIHByaW9yaXR5IG9mIGFuIGV2ZW50LCBjb3B5IG92ZXIgdHJhbnNwYXJlbmN5IG9mIGV2ZW50IHRvIGFueSBuZXcgZXZlbnRzIHdob3NlIGRldGFpbHMgYXJlIHNpbWlsYXI/IChIaW50KTwvVGV4dD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvVG9vbHRpcD5cblxuICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICAgICAgPEJveCBmbGV4RGlyZWN0aW9uPVwicm93XCIganVzdGlmeUNvbnRlbnQ9XCJmbGV4LWVuZFwiIHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFN3aXRjaDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNvbG9yPXtDb2xvcnMucHVycGxlMzB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2ZmQ29sb3I9e0NvbG9ycy5wdXJwbGU2MH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkPXtjb3B5QXZhaWxhYmlsaXR5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVmFsdWVDaGFuZ2U9e2NoYW5nZUNvcHlBdmFpbGFiaWxpdHl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3ttYXJnaW5Cb3R0b206IDIwfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgIDxCb3ggc3R5bGU9e3sgd2lkdGg6ICc5MCUnIH19IHB0PXt7IHBob25lOiAnbScsIHRhYmxldDogJ3MnIH19PlxuICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtc3RhcnRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8VG9vbHRpcCBoYXNBcnJvdyBsYWJlbD0nQmxvY2tlZCB0aW1lIGZvciBiZWZvcmUgYW5kIGFmdGVyIHRoZSBldmVudCB3aWxsIGJlIGNvcGllZCBvdmVyIHRvIG5ldyBldmVudHMgd2hvc2UgZGV0YWlscyBhcmUgc2ltaWxhciB0byB0aGlzIG9uZS4nIGJnPSdwdXJwbGUuNzAwJyBjb2xvcj0nd2hpdGUnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0IHZhcmlhbnQ9XCJvcHRpb25IZWFkZXJcIiBwdD17eyBwaG9uZTogJ20nLCB0YWJsZXQ6ICdzJyB9fT5PbmNlIHlvdSBzZXQgdGltZSBwcmVmZXJlbmNlcyBvciBwcmlvcml0eSBvZiBhbiBldmVudCwgY29weSBvdmVyIGJ1ZmZlciB0aW1lcyB0byBhbnkgbmV3IGV2ZW50cyB3aG9zZSBkZXRhaWxzIGhhdmUgc2ltaWxhciBjb250ZXh0PyAoSGludCk8L1RleHQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1Rvb2x0aXA+ICAgXG4gICAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtZW5kXCIgcHQ9e3sgcGhvbmU6ICdtJywgdGFibGV0OiAncycgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8U3dpdGNoMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ29sb3I9e0NvbG9ycy5wdXJwbGUzMH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZDb2xvcj17Q29sb3JzLnB1cnBsZTYwfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2NvcHlUaW1lQmxvY2tpbmd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25WYWx1ZUNoYW5nZT17Y2hhbmdlQ29weVRpbWVCbG9ja2luZ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBtYXJnaW5Cb3R0b206IDIwIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L0JveD5cbiAgICApXG59XG5cbmV4cG9ydCBkZWZhdWx0IEVkaXRDYXRlZ29yeVN0ZXAxXG4iXX0=