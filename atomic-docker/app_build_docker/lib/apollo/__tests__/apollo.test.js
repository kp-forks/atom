"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const client_1 = require("@apollo/client");
const logger_1 = require("../../logger"); // Actual logger
const apollo_1 = __importDefault(require("../apollo")); // The function we want to test (indirectly its RetryLink)
// Mock Session from supertokens-web-js
jest.mock('supertokens-web-js/recipe/session', () => ({
    __esModule: true,
    default: {
        getAccessToken: jest.fn().mockResolvedValue('mock-access-token'),
    },
}));
// Mock the logger for verification
jest.mock('../../logger', () => ({
    appServiceLogger: {
        info: jest.fn(),
        warn: jest.fn(),
        error: jest.fn(),
        debug: jest.fn(),
    },
}));
const mockedLogger = logger_1.appServiceLogger;
// Mock 'got' which might be used by HttpLink under the hood, or node-fetch.
// For HttpLink, it typically uses `fetch`. We'll mock global fetch for these tests.
const mockFetch = jest.fn();
global.fetch = mockFetch;
describe('Apollo Client with RetryLink', () => {
    let client;
    const GET_TEST_DATA = (0, client_1.gql) `
    query GetTestData {
      testData {
        id
        value
      }
    }
  `;
    beforeEach(() => {
        mockFetch.mockReset();
        // Reset all logger spies
        Object.values(mockedLogger).forEach((mockFn) => mockFn.mockReset());
        // Create a new client for each test to ensure isolation
        // makeApolloClient expects a token, but it's for WebSocket, HttpLink uses setContext
        client = (0, apollo_1.default)('mock-ws-token');
    });
    it('should succeed on the first attempt if fetch is successful', async () => {
        mockFetch.mockResolvedValueOnce({
            ok: true,
            json: async () => ({ data: { testData: { id: '1', value: 'success' } } }),
            text: async () => JSON.stringify({ data: { testData: { id: '1', value: 'success' } } }),
            headers: new Headers({ 'Content-Type': 'application/json' }),
        });
        const { data } = await client.query({ query: GET_TEST_DATA });
        expect(data.testData.value).toBe('success');
        expect(mockFetch).toHaveBeenCalledTimes(1);
        // Logger for UNAUTHENTICATED might still be called if errorLink is processed even on success for some reason (unlikely for this path)
        // More specific logging checks would depend on what RetryLink logs on success (usually nothing)
    });
    it('should retry on a 503 server error and then succeed', async () => {
        mockFetch
            .mockResolvedValueOnce({
            // Attempt 1: Fails with 503
            ok: false,
            status: 503,
            statusText: 'Service Unavailable',
            json: async () => ({ errors: [{ message: 'Service Unavailable' }] }),
            text: async () => JSON.stringify({ errors: [{ message: 'Service Unavailable' }] }),
            headers: new Headers({ 'Content-Type': 'application/json' }),
        })
            .mockResolvedValueOnce({
            // Attempt 2: Succeeds
            ok: true,
            json: async () => ({
                data: { testData: { id: '1', value: 'retry success' } },
            }),
            text: async () => JSON.stringify({
                data: { testData: { id: '1', value: 'retry success' } },
            }),
            headers: new Headers({ 'Content-Type': 'application/json' }),
        });
        const { data } = await client.query({ query: GET_TEST_DATA });
        expect(data.testData.value).toBe('retry success');
        expect(mockFetch).toHaveBeenCalledTimes(2);
        expect(mockedLogger.warn).toHaveBeenCalledWith(expect.objectContaining({
            message: expect.stringContaining('RetryLink: Retrying due to server error.'),
        }), expect.anything() // This was the format in the RetryLink logger call
        );
    });
    it('should fail after max retries for persistent 500 errors', async () => {
        mockFetch.mockResolvedValue({
            // All attempts fail
            ok: false,
            status: 500,
            statusText: 'Internal Server Error',
            json: async () => ({ errors: [{ message: 'Internal Server Error' }] }),
            text: async () => JSON.stringify({ errors: [{ message: 'Internal Server Error' }] }),
            headers: new Headers({ 'Content-Type': 'application/json' }),
        });
        await expect(client.query({ query: GET_TEST_DATA })).rejects.toThrow(); // Throws ApolloError
        expect(mockFetch).toHaveBeenCalledTimes(4); // 1 initial + 3 retries
        expect(mockedLogger.warn).toHaveBeenCalledTimes(3); // For each retry attempt
        expect(mockedLogger.warn).toHaveBeenLastCalledWith(expect.objectContaining({
            message: expect.stringContaining('RetryLink: Retrying due to server error.'),
        }), expect.anything());
        // The onError link will also log the final networkError
        expect(mockedLogger.error).toHaveBeenCalledWith(expect.objectContaining({ type: 'NetworkError' }), expect.stringContaining('[ApolloLinkNetworkError]: Response not successful: Received status code 500'));
    });
    it('should not retry on a 400 client error', async () => {
        mockFetch.mockResolvedValueOnce({
            ok: false,
            status: 400,
            statusText: 'Bad Request',
            json: async () => ({ errors: [{ message: 'Bad Request' }] }),
            text: async () => JSON.stringify({ errors: [{ message: 'Bad Request' }] }),
            headers: new Headers({ 'Content-Type': 'application/json' }),
        });
        await expect(client.query({ query: GET_TEST_DATA })).rejects.toThrow();
        expect(mockFetch).toHaveBeenCalledTimes(1);
        expect(mockedLogger.warn).not.toHaveBeenCalledWith(expect.stringContaining('RetryLink: Retrying due to server error.'), expect.anything());
        expect(mockedLogger.debug).toHaveBeenCalledWith(
        // RetryLink logs 'Not retrying' at debug
        expect.objectContaining({
            message: expect.stringContaining('RetryLink: Not retrying this error.'),
        }), expect.anything());
        expect(mockedLogger.error).toHaveBeenCalledWith(
        // onError link logs the final error
        expect.objectContaining({ type: 'NetworkError' }), expect.stringContaining('[ApolloLinkNetworkError]: Response not successful: Received status code 400'));
    });
    it('should retry on a network error (fetch throws)', async () => {
        mockFetch
            .mockRejectedValueOnce(new TypeError('Network request failed')) // Attempt 1: Network error
            .mockResolvedValueOnce({
            // Attempt 2: Succeeds
            ok: true,
            json: async () => ({
                data: { testData: { id: '1', value: 'network retry success' } },
            }),
            text: async () => JSON.stringify({
                data: { testData: { id: '1', value: 'network retry success' } },
            }),
            headers: new Headers({ 'Content-Type': 'application/json' }),
        });
        const { data } = await client.query({ query: GET_TEST_DATA });
        expect(data.testData.value).toBe('network retry success');
        expect(mockFetch).toHaveBeenCalledTimes(2);
        expect(mockedLogger.warn).toHaveBeenCalledWith(expect.objectContaining({
            message: expect.stringContaining('RetryLink: Retrying due to network error.'),
        }), expect.anything());
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBvbGxvLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJhcG9sbG8udGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLDJDQU93QjtBQUl4Qix5Q0FBZ0QsQ0FBQyxnQkFBZ0I7QUFDakUsdURBQXlDLENBQUMsMERBQTBEO0FBRXBHLHVDQUF1QztBQUN2QyxJQUFJLENBQUMsSUFBSSxDQUFDLG1DQUFtQyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDcEQsVUFBVSxFQUFFLElBQUk7SUFDaEIsT0FBTyxFQUFFO1FBQ1AsY0FBYyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxtQkFBbUIsQ0FBQztLQUNqRTtDQUNGLENBQUMsQ0FBQyxDQUFDO0FBRUosbUNBQW1DO0FBQ25DLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDL0IsZ0JBQWdCLEVBQUU7UUFDaEIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2hCLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ2pCO0NBQ0YsQ0FBQyxDQUFDLENBQUM7QUFDSixNQUFNLFlBQVksR0FBRyx5QkFBd0QsQ0FBQztBQUU5RSw0RUFBNEU7QUFDNUUsb0ZBQW9GO0FBQ3BGLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztBQUM1QixNQUFNLENBQUMsS0FBSyxHQUFHLFNBQWdCLENBQUM7QUFFaEMsUUFBUSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtJQUM1QyxJQUFJLE1BQXlCLENBQUM7SUFFOUIsTUFBTSxhQUFhLEdBQUcsSUFBQSxZQUFHLEVBQUE7Ozs7Ozs7R0FPeEIsQ0FBQztJQUVGLFVBQVUsQ0FBQyxHQUFHLEVB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bnRlbnQiOlsiaW1wb3J0IHtcbiAgQXBvbGxvQ2xpZW50LFxuICBncWwsXG4gIEh0dHBMaW5rLFxuICBJbk1lbW9yeUNhY2hlLFxuICBTZXJ2ZXJFcnJvcixcbiAgU2VydmVyUGFyc2VFcnJvcixcbn0gZnJvbSAnQGFwb2xsby9jbGllbnQnO1xuaW1wb3J0IHsgUmV0cnlMaW5rIH0gZnJvbSAnQGFwb2xsby9jbGllbnQvbGluay9yZXRyeSc7XG5pbXBvcnQgeyBvbkVycm9yIH0gZnJvbSAnQGFwb2xsby9jbGllbnQvbGluay9lcnJvcic7XG5pbXBvcnQgeyBzZXRDb250ZXh0IH0gZnJvbSAnQGFwb2xsby9jbGllbnQvbGluay9jb250ZXh0JztcbmltcG9ydCB7IGFwcFNlcnZpY2VMb2dnZXIgfSBmcm9tICcuLi8uLi9sb2dnZXInOyAvLyBBY3R1YWwgbG9nZ2VyXG5pbXBvcnQgbWFrZUFwb2xsb0NsaWVudCBmcm9tICcuLi9hcG9sbG8nOyAvLyBUaGUgZnVuY3Rpb24gd2Ugd2FudCB0byB0ZXN0IChpbmRpcmVjdGx5IGl0cyBSZXRyeUxpbmspXG5cbi8vIE1vY2sgU2Vzc2lvbiBmcm9tIHN1cGVydG9rZW5zLXdlYi1qc1xuamVzdC5tb2NrKCdzdXBlcnRva2Vucy13ZWItanMvcmVjaXBlL3Nlc3Npb24nLCAoKSA9PiAoe1xuICBfX2VzTW9kdWxlOiB0cnVlLFxuICBkZWZhdWx0OiB7XG4gICAgZ2V0QWNjZXNzVG9rZW46IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnbW9jay1hY2Nlc3MtdG9rZW4nKSxcbiAgfSxcbn0pKTtcblxuLy8gTW9jayB0aGUgbG9nZ2VyIGZvciB2ZXJpZmljYXRpb25cbmplc3QubW9jaygnLi4vLi4vbG9nZ2VyJywgKCkgPT4gKHtcbiAgYXBwU2VydmljZUxvZ2dlcjoge1xuICAgIGluZm86IGplc3QuZm4oKSxcbiAgICB3YXJuOiBqZXN0LmZuKCksXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgICBkZWJ1ZzogamVzdC5mbigpLFxuICB9LFxufSkpO1xuY29uc3QgbW9ja2VkTG9nZ2VyID0gYXBwU2VydmljZUxvZ2dlciBhcyBqZXN0Lk1vY2tlZDx0eXBlb2YgYXBwU2VydmljZUxvZ2dlcj47XG5cbi8vIE1vY2sgJ2dvdCcgd2hpY2ggbWlnaHQgYmUgdXNlZCBieSBIdHRwTGluayB1bmRlciB0aGUgaG9vZCwgb3Igbm9kZS1mZXRjaC5cbi8vIEZvciBIdHRwTGluaywgaXQgdHlwaWNhbGx5IHVzZXMgYGZldGNoYC4gV2UnbGwgbW9jayBnbG9iYWwgZmV0Y2ggZm9yIHRoZXNlIHRlc3RzLlxuY29uc3QgbW9ja0ZldGNoID0gamVzdC5mbigpO1xuZ2xvYmFsLmZldGNoID0gbW9ja0ZldGNoIGFzIGFueTtcblxuZGVzY3JpYmUoJ0Fwb2xsbyBDbGllbnQgd2l0aCBSZXRyeUxpbmsnLCAoKSA9PiB7XG4gIGxldCBjbGllbnQ6IEFwb2xsb0NsaWVudDxhbnk+O1xuXG4gIGNvbnN0IEdFVF9URVNUX0RBVEEgPSBncWxgXG4gICAgcXVlcnkgR2V0VGVzdERhdGEge1xuICAgICAgdGVzdERhdGEge1xuICAgICAgICBpZFxuICAgICAgICB2YWx1ZVxuICAgICAgfVxuICAgIH1cbiAgYDtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBtb2NrRmV0Y2gubW9ja1Jlc2V0KCk7XG4gICAgLy8gUmVzZXQgYWxsIGxvZ2dlciBzcGllc1xuICAgIE9iamVjdC52YWx1ZXMobW9ja2VkTG9nZ2VyKS5mb3JFYWNoKChtb2NrRm4pID0+IG1vY2tGbi5tb2NrUmVzZXQoKSk7XG5cbiAgICAvLyBDcmVhdGUgYSBuZXcgY2xpZW50IGZvciBlYWNoIHRlc3QgdG8gZW5zdXJlIGlzb2xhdGlvblxuICAgIC8vIG1ha2VBcG9sbG9DbGllbnQgZXhwZWN0cyBhIHRva2VuLCBidXQgaXQncyBmb3IgV2ViU29ja2V0LCBIdHRwTGluayB1c2VzIHNldENvbnRleHRcbiAgICBjbGllbnQgPSBtYWtlQXBvbGxvQ2xpZW50KCdtb2NrLXdzLXRva2VuJyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgc3VjY2VlZCBvbiB0aGUgZmlyc3QgYXR0ZW1wdCBpZiBmZXRjaCBpcyBzdWNjZXNzZnVsJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgb2s6IHRydWUsXG4gICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBkYXRhOiB7IHRlc3REYXRhOiB7IGlkOiAnMScsIHZhbHVlOiAnc3VjY2VzcycgfSB9IH0pLFxuICAgICAgdGV4dDogYXN5bmMgKCkgPT5cbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoeyBkYXRhOiB7IHRlc3REYXRhOiB7IGlkOiAnMScsIHZhbHVlOiAnc3VjY2VzcycgfSB9IH0pLFxuICAgICAgaGVhZGVyczogbmV3IEhlYWRlcnMoeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0pLFxuICAgIH0pO1xuXG4gICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBjbGllbnQucXVlcnkoeyBxdWVyeTogR0VUX1RFU1RfREFUQSB9KTtcbiAgICBleHBlY3QoZGF0YS50ZXN0RGF0YS52YWx1ZSkudG9CZSgnc3VjY2VzcycpO1xuICAgIGV4cGVjdChtb2NrRmV0Y2gpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICAvLyBMb2dnZXIgZm9yIFVOQVVUSEVOVElDQVRFRCBtaWdodCBzdGlsbCBiZSBjYWxsZWQgaWYgZXJyb3JMaW5rIGlzIHByb2Nlc3NlZCBldmVuIG9uIHN1Y2Nlc3MgZm9yIHNvbWUgcmVhc29uICh1bmxpa2VseSBmb3IgdGhpcyBwYXRoKVxuICAgIC8vIE1vcmUgc3BlY2lmaWMgbG9nZ2luZyBjaGVja3Mgd291bGQgZGVwZW5kIG9uIHdoYXQgUmV0cnlMaW5rIGxvZ3Mgb24gc3VjY2VzcyAodXN1YWxseSBub3RoaW5nKVxuICB9KTtcblxuICBpdCgnc2hvdWxkIHJldHJ5IG9uIGEgNTAzIHNlcnZlciBlcnJvciBhbmQgdGhlbiBzdWNjZWVkJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tGZXRjaFxuICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIC8vIEF0dGVtcHQgMTogRmFpbHMgd2l0aCA1MDNcbiAgICAgICAgb2s6IGZhbHNlLFxuICAgICAgICBzdGF0dXM6IDUwMyxcbiAgICAgICAgc3RhdHVzVGV4dDogJ1NlcnZpY2UgVW5hdmFpbGFibGUnLFxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBlcnJvcnM6IFt7IG1lc3NhZ2U6ICdTZXJ2aWNlIFVuYXZhaWxhYmxlJyB9XSB9KSxcbiAgICAgICAgdGV4dDogYXN5bmMgKCkgPT5cbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7IGVycm9yczogW3sgbWVzc2FnZTogJ1NlcnZpY2UgVW5hdmFpbGFibGUnIH1dIH0pLFxuICAgICAgICBoZWFkZXJzOiBuZXcgSGVhZGVycyh7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSksXG4gICAgICB9KVxuICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIC8vIEF0dGVtcHQgMjogU3VjY2VlZHNcbiAgICAgICAgb2s6IHRydWUsXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgZGF0YTogeyB0ZXN0RGF0YTogeyBpZDogJzEnLCB2YWx1ZTogJ3JldHJ5IHN1Y2Nlc3MnIH0gfSxcbiAgICAgICAgfSksXG4gICAgICAgIHRleHQ6IGFzeW5jICgpID0+XG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgZGF0YTogeyB0ZXN0RGF0YTogeyBpZDogJzEnLCB2YWx1ZTogJ3JldHJ5IHN1Y2Nlc3MnIH0gfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczogbmV3IEhlYWRlcnMoeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0pLFxuICAgICAgfSk7XG5cbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGNsaWVudC5xdWVyeSh7IHF1ZXJ5OiBHRVRfVEVTVF9EQVRBIH0pO1xuICAgIGV4cGVjdChkYXRhLnRlc3REYXRhLnZhbHVlKS50b0JlKCdyZXRyeSBzdWNjZXNzJyk7XG4gICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgIGV4cGVjdChtb2NrZWRMb2dnZXIud2FybikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgIG1lc3NhZ2U6IGV4cGVjdC5zdHJpbmdDb250YWluaW5nKFxuICAgICAgICAgICdSZXRyeUxpbms6IFJldHJ5aW5nIGR1ZSB0byBzZXJ2ZXIgZXJyb3IuJ1xuICAgICAgICApLFxuICAgICAgfSksXG4gICAgICBleHBlY3QuYW55dGhpbmcoKSAvLyBUaGlzIHdhcyB0aGUgZm9ybWF0IGluIHRoZSBSZXRyeUxpbmsgbG9nZ2VyIGNhbGxcbiAgICApO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGZhaWwgYWZ0ZXIgbWF4IHJldHJpZXMgZm9yIHBlcnNpc3RlbnQgNTAwIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgLy8gQWxsIGF0dGVtcHRzIGZhaWxcbiAgICAgIG9rOiBmYWxzZSxcbiAgICAgIHN0YXR1czogNTAwLFxuICAgICAgc3RhdHVzVGV4dDogJ0ludGVybmFsIFNlcnZlciBFcnJvcicsXG4gICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBlcnJvcnM6IFt7IG1lc3NhZ2U6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InIH1dIH0pLFxuICAgICAgdGV4dDogYXN5bmMgKCkgPT5cbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoeyBlcnJvcnM6IFt7IG1lc3NhZ2U6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InIH1dIH0pLFxuICAgICAgaGVhZGVyczogbmV3IEhlYWRlcnMoeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0pLFxuICAgIH0pO1xuXG4gICAgYXdhaXQgZXhwZWN0KGNsaWVudC5xdWVyeSh7IHF1ZXJ5OiBHRVRfVEVTVF9EQVRBIH0pKS5yZWplY3RzLnRvVGhyb3coKTsgLy8gVGhyb3dzIEFwb2xsb0Vycm9yXG4gICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDQpOyAvLyAxIGluaXRpYWwgKyAzIHJldHJpZXNcbiAgICBleHBlY3QobW9ja2VkTG9nZ2VyLndhcm4pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygzKTsgLy8gRm9yIGVhY2ggcmV0cnkgYXR0ZW1wdFxuICAgIGV4cGVjdChtb2NrZWRMb2dnZXIud2FybikudG9IYXZlQmVlbkxhc3RDYWxsZWRXaXRoKFxuICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICBtZXNzYWdlOiBleHBlY3Quc3RyaW5nQ29udGFpbmluZyhcbiAgICAgICAgICAnUmV0cnlMaW5rOiBSZXRyeWluZyBkdWUgdG8gc2VydmVyIGVycm9yLidcbiAgICAgICAgKSxcbiAgICAgIH0pLFxuICAgICAgZXhwZWN0LmFueXRoaW5nKClcbiAgICApO1xuICAgIC8vIFRoZSBvbkVycm9yIGxpbmsgd2lsbCBhbHNvIGxvZyB0aGUgZmluYWwgbmV0d29ya0Vycm9yXG4gICAgZXhwZWN0KG1vY2tlZExvZ2dlci5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IHR5cGU6ICdOZXR3b3JrRXJyb3InIH0pLFxuICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoXG4gICAgICAgICdbQXBvbGxvTGlua05ldHdvcmtFcnJvcl06IFJlc3BvbnNlIG5vdCBzdWNjZXNzZnVsOiBSZWNlaXZlZCBzdGF0dXMgY29kZSA1MDAnXG4gICAgICApXG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBub3QgcmV0cnkgb24gYSA0MDAgY2xpZW50IGVycm9yJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgb2s6IGZhbHNlLFxuICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICBzdGF0dXNUZXh0OiAnQmFkIFJlcXVlc3QnLFxuICAgICAganNvbjogYXN5bmMgKCkgPT4gKHsgZXJyb3JzOiBbeyBtZXNzYWdlOiAnQmFkIFJlcXVlc3QnIH1dIH0pLFxuICAgICAgdGV4dDogYXN5bmMgKCkgPT5cbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoeyBlcnJvcnM6IFt7IG1lc3NhZ2U6ICdCYWQgUmVxdWVzdCcgfV0gfSksXG4gICAgICBoZWFkZXJzOiBuZXcgSGVhZGVycyh7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSksXG4gICAgfSk7XG5cbiAgICBhd2FpdCBleHBlY3QoY2xpZW50LnF1ZXJ5KHsgcXVlcnk6IEdFVF9URVNUX0RBVEEgfSkpLnJlamVjdHMudG9UaHJvdygpO1xuICAgIGV4cGVjdChtb2NrRmV0Y2gpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICBleHBlY3QobW9ja2VkTG9nZ2VyLndhcm4pLm5vdC50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdSZXRyeUxpbms6IFJldHJ5aW5nIGR1ZSB0byBzZXJ2ZXIgZXJyb3IuJyksXG4gICAgICBleHBlY3QuYW55dGhpbmcoKVxuICAgICk7XG4gICAgZXhwZWN0KG1vY2tlZExvZ2dlci5kZWJ1ZykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAvLyBSZXRyeUxpbmsgbG9ncyAnTm90IHJldHJ5aW5nJyBhdCBkZWJ1Z1xuICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICBtZXNzYWdlOiBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnUmV0cnlMaW5rOiBOb3QgcmV0cnlpbmcgdGhpcyBlcnJvci4nKSxcbiAgICAgIH0pLFxuICAgICAgZXhwZWN0LmFueXRoaW5nKClcbiAgICApO1xuICAgIGV4cGVjdChtb2NrZWRMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgLy8gb25FcnJvciBsaW5rIGxvZ3MgdGhlIGZpbmFsIGVycm9yXG4gICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IHR5cGU6ICdOZXR3b3JrRXJyb3InIH0pLFxuICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoXG4gICAgICAgICdbQXBvbGxvTGlua05ldHdvcmtFcnJvcl06IFJlc3BvbnNlIG5vdCBzdWNjZXNzZnVsOiBSZWNlaXZlZCBzdGF0dXMgY29kZSA0MDAnXG4gICAgICApXG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCByZXRyeSBvbiBhIG5ldHdvcmsgZXJyb3IgKGZldGNoIHRocm93cyknLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja0ZldGNoXG4gICAgICAubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSkgLy8gQXR0ZW1wdCAxOiBOZXR3b3JrIGVycm9yXG4gICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgLy8gQXR0ZW1wdCAyOiBTdWNjZWVkc1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgICBkYXRhOiB7IHRlc3REYXRhOiB7IGlkOiAnMScsIHZhbHVlOiAnbmV0d29yayByZXRyeSBzdWNjZXNzJyB9IH0sXG4gICAgICAgIH0pLFxuICAgICAgICB0ZXh0OiBhc3luYyAoKSA9PlxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGRhdGE6IHsgdGVzdERhdGE6IHsgaWQ6ICcxJywgdmFsdWU6ICduZXR3b3JrIHJldHJ5IHN1Y2Nlc3MnIH0gfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczogbmV3IEhlYWRlcnMoeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0pLFxuICAgICAgfSk7XG5cbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGNsaWVudC5xdWVyeSh7IHF1ZXJ5OiBHRVRfVEVTVF9EQVRBIH0pO1xuICAgIGV4cGVjdChkYXRhLnRlc3REYXRhLnZhbHVlKS50b0JlKCduZXR3b3JrIHJldHJ5IHN1Y2Nlc3MnKTtcbiAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gICAgZXhwZWN0KG1vY2tlZExvZ2dlci53YXJuKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgbWVzc2FnZTogZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoXG4gICAgICAgICAgJ1JldHJ5TGluazogUmV0cnlpbmcgZHVlIHRvIG5ldHdvcmsgZXJyb3IuJ1xuICAgICAgICApLFxuICAgICAgfSksXG4gICAgICBleHBlY3QuYW55dGhpbmcoKVxuICAgICk7XG4gIH0pO1xufSk7XG4iXX0=