"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = handler;
// Next.js API route support: https://nextjs.org/docs/api-routes/introduction
const api_helper_1 = require("@lib/api-helper");
async function handler(req, res) {
    try {
        const body = req.body;
        if (body?.method === 'cancelMeetingAssist') {
            const id = body?.variables?.id;
            const meetingAssistCancelled = await (0, api_helper_1.cancelMeetingAssist)(id);
            if (meetingAssistCancelled?.id) {
                return res.status(200).json(meetingAssistCancelled);
            }
        }
        if (body?.method === 'getUserContactInfo') {
            const id = body?.variables?.id;
            const userContactInfo = await (0, api_helper_1.getUserContactInfo)(id);
            return res.status(200).json(userContactInfo);
        }
        if (body?.method === 'deleteMeetingAssistAttendee') {
            const id = body
                ?.variables?.id;
            const deletedMeetingAssistAttendee = await (0, api_helper_1.deleteMeetingAssistAttendee)(id);
            if (deletedMeetingAssistAttendee?.id) {
                return res.status(200).json(deletedMeetingAssistAttendee);
            }
        }
        if (body?.method === 'getMeetingAssist') {
            const id = body?.variables?.id;
            const meetingAssist = await (0, api_helper_1.getMeetingAssist)(id);
            if (meetingAssist?.id) {
                return res.status(200).json(meetingAssist);
            }
        }
        if (body?.method === 'getMeetingAssistAttendee') {
            const id = body?.variables
                ?.id;
            const meetingAssistAttendee = await (0, api_helper_1.getMeetingAssistAttendee)(id);
            return res.status(200).json(meetingAssistAttendee);
        }
        if (body?.method === 'upsertOneMeetingAssistAttendee') {
            const attendee = body
                ?.variables?.attendee;
            const meetingAssistAttendee = await (0, api_helper_1.upsertOneMeetingAssistAttendee)(attendee);
            if (meetingAssistAttendee?.id) {
                return res.status(200).json(meetingAssistAttendee);
            }
        }
        if (body?.method === 'updateMeetingAssistAttendanceCount') {
            const { id, attendeeCount, attendeeRespondedCount } = body?.variables;
            const meetingAssistUpdatedCount = await (0, api_helper_1.updateMeetingAssistAttendanceCount)(id, attendeeCount, attendeeRespondedCount);
            if (meetingAssistUpdatedCount?.id) {
                return res.status(200).json(meetingAssistUpdatedCount);
            }
        }
        if (body?.method === 'updateMeetingAssistInviteResponse') {
            const { id, response } = body?.variables;
            await (0, api_helper_1.updateMeetingAssistInviteResponse)(id, response);
            return res.status(204).end();
        }
        return res.status(404).end();
    }
    catch (e) {
        console.log(e, ' unable to get meeting assist');
        return res.status(404).end();
    }
    // res.status(200).json({ name: 'John Doe' })
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJuYWwtYXR0ZW5kZWUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbnRlcm5hbC1hdHRlbmRlZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQThEQSwwQkFzR0M7QUFwS0QsNkVBQTZFO0FBQzdFLGdEQVN5QjtBQW9EVixLQUFLLFVBQVUsT0FBTyxDQUNuQyxHQUFtQixFQUNuQixHQUtDO0lBRUQsSUFBSSxDQUFDO1FBQ0gsTUFBTSxJQUFJLEdBUWdELEdBQUcsQ0FBQyxJQUFJLENBQUM7UUFFbkUsSUFBSSxJQUFJLEVBQUUsTUFBTSxLQUFLLHFCQUFxQixFQUFFLENBQUM7WUFDM0MsTUFBTSxFQUFFLEdBQUksSUFBOEMsRUFBRSxTQUFTLEVBQUUsRUFBRSxDQUFDO1lBQzFFLE1BQU0sc0JBQXNCLEdBQUcsTUFBTSxJQUFBLGdDQUFtQixFQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzdELElBQUksc0JBQXNCLEVBQUUsRUFBRSxFQUFFLENBQUM7Z0JBQy9CLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsQ0FBQztZQUN0RCxDQUFDO1FBQ0gsQ0FBQztRQUVELElBQUksSUFBSSxFQUFFLE1BQU0sS0FBSyxvQkFBb0IsRUFBRSxDQUFDO1lBQzFDLE1BQU0sRUFBRSxHQUFJLElBQTZDLEVBQUUsU0FBUyxFQUFFLEVBQUUsQ0FBQztZQUN6RSxNQUFNLGVBQWUsR0FBRyxNQUFNLElBQUEsK0JBQWtCLEVBQUMsRUFBRSxDQUFDLENBQUM7WUFFckQsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUMvQyxDQUFDO1FBRUQsSUFBSSxJQUFJLEVBQUUsTUFBTSxLQUFLLDZCQUE2QixFQUFFLENBQUM7WUFDbkQsTUFBTSxFQUFFLEdBQUksSUFBc0Q7Z0JBQ2hFLEVBQUUsU0FBUyxFQUFFLEVBQUUsQ0FBQztZQUNs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QUFDO0lBQy9CLENBQUM7SUFDRCw2Q0FBNkM7QUFDL0MsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIE5leHQuanMgQVBJIHJvdXRlIHN1cHBvcnQ6IGh0dHBzOi8vbmV4dGpzLm9yZy9kb2NzL2FwaS1yb3V0ZXMvaW50cm9kdWN0aW9uXG5pbXBvcnQge1xuICBjYW5jZWxNZWV0aW5nQXNzaXN0LFxuICBkZWxldGVNZWV0aW5nQXNzaXN0QXR0ZW5kZWUsXG4gIGdldE1lZXRpbmdBc3Npc3QsXG4gIGdldE1lZXRpbmdBc3Npc3RBdHRlbmRlZSxcbiAgZ2V0VXNlckNvbnRhY3RJbmZvLFxuICB1cGRhdGVNZWV0aW5nQXNzaXN0QXR0ZW5kYW5jZUNvdW50LFxuICB1cGRhdGVNZWV0aW5nQXNzaXN0SW52aXRlUmVzcG9uc2UsXG4gIHVwc2VydE9uZU1lZXRpbmdBc3Npc3RBdHRlbmRlZSxcbn0gZnJvbSAnQGxpYi9hcGktaGVscGVyJztcbmltcG9ydCB7XG4gIE1lZXRpbmdBc3Npc3RBdHRlbmRlZVR5cGUsXG4gIE1lZXRpbmdBc3Npc3RUeXBlLFxuICBVc2VyQ29udGFjdEluZm9UeXBlLFxufSBmcm9tICdAbGliL3R5cGVzJztcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuXG50eXBlIFJlcXVlc3REYXRhRm9yR2V0VXNlckNvbnRhY3RJbmZvVHlwZSA9IHtcbiAgbWV0aG9kOiAnZ2V0VXNlckNvbnRhY3RJbmZvJztcbiAgdmFyaWFibGVzOiB7IGlkOiBzdHJpbmcgfTtcbn07XG5cbnR5cGUgUmVxdWVzdERhdGFGb3JDYW5jZWxNZWV0aW5nQXNzaXN0VHlwZSA9IHtcbiAgbWV0aG9kOiAnY2FuY2VsTWVldGluZ0Fzc2lzdCc7XG4gIHZhcmlhYmxlczogeyBpZDogc3RyaW5nIH07XG59O1xuXG50eXBlIFJlcXVlc3REYXRhRm9yRGVsZXRlTWVldGluZ0Fzc2lzdEF0dGVuZGVlVHlwZSA9IHtcbiAgbWV0aG9kOiAnZGVsZXRlTWVldGluZ0Fzc2lzdEF0dGVuZGVlJztcbiAgdmFyaWFibGVzOiB7IGlkOiBzdHJpbmcgfTtcbn07XG5cbnR5cGUgUmVxdWVzdERhdGFGb3JHZXRNZWV0aW5nQXNzaXN0VHlwZSA9IHtcbiAgbWV0aG9kOiAnZ2V0TWVldGluZ0Fzc2lzdCc7XG4gIHZhcmlhYmxlczogeyBpZDogc3RyaW5nIH07XG59O1xuXG50eXBlIFJlcXVlc3REYXRhRm9yR2V0TWVldGluZ0Fzc2lzdEF0dGVuZGVlVHlwZSA9IHtcbiAgbWV0aG9kOiAnZ2V0TWVldGluZ0Fzc2lzdEF0dGVuZGVlJztcbiAgdmFyaWFibGVzOiB7IGlkOiBzdHJpbmcgfTtcbn07XG5cbnR5cGUgUmVxdWVzdERhdGFGb3JVcHNlcnRNZWV0aW5nQXNzaXN0QXR0ZW5kZWVUeXBlID0ge1xuICBtZXRob2Q6ICd1cHNlcnRPbmVNZWV0aW5nQXNzaXN0QXR0ZW5kZWUnO1xuICB2YXJpYWJsZXM6IHsgYXR0ZW5kZWU6IE1lZXRpbmdBc3Npc3RBdHRlbmRlZVR5cGUgfTtcbn07XG5cbnR5cGUgUmVxdWVzdERhdGFGb3JVcGRhdGVNZWV0aW5nQXNzaXN0QXR0ZW5kYW5jZUNvdW50VHlwZSA9IHtcbiAgbWV0aG9kOiAndXBkYXRlTWVldGluZ0Fzc2lzdEF0dGVuZGFuY2VDb3VudCc7XG4gIHZhcmlhYmxlczoge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgYXR0ZW5kZWVDb3VudDogbnVtYmVyO1xuICAgIGF0dGVuZGVlUmVzcG9uZGVkQ291bnQ6IG51bWJlcjtcbiAgfTtcbn07XG5cbnR5cGUgUmVxdWVzdERhdGFGb3JVcGRhdGVNZWV0aW5nQXNzaXN0SW52aXRlUmVzcG9uc2VUeXBlID0ge1xuICBtZXRob2Q6ICd1cGRhdGVNZWV0aW5nQXNzaXN0SW52aXRlUmVzcG9uc2UnO1xuICB2YXJpYWJsZXM6IHsgaWQ6IHN0cmluZzsgcmVzcG9uc2U6ICdQRU5ESU5HJyB8ICdBVFRFTkRJTkcnIHwgJ0NBTkNFTExFRCcgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXG4gIHJlczogTmV4dEFwaVJlc3BvbnNlPFxuICAgIHwgTWVldGluZ0Fzc2lzdFR5cGVcbiAgICB8IE1lZXRpbmdBc3Npc3RBdHRlbmRlZVR5cGVcbiAgICB8IFVzZXJDb250YWN0SW5mb1R5cGVcbiAgICB8IHVuZGVmaW5lZFxuICA+XG4pIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5OlxuICAgICAgfCBSZXF1ZXN0RGF0YUZvckNhbmNlbE1lZXRpbmdBc3Npc3RUeXBlXG4gICAgICB8IFJlcXVlc3REYXRhRm9yRGVsZXRlTWVldGluZ0Fzc2lzdEF0dGVuZGVlVHlwZVxuICAgICAgfCBSZXF1ZXN0RGF0YUZvckdldE1lZXRpbmdBc3Npc3RUeXBlXG4gICAgICB8IFJlcXVlc3REYXRhRm9yR2V0TWVldGluZ0Fzc2lzdEF0dGVuZGVlVHlwZVxuICAgICAgfCBSZXF1ZXN0RGF0YUZvclVwc2VydE1lZXRpbmdBc3Npc3RBdHRlbmRlZVR5cGVcbiAgICAgIHwgUmVxdWVzdERhdGFGb3JVcGRhdGVNZWV0aW5nQXNzaXN0QXR0ZW5kYW5jZUNvdW50VHlwZVxuICAgICAgfCBSZXF1ZXN0RGF0YUZvckdldFVzZXJDb250YWN0SW5mb1R5cGVcbiAgICAgIHwgUmVxdWVzdERhdGFGb3JVcGRhdGVNZWV0aW5nQXNzaXN0SW52aXRlUmVzcG9uc2VUeXBlID0gcmVxLmJvZHk7XG5cbiAgICBpZiAoYm9keT8ubWV0aG9kID09PSAnY2FuY2VsTWVldGluZ0Fzc2lzdCcpIHtcbiAgICAgIGNvbnN0IGlkID0gKGJvZHkgYXMgUmVxdWVzdERhdGFGb3JDYW5jZWxNZWV0aW5nQXNzaXN0VHlwZSk/LnZhcmlhYmxlcz8uaWQ7XG4gICAgICBjb25zdCBtZWV0aW5nQXNzaXN0Q2FuY2VsbGVkID0gYXdhaXQgY2FuY2VsTWVldGluZ0Fzc2lzdChpZCk7XG4gICAgICBpZiAobWVldGluZ0Fzc2lzdENhbmNlbGxlZD8uaWQpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKG1lZXRpbmdBc3Npc3RDYW5jZWxsZWQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChib2R5Py5tZXRob2QgPT09ICdnZXRVc2VyQ29udGFjdEluZm8nKSB7XG4gICAgICBjb25zdCBpZCA9IChib2R5IGFzIFJlcXVlc3REYXRhRm9yR2V0VXNlckNvbnRhY3RJbmZvVHlwZSk/LnZhcmlhYmxlcz8uaWQ7XG4gICAgICBjb25zdCB1c2VyQ29udGFjdEluZm8gPSBhd2FpdCBnZXRVc2VyQ29udGFjdEluZm8oaWQpO1xuXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24odXNlckNvbnRhY3RJbmZvKTtcbiAgICB9XG5cbiAgICBpZiAoYm9keT8ubWV0aG9kID09PSAnZGVsZXRlTWVldGluZ0Fzc2lzdEF0dGVuZGVlJykge1xuICAgICAgY29uc3QgaWQgPSAoYm9keSBhcyBSZXF1ZXN0RGF0YUZvckRlbGV0ZU1lZXRpbmdBc3Npc3RBdHRlbmRlZVR5cGUpXG4gICAgICAgID8udmFyaWFibGVzPy5pZDtcbiAgICAgIGNvbnN0IGRlbGV0ZWRNZWV0aW5nQXNzaXN0QXR0ZW5kZWUgPVxuICAgICAgICBhd2FpdCBkZWxldGVNZWV0aW5nQXNzaXN0QXR0ZW5kZWUoaWQpO1xuICAgICAgaWYgKGRlbGV0ZWRNZWV0aW5nQXNzaXN0QXR0ZW5kZWU/LmlkKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihkZWxldGVkTWVldGluZ0Fzc2lzdEF0dGVuZGVlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoYm9keT8ubWV0aG9kID09PSAnZ2V0TWVldGluZ0Fzc2lzdCcpIHtcbiAgICAgIGNvbnN0IGlkID0gKGJvZHkgYXMgUmVxdWVzdERhdGFGb3JHZXRNZWV0aW5nQXNzaXN0VHlwZSk/LnZhcmlhYmxlcz8uaWQ7XG4gICAgICBjb25zdCBtZWV0aW5nQXNzaXN0ID0gYXdhaXQgZ2V0TWVldGluZ0Fzc2lzdChpZCk7XG4gICAgICBpZiAobWVldGluZ0Fzc2lzdD8uaWQpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKG1lZXRpbmdBc3Npc3QpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChib2R5Py5tZXRob2QgPT09ICdnZXRNZWV0aW5nQXNzaXN0QXR0ZW5kZWUnKSB7XG4gICAgICBjb25zdCBpZCA9IChib2R5IGFzIFJlcXVlc3REYXRhRm9yR2V0TWVldGluZ0Fzc2lzdEF0dGVuZGVlVHlwZSk/LnZhcmlhYmxlc1xuICAgICAgICA/LmlkO1xuICAgICAgY29uc3QgbWVldGluZ0Fzc2lzdEF0dGVuZGVlID0gYXdhaXQgZ2V0TWVldGluZ0Fzc2lzdEF0dGVuZGVlKGlkKTtcblxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKG1lZXRpbmdBc3Npc3RBdHRlbmRlZSk7XG4gICAgfVxuXG4gICAgaWYgKGJvZHk/Lm1ldGhvZCA9PT0gJ3Vwc2VydE9uZU1lZXRpbmdBc3Npc3RBdHRlbmRlZScpIHtcbiAgICAgIGNvbnN0IGF0dGVuZGVlID0gKGJvZHkgYXMgUmVxdWVzdERhdGFGb3JVcHNlcnRNZWV0aW5nQXNzaXN0QXR0ZW5kZWVUeXBlKVxuICAgICAgICA/LnZhcmlhYmxlcz8uYXR0ZW5kZWU7XG4gICAgICBjb25zdCBtZWV0aW5nQXNzaXN0QXR0ZW5kZWUgPVxuICAgICAgICBhd2FpdCB1cHNlcnRPbmVNZWV0aW5nQXNzaXN0QXR0ZW5kZWUoYXR0ZW5kZWUpO1xuICAgICAgaWYgKG1lZXRpbmdBc3Npc3RBdHRlbmRlZT8uaWQpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKG1lZXRpbmdBc3Npc3RBdHRlbmRlZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGJvZHk/Lm1ldGhvZCA9PT0gJ3VwZGF0ZU1lZXRpbmdBc3Npc3RBdHRlbmRhbmNlQ291bnQnKSB7XG4gICAgICBjb25zdCB7IGlkLCBhdHRlbmRlZUNvdW50LCBhdHRlbmRlZVJlc3BvbmRlZENvdW50IH0gPSAoXG4gICAgICAgIGJvZHkgYXMgUmVxdWVzdERhdGFGb3JVcGRhdGVNZWV0aW5nQXNzaXN0QXR0ZW5kYW5jZUNvdW50VHlwZVxuICAgICAgKT8udmFyaWFibGVzO1xuXG4gICAgICBjb25zdCBtZWV0aW5nQXNzaXN0VXBkYXRlZENvdW50ID1cbiAgICAgICAgYXdhaXQgdXBkYXRlTWVldGluZ0Fzc2lzdEF0dGVuZGFuY2VDb3VudChcbiAgICAgICAgICBpZCxcbiAgICAgICAgICBhdHRlbmRlZUNvdW50LFxuICAgICAgICAgIGF0dGVuZGVlUmVzcG9uZGVkQ291bnRcbiAgICAgICAgKTtcbiAgICAgIGlmIChtZWV0aW5nQXNzaXN0VXBkYXRlZENvdW50Py5pZCkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24obWVldGluZ0Fzc2lzdFVwZGF0ZWRDb3VudCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGJvZHk/Lm1ldGhvZCA9PT0gJ3VwZGF0ZU1lZXRpbmdBc3Npc3RJbnZpdGVSZXNwb25zZScpIHtcbiAgICAgIGNvbnN0IHsgaWQsIHJlc3BvbnNlIH0gPSAoXG4gICAgICAgIGJvZHkgYXMgUmVxdWVzdERhdGFGb3JVcGRhdGVNZWV0aW5nQXNzaXN0SW52aXRlUmVzcG9uc2VUeXBlXG4gICAgICApPy52YXJpYWJsZXM7XG5cbiAgICAgIGF3YWl0IHVwZGF0ZU1lZXRpbmdBc3Npc3RJbnZpdGVSZXNwb25zZShpZCwgcmVzcG9uc2UpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjA0KS5lbmQoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmVuZCgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5sb2coZSwgJyB1bmFibGUgdG8gZ2V0IG1lZXRpbmcgYXNzaXN0Jyk7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5lbmQoKTtcbiAgfVxuICAvLyByZXMuc3RhdHVzKDIwMCkuanNvbih7IG5hbWU6ICdKb2huIERvZScgfSlcbn1cbiJdfQ==