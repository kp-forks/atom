import { triggerZap as trigger } from './zapierSkills';
import { handleError } from '../../_utils/errorHandler';
export async function handleTriggerZap(entities) {
    try {
        const { zap_name, data } = entities;
        if (!zap_name || typeof zap_name !== 'string') {
            return 'Zap name is required to trigger a Zap via NLU.';
        }
        else {
            const zapData = typeof data === 'object' && data !== null ? data : {};
            const response = await trigger(zap_name, zapData);
            if (response.success) {
                return `Zap triggered via NLU: ${response.message} (Run ID: ${response.runId})`;
            }
            else {
                return `Failed to trigger Zap via NLU: ${response.message}`;
            }
        }
    }
    catch (error) {
        return handleError(error, "Sorry, I couldn't trigger the Zap due to an error (NLU path).");
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiemFwaWVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiemFwaWVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxVQUFVLElBQUksT0FBTyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDdkQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBRXhELE1BQU0sQ0FBQyxLQUFLLFVBQVUsZ0JBQWdCLENBQUMsUUFBYTtJQUNsRCxJQUFJLENBQUM7UUFDSCxNQUFNLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxHQUFHLFFBQVEsQ0FBQztRQUNwQyxJQUFJLENBQUMsUUFBUSxJQUFJLE9BQU8sUUFBUSxLQUFLLFFBQVEsRUFBRSxDQUFDO1lBQzlDLE9BQU8sZ0RBQWdELENBQUM7UUFDMUQsQ0FBQzthQUFNLENBQUM7WUFDTixNQUFNLE9BQU8sR0FDWCxPQUFPLElBQUksS0FBSyxRQUFRLElBQUksSUFBSSxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDeEQsTUFBTSxRQUFRLEdBQXVCLE1BQU0sT0FBTyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztZQUN0RSxJQUFJLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQztnQkFDckIsT0FBTywwQkFBMEIsUUFBUSxDQUFDLE9BQU8sYUFBYSxRQUFRLENBQUMsS0FBSyxHQUFHLENBQUM7WUFDbEYsQ0FBQztpQkFBTSxDQUFDO2dCQUNOLE9BQU8sa0NBQWtDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUM5RCxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUM7SUFBQyxPQUFPLEtBQVUsRUFBRSxDQUFDO1FBQ3BCLE9BQU8sV0FBVyxDQUNoQixLQUFLLEVBQ0wsK0RBQStELENBQ2hFLENBQUM7SUFDSixDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFphcFRyaWdnZXJSZXNwb25zZSwgWmFwRGF0YSB9IGZyb20gJy4uLy4uL3R5cGVzJztcbmltcG9ydCB7IHRyaWdnZXJaYXAgYXMgdHJpZ2dlciB9IGZyb20gJy4vemFwaWVyU2tpbGxzJztcbmltcG9ydCB7IGhhbmRsZUVycm9yIH0gZnJvbSAnLi4vLi4vX3V0aWxzL2Vycm9ySGFuZGxlcic7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVUcmlnZ2VyWmFwKGVudGl0aWVzOiBhbnkpOiBQcm9taXNlPHN0cmluZz4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgemFwX25hbWUsIGRhdGEgfSA9IGVudGl0aWVzO1xuICAgIGlmICghemFwX25hbWUgfHwgdHlwZW9mIHphcF9uYW1lICE9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuICdaYXAgbmFtZSBpcyByZXF1aXJlZCB0byB0cmlnZ2VyIGEgWmFwIHZpYSBOTFUuJztcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgemFwRGF0YTogWmFwRGF0YSA9XG4gICAgICAgIHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JyAmJiBkYXRhICE9PSBudWxsID8gZGF0YSA6IHt9O1xuICAgICAgY29uc3QgcmVzcG9uc2U6IFphcFRyaWdnZXJSZXNwb25zZSA9IGF3YWl0IHRyaWdnZXIoemFwX25hbWUsIHphcERhdGEpO1xuICAgICAgaWYgKHJlc3BvbnNlLnN1Y2Nlc3MpIHtcbiAgICAgICAgcmV0dXJuIGBaYXAgdHJpZ2dlcmVkIHZpYSBOTFU6ICR7cmVzcG9uc2UubWVzc2FnZX0gKFJ1biBJRDogJHtyZXNwb25zZS5ydW5JZH0pYDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBgRmFpbGVkIHRvIHRyaWdnZXIgWmFwIHZpYSBOTFU6ICR7cmVzcG9uc2UubWVzc2FnZX1gO1xuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHJldHVybiBoYW5kbGVFcnJvcihcbiAgICAgIGVycm9yLFxuICAgICAgXCJTb3JyeSwgSSBjb3VsZG4ndCB0cmlnZ2VyIHRoZSBaYXAgZHVlIHRvIGFuIGVycm9yIChOTFUgcGF0aCkuXCJcbiAgICApO1xuICB9XG59XG4iXX0=