import * as conversationManager from './conversationState'; // Added for conversation management
import { initializeDB as initializeLanceDB } from '../lanceDBManager';
import { retrieveRelevantLTM, loadLTMToSTM, processSTMToLTM, } from './memoryManager';
import { understandMessage } from './skills/nluService';
import { // Added for Notion Tasks
LANCEDB_LTM_AGENT_TABLE_NAME, // Added for LTM table name
 } from '../_libs/constants';
import { handleGetCalendarEvents, } from './skills/calendar';
import { ReminderSkills } from './skills/reminderSkills';
// Define the TTS service URL
const AUDIO_PROCESSOR_TTS_URL = process.env.AUDIO_PROCESSOR_BASE_URL
    ? `${process.env.AUDIO_PROCESSOR_BASE_URL}/tts`
    : 'http://localhost:8080/tts';
// --- LanceDB Initialization ---
let ltmDbConnection = null;
async function initializeLtmDatabase() {
    try {
        ltmDbConnection = await initializeLanceDB('ltm_agent_data');
        if (ltmDbConnection) {
            console.log('[Handler] LanceDB LTM connection initialized successfully.');
        }
        else {
            console.error('[Handler] LanceDB LTM connection failed to initialize (returned null).');
        }
    }
    catch (error) {
        console.error('[Handler] Error initializing LanceDB LTM connection:', error);
        ltmDbConnection = null;
    }
}
initializeLtmDatabase();
// --- End Interface Definitions ---
async function _internalHandleMessage(interfaceType, message, userId, llm, 
// Options now uses the extended interface
options) {
    const reminderSkills = new ReminderSkills();
    await reminderSkills.processDueReminders();
    let textResponse;
    let structuredDataResponse = undefined; // Variable to hold structured data
    let conversationLtmContext = null;
    let nluResponse;
    const requestSource = options?.requestSource;
    const directIntentName = options?.intentName;
    const directEntities = options?.entities;
    const conversationId = options?.conversationId; // Available if needed
    // Construct the AgentSkillContext to be passed to skill handlers
    // This context now includes the sendCommandToClient function if it was provided by the caller.
    const agentSkillContext = {
        userId: userId,
        sendCommandToClient: options?.sendCommandToClientFunction ||
            (async (uid_unused, cmd_unused) => {
                // This default function is a fallback and logs a warning if no actual send function is provided.
                // It ensures that skills can always try to call context.sendCommandToClient without crashing,
                // but it won't actually send anything if the infrastructure isn't wired up from the caller.
                console.warn(`[AgentSkillContext] sendCommandToClient was called for user ${userId} ` +
                    `but no implementation was provided to _internalHandleMessage. Command was: ${JSON.stringify(cmd_unused)}`);
                return false; // Indicate failure to send
            }),
        // Potentially add other context items here if needed by various skills
    };
    if (requestSource === 'ScheduledJobExecutor' && directIntentName) {
        console.log(`[InternalHandleMessage][${interfaceType}] Received direct execution request from ScheduledJobExecutor. ConversationID: ${conversationId}`);
        nluResponse = {
            intent: directIntentName,
            entities: directEntities || {},
            // Ensure other necessary fields for ProcessedNLUResponse are present
            user_id: userId,
            original_query: `Scheduled task: ${directIntentName}`, // Construct a descriptive query
            // confidence: 1.0, // Assuming 100% confidence for direct execution
            // error: undefined
        };
        console.log(`[InternalHandleMessage][${interfaceType}] Bypassing NLU for scheduled task. Intent: ${nluResponse.intent}, Entities: ${JSON.stringify(nluResponse.entities)}`);
    }
    else {
        if (ltmDbConnection) {
            try {
                const relevantLtm = await retrieveRelevantLTM(message, userId, ltmDbConnection, { table: LANCEDB_LTM_AGENT_TABLE_NAME });
                if (relevantLtm && relevantLtm.length > 0) {
                    console.log(`[Handler][${interfaceType}] Retrieved ${relevantLtm.length} items from LTM for query: ${message}. Storing in conversation state.`);
                    conversationManager.updateLTMContext(interfaceType, relevantLtm);
                    conversationLtmContext = relevantLtm;
                    const conversationStateActions = {
                        updateUserGoal: (goal) => conversationManager.updateUserGoal(interfaceType, goal),
                        updateIntentAndEntities: (intent, entities) => conversationManager.updateIntentAndEntities(interfaceType, intent, entities),
                        updateLtmRepoContext: (context) => conversationManager.updateLTMContext(interfaceType, context),
                    };
                    await loadLTMToSTM(relevantLtm, conversationStateActions);
                }
                else {
                    conversationManager.updateLTMContext(interfaceType, null);
                    conversationLtmContext = null;
                }
            }
            catch (error) {
                console.error(`[Handler][${interfaceType}] Error retrieving or loading LTM:`, error);
                conversationManager.updateLTMContext(interfaceType, null);
                conversationLtmContext = null;
            }
        }
        else {
            console.warn(`[Handler][${interfaceType}] LTM DB connection not available, skipping LTM retrieval.`);
            conversationManager.updateLTMContext(interfaceType, null);
            conversationLtmContext = null;
        }
        nluResponse = await understandMessage(message, undefined, conversationLtmContext, llm);
        console.log(`[InternalHandleMessage][${interfaceType}] NLU Response (with LTM context consideration):`, JSON.stringify(nluResponse, null, 2));
    }
    if (nluResponse.error && !nluResponse.intent) {
        // This condition might need adjustment if scheduled tasks (bypassing NLU) could still have an "error"
        // in the constructed nluResponse, though ideally they wouldn't if intent is present.
        console.error(`[InternalHandleMessage][${interfaceType}] NLU service critical error or no intent from scheduled task:`, nluResponse.error);
        textResponse =
            "Sorry, I'm having trouble understanding requests right now or processing the scheduled task. Please try again later.";
        const currentConvStateOnError = conversationManager.getConversationStateSnapshot(interfaceType);
        const ltmContextForErrorResponse = currentConvStateOnError.ltmContext;
        if (ltmContextForErrorResponse && ltmContextForErrorResponse.length > 0) {
            const firstLtmItem = ltmContextForErrorResponse[0]; // Type assertion still needed
            if (firstLtmItem && firstLtmItem.text) {
                // Check if text property exists
                let ltmPreamble = `I recall from our records that: "${firstLtmItem.text.substring(0, 150)}${firstLtmItem.text.length > 150 ? '...' : ''}". `;
                textResponse = ltmPreamble + textResponse;
                console.log(`[Handler][${interfaceType}] Augmented error response with LTM context: ${ltmPreamble}`);
            }
        }
        return {
            text: textResponse,
            nluResponse,
            structuredData: structuredDataResponse,
        };
    }
    // Process NLU response and execute skills
    // All console logs within this block should also be prefixed with [interfaceType]
    if (nluResponse.intent) {
        const entities = nluResponse.entities || {};
        // Log intent and entities with interfaceType
        console.log(`[Handler][${interfaceType}] Intent: ${nluResponse.intent}, Entities: ${JSON.stringify(entities)}`);
        try {
            switch (nluResponse.intent) {
                case 'GetCalendarEvents':
                    textResponse = await handleGetCalendarEvents(userId, entities, agentSkillContext.settings.integrations);
                    break;
                // ... (other cases)
                default:
                    textResponse = `I understood your intent as '${nluResponse.intent}', but I'm not set up to handle that yet.`;
            }
        }
        catch (error) {
            console.error(`[Handler][${interfaceType}] Error executing intent "${nluResponse.intent}":`, error.message, error.stack);
            textResponse = `Sorry, I encountered an error while trying to handle your request for "${nluResponse.intent}". Please try again.`;
        }
    }
    else if (message.toLowerCase() === 'help' ||
        message.toLowerCase() === '?') {
        // Check lowerCaseMessage for 'help'
        textResponse = `I can understand natural language for tasks like listing calendar events, creating HubSpot contacts, or sending Slack messages. Try "show me my next 3 meetings" or "create hubspot contact for jane@example.com name Jane Doe".
You can also use specific commands:
- "create hubspot contact and dm me details {JSON_DETAILS}"
- "create hubspot contact {JSON_DETAILS}" (for channel notifications)
// ... (help message content as before)
- And other general commands like "list emails", "read email <id>", "send email {JSON}", "search web <query>", "trigger zap <name> [with data {JSON}]".`;
    }
    else {
        if (nluResponse.error) {
            textResponse = `I had some trouble fully understanding that due to: ${nluResponse.error}. You can try rephrasing or use 'help'.`;
        }
        else {
            textResponse =
                "Sorry, I didn't quite understand your request. Please try rephrasing, or type 'help' to see what I can do.";
        }
    }
    // 4. Augment response with LTM context (New)
    console.log(`[Handler][${interfaceType}] Future enhancement: Implement relevance check for LTM items before augmenting response.`);
    const currentConvState = conversationManager.getConversationStateSnapshot(interfaceType);
    const ltmContextForResponse = currentConvState.ltmContext;
    if (ltmContextForResponse && ltmContextForResponse.length > 0) {
        const firstLtmItem = ltmContextForResponse[0]; // Type assertion still needed
        if (firstLtmItem && firstLtmItem.text) {
            // Check if text property exists
            let ltmPreamble = `I recall from our records that: "${firstLtmItem.text.substring(0, 150)}${firstLtmItem.text.length > 150 ? '...' : ''}". `;
            textResponse = ltmPreamble + textResponse;
            console.log(`[Handler][${interfaceType}] Augmented response with LTM context: ${ltmPreamble}`);
        }
    }
    return {
        text: textResponse,
        nluResponse,
        structuredData: structuredDataResponse,
    };
}
// --- New Exported Functions for Conversation Management ---
/**
 * Placeholder for user ID retrieval. In a real scenario, this would come from session, token, etc.
 */
function getCurrentUserId() {
    // For now, using a mock user ID. This should be replaced with actual user management.
    return 'mock_user_id_from_handler';
}
/**
 * Activates the conversation mode.
 * Assumed to be mapped to an HTTP endpoint like POST /atom-agent/activate
 */
export async function activateConversationWrapper() {
    console.log(`[Handler][voice] Received request to activate conversation (assumed for voice).`);
    // activateConversation itself now sets isAgentResponding to false.
    const result = conversationManager.activateConversation('voice');
    return { ...result, message: result.status };
}
/**
 * Deactivates the conversation mode.
 * Assumed to be mapped to an HTTP endpoint like POST /atom-agent/deactivate
 */
export async function deactivateConversationWrapper(reason = 'manual_deactivation') {
    console.log(`[Handler][voice] Received request to deactivate conversation. Reason: ${reason}`);
    // deactivateConversation itself now sets isAgentResponding to false.
    // Deactivates 'voice' by default. If text needs separate deactivation, it needs its own endpoint/logic.
    conversationManager.deactivateConversation('voice', reason);
    return {
        status: `Conversation deactivated due to ${reason}.`,
        active: false,
        message: `Conversation deactivated due to ${reason}.`,
    };
}
/**
 * Handles an interrupt signal.
 * Assumed to be mapped to an HTTP endpoint like POST /atom-agent/interrupt
 */
export async function handleInterruptWrapper() {
    console.log('[Handler][voice] Received interrupt signal.');
    // Key action: Signal that the agent should stop its current response processing/output.
    // Primarily for voice interface, as text doesn't usually have an agent "speaking" state to interrupt.
    conversationManager.setAgentResponding('voice', false);
    // Optional: Could also deactivate conversation entirely or just reset timer to allow immediate next command.
    // For now, just stopping agent response and keeping conversation active.
    // conversationManager.activateConversation('voice'); // This would reset the timer and keep it active.
    // Or, if an interrupt means "stop everything":
    // conversationManager.deactivateConversation('voice', "interrupt_signal");
    // For now, the primary effect is setting isAgentResponding = false for 'voice'.
    // The wake_word_detector will follow up with an activate & new conversation input for 'voice'.
    // This ensures the agent is receptive.
    // If there were long-running tasks tied to the previous response, they should ideally check
    // conversationManager.checkIfAgentIsResponding('voice') and halt. This is not implemented in skills yet.
    return {
        status: 'success',
        message: 'Interrupt signal processed for voice interface. Agent responding state set to false.',
    };
}
/**
 * Handles transcribed text input for an ongoing conversation.
 * Assumed to be mapped to an HTTP endpoint like POST /atom-agent/conversation
 * Expects payload: { "text": "user's transcribed speech" }
 */
export async function handleConversationInputWrapper(payload, optionsFromCaller // Added optionsFromCaller for passing sendCommandToClient
) {
    const interfaceType = 'voice'; // This wrapper is for voice interactions
    const { text } = payload;
    console.log(`[Handler][${interfaceType}] Received conversation input: "${text}"`);
    const userId = getCurrentUserId();
    conversationManager.recordUserInteraction(interfaceType, text);
    if (!conversationManager.isConversationActive(interfaceType)) {
        console.log(`[Handler][${interfaceType}] Conversation is not active. Ignoring input.`);
        conversationManager.setAgentResponding(interfaceType, false);
        return {
            error: 'Conversation not active. Please activate with wake word or activation command.',
            active: conversationManager.isConversationActive(interfaceType),
            message: 'Conversation is not active. Wake word or activation needed.',
        };
    }
    if (conversationManager.checkIfAgentIsResponding(interfaceType)) {
        console.warn(`[Handler][${interfaceType}] New input received while agent was still marked as responding.`);
        // This implies an interruption, so agent should stop current response.
        conversationManager.setAgentResponding(interfaceType, false);
    }
    conversationManager.setAgentResponding(interfaceType, true);
    console.log(`[Handler][${interfaceType}] Conversation active. Processing message...`);
    // Destructure structuredData as well from _internalHandleMessage
    const { text: coreResponseText, nluResponse, structuredData: structuredDataFromInternal, } = await _internalHandleMessage(interfaceType, text, userId, 
    // Pass the sendCommandToClient function in options for voice interactions
    // This needs to be correctly implemented in the server layer (e.g. server.ts for WebSockets)
    {
        sendCommandToClientFunction: optionsFromCaller?.sendCommandToClientFunction,
    } // Assuming optionsFromCaller is passed to handleConversationInputWrapper
    );
    // Record agent's core text response (before TTS) into conversation history
    // NLU results (intent, entities) from this turn can also be added to turnHistory here.
    const currentTurnIntent = nluResponse?.intent || undefined;
    const currentTurnEntities = nluResponse?.entities || undefined;
    conversationManager.recordAgentResponse(interfaceType, text, { text: coreResponseText }, currentTurnIntent, currentTurnEntities);
    // STM to LTM Processing (Fire-and-forget for now)
    if (ltmDbConnection) {
        try {
            const currentConversationState = conversationManager.getConversationStateSnapshot(interfaceType);
            processSTMToLTM(userId, currentConversationState, ltmDbConnection)
                .then(() => console.log(`[Handler][${interfaceType}] STM to LTM processing initiated.`))
                .catch((err) => console.error(`[Handler][${interfaceType}] Error in STM to LTM processing:`, err));
        }
        catch (error) {
            console.error(`[Handler][${interfaceType}] Error initiating STM to LTM processing:`, error);
        }
    }
    else {
        console.warn('[Handler] LTM DB connection not available, skipping STM to LTM processing.');
    }
    // TTS Synthesis (as before)
    try {
        const ttsPayload = { text: coreResponseText };
        const ttsResponse = await fetch(AUDIO_PROCESSOR_TTS_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(ttsPayload),
        });
        if (ttsResponse.ok) {
            const ttsResult = await ttsResponse.json();
            if (ttsResult.audio_url) {
                console.log(`[Handler][${interfaceType}] TTS synthesis successful. Audio URL generated.`);
                conversationManager.setAgentResponding(interfaceType, false); // Agent finished processing and responding
                // Include structuredData in the response if present
                return {
                    text: coreResponseText,
                    audioUrl: ttsResult.audio_url,
                    structuredData: structuredDataFromInternal,
                };
            }
            else {
                console.error(`[Handler][${interfaceType}] TTS response OK, but no audio_url:`, ttsResult);
                conversationManager.setAgentResponding(interfaceType, false); // Agent finished processing (with error)
                return {
                    text: coreResponseText,
                    error: 'TTS synthesis succeeded but no audio URL was returned.',
                    structuredData: structuredDataFromInternal,
                };
            }
        }
        else {
            const errorBody = await ttsResponse.text();
            console.error(`[Handler][${interfaceType}] TTS request failed:`, ttsResponse.status, errorBody);
            conversationManager.setAgentResponding(interfaceType, false); // Agent finished processing (with error)
            return {
                text: coreResponseText,
                error: `Failed to synthesize audio. Status: ${ttsResponse.status}`,
                structuredData: structuredDataFromInternal,
            };
        }
    }
    catch (error) {
        console.error(`[Handler][${interfaceType}] Error calling TTS service:`, error.message, error.stack);
        conversationManager.setAgentResponding(interfaceType, false); // Agent finished processing (with error)
        return {
            text: coreResponseText,
            error: 'Error occurred during audio synthesis.',
            structuredData: structuredDataFromInternal,
        };
    }
}
// Make sure handleConversationInputWrapper receives options: TempOptionsForCaller
// export async function handleConversationInputWrapper(
//   payload: { text: string },
//   optionsFromCaller?: TempOptionsForCaller // Added for passing sendCommandToClient
// ): Promise<HandleMessageResponse | { error: string; active: boolean; message?: string }> { ... }
/**
 * This is the original handleMessage function, primarily for Hasura Action.
 * It remains largely stateless and does not interact with isAgentResponding by default.
 * If Hasura actions need to be part of conversational flow, this would require more thought.
 */
export async function handleMessage(message, settings) {
    const interfaceType = 'text'; // This handler is for text-based interactions (e.g., Hasura)
    console.log(`[Handler][${interfaceType}] Received message: "${message}"`);
    const userId = getCurrentUserId();
    // Hasura actions are typically independent and don't use the conversation state's isAgentResponding flag.
    // If they were to, it would need careful consideration of how they fit into the conversation flow.
    // conversationManager.setAgentResponding(interfaceType, true);
    // Activate conversation for this interaction if not already active (for LTM context, etc.)
    // This is a simplified model; a more robust system might have explicit session management for text.
    if (!conversationManager.isConversationActive(interfaceType)) {
        conversationManager.activateConversation(interfaceType);
    }
    conversationManager.recordUserInteraction(interfaceType, message);
    // Destructure structuredData as well
    const { text: coreResponseText, nluResponse, structuredData: structuredDataFromInternal, } = await _internalHandleMessage(interfaceType, message, userId, settings.llm, 
    // For Hasura/text, sendCommandToClient is typically not available or needed unless specifically designed.
    // So, we might not pass sendCommandToClientFunction here, or pass a stub.
    // For now, assuming the default stub in _internalHandleMessage is sufficient if not provided.
    {} // Empty options, relying on default sendCommandToClient stub if skill attempts to use it.
    );
    // Record agent's response
    const currentTurnIntent = nluResponse?.intent || undefined;
    const currentTurnEntities = nluResponse?.entities || undefined;
    conversationManager.recordAgentResponse(interfaceType, message, { text: coreResponseText }, currentTurnIntent, currentTurnEntities);
    // STM to LTM Processing for text interface as well
    if (ltmDbConnection) {
        try {
            const currentConversationState = conversationManager.getConversationStateSnapshot(interfaceType);
            processSTMToLTM(userId, currentConversationState, ltmDbConnection)
                .then(() => console.log(`[Handler][${interfaceType}] STM to LTM processing initiated.`))
                .catch((err) => console.error(`[Handler][${interfaceType}] Error in STM to LTM processing:`, err));
        }
        catch (error) {
            console.error(`[Handler][${interfaceType}] Error initiating STM to LTM processing:`, error);
        }
    }
    // For 'text' interface, we do NOT call TTS.
    // conversationManager.setAgentResponding(interfaceType, false); // Agent has finished.
    // Deactivate after single text interaction, unless a longer session is desired.
    // For now, let's assume single interaction for Hasura.
    conversationManager.deactivateConversation(interfaceType, 'completed_text_interaction');
    // Include structuredData in the response
    return { text: coreResponseText, structuredData: structuredDataFromInternal };
}
// Example for testing the conversation state (manual activation)
// This would be mapped to an endpoint like /atom-agent/test-activate
export async function testActivateConversation() {
    // Test with 'voice' interface by default for this test wrapper
    conversationManager._test_setConversationActive('voice', true); // This itself calls activateConversation now
    return {
        status: 'Conversation manually activated for testing (voice interface) via _test_setConversationActive.',
        active: conversationManager.isConversationActive('voice'),
        agentResponding: conversationManager.checkIfAgentIsResponding('voice'),
    };
}
export async function testDeactivateConversation() {
    // Test with 'voice' interface by default
    conversationManager._test_setConversationActive('voice', false); // This itself calls deactivateConversation now
    return {
        status: 'Conversation manually deactivated for testing (voice interface) via _test_setConversationActive.',
        active: conversationManager.isConversationActive('voice'),
        agentResponding: conversationManager.checkIfAgentIsResponding('voice'),
    };
}
export async function getConversationStatus() {
    // Provide status for both interfaces
    return {
        voice_active: conversationManager.isConversationActive('voice'),
        voice_agentResponding: conversationManager.checkIfAgentIsResponding('voice'),
        text_active: conversationManager.isConversationActive('text'),
        text_agentResponding: conversationManager.checkIfAgentIsResponding('text'),
        voice_state: conversationManager.getConversationStateSnapshot('voice'),
        text_state: conversationManager.getConversationStateSnapshot('text'),
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFuZGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImhhbmRsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLG1CQUFtQixNQUFNLHFCQUFxQixDQUFDLENBQUMsb0NBQW9DO0FBMEhoRyxPQUFPLEVBQUUsWUFBWSxJQUFJLGlCQUFpQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUEyQnRFLE9BQU8sRUFDTCxtQkFBbUIsRUFDbkIsWUFBWSxFQUNaLGVBQWUsR0FFaEIsTUFBTSxpQkFBaUIsQ0FBQztBQWdEekIsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDeEQsT0FBTyxFQUkwQix5QkFBeUI7QUFDeEQsNEJBQTRCLEVBQUUsMkJBQTJCO0VBUzFELE1BQU0sb0JBQW9CLENBQUM7QUFnQjVCLE9BQU8sRUFDTCx1QkFBdUIsR0FFeEIsTUFBTSxtQkFBbUIsQ0FBQztBQXVEM0IsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBRXpELDZCQUE2QjtBQUM3QixNQUFNLHVCQUF1QixHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsd0JBQXdCO0lBQ2xFLENBQUMsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLE1BQU07SUFDL0MsQ0FBQyxDQUFDLDJCQUEyQixDQUFDO0FBRWhDLGlDQUFpQztBQUNqQyxJQUFJLGVBQWUsR0FBOEIsSUFBSSxDQUFDO0FBRXRELEtBQUssVUFBVSxxQkFBcUI7SUFDbEMsSUFBSSxDQUFDO1FBQ0gsZUFBZSxHQUFHLE1BQU0saUJBQWlCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUM1RCxJQUFJLGVBQWUsRUFBRSxDQUFDO1lBQ3BCLE9BQU8sQ0FBQyxHQUFHLENBQUMsNERBQTRELENBQUMsQ0FBQztRQUM1RSxDQUFDO2FBQU0sQ0FBQztZQUNOLE9BQU8sQ0FBQyxLQUFLLENBQ1gsd0VBQXdFLENBQ3pFLENBQUM7UUFDSixDQUFD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TCxNQUFNLEVBQ0osZ0dBQWdHO1FBQ2xHLE1BQU0sRUFBRSxtQkFBbUIsQ0FBQyxvQkFBb0IsQ0FBQyxPQUFPLENBQUM7UUFDekQsZUFBZSxFQUFFLG1CQUFtQixDQUFDLHdCQUF3QixDQUFDLE9BQU8sQ0FBQztLQUN2RSxDQUFDO0FBQ0osQ0FBQztBQUVELE1BQU0sQ0FBQyxLQUFLLFVBQVUsMEJBQTBCO0lBQzlDLHlDQUF5QztJQUN6QyxtQkFBbUIsQ0FBQywyQkFBMkIsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQywrQ0FBK0M7SUFDaEgsT0FBTztRQUNMLE1BQU0sRUFDSixrR0FBa0c7UUFDcEcsTUFBTSxFQUFFLG1CQUFtQixDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQztRQUN6RCxlQUFlLEVBQUUsbUJBQW1CLENBQUMsd0JBQXdCLENBQUMsT0FBTyxDQUFDO0tBQ3ZFLENBQUM7QUFDSixDQUFDO0FBRUQsTUFBTSxDQUFDLEtBQUssVUFBVSxxQkFBcUI7SUFDekMscUNBQXFDO0lBQ3JDLE9BQU87UUFDTCxZQUFZLEVBQUUsbUJBQW1CLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDO1FBQy9ELHFCQUFxQixFQUNuQixtQkFBbUIsQ0FBQyx3QkFBd0IsQ0FBQyxPQUFPLENBQUM7UUFDdkQsV0FBVyxFQUFFLG1CQUFtQixDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQztRQUM3RCxvQkFBb0IsRUFBRSxtQkFBbUIsQ0FBQyx3QkFBd0IsQ0FBQyxNQUFNLENBQUM7UUFDMUUsV0FBVyxFQUFFLG1CQUFtQixDQUFDLDRCQUE0QixDQUFDLE9BQU8sQ0FBQztRQUN0RSxVQUFVLEVBQUUsbUJBQW1CLENBQUMsNEJBQTRCLENBQUMsTUFBTSxDQUFDO0tBQ3JFLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgY29udmVyc2F0aW9uTWFuYWdlciBmcm9tICcuL2NvbnZlcnNhdGlvblN0YXRlJzsgLy8gQWRkZWQgZm9yIGNvbnZlcnNhdGlvbiBtYW5hZ2VtZW50XG5pbXBvcnQgdHlwZSB7IEludGVyZmFjZVR5cGUgfSBmcm9tICcuL2NvbnZlcnNhdGlvblN0YXRlJztcbi8vIGltcG9ydCB7IGxpc3RVcGNvbWluZ0V2ZW50cywgY3JlYXRlQ2FsZW5kYXJFdmVudCB9IGZyb20gJy4vc2tpbGxzL2NhbGVuZGFyU2tpbGxzJzsgLy8gV2lsbCBiZSByZS1pbXBvcnRlZCB3aXRoIG90aGVyc1xuLy8gaW1wb3J0IHsgbGlzdFJlY2VudEVtYWlscywgcmVhZEVtYWlsLCBzZW5kRW1haWwsIEVtYWlsRGV0YWlscyB9IGZyb20gJy4vc2tpbGxzL2VtYWlsU2tpbGxzJzsgLy8gV2lsbCBiZSByZS1pbXBvcnRlZFxuLy8gaW1wb3J0IHsgc2VhcmNoV2ViIH0gZnJvbSAnLi9za2lsbHMvd2ViUmVzZWFyY2hTa2lsbHMnOyAvLyBXaWxsIGJlIHJlLWltcG9ydGVkXG4vLyBpbXBvcnQgeyB0cmlnZ2VyWmFwLCBaYXBEYXRhIH0gZnJvbSAnLi9za2lsbHMvemFwaWVyU2tpbGxzJzsgLy8gV2lsbCBiZSByZS1pbXBvcnRlZFxuXG5pbXBvcnQge1xuICBDYWxlbmRhckV2ZW50LFxuICBDcmVhdGVFdmVudFJlc3BvbnNlLFxuICBFbWFpbCxcbiAgUmVhZEVtYWlsUmVzcG9uc2UsXG4gIFNlbmRFbWFpbFJlc3BvbnNlLFxuICBFbWFpbERldGFpbHMsXG4gIFNlYXJjaFJlc3VsdCxcbiAgWmFwVHJpZ2dlclJlc3BvbnNlLFxuICBaYXBEYXRhLFxuICBIdWJTcG90Q29udGFjdFByb3BlcnRpZXMsXG4gIENyZWF0ZUh1YlNwb3RDb250YWN0UmVzcG9uc2UsXG4gIEh1YlNwb3RDb250YWN0LFxuICBMaXN0Q2FsZW5kbHlFdmVudFR5cGVzUmVzcG9uc2UsXG4gIExpc3RDYWxlbmRseVNjaGVkdWxlZEV2ZW50c1Jlc3BvbnNlLFxuICBMaXN0Wm9vbU1lZXRpbmdzUmVzcG9uc2UsXG4gIEdldFpvb21NZWV0aW5nRGV0YWlsc1Jlc3BvbnNlLFxuICBab29tTWVldGluZyxcbiAgTGlzdEdvb2dsZU1lZXRFdmVudHNSZXNwb25zZSxcbiAgR2V0R29vZ2xlTWVldEV2ZW50RGV0YWlsc1Jlc3BvbnNlLFxuICBMaXN0TVNUZWFtc01lZXRpbmdzUmVzcG9uc2UsXG4gIEdldE1TVGVhbXNNZWV0aW5nRGV0YWlsc1Jlc3BvbnNlLFxuICBNU0dyYXBoRXZlbnQsXG4gIExpc3RTdHJpcGVQYXltZW50c1Jlc3BvbnNlLFxuICBHZXRTdHJpcGVQYXltZW50RGV0YWlsc1Jlc3BvbnNlLFxuICBTdHJpcGVQYXltZW50SW50ZW50LFxuICBMaXN0UXVpY2tCb29rc0ludm9pY2VzUmVzcG9uc2UsXG4gIEdldFF1aWNrQm9va3NJbnZvaWNlRGV0YWlsc1Jlc3BvbnNlLFxuICBRdWlja0Jvb2tzSW52b2ljZSxcbiAgUHJvY2Vzc2VkTkxVUmVzcG9uc2UsXG4gIEx0bVF1ZXJ5UmVzdWx0LFxuICBTa2lsbEFyZ3MsIC8vIEFkZGVkIGZvciBTZW1hbnRpY1NlYXJjaE1lZXRpbmdOb3Rlc1xuICAvLyBTZW1hbnRpYyBTZWFyY2ggUmVzdWx0IFR5cGUgLSBmb3Igc3RydWN0dXJlZCBkYXRhXG4gIEFwaU1lZXRpbmdTZWFyY2hSZXN1bHQsIC8vIEFzc3VtaW5nIHRoaXMgdHlwZSBjYW4gYmUgaW1wb3J0ZWQgb3IgZGVmaW5lZFxuICAvLyBUYXNrIE1hbmFnZW1lbnQgVHlwZXNcbiAgQ3JlYXRlTm90aW9uVGFza1BhcmFtcyxcbiAgUXVlcnlOb3Rpb25UYXNrc1BhcmFtcyxcbiAgVXBkYXRlTm90aW9uVGFza1BhcmFtcyxcbiAgTm90aW9uVGFzayxcbiAgTm90aW9uVGFza1N0YXR1cyxcbiAgTm90aW9uVGFza1ByaW9yaXR5LFxuICBUYXNrUXVlcnlSZXNwb25zZSwgLy8gUmVzcG9uc2UgdHlwZSBmb3IgcXVlcnlOb3Rpb25UYXNrcyBza2lsbFxuICBTa2lsbFJlc3BvbnNlLCAvLyBHZW5lcmljIHNraWxsIHJlc3BvbnNlXG4gIENyZWF0ZVRhc2tEYXRhLCAvLyBEYXRhIHR5cGUgZm9yIENyZWF0ZVRhc2sgc2tpbGwgcmVzcG9uc2VcbiAgVXBkYXRlVGFza0RhdGEsIC8vIERhdGEgdHlwZSBmb3IgVXBkYXRlVGFzayBza2lsbCByZXNwb25zZVxuICBTa2lsbEVycm9yLCAvLyBGb3IgZ2V0VXNlcklkQnlFbWFpbFxuICBQcmVwYXJlRm9yTWVldGluZ1Jlc3BvbnNlLCAvLyBBZGRlZCBmb3IgU21hcnQgTWVldGluZyBQcmVwXG4gIFByZXBhcmVGb3JNZWV0aW5nRW50aXRpZXMsIC8vIEFkZGVkIGZvciBTbWFydCBNZWV0aW5nIFByZXBcbiAgR2VuZXJhdGVXZWVrbHlEaWdlc3RSZXNwb25zZSwgLy8gQWRkZWQgZm9yIFdlZWtseSBEaWdlc3RcbiAgR2VuZXJhdGVXZWVrbHlEaWdlc3RFbnRpdGllcywgLy8gQWRkZWQgZm9yIFdlZWtseSBEaWdlc3RcbiAgU3VnZ2VzdEZvbGxvd1Vwc1Jlc3BvbnNlLCAvLyBBZGRlZCBmb3IgRm9sbG93LXVwIFN1Z2dlc3RlclxuICBTdWdnZXN0Rm9sbG93VXBzRW50aXRpZXMsIC8vIEFkZGVkIGZvciBGb2xsb3ctdXAgU3VnZ2VzdGVyXG4gIC8vIFR5cGVzIGZvciBDb21wbGV4VGFzayBPcmNoZXN0cmF0aW9uXG4gIENvbXBsZXhUYXNrU3ViVGFza05sdSxcbiAgRXhlY3V0ZWRTdWJUYXNrUmVzdWx0LFxuICBPcmNoZXN0cmF0ZWRDb21wbGV4VGFza1JlcG9ydCxcbiAgQWdlbnRDbGllbnRDb21tYW5kLCAvLyBJbXBvcnQgZnJvbSBjZW50cmFsIHR5cGVzXG4gIEFnZW50U2tpbGxDb250ZXh0LCAvLyBJbXBvcnQgZnJvbSBjZW50cmFsIHR5cGVzXG59IGZyb20gJy4uL3R5cGVzJztcblxuLy8gSW1wb3J0IHRoZSBzcGVjaWZpYyBza2lsbCByZXNwb25zZSB0eXBlIGlmIGF2YWlsYWJsZSwgb3IgZGVmaW5lIGxvY2FsbHlcbi8vIEZvciBTZW1hbnRpY1NlYXJjaE1lZXRpbmdOb3RlcywgdGhlIHNraWxsIHJldHVybnMgUHJvbWlzZTxzdHJpbmcgfCB7IGRpc3BsYXlUeXBlOiAnc2VtYW50aWNfc2VhcmNoX3Jlc3VsdHMnOyBzdW1tYXJ5VGV4dDogc3RyaW5nOyBkYXRhOiBBcGlNZWV0aW5nU2VhcmNoUmVzdWx0W10gfT5cbi8vIFdlIG5lZWQgQXBpTWVldGluZ1NlYXJjaFJlc3VsdCBkZWZpbml0aW9uLiBGb3Igbm93LCBsZXQncyBhc3N1bWUgaXQncyBhdmFpbGFibGUgdmlhICcuLi90eXBlcycgb3Igd2UnbGwgZGVmaW5lIGEgcGxhY2Vob2xkZXIuXG4vLyBJZiBpdCdzIG5vdCBpbiB0eXBlcywgbGV0J3MgZGVmaW5lIGEgcGxhY2Vob2xkZXIgZm9yIHRoZSBkYXRhIHBhcnQgb2Ygc2VtYW50aWMgc2VhcmNoXG5pbnRlcmZhY2UgUGxhY2Vob2xkZXJBcGlNZWV0aW5nU2VhcmNoUmVzdWx0IHtcbiAgbm90aW9uX3BhZ2VfaWQ6IHN0cmluZztcbiAgbm90aW9uX3BhZ2VfdGl0bGU6IHN0cmluZztcbiAgbm90aW9uX3BhZ2VfdXJsOiBzdHJpbmc7XG4gIHRleHRfcHJldmlldzogc3RyaW5nO1xuICBsYXN0X2VkaXRlZDogc3RyaW5nO1xuICBzY29yZTogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgU2VtYW50aWNTZWFyY2hTdHJ1Y3R1cmVkRGF0YSB7XG4gIGRpc3BsYXlUeXBlOiAnc2VtYW50aWNfc2VhcmNoX3Jlc3VsdHMnO1xuICBzdW1tYXJ5VGV4dDogc3RyaW5nO1xuICBkYXRhOiBQbGFjZWhvbGRlckFwaU1lZXRpbmdTZWFyY2hSZXN1bHRbXTtcbn1cblxuaW1wb3J0IHsgZXhlY3V0ZUdyYXBoUUxRdWVyeSB9IGZyb20gJy4vX2xpYnMvZ3JhcGhxbENsaWVudCc7IC8vIEZvciBnZXRVc2VySWRCeUVtYWlsXG5cbi8vIC0tLSBJbnRlcmZhY2UgRGVmaW5pdGlvbnMgZm9yIEFnZW50LUNsaWVudCBDb21tdW5pY2F0aW9uIGFuZCBTa2lsbCBDb250ZXh0IC0tLVxuLy8gTG9jYWwgZGVmaW5pdGlvbnMgb2YgQWdlbnRDbGllbnRDb21tYW5kIGFuZCBBZ2VudFNraWxsQ29udGV4dCBhcmUgcmVtb3ZlZC5cbi8vIFRoZXkgYXJlIG5vdyBpbXBvcnRlZCBmcm9tICcuLi90eXBlcycuXG5cbi8vIEV4dGVuZCBleGlzdGluZyBvcHRpb25zIGZvciBfaW50ZXJuYWxIYW5kbGVNZXNzYWdlIHRvIGluY2x1ZGUgdGhlIHNlbmRDb21tYW5kVG9DbGllbnRGdW5jdGlvbi5cbi8vIFRoaXMgYWxsb3dzIHRoZSBjb3JlIG1lc3NhZ2UgaGFuZGxpbmcgbG9naWMgdG8gYmUgZXF1aXBwZWQgd2l0aCB0aGUgY2FwYWJpbGl0eSB0byBzZW5kIGNvbW1hbmRzIHRvIHRoZSBjbGllbnQuXG5pbnRlcmZhY2UgSW50ZXJuYWxIYW5kbGVNZXNzYWdlT3B0aW9ucyB7XG4gIHJlcXVlc3RTb3VyY2U/OiBzdHJpbmc7IC8vIFNvdXJjZSBvZiB0aGUgcmVxdWVzdCAoZS5nLiwgJ1dlYlNvY2tldENoYXQnLCAnU2NoZWR1bGVkSm9iRXhlY3V0b3InLCAnSGFzdXJhQWN0aW9uJylcbiAgaW50ZW50TmFtZT86IHN0cmluZzsgLy8gUHJlLWRldGVybWluZWQgaW50ZW50IG5hbWUsIGJ5cGFzc2luZyBOTFUgKGUuZy4sIGZvciBzY2hlZHVsZWQgdGFza3MpXG4gIGVudGl0aWVzPzogUmVjb3JkPHN0cmluZywgYW55PjsgLy8gUHJlLWRldGVybWluZWQgZW50aXRpZXNcbiAgY29udmVyc2F0aW9uSWQ/OiBzdHJpbmc7IC8vIElEIGZvciB0cmFja2luZyB0aGUgY29udmVyc2F0aW9uIHNlc3Npb25cbiAgc2VuZENvbW1hbmRUb0NsaWVudEZ1bmN0aW9uPzogKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGNvbW1hbmQ6IEFnZW50Q2xpZW50Q29tbWFuZFxuICApID0+IFByb21pc2U8Ym9vbGVhbj47IC8vIFRoZSBhY3R1YWwgZnVuY3Rpb24gdG8gc2VuZCBhIGNvbW1hbmRcbn1cbi8vIC0tLSBFbmQgSW50ZXJmYWNlIERlZmluaXRpb25zIC0tLVxuXG4vLyBpbXBvcnQgKiBhcyBjb252ZXJzYXRpb25NYW5hZ2VyIGZyb20gJy4vY29udmVyc2F0aW9uU3RhdGUnOyAvLyBBbHJlYWR5IGltcG9ydGVkIGF0IHRoZSB0b3Bcbi8vIE5vIGxvbmdlciBpbXBvcnRpbmcgaW5kaXZpZHVhbCBmdW5jdGlvbnMgZGlyZWN0bHksIHdpbGwgdXNlIGNvbnZlcnNhdGlvbk1hbmFnZXIuXG4vLyBpbXBvcnQge1xuLy8gZ2V0Q29udmVyc2F0aW9uU3RhdGVTbmFwc2hvdCxcbi8vIHVwZGF0ZUxUTUNvbnRleHQsXG4vLyB1cGRhdGVVc2VyR29hbCxcbi8vIHVwZGF0ZUludGVudEFuZEVudGl0aWVzXG4vLyB9IGZyb20gJy4vY29udmVyc2F0aW9uU3RhdGUnO1xuaW1wb3J0IHsgaGFuZGxlU2VtYW50aWNTZWFyY2hNZWV0aW5nTm90ZXNTa2lsbCB9IGZyb20gJy4vc2tpbGxzL3NlbWFudGljU2VhcmNoU2tpbGxzJztcbmltcG9ydCB7XG4gIGNyZWF0ZU5vdGlvblRhc2ssXG4gIHF1ZXJ5Tm90aW9uVGFza3MsXG4gIC8vIGNyZWF0ZU5vdGlvblRhc2ssIC8vIE5vdyBoYW5kbGVkIGJ5IGNyZWF0ZU5vdGlvblRhc2tDb21tYW5kSGFuZGxlclxuICAvLyBxdWVyeU5vdGlvblRhc2tzLCAvLyBOb3cgaGFuZGxlZCBieSBxdWVyeU5vdGlvblRhc2tzQ29tbWFuZEhhbmRsZXJcbiAgLy8gdXBkYXRlTm90aW9uVGFzayAvLyBOb3cgaGFuZGxlZCBieSB1cGRhdGVOb3Rpb25UYXNrQ29tbWFuZEhhbmRsZXJcbn0gZnJvbSAnLi9za2lsbHMvbm90aW9uQW5kUmVzZWFyY2hTa2lsbHMnO1xuaW1wb3J0IHsgaW5pdGlhbGl6ZURCIGFzIGluaXRpYWxpemVMYW5jZURCIH0gZnJvbSAnLi4vbGFuY2VEQk1hbmFnZXInO1xuaW1wb3J0ICogYXMgbGFuY2VkYiBmcm9tICdAbGFuY2VkYi9sYW5jZWRiJztcbi8vIEltcG9ydCBuZXcgY29tbWFuZCBoYW5kbGVycyBmb3IgTm90aW9uIHRhc2tzXG5pbXBvcnQgeyBoYW5kbGVDcmVhdGVUYXNrUmVxdWVzdCB9IGZyb20gJy4vY29tbWFuZF9oYW5kbGVycy9jcmVhdGVOb3Rpb25UYXNrQ29tbWFuZEhhbmRsZXInO1xuaW1wb3J0IHsgaGFuZGxlUXVlcnlUYXNrc1JlcXVlc3QgfSBmcm9tICcuL2NvbW1hbmRfaGFuZGxlcnMvcXVlcnlOb3Rpb25UYXNrc0NvbW1hbmRIYW5kbGVyJztcbmltcG9ydCB7IGhhbmRsZVVwZGF0ZVRhc2tSZXF1ZXN0IH0gZnJvbSAnLi9jb21tYW5kX2hhbmRsZXJzL3VwZGF0ZU5vdGlvblRhc2tDb21tYW5kSGFuZGxlcic7XG4vLyBJbXBvcnQgbmV3IEdtYWlsIHNraWxsc1xuaW1wb3J0IHtcbiAgaGFuZGxlU2VhcmNoR21haWwsXG4gIGhhbmRsZUV4dHJhY3RJbmZvRnJvbUdtYWlsLFxuICBTZWFyY2hHbWFpbE5sdUVudGl0aWVzLFxuICBFeHRyYWN0SW5mb0Zyb21HbWFpbE5sdUVudGl0aWVzLFxufSBmcm9tICcuL3NraWxscy9nbWFpbFNraWxscyc7XG4vLyBJbXBvcnQgbmV3IFNsYWNrIFF1ZXJ5IHNraWxsc1xuaW1wb3J0IHtcbiAgaGFuZGxlU2VhcmNoU2xhY2tNZXNzYWdlcyxcbiAgaGFuZGxlRXh0cmFjdEluZm9Gcm9tU2xhY2tNZXNzYWdlLFxuICBTZWFyY2hTbGFja01lc3NhZ2VzTmx1RW50aXRpZXMsXG4gIEV4dHJhY3RJbmZvRnJvbVNsYWNrTWVzc2FnZU5sdUVudGl0aWVzLFxufSBmcm9tICcuL3NraWxscy9zbGFja1F1ZXJ5U2tpbGxzJztcbi8vIEltcG9ydCBuZXcgTVMgVGVhbXMgUXVlcnkgc2tpbGxzXG5pbXBvcnQge1xuICBoYW5kbGVTZWFyY2hNU1RlYW1zTWVzc2FnZXMsXG4gIGhhbmRsZUV4dHJhY3RJbmZvRnJvbU1TVGVhbXNNZXNzYWdlLFxuICBTZWFyY2hNU1RlYW1zTWVzc2FnZXNObHVFbnRpdGllcyxcbiAgRXh0cmFjdEluZm9Gcm9tTVNUZWFtc01lc3NhZ2VObHVFbnRpdGllcyxcbn0gZnJvbSAnLi9za2lsbHMvbXNUZWFtc1F1ZXJ5U2tpbGxzJztcbmltcG9ydCB7XG4gIHJldHJpZXZlUmVsZXZhbnRMVE0sXG4gIGxvYWRMVE1Ub1NUTSxcbiAgcHJvY2Vzc1NUTVRvTFRNLFxuICBDb252ZXJzYXRpb25TdGF0ZUFjdGlvbnMsXG59IGZyb20gJy4vbWVtb3J5TWFuYWdlcic7XG5cbmltcG9ydCB7XG4gIGNyZWF0ZUh1YlNwb3RDb250YWN0LFxuICBnZXRIdWJTcG90Q29udGFjdEJ5RW1haWwsXG59IGZyb20gJy4vc2tpbGxzL2h1YnNwb3RTa2lsbHMnO1xuaW1wb3J0IHsgc2VuZFNsYWNrTWVzc2FnZSB9IGZyb20gJy4vc2tpbGxzL3NsYWNrU2tpbGxzJztcbmltcG9ydCB7XG4gIGxpc3RDYWxlbmRseUV2ZW50VHlwZXMsXG4gIGxpc3RDYWxlbmRseVNjaGVkdWxlZEV2ZW50cyxcbn0gZnJvbSAnLi9za2lsbHMvY2FsZW5kbHlTa2lsbHMnO1xuaW1wb3J0IHsgbGlzdFpvb21NZWV0aW5ncywgZ2V0Wm9vbU1lZXRpbmdEZXRhaWxzIH0gZnJvbSAnLi9za2lsbHMvem9vbVNraWxscyc7XG5pbXBvcnQge1xuICBsaXN0VXBjb21pbmdFdmVudHMsIC8vIEFscmVhZHkgaW1wb3J0ZWQgYnV0IGVuc3VyZSBpdCdzIGNvdmVyZWRcbiAgY3JlYXRlQ2FsZW5kYXJFdmVudCwgLy8gQWxyZWFkeSBpbXBvcnRlZFxuICBsaXN0VXBjb21pbmdHb29nbGVNZWV0RXZlbnRzLFxuICBnZXRHb29nbGVNZWV0RXZlbnREZXRhaWxzLFxufSBmcm9tICcuL3NraWxscy9jYWxlbmRhclNraWxscyc7XG5pbXBvcnQge1xuICBsaXN0TWljcm9zb2Z0VGVhbXNNZWV0aW5ncyxcbiAgZ2V0TWljcm9zb2Z0VGVhbXNNZWV0aW5nRGV0YWlscyxcbn0gZnJvbSAnLi9za2lsbHMvbXNUZWFtc1NraWxscyc7XG5pbXBvcnQge1xuICBsaXN0U3RyaXBlUGF5bWVudHMsXG4gIGdldFN0cmlwZVBheW1lbnREZXRhaWxzLFxufSBmcm9tICcuL3NraWxscy9zdHJpcGVTa2lsbHMnO1xuaW1wb3J0IHtcbiAgbGlzdFF1aWNrQm9va3NJbnZvaWNlcyxcbiAgZ2V0UXVpY2tCb29rc0ludm9pY2VEZXRhaWxzLFxuICBnZXRBdXRoVXJpIGFzIGdldFF1aWNrQm9va3NBdXRoVXJpLFxufSBmcm9tICcuL3NraWxscy9xdWlja2Jvb2tzU2tpbGxzJztcbmltcG9ydCB7XG4gIGVuYWJsZUF1dG9waWxvdCxcbiAgZGlzYWJsZUF1dG9waWxvdCxcbiAgZ2V0QXV0b3BpbG90U3RhdHVzLFxufSBmcm9tICcuL3NraWxscy9hdXRvcGlsb3RTa2lsbHMnO1xuaW1wb3J0IHtcbiAgY3JlYXRlU2NoZWR1bGluZ1J1bGUsXG4gIGJsb2NrQ2FsZW5kYXJUaW1lLFxuICBpbml0aWF0ZVRlYW1NZWV0aW5nU2NoZWR1bGluZyxcbiAgTkxVQ3JlYXRlVGltZVByZWZlcmVuY2VSdWxlRW50aXRpZXMsXG4gIE5MVUJsb2NrVGltZVNsb3RFbnRpdGllcyxcbiAgTkxVU2NoZWR1bGVUZWFtTWVldGluZ0VudGl0aWVzLFxuICBTY2hlZHVsaW5nUmVzcG9uc2UsXG4gIFNjaGVkdWxlVGFza1BhcmFtcywgLy8gQWRkZWQgZm9yIHNjaGVkdWxlVGFza1xuICBzY2hlZHVsZVRhc2ssIC8vIEFkZGVkIGZvciBzY2hlZHVsZVRhc2tcbiAgaGFuZGxlU2NoZWR1bGVTa2lsbEFjdGl2YXRpb24sXG59IGZyb20gJy4vc2tpbGxzL3NjaGVkdWxpbmdTa2lsbHMnO1xuaW1wb3J0IHsgdW5kZXJzdGFuZE1lc3NhZ2UgfSBmcm9tICcuL3NraWxscy9ubHVTZXJ2aWNlJztcbmltcG9ydCB7XG4gIEFUT01fU0xBQ0tfSFVCU1BPVF9OT1RJRklDQVRJT05fQ0hBTk5FTF9JRCxcbiAgQVRPTV9IVUJTUE9UX1BPUlRBTF9JRCxcbiAgQVRPTV9RQl9UT0tFTl9GSUxFX1BBVEgsXG4gIEFUT01fTk9USU9OX1RBU0tTX0RBVEFCQVNFX0lELCAvLyBBZGRlZCBmb3IgTm90aW9uIFRhc2tzXG4gIExBTkNFREJfTFRNX0FHRU5UX1RBQkxFX05BTUUsIC8vIEFkZGVkIGZvciBMVE0gdGFibGUgbmFtZVxuICBQWVRIT05fQVBJX1NFUlZJQ0VfQkFTRV9VUkwsXG4gIEFTQU5BX0FDQ0VTU19UT0tFTixcbiAgSklSQV9TRVJWRVIsXG4gIEpJUkFfVVNFUk5BTUUsXG4gIEpJUkFfUEFTU1dPUkQsXG4gIFRSRUxMT19BUElfS0VZLFxuICBUUkVMTE9fQVBJX1NFQ1JFVCxcbiAgVFJFTExPX1RPS0VOLFxufSBmcm9tICcuLi9fbGlicy9jb25zdGFudHMnO1xuaW1wb3J0IHsgYWdlbmRhLCBTY2hlZHVsZWRBZ2VudFRhc2tEYXRhIH0gZnJvbSAnLi4vYWdlbmRhU2VydmljZSc7IC8vIEFkZGVkIGZvciBBZ2VuZGFcbmltcG9ydCB7IHNlYXJjaFdlYiB9IGZyb20gJy4vc2tpbGxzL3dlYlJlc2VhcmNoU2tpbGxzJzsgLy8gQWRkZWQgbWlzc2luZyBpbXBvcnRcbmltcG9ydCB7IGxpc3RSZWNlbnRFbWFpbHMsIHJlYWRFbWFpbCwgc2VuZEVtYWlsIH0gZnJvbSAnLi9za2lsbHMvZW1haWxTa2lsbHMnOyAvLyBBZGRlZCBtaXNzaW5nIGltcG9ydFxuaW1wb3J0IHsgdHJpZ2dlclphcCB9IGZyb20gJy4vc2tpbGxzL3phcGllclNraWxscyc7IC8vIEFkZGVkIG1pc3NpbmcgaW1wb3J0XG5pbXBvcnQgeyByZXNvbHZlQXR0ZW5kZWVzIH0gZnJvbSAnLi9za2lsbHMvY29udGFjdFNraWxscyc7IC8vIEZvciBTY2hlZHVsZU1lZXRpbmdGcm9tRW1haWxcbi8vIGltcG9ydCB7IGludm9rZU9wdGFQbGFubmVyU2NoZWR1bGluZyB9IGZyb20gJy4vc2tpbGxzL3NjaGVkdWxpbmdTa2lsbHMnOyAvLyBXaWxsIGJlIGFkZGVkIHRvIHNjaGVkdWxpbmdTa2lsbHNcbmltcG9ydCB7XG4gIGhhbmRsZVByZXBhcmVGb3JNZWV0aW5nLFxuICBoYW5kbGVHZW5lcmF0ZVdlZWtseURpZ2VzdCxcbiAgaGFuZGxlU3VnZ2VzdEZvbGxvd1Vwcyxcbn0gZnJvbSAnLi9za2lsbHMvcHJvZHVjdGl2aXR5U2tpbGxzJzsgLy8gQWRkZWQgZm9yIFNtYXJ0IE1lZXRpbmcgUHJlcCwgV2Vla2x5IERpZ2VzdCAmIEZvbGxvdy11cCBTdWdnZXN0ZXJcbmltcG9ydCB7IGhhbmRsZU1lZXRpbmdQcmVwYXJhdGlvblJlcXVlc3QgfSBmcm9tICcuL2NvbW1hbmRfaGFuZGxlcnMvbWVldGluZ1ByZXBDb21tYW5kSGFuZGxlcic7IC8vIEFkZGVkIGZvciBNZWV0aW5nIFByZXBcbmltcG9ydCB7IGhhbmRsZVByb2Nlc3NNZWV0aW5nT3V0Y29tZXNSZXF1ZXN0IH0gZnJvbSAnLi9jb21tYW5kX2hhbmRsZXJzL3Bvc3RNZWV0aW5nV29ya2Zsb3dDb21tYW5kSGFuZGxlcic7IC8vIEFkZGVkIGZvciBQb3N0LU1lZXRpbmcgV29ya2Zsb3dcbmltcG9ydCB7IGhhbmRsZUdldERhaWx5QnJpZWZpbmdSZXF1ZXN0IH0gZnJvbSAnLi9jb21tYW5kX2hhbmRsZXJzL2RhaWx5QnJpZWZpbmdDb21tYW5kSGFuZGxlcic7IC8vIEFkZGVkIGZvciBEYWlseSBCcmllZmluZ1xuaW1wb3J0IHsgaGFuZGxlQ3JlYXRlVGFza0Zyb21DaGF0TWVzc2FnZVJlcXVlc3QgfSBmcm9tICcuL2NvbW1hbmRfaGFuZGxlcnMvdGFza0Zyb21DaGF0Q29tbWFuZEhhbmRsZXInOyAvLyBBZGRlZCBmb3IgVGFzayBmcm9tIENoYXRcbmltcG9ydCB7XG4gIGhhbmRsZUdldENhbGVuZGFyRXZlbnRzLFxuICBoYW5kbGVDcmVhdGVDYWxlbmRhckV2ZW50LFxufSBmcm9tICcuL3NraWxscy9jYWxlbmRhcic7XG5pbXBvcnQge1xuICBoYW5kbGVMaXN0RW1haWxzLFxuICBoYW5kbGVSZWFkRW1haWwsXG4gIGhhbmRsZVNlbmRFbWFpbCxcbn0gZnJvbSAnLi9za2lsbHMvZW1haWwnO1xuaW1wb3J0IHsgaGFuZGxlU2VhcmNoV2ViIH0gZnJvbSAnLi9za2lsbHMvd2ViJztcbmltcG9ydCB7IGhhbmRsZVRyaWdnZXJaYXAgfSBmcm9tICcuL3NraWxscy96YXBpZXInO1xuaW1wb3J0IHtcbiAgaGFuZGxlR2V0SHViU3BvdENvbnRhY3RCeUVtYWlsLFxuICBoYW5kbGVDcmVhdGVIdWJTcG90Q29udGFjdCxcbn0gZnJvbSAnLi9za2lsbHMvaHVic3BvdCc7XG5pbXBvcnQgeyBoYW5kbGVTZW5kU2xhY2tNZXNzYWdlLCBoYW5kbGVTbGFja015QWdlbmRhIH0gZnJvbSAnLi9za2lsbHMvc2xhY2snO1xuaW1wb3J0IHtcbiAgaGFuZGxlTGlzdENhbGVuZGx5RXZlbnRUeXBlcyxcbiAgaGFuZGxlTGlzdENhbGVuZGx5U2NoZWR1bGVkRXZlbnRzLFxufSBmcm9tICcuL3NraWxscy9jYWxlbmRseSc7XG5pbXBvcnQge1xuICBoYW5kbGVMaXN0Wm9vbU1lZXRpbmdzLFxuICBoYW5kbGVHZXRab29tTWVldGluZ0RldGFpbHMsXG59IGZyb20gJy4vc2tpbGxzL3pvb20nO1xuaW1wb3J0IHtcbiAgaGFuZGxlTGlzdEdvb2dsZU1lZXRFdmVudHMsXG4gIGhhbmRsZUdldEdvb2dsZU1lZXRFdmVudERldGFpbHMsXG59IGZyb20gJy4vc2tpbGxzL2dvb2dsZU1lZXQnO1xuaW1wb3J0IHtcbiAgaGFuZGxlTGlzdE1pY3Jvc29mdFRlYW1zTWVldGluZ3MsXG4gIGhhbmRsZUdldE1pY3Jvc29mdFRlYW1zTWVldGluZ0RldGFpbHMsXG59IGZyb20gJy4vc2tpbGxzL21zdGVhbXMnO1xuaW1wb3J0IHtcbiAgaGFuZGxlTGlzdFN0cmlwZVBheW1lbnRzLFxuICBoYW5kbGVHZXRTdHJpcGVQYXltZW50RGV0YWlscyxcbn0gZnJvbSAnLi9za2lsbHMvc3RyaXBlJztcbmltcG9ydCB7XG4gIGhhbmRsZUdldFF1aWNrQm9va3NBdXRoVXJsLFxuICBoYW5kbGVMaXN0UXVpY2tCb29rc0ludm9pY2VzLFxuICBoYW5kbGVHZXRRdWlja0Jvb2tzSW52b2ljZURldGFpbHMsXG59IGZyb20gJy4vc2tpbGxzL3F1aWNrYm9va3MnO1xuaW1wb3J0IHsgaGFuZGxlTWVldGluZ1ByZXAgfSBmcm9tICcuL3NraWxscy9tZWV0aW5nUHJlcCc7XG5pbXBvcnQge1xuICBoYW5kbGVDcmVhdGVBc2FuYVRhc2ssXG4gIGhhbmRsZVF1ZXJ5QXNhbmFUYXNrcyxcbiAgaGFuZGxlVXBkYXRlQXNhbmFUYXNrLFxufSBmcm9tICcuL3NraWxscy9hc2FuYSc7XG5pbXBvcnQge1xuICBoYW5kbGVDcmVhdGVKaXJhSXNzdWUsXG4gIGhhbmRsZVF1ZXJ5SmlyYUlzc3VlcyxcbiAgaGFuZGxlVXBkYXRlSmlyYUlzc3VlLFxufSBmcm9tICcuL3NraWxscy9qaXJhJztcbmltcG9ydCB7XG4gIGhhbmRsZUNyZWF0ZVRyZWxsb0NhcmQsXG4gIGhhbmRsZVF1ZXJ5VHJlbGxvQ2FyZHMsXG4gIGhhbmRsZVVwZGF0ZVRyZWxsb0NhcmQsXG59IGZyb20gJy4vc2tpbGxzL3RyZWxsbyc7XG5pbXBvcnQgeyBoYW5kbGVCcm93c2VyIH0gZnJvbSAnLi9za2lsbHMvYnJvd3NlclNraWxscyc7XG5pbXBvcnQgeyBSZW1pbmRlclNraWxscyB9IGZyb20gJy4vc2tpbGxzL3JlbWluZGVyU2tpbGxzJztcblxuLy8gRGVmaW5lIHRoZSBUVFMgc2VydmljZSBVUkxcbmNvbnN0IEFVRElPX1BST0NFU1NPUl9UVFNfVVJMID0gcHJvY2Vzcy5lbnYuQVVESU9fUFJPQ0VTU09SX0JBU0VfVVJMXG4gID8gYCR7cHJvY2Vzcy5lbnYuQVVESU9fUFJPQ0VTU09SX0JBU0VfVVJMfS90dHNgXG4gIDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MC90dHMnO1xuXG4vLyAtLS0gTGFuY2VEQiBJbml0aWFsaXphdGlvbiAtLS1cbmxldCBsdG1EYkNvbm5lY3Rpb246IGxhbmNlZGIuQ29ubmVjdGlvbiB8IG51bGwgPSBudWxsO1xuXG5hc3luYyBmdW5jdGlvbiBpbml0aWFsaXplTHRtRGF0YWJhc2UoKTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgbHRtRGJDb25uZWN0aW9uID0gYXdhaXQgaW5pdGlhbGl6ZUxhbmNlREIoJ2x0bV9hZ2VudF9kYXRhJyk7XG4gICAgaWYgKGx0bURiQ29ubmVjdGlvbikge1xuICAgICAgY29uc29sZS5sb2coJ1tIYW5kbGVyXSBMYW5jZURCIExUTSBjb25uZWN0aW9uIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseS4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgJ1tIYW5kbGVyXSBMYW5jZURCIExUTSBjb25uZWN0aW9uIGZhaWxlZCB0byBpbml0aWFsaXplIChyZXR1cm5lZCBudWxsKS4nXG4gICAgICApO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFxuICAgICAgJ1tIYW5kbGVyXSBFcnJvciBpbml0aWFsaXppbmcgTGFuY2VEQiBMVE0gY29ubmVjdGlvbjonLFxuICAgICAgZXJyb3JcbiAgICApO1xuICAgIGx0bURiQ29ubmVjdGlvbiA9IG51bGw7XG4gIH1cbn1cblxuaW5pdGlhbGl6ZUx0bURhdGFiYXNlKCk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSGFuZGxlTWVzc2FnZVJlc3BvbnNlIHtcbiAgdGV4dDogc3RyaW5nO1xuICBhdWRpb1VybD86IHN0cmluZztcbiAgZXJyb3I/OiBzdHJpbmc7XG4gIHN0cnVjdHVyZWREYXRhPzogYW55OyAvLyBBZGRlZCBmaWVsZCBmb3Igc3RydWN0dXJlZCBza2lsbCByZXNwb25zZXNcbn1cblxuLy8gRXh0ZW5kIGV4aXN0aW5nIG9wdGlvbnMgZm9yIF9pbnRlcm5hbEhhbmRsZU1lc3NhZ2UgdG8gaW5jbHVkZSB0aGUgc2VuZENvbW1hbmRUb0NsaWVudEZ1bmN0aW9uLlxuLy8gVGhpcyBhbGxvd3MgdGhlIGNvcmUgbWVzc2FnZSBoYW5kbGluZyBsb2dpYyB0byBiZSBlcXVpcHBlZCB3aXRoIHRoZSBjYXBhYmlsaXR5IHRvIHNlbmQgY29tbWFuZHMgdG8gdGhlIGNsaWVudC5cbmludGVyZmFjZSBJbnRlcm5hbEhhbmRsZU1lc3NhZ2VPcHRpb25zIHtcbiAgcmVxdWVzdFNvdXJjZT86IHN0cmluZzsgLy8gU291cmNlIG9mIHRoZSByZXF1ZXN0IChlLmcuLCAnV2ViU29ja2V0Q2hhdCcsICdTY2hlZHVsZWRKb2JFeGVjdXRvcicsICdIYXN1cmFBY3Rpb24nKVxuICBpbnRlbnROYW1lPzogc3RyaW5nOyAvLyBQcmUtZGV0ZXJtaW5lZCBpbnRlbnQgbmFtZSwgYnlwYXNzaW5nIE5MVSAoZS5nLiwgZm9yIHNjaGVkdWxlZCB0YXNrcylcbiAgZW50aXRpZXM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+OyAvLyBQcmUtZGV0ZXJtaW5lZCBlbnRpdGllc1xuICBjb252ZXJzYXRpb25JZD86IHN0cmluZzsgLy8gSUQgZm9yIHRyYWNraW5nIHRoZSBjb252ZXJzYXRpb24gc2Vzc2lvblxuICBzZW5kQ29tbWFuZFRvQ2xpZW50RnVuY3Rpb24/OiAoXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgY29tbWFuZDogQWdlbnRDbGllbnRDb21tYW5kXG4gICkgPT4gUHJvbWlzZTxib29sZWFuPjsgLy8gVGhlIGFjdHVhbCBmdW5jdGlvbiB0byBzZW5kIGEgY29tbWFuZFxufVxuLy8gLS0tIEVuZCBJbnRlcmZhY2UgRGVmaW5pdGlvbnMgLS0tXG5cbmFzeW5jIGZ1bmN0aW9uIF9pbnRlcm5hbEhhbmRsZU1lc3NhZ2UoXG4gIGludGVyZmFjZVR5cGU6IEludGVyZmFjZVR5cGUsXG4gIG1lc3NhZ2U6IHN0cmluZyxcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGxsbTogeyBzZXJ2aWNlOiBzdHJpbmc7IGFwaUtleTogc3RyaW5nIH0sXG4gIC8vIE9wdGlvbnMgbm93IHVzZXMgdGhlIGV4dGVuZGVkIGludGVyZmFjZVxuICBvcHRpb25zPzogSW50ZXJuYWxIYW5kbGVNZXNzYWdlT3B0aW9uc1xuKTogUHJvbWlzZTx7XG4gIHRleHQ6IHN0cmluZztcbiAgbmx1UmVzcG9uc2U/OiBQcm9jZXNzZWROTFVSZXNwb25zZTtcbiAgc3RydWN0dXJlZERhdGE/OiBhbnk7XG59PiB7XG4gIGNvbnN0IHJlbWluZGVyU2tpbGxzID0gbmV3IFJlbWluZGVyU2tpbGxzKCk7XG4gIGF3YWl0IHJlbWluZGVyU2tpbGxzLnByb2Nlc3NEdWVSZW1pbmRlcnMoKTtcblxuICBsZXQgdGV4dFJlc3BvbnNlOiBzdHJpbmc7XG4gIGxldCBzdHJ1Y3R1cmVkRGF0YVJlc3BvbnNlOiBhbnkgPSB1bmRlZmluZWQ7IC8vIFZhcmlhYmxlIHRvIGhvbGQgc3RydWN0dXJlZCBkYXRhXG4gIGxldCBjb252ZXJzYXRpb25MdG1Db250ZXh0OiBMdG1RdWVyeVJlc3VsdFtdIHwgbnVsbCA9IG51bGw7XG4gIGxldCBubHVSZXNwb25zZTogUHJvY2Vzc2VkTkxVUmVzcG9uc2U7XG5cbiAgY29uc3QgcmVxdWVzdFNvdXJjZSA9IG9wdGlvbnM/LnJlcXVlc3RTb3VyY2U7XG4gIGNvbnN0IGRpcmVjdEludGVudE5hbWUgPSBvcHRpb25zPy5pbnRlbnROYW1lO1xuICBjb25zdCBkaXJlY3RFbnRpdGllcyA9IG9wdGlvbnM/LmVudGl0aWVzO1xuICBjb25zdCBjb252ZXJzYXRpb25JZCA9IG9wdGlvbnM/LmNvbnZlcnNhdGlvbklkOyAvLyBBdmFpbGFibGUgaWYgbmVlZGVkXG5cbiAgLy8gQ29uc3RydWN0IHRoZSBBZ2VudFNraWxsQ29udGV4dCB0byBiZSBwYXNzZWQgdG8gc2tpbGwgaGFuZGxlcnNcbiAgLy8gVGhpcyBjb250ZXh0IG5vdyBpbmNsdWRlcyB0aGUgc2VuZENvbW1hbmRUb0NsaWVudCBmdW5jdGlvbiBpZiBpdCB3YXMgcHJvdmlkZWQgYnkgdGhlIGNhbGxlci5cbiAgY29uc3QgYWdlbnRTa2lsbENvbnRleHQ6IEFnZW50U2tpbGxDb250ZXh0ID0ge1xuICAgIHVzZXJJZDogdXNlcklkLFxuICAgIHNlbmRDb21tYW5kVG9DbGllbnQ6XG4gICAgICBvcHRpb25zPy5zZW5kQ29tbWFuZFRvQ2xpZW50RnVuY3Rpb24gfHxcbiAgICAgIChhc3luYyAodWlkX3VudXNlZCwgY21kX3VudXNlZCkgPT4ge1xuICAgICAgICAvLyBUaGlzIGRlZmF1bHQgZnVuY3Rpb24gaXMgYSBmYWxsYmFjayBhbmQgbG9ncyBhIHdhcm5pbmcgaWYgbm8gYWN0dWFsIHNlbmQgZnVuY3Rpb24gaXMgcHJvdmlkZWQuXG4gICAgICAgIC8vIEl0IGVuc3VyZXMgdGhhdCBza2lsbHMgY2FuIGFsd2F5cyB0cnkgdG8gY2FsbCBjb250ZXh0LnNlbmRDb21tYW5kVG9DbGllbnQgd2l0aG91dCBjcmFzaGluZyxcbiAgICAgICAgLy8gYnV0IGl0IHdvbid0IGFjdHVhbGx5IHNlbmQgYW55dGhpbmcgaWYgdGhlIGluZnJhc3RydWN0dXJlIGlzbid0IHdpcmVkIHVwIGZyb20gdGhlIGNhbGxlci5cbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIGBbQWdlbnRTa2lsbENvbnRleHRdIHNlbmRDb21tYW5kVG9DbGllbnQgd2FzIGNhbGxlZCBmb3IgdXNlciAke3VzZXJJZH0gYCArXG4gICAgICAgICAgICBgYnV0IG5vIGltcGxlbWVudGF0aW9uIHdhcyBwcm92aWRlZCB0byBfaW50ZXJuYWxIYW5kbGVNZXNzYWdlLiBDb21tYW5kIHdhczogJHtKU09OLnN0cmluZ2lmeShjbWRfdW51c2VkKX1gXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBmYWxzZTsgLy8gSW5kaWNhdGUgZmFpbHVyZSB0byBzZW5kXG4gICAgICB9KSxcbiAgICAvLyBQb3RlbnRpYWxseSBhZGQgb3RoZXIgY29udGV4dCBpdGVtcyBoZXJlIGlmIG5lZWRlZCBieSB2YXJpb3VzIHNraWxsc1xuICB9O1xuXG4gIGlmIChyZXF1ZXN0U291cmNlID09PSAnU2NoZWR1bGVkSm9iRXhlY3V0b3InICYmIGRpcmVjdEludGVudE5hbWUpIHtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGBbSW50ZXJuYWxIYW5kbGVNZXNzYWdlXVske2ludGVyZmFjZVR5cGV9XSBSZWNlaXZlZCBkaXJlY3QgZXhlY3V0aW9uIHJlcXVlc3QgZnJvbSBTY2hlZHVsZWRKb2JFeGVjdXRvci4gQ29udmVyc2F0aW9uSUQ6ICR7Y29udmVyc2F0aW9uSWR9YFxuICAgICk7XG4gICAgbmx1UmVzcG9uc2UgPSB7XG4gICAgICBpbnRlbnQ6IGRpcmVjdEludGVudE5hbWUsXG4gICAgICBlbnRpdGllczogZGlyZWN0RW50aXRpZXMgfHwge30sXG4gICAgICAvLyBFbnN1cmUgb3RoZXIgbmVjZXNzYXJ5IGZpZWxkcyBmb3IgUHJvY2Vzc2VkTkxVUmVzcG9uc2UgYXJlIHByZXNlbnRcbiAgICAgIHVzZXJfaWQ6IHVzZXJJZCxcbiAgICAgIG9yaWdpbmFsX3F1ZXJ5OiBgU2NoZWR1bGVkIHRhc2s6ICR7ZGlyZWN0SW50ZW50TmFtZX1gLCAvLyBDb25zdHJ1Y3QgYSBkZXNjcmlwdGl2ZSBxdWVyeVxuICAgICAgLy8gY29uZmlkZW5jZTogMS4wLCAvLyBBc3N1bWluZyAxMDAlIGNvbmZpZGVuY2UgZm9yIGRpcmVjdCBleGVjdXRpb25cbiAgICAgIC8vIGVycm9yOiB1bmRlZmluZWRcbiAgICB9O1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgYFtJbnRlcm5hbEhhbmRsZU1lc3NhZ2VdWyR7aW50ZXJmYWNlVHlwZX1dIEJ5cGFzc2luZyBOTFUgZm9yIHNjaGVkdWxlZCB0YXNrLiBJbnRlbnQ6ICR7bmx1UmVzcG9uc2UuaW50ZW50fSwgRW50aXRpZXM6ICR7SlNPTi5zdHJpbmdpZnkobmx1UmVzcG9uc2UuZW50aXRpZXMpfWBcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGlmIChsdG1EYkNvbm5lY3Rpb24pIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlbGV2YW50THRtID0gYXdhaXQgcmV0cmlldmVSZWxldmFudExUTShcbiAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICBsdG1EYkNvbm5lY3Rpb24sXG4gICAgICAgICAgeyB0YWJsZTogTEFOQ0VEQl9MVE1fQUdFTlRfVEFCTEVfTkFNRSB9XG4gICAgICAgICk7XG4gICAgICAgIGlmIChyZWxldmFudEx0bSAmJiByZWxldmFudEx0bS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICBgW0hhbmRsZXJdWyR7aW50ZXJmYWNlVHlwZX1dIFJldHJpZXZlZCAke3JlbGV2YW50THRtLmxlbmd0aH0gaXRlbXMgZnJvbSBMVE0gZm9yIHF1ZXJ5OiAke21lc3NhZ2V9LiBTdG9yaW5nIGluIGNvbnZlcnNhdGlvbiBzdGF0ZS5gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb252ZXJzYXRpb25NYW5hZ2VyLnVwZGF0ZUxUTUNvbnRleHQoaW50ZXJmYWNlVHlwZSwgcmVsZXZhbnRMdG0pO1xuICAgICAgICAgIGNvbnZlcnNhdGlvbkx0bUNvbnRleHQgPSByZWxldmFudEx0bTtcbiAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25TdGF0ZUFjdGlvbnM6IENvbnZlcnNhdGlvblN0YXRlQWN0aW9ucyA9IHtcbiAgICAgICAgICAgIHVwZGF0ZVVzZXJHb2FsOiAoZ29hbCkgPT5cbiAgICAgICAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlci51cGRhdGVVc2VyR29hbChpbnRlcmZhY2VUeXBlLCBnb2FsKSxcbiAgICAgICAgICAgIHVwZGF0ZUludGVudEFuZEVudGl0aWVzOiAoaW50ZW50LCBlbnRpdGllcykgPT5cbiAgICAgICAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlci51cGRhdGVJbnRlbnRBbmRFbnRpdGllcyhcbiAgICAgICAgICAgICAgICBpbnRlcmZhY2VUeXBlLFxuICAgICAgICAgICAgICAgIGludGVudCxcbiAgICAgICAgICAgICAgICBlbnRpdGllc1xuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgdXBkYXRlTHRtUmVwb0NvbnRleHQ6IChjb250ZXh0KSA9PlxuICAgICAgICAgICAgICBjb252ZXJzYXRpb25NYW5hZ2VyLnVwZGF0ZUxUTUNvbnRleHQoaW50ZXJmYWNlVHlwZSwgY29udGV4dCksXG4gICAgICAgICAgfTtcbiAgICAgICAgICBhd2FpdCBsb2FkTFRNVG9TVE0ocmVsZXZhbnRMdG0sIGNvbnZlcnNhdGlvblN0YXRlQWN0aW9ucyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlci51cGRhdGVMVE1Db250ZXh0KGludGVyZmFjZVR5cGUsIG51bGwpO1xuICAgICAgICAgIGNvbnZlcnNhdGlvbkx0bUNvbnRleHQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICAgIGBbSGFuZGxlcl1bJHtpbnRlcmZhY2VUeXBlfV0gRXJyb3IgcmV0cmlldmluZyBvciBsb2FkaW5nIExUTTpgLFxuICAgICAgICAgIGVycm9yXG4gICAgICAgICk7XG4gICAgICAgIGNvbnZlcnNhdGlvbk1hbmFnZXIudXBkYXRlTFRNQ29udGV4dChpbnRlcmZhY2VUeXBlLCBudWxsKTtcbiAgICAgICAgY29udmVyc2F0aW9uTHRtQ29udGV4dCA9IG51bGw7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBMVE0gREIgY29ubmVjdGlvbiBub3QgYXZhaWxhYmxlLCBza2lwcGluZyBMVE0gcmV0cmlldmFsLmBcbiAgICAgICk7XG4gICAgICBjb252ZXJzYXRpb25NYW5hZ2VyLnVwZGF0ZUxUTUNvbnRleHQoaW50ZXJmYWNlVHlwZSwgbnVsbCk7XG4gICAgICBjb252ZXJzYXRpb25MdG1Db250ZXh0ID0gbnVsbDtcbiAgICB9XG5cbiAgICBubHVSZXNwb25zZSA9IGF3YWl0IHVuZGVyc3RhbmRNZXNzYWdlKFxuICAgICAgbWVzc2FnZSxcbiAgICAgIHVuZGVmaW5lZCxcbiAgICAgIGNvbnZlcnNhdGlvbkx0bUNvbnRleHQsXG4gICAgICBsbG1cbiAgICApO1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgYFtJbnRlcm5hbEhhbmRsZU1lc3NhZ2VdWyR7aW50ZXJmYWNlVHlwZX1dIE5MVSBSZXNwb25zZSAod2l0aCBMVE0gY29udGV4dCBjb25zaWRlcmF0aW9uKTpgLFxuICAgICAgSlNPTi5zdHJpbmdpZnkobmx1UmVzcG9uc2UsIG51bGwsIDIpXG4gICAgKTtcbiAgfVxuXG4gIGlmIChubHVSZXNwb25zZS5lcnJvciAmJiAhbmx1UmVzcG9uc2UuaW50ZW50KSB7XG4gICAgLy8gVGhpcyBjb25kaXRpb24gbWlnaHQgbmVlZCBhZGp1c3RtZW50IGlmIHNjaGVkdWxlZCB0YXNrcyAoYnlwYXNzaW5nIE5MVSkgY291bGQgc3RpbGwgaGF2ZSBhbiBcImVycm9yXCJcbiAgICAvLyBpbiB0aGUgY29uc3RydWN0ZWQgbmx1UmVzcG9uc2UsIHRob3VnaCBpZGVhbGx5IHRoZXkgd291bGRuJ3QgaWYgaW50ZW50IGlzIHByZXNlbnQuXG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIGBbSW50ZXJuYWxIYW5kbGVNZXNzYWdlXVske2ludGVyZmFjZVR5cGV9XSBOTFUgc2VydmljZSBjcml0aWNhbCBlcnJvciBvciBubyBpbnRlbnQgZnJvbSBzY2hlZHVsZWQgdGFzazpgLFxuICAgICAgbmx1UmVzcG9uc2UuZXJyb3JcbiAgICApO1xuICAgIHRleHRSZXNwb25zZSA9XG4gICAgICBcIlNvcnJ5LCBJJ20gaGF2aW5nIHRyb3VibGUgdW5kZXJzdGFuZGluZyByZXF1ZXN0cyByaWdodCBub3cgb3IgcHJvY2Vzc2luZyB0aGUgc2NoZWR1bGVkIHRhc2suIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCI7XG4gICAgY29uc3QgY3VycmVudENvbnZTdGF0ZU9uRXJyb3IgPVxuICAgICAgY29udmVyc2F0aW9uTWFuYWdlci5nZXRDb252ZXJzYXRpb25TdGF0ZVNuYXBzaG90KGludGVyZmFjZVR5cGUpO1xuICAgIGNvbnN0IGx0bUNvbnRleHRGb3JFcnJvclJlc3BvbnNlID0gY3VycmVudENvbnZTdGF0ZU9uRXJyb3IubHRtQ29udGV4dDtcbiAgICBpZiAobHRtQ29udGV4dEZvckVycm9yUmVzcG9uc2UgJiYgbHRtQ29udGV4dEZvckVycm9yUmVzcG9uc2UubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgZmlyc3RMdG1JdGVtID0gbHRtQ29udGV4dEZvckVycm9yUmVzcG9uc2VbMF0gYXMgTHRtUXVlcnlSZXN1bHQ7IC8vIFR5cGUgYXNzZXJ0aW9uIHN0aWxsIG5lZWRlZFxuICAgICAgaWYgKGZpcnN0THRtSXRlbSAmJiBmaXJzdEx0bUl0ZW0udGV4dCkge1xuICAgICAgICAvLyBDaGVjayBpZiB0ZXh0IHByb3BlcnR5IGV4aXN0c1xuICAgICAgICBsZXQgbHRtUHJlYW1ibGUgPSBgSSByZWNhbGwgZnJvbSBvdXIgcmVjb3JkcyB0aGF0OiBcIiR7Zmlyc3RMdG1JdGVtLnRleHQuc3Vic3RyaW5nKDAsIDE1MCl9JHtmaXJzdEx0bUl0ZW0udGV4dC5sZW5ndGggPiAxNTAgPyAnLi4uJyA6ICcnfVwiLiBgO1xuICAgICAgICB0ZXh0UmVzcG9uc2UgPSBsdG1QcmVhbWJsZSArIHRleHRSZXNwb25zZTtcbiAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBBdWdtZW50ZWQgZXJyb3IgcmVzcG9uc2Ugd2l0aCBMVE0gY29udGV4dDogJHtsdG1QcmVhbWJsZX1gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB0ZXh0OiB0ZXh0UmVzcG9uc2UsXG4gICAgICBubHVSZXNwb25zZSxcbiAgICAgIHN0cnVjdHVyZWREYXRhOiBzdHJ1Y3R1cmVkRGF0YVJlc3BvbnNlLFxuICAgIH07XG4gIH1cblxuICAvLyBQcm9jZXNzIE5MVSByZXNwb25zZSBhbmQgZXhlY3V0ZSBza2lsbHNcbiAgLy8gQWxsIGNvbnNvbGUgbG9ncyB3aXRoaW4gdGhpcyBibG9jayBzaG91bGQgYWxzbyBiZSBwcmVmaXhlZCB3aXRoIFtpbnRlcmZhY2VUeXBlXVxuICBpZiAobmx1UmVzcG9uc2UuaW50ZW50KSB7XG4gICAgY29uc3QgZW50aXRpZXMgPSBubHVSZXNwb25zZS5lbnRpdGllcyB8fCB7fTtcbiAgICAvLyBMb2cgaW50ZW50IGFuZCBlbnRpdGllcyB3aXRoIGludGVyZmFjZVR5cGVcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGBbSGFuZGxlcl1bJHtpbnRlcmZhY2VUeXBlfV0gSW50ZW50OiAke25sdVJlc3BvbnNlLmludGVudH0sIEVudGl0aWVzOiAke0pTT04uc3RyaW5naWZ5KGVudGl0aWVzKX1gXG4gICAgKTtcblxuICAgIHRyeSB7XG4gICAgICBzd2l0Y2ggKG5sdVJlc3BvbnNlLmludGVudCkge1xuICAgICAgICBjYXNlICdHZXRDYWxlbmRhckV2ZW50cyc6XG4gICAgICAgICAgdGV4dFJlc3BvbnNlID0gYXdhaXQgaGFuZGxlR2V0Q2FsZW5kYXJFdmVudHMoXG4gICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICBlbnRpdGllcyxcbiAgICAgICAgICAgIGFnZW50U2tpbGxDb250ZXh0LnNldHRpbmdzLmludGVncmF0aW9uc1xuICAgICAgICAgICk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIC4uLiAob3RoZXIgY2FzZXMpXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGV4dFJlc3BvbnNlID0gYEkgdW5kZXJzdG9vZCB5b3VyIGludGVudCBhcyAnJHtubHVSZXNwb25zZS5pbnRlbnR9JywgYnV0IEknbSBub3Qgc2V0IHVwIHRvIGhhbmRsZSB0aGF0IHlldC5gO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgIGBbSGFuZGxlcl1bJHtpbnRlcmZhY2VUeXBlfV0gRXJyb3IgZXhlY3V0aW5nIGludGVudCBcIiR7bmx1UmVzcG9uc2UuaW50ZW50fVwiOmAsXG4gICAgICAgIGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIGVycm9yLnN0YWNrXG4gICAgICApO1xuICAgICAgdGV4dFJlc3BvbnNlID0gYFNvcnJ5LCBJIGVuY291bnRlcmVkIGFuIGVycm9yIHdoaWxlIHRyeWluZyB0byBoYW5kbGUgeW91ciByZXF1ZXN0IGZvciBcIiR7bmx1UmVzcG9uc2UuaW50ZW50fVwiLiBQbGVhc2UgdHJ5IGFnYWluLmA7XG4gICAgfVxuICB9IGVsc2UgaWYgKFxuICAgIG1lc3NhZ2UudG9Mb3dlckNhc2UoKSA9PT0gJ2hlbHAnIHx8XG4gICAgbWVzc2FnZS50b0xvd2VyQ2FzZSgpID09PSAnPydcbiAgKSB7XG4gICAgLy8gQ2hlY2sgbG93ZXJDYXNlTWVzc2FnZSBmb3IgJ2hlbHAnXG4gICAgdGV4dFJlc3BvbnNlID0gYEkgY2FuIHVuZGVyc3RhbmQgbmF0dXJhbCBsYW5ndWFnZSBmb3IgdGFza3MgbGlrZSBsaXN0aW5nIGNhbGVuZGFyIGV2ZW50cywgY3JlYXRpbmcgSHViU3BvdCBjb250YWN0cywgb3Igc2VuZGluZyBTbGFjayBtZXNzYWdlcy4gVHJ5IFwic2hvdyBtZSBteSBuZXh0IDMgbWVldGluZ3NcIiBvciBcImNyZWF0ZSBodWJzcG90IGNvbnRhY3QgZm9yIGphbmVAZXhhbXBsZS5jb20gbmFtZSBKYW5lIERvZVwiLlxuWW91IGNhbiBhbHNvIHVzZSBzcGVjaWZpYyBjb21tYW5kczpcbi0gXCJjcmVhdGUgaHVic3BvdCBjb250YWN0IGFuZCBkbSBtZSBkZXRhaWxzIHtKU09OX0RFVEFJTFN9XCJcbi0gXCJjcmVhdGUgaHVic3BvdCBjb250YWN0IHtKU09OX0RFVEFJTFN9XCIgKGZvciBjaGFubmVsIG5vdGlmaWNhdGlvbnMpXG4vLyAuLi4gKGhlbHAgbWVzc2FnZSBjb250ZW50IGFzIGJlZm9yZSlcbi0gQW5kIG90aGVyIGdlbmVyYWwgY29tbWFuZHMgbGlrZSBcImxpc3QgZW1haWxzXCIsIFwicmVhZCBlbWFpbCA8aWQ+XCIsIFwic2VuZCBlbWFpbCB7SlNPTn1cIiwgXCJzZWFyY2ggd2ViIDxxdWVyeT5cIiwgXCJ0cmlnZ2VyIHphcCA8bmFtZT4gW3dpdGggZGF0YSB7SlNPTn1dXCIuYDtcbiAgfSBlbHNlIHtcbiAgICBpZiAobmx1UmVzcG9uc2UuZXJyb3IpIHtcbiAgICAgIHRleHRSZXNwb25zZSA9IGBJIGhhZCBzb21lIHRyb3VibGUgZnVsbHkgdW5kZXJzdGFuZGluZyB0aGF0IGR1ZSB0bzogJHtubHVSZXNwb25zZS5lcnJvcn0uIFlvdSBjYW4gdHJ5IHJlcGhyYXNpbmcgb3IgdXNlICdoZWxwJy5gO1xuICAgIH0gZWxzZSB7XG4gICAgICB0ZXh0UmVzcG9uc2UgPVxuICAgICAgICBcIlNvcnJ5LCBJIGRpZG4ndCBxdWl0ZSB1bmRlcnN0YW5kIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHRyeSByZXBocmFzaW5nLCBvciB0eXBlICdoZWxwJyB0byBzZWUgd2hhdCBJIGNhbiBkby5cIjtcbiAgICB9XG4gIH1cblxuICAvLyA0LiBBdWdtZW50IHJlc3BvbnNlIHdpdGggTFRNIGNvbnRleHQgKE5ldylcbiAgY29uc29sZS5sb2coXG4gICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBGdXR1cmUgZW5oYW5jZW1lbnQ6IEltcGxlbWVudCByZWxldmFuY2UgY2hlY2sgZm9yIExUTSBpdGVtcyBiZWZvcmUgYXVnbWVudGluZyByZXNwb25zZS5gXG4gICk7XG4gIGNvbnN0IGN1cnJlbnRDb252U3RhdGUgPVxuICAgIGNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udmVyc2F0aW9uU3RhdGVTbmFwc2hvdChpbnRlcmZhY2VUeXBlKTtcbiAgY29uc3QgbHRtQ29udGV4dEZvclJlc3BvbnNlID0gY3VycmVudENvbnZTdGF0ZS5sdG1Db250ZXh0O1xuXG4gIGlmIChsdG1Db250ZXh0Rm9yUmVzcG9uc2UgJiYgbHRtQ29udGV4dEZvclJlc3BvbnNlLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBmaXJzdEx0bUl0ZW0gPSBsdG1Db250ZXh0Rm9yUmVzcG9uc2VbMF0gYXMgTHRtUXVlcnlSZXN1bHQ7IC8vIFR5cGUgYXNzZXJ0aW9uIHN0aWxsIG5lZWRlZFxuICAgIGlmIChmaXJzdEx0bUl0ZW0gJiYgZmlyc3RMdG1JdGVtLnRleHQpIHtcbiAgICAgIC8vIENoZWNrIGlmIHRleHQgcHJvcGVydHkgZXhpc3RzXG4gICAgICBsZXQgbHRtUHJlYW1ibGUgPSBgSSByZWNhbGwgZnJvbSBvdXIgcmVjb3JkcyB0aGF0OiBcIiR7Zmlyc3RMdG1JdGVtLnRleHQuc3Vic3RyaW5nKDAsIDE1MCl9JHtmaXJzdEx0bUl0ZW0udGV4dC5sZW5ndGggPiAxNTAgPyAnLi4uJyA6ICcnfVwiLiBgO1xuICAgICAgdGV4dFJlc3BvbnNlID0gbHRtUHJlYW1ibGUgKyB0ZXh0UmVzcG9uc2U7XG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBBdWdtZW50ZWQgcmVzcG9uc2Ugd2l0aCBMVE0gY29udGV4dDogJHtsdG1QcmVhbWJsZX1gXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdGV4dDogdGV4dFJlc3BvbnNlLFxuICAgIG5sdVJlc3BvbnNlLFxuICAgIHN0cnVjdHVyZWREYXRhOiBzdHJ1Y3R1cmVkRGF0YVJlc3BvbnNlLFxuICB9O1xufVxuXG4vLyAtLS0gTmV3IEV4cG9ydGVkIEZ1bmN0aW9ucyBmb3IgQ29udmVyc2F0aW9uIE1hbmFnZW1lbnQgLS0tXG5cbi8qKlxuICogUGxhY2Vob2xkZXIgZm9yIHVzZXIgSUQgcmV0cmlldmFsLiBJbiBhIHJlYWwgc2NlbmFyaW8sIHRoaXMgd291bGQgY29tZSBmcm9tIHNlc3Npb24sIHRva2VuLCBldGMuXG4gKi9cbmZ1bmN0aW9uIGdldEN1cnJlbnRVc2VySWQoKTogc3RyaW5nIHtcbiAgLy8gRm9yIG5vdywgdXNpbmcgYSBtb2NrIHVzZXIgSUQuIFRoaXMgc2hvdWxkIGJlIHJlcGxhY2VkIHdpdGggYWN0dWFsIHVzZXIgbWFuYWdlbWVudC5cbiAgcmV0dXJuICdtb2NrX3VzZXJfaWRfZnJvbV9oYW5kbGVyJztcbn1cblxuLyoqXG4gKiBBY3RpdmF0ZXMgdGhlIGNvbnZlcnNhdGlvbiBtb2RlLlxuICogQXNzdW1lZCB0byBiZSBtYXBwZWQgdG8gYW4gSFRUUCBlbmRwb2ludCBsaWtlIFBPU1QgL2F0b20tYWdlbnQvYWN0aXZhdGVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFjdGl2YXRlQ29udmVyc2F0aW9uV3JhcHBlcigpOiBQcm9taXNlPHtcbiAgc3RhdHVzOiBzdHJpbmc7XG4gIGFjdGl2ZTogYm9vbGVhbjtcbiAgbWVzc2FnZT86IHN0cmluZztcbn0+IHtcbiAgY29uc29sZS5sb2coXG4gICAgYFtIYW5kbGVyXVt2b2ljZV0gUmVjZWl2ZWQgcmVxdWVzdCB0byBhY3RpdmF0ZSBjb252ZXJzYXRpb24gKGFzc3VtZWQgZm9yIHZvaWNlKS5gXG4gICk7XG4gIC8vIGFjdGl2YXRlQ29udmVyc2F0aW9uIGl0c2VsZiBub3cgc2V0cyBpc0FnZW50UmVzcG9uZGluZyB0byBmYWxzZS5cbiAgY29uc3QgcmVzdWx0ID0gY29udmVyc2F0aW9uTWFuYWdlci5hY3RpdmF0ZUNvbnZlcnNhdGlvbigndm9pY2UnKTtcbiAgcmV0dXJuIHsgLi4ucmVzdWx0LCBtZXNzYWdlOiByZXN1bHQuc3RhdHVzIH07XG59XG5cbi8qKlxuICogRGVhY3RpdmF0ZXMgdGhlIGNvbnZlcnNhdGlvbiBtb2RlLlxuICogQXNzdW1lZCB0byBiZSBtYXBwZWQgdG8gYW4gSFRUUCBlbmRwb2ludCBsaWtlIFBPU1QgL2F0b20tYWdlbnQvZGVhY3RpdmF0ZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVhY3RpdmF0ZUNvbnZlcnNhdGlvbldyYXBwZXIoXG4gIHJlYXNvbjogc3RyaW5nID0gJ21hbnVhbF9kZWFjdGl2YXRpb24nXG4pOiBQcm9taXNlPHsgc3RhdHVzOiBzdHJpbmc7IGFjdGl2ZTogYm9vbGVhbjsgbWVzc2FnZT86IHN0cmluZyB9PiB7XG4gIGNvbnNvbGUubG9nKFxuICAgIGBbSGFuZGxlcl1bdm9pY2VdIFJlY2VpdmVkIHJlcXVlc3QgdG8gZGVhY3RpdmF0ZSBjb252ZXJzYXRpb24uIFJlYXNvbjogJHtyZWFzb259YFxuICApO1xuICAvLyBkZWFjdGl2YXRlQ29udmVyc2F0aW9uIGl0c2VsZiBub3cgc2V0cyBpc0FnZW50UmVzcG9uZGluZyB0byBmYWxzZS5cbiAgLy8gRGVhY3RpdmF0ZXMgJ3ZvaWNlJyBieSBkZWZhdWx0LiBJZiB0ZXh0IG5lZWRzIHNlcGFyYXRlIGRlYWN0aXZhdGlvbiwgaXQgbmVlZHMgaXRzIG93biBlbmRwb2ludC9sb2dpYy5cbiAgY29udmVyc2F0aW9uTWFuYWdlci5kZWFjdGl2YXRlQ29udmVyc2F0aW9uKCd2b2ljZScsIHJlYXNvbik7XG4gIHJldHVybiB7XG4gICAgc3RhdHVzOiBgQ29udmVyc2F0aW9uIGRlYWN0aXZhdGVkIGR1ZSB0byAke3JlYXNvbn0uYCxcbiAgICBhY3RpdmU6IGZhbHNlLFxuICAgIG1lc3NhZ2U6IGBDb252ZXJzYXRpb24gZGVhY3RpdmF0ZWQgZHVlIHRvICR7cmVhc29ufS5gLFxuICB9O1xufVxuXG4vKipcbiAqIEhhbmRsZXMgYW4gaW50ZXJydXB0IHNpZ25hbC5cbiAqIEFzc3VtZWQgdG8gYmUgbWFwcGVkIHRvIGFuIEhUVFAgZW5kcG9pbnQgbGlrZSBQT1NUIC9hdG9tLWFnZW50L2ludGVycnVwdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlSW50ZXJydXB0V3JhcHBlcigpOiBQcm9taXNlPHtcbiAgc3RhdHVzOiBzdHJpbmc7XG4gIG1lc3NhZ2U6IHN0cmluZztcbn0+IHtcbiAgY29uc29sZS5sb2coJ1tIYW5kbGVyXVt2b2ljZV0gUmVjZWl2ZWQgaW50ZXJydXB0IHNpZ25hbC4nKTtcbiAgLy8gS2V5IGFjdGlvbjogU2lnbmFsIHRoYXQgdGhlIGFnZW50IHNob3VsZCBzdG9wIGl0cyBjdXJyZW50IHJlc3BvbnNlIHByb2Nlc3Npbmcvb3V0cHV0LlxuICAvLyBQcmltYXJpbHkgZm9yIHZvaWNlIGludGVyZmFjZSwgYXMgdGV4dCBkb2Vzbid0IHVzdWFsbHkgaGF2ZSBhbiBhZ2VudCBcInNwZWFraW5nXCIgc3RhdGUgdG8gaW50ZXJydXB0LlxuICBjb252ZXJzYXRpb25NYW5hZ2VyLnNldEFnZW50UmVzcG9uZGluZygndm9pY2UnLCBmYWxzZSk7XG5cbiAgLy8gT3B0aW9uYWw6IENvdWxkIGFsc28gZGVhY3RpdmF0ZSBjb252ZXJzYXRpb24gZW50aXJlbHkgb3IganVzdCByZXNldCB0aW1lciB0byBhbGxvdyBpbW1lZGlhdGUgbmV4dCBjb21tYW5kLlxuICAvLyBGb3Igbm93LCBqdXN0IHN0b3BwaW5nIGFnZW50IHJlc3BvbnNlIGFuZCBrZWVwaW5nIGNvbnZlcnNhdGlvbiBhY3RpdmUuXG4gIC8vIGNvbnZlcnNhdGlvbk1hbmFnZXIuYWN0aXZhdGVDb252ZXJzYXRpb24oJ3ZvaWNlJyk7IC8vIFRoaXMgd291bGQgcmVzZXQgdGhlIHRpbWVyIGFuZCBrZWVwIGl0IGFjdGl2ZS5cbiAgLy8gT3IsIGlmIGFuIGludGVycnVwdCBtZWFucyBcInN0b3AgZXZlcnl0aGluZ1wiOlxuICAvLyBjb252ZXJzYXRpb25NYW5hZ2VyLmRlYWN0aXZhdGVDb252ZXJzYXRpb24oJ3ZvaWNlJywgXCJpbnRlcnJ1cHRfc2lnbmFsXCIpO1xuXG4gIC8vIEZvciBub3csIHRoZSBwcmltYXJ5IGVmZmVjdCBpcyBzZXR0aW5nIGlzQWdlbnRSZXNwb25kaW5nID0gZmFsc2UgZm9yICd2b2ljZScuXG4gIC8vIFRoZSB3YWtlX3dvcmRfZGV0ZWN0b3Igd2lsbCBmb2xsb3cgdXAgd2l0aCBhbiBhY3RpdmF0ZSAmIG5ldyBjb252ZXJzYXRpb24gaW5wdXQgZm9yICd2b2ljZScuXG4gIC8vIFRoaXMgZW5zdXJlcyB0aGUgYWdlbnQgaXMgcmVjZXB0aXZlLlxuICAvLyBJZiB0aGVyZSB3ZXJlIGxvbmctcnVubmluZyB0YXNrcyB0aWVkIHRvIHRoZSBwcmV2aW91cyByZXNwb25zZSwgdGhleSBzaG91bGQgaWRlYWxseSBjaGVja1xuICAvLyBjb252ZXJzYXRpb25NYW5hZ2VyLmNoZWNrSWZBZ2VudElzUmVzcG9uZGluZygndm9pY2UnKSBhbmQgaGFsdC4gVGhpcyBpcyBub3QgaW1wbGVtZW50ZWQgaW4gc2tpbGxzIHlldC5cblxuICByZXR1cm4ge1xuICAgIHN0YXR1czogJ3N1Y2Nlc3MnLFxuICAgIG1lc3NhZ2U6XG4gICAgICAnSW50ZXJydXB0IHNpZ25hbCBwcm9jZXNzZWQgZm9yIHZvaWNlIGludGVyZmFjZS4gQWdlbnQgcmVzcG9uZGluZyBzdGF0ZSBzZXQgdG8gZmFsc2UuJyxcbiAgfTtcbn1cblxuLyoqXG4gKiBIYW5kbGVzIHRyYW5zY3JpYmVkIHRleHQgaW5wdXQgZm9yIGFuIG9uZ29pbmcgY29udmVyc2F0aW9uLlxuICogQXNzdW1lZCB0byBiZSBtYXBwZWQgdG8gYW4gSFRUUCBlbmRwb2ludCBsaWtlIFBPU1QgL2F0b20tYWdlbnQvY29udmVyc2F0aW9uXG4gKiBFeHBlY3RzIHBheWxvYWQ6IHsgXCJ0ZXh0XCI6IFwidXNlcidzIHRyYW5zY3JpYmVkIHNwZWVjaFwiIH1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUNvbnZlcnNhdGlvbklucHV0V3JhcHBlcihcbiAgcGF5bG9hZDogeyB0ZXh0OiBzdHJpbmcgfSxcbiAgb3B0aW9uc0Zyb21DYWxsZXI/OiBUZW1wT3B0aW9uc0ZvckNhbGxlciAvLyBBZGRlZCBvcHRpb25zRnJvbUNhbGxlciBmb3IgcGFzc2luZyBzZW5kQ29tbWFuZFRvQ2xpZW50XG4pOiBQcm9taXNlPFxuICBIYW5kbGVNZXNzYWdlUmVzcG9uc2UgfCB7IGVycm9yOiBzdHJpbmc7IGFjdGl2ZTogYm9vbGVhbjsgbWVzc2FnZT86IHN0cmluZyB9XG4+IHtcbiAgY29uc3QgaW50ZXJmYWNlVHlwZTogSW50ZXJmYWNlVHlwZSA9ICd2b2ljZSc7IC8vIFRoaXMgd3JhcHBlciBpcyBmb3Igdm9pY2UgaW50ZXJhY3Rpb25zXG4gIGNvbnN0IHsgdGV4dCB9ID0gcGF5bG9hZDtcbiAgY29uc29sZS5sb2coXG4gICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBSZWNlaXZlZCBjb252ZXJzYXRpb24gaW5wdXQ6IFwiJHt0ZXh0fVwiYFxuICApO1xuXG4gIGNvbnN0IHVzZXJJZCA9IGdldEN1cnJlbnRVc2VySWQoKTtcblxuICBjb252ZXJzYXRpb25NYW5hZ2VyLnJlY29yZFVzZXJJbnRlcmFjdGlvbihpbnRlcmZhY2VUeXBlLCB0ZXh0KTtcblxuICBpZiAoIWNvbnZlcnNhdGlvbk1hbmFnZXIuaXNDb252ZXJzYXRpb25BY3RpdmUoaW50ZXJmYWNlVHlwZSkpIHtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGBbSGFuZGxlcl1bJHtpbnRlcmZhY2VUeXBlfV0gQ29udmVyc2F0aW9uIGlzIG5vdCBhY3RpdmUuIElnbm9yaW5nIGlucHV0LmBcbiAgICApO1xuICAgIGNvbnZlcnNhdGlvbk1hbmFnZXIuc2V0QWdlbnRSZXNwb25kaW5nKGludGVyZmFjZVR5cGUsIGZhbHNlKTtcbiAgICByZXR1cm4ge1xuICAgICAgZXJyb3I6XG4gICAgICAgICdDb252ZXJzYXRpb24gbm90IGFjdGl2ZS4gUGxlYXNlIGFjdGl2YXRlIHdpdGggd2FrZSB3b3JkIG9yIGFjdGl2YXRpb24gY29tbWFuZC4nLFxuICAgICAgYWN0aXZlOiBjb252ZXJzYXRpb25NYW5hZ2VyLmlzQ29udmVyc2F0aW9uQWN0aXZlKGludGVyZmFjZVR5cGUpLFxuICAgICAgbWVzc2FnZTogJ0NvbnZlcnNhdGlvbiBpcyBub3QgYWN0aXZlLiBXYWtlIHdvcmQgb3IgYWN0aXZhdGlvbiBuZWVkZWQuJyxcbiAgICB9O1xuICB9XG5cbiAgaWYgKGNvbnZlcnNhdGlvbk1hbmFnZXIuY2hlY2tJZkFnZW50SXNSZXNwb25kaW5nKGludGVyZmFjZVR5cGUpKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBOZXcgaW5wdXQgcmVjZWl2ZWQgd2hpbGUgYWdlbnQgd2FzIHN0aWxsIG1hcmtlZCBhcyByZXNwb25kaW5nLmBcbiAgICApO1xuICAgIC8vIFRoaXMgaW1wbGllcyBhbiBpbnRlcnJ1cHRpb24sIHNvIGFnZW50IHNob3VsZCBzdG9wIGN1cnJlbnQgcmVzcG9uc2UuXG4gICAgY29udmVyc2F0aW9uTWFuYWdlci5zZXRBZ2VudFJlc3BvbmRpbmcoaW50ZXJmYWNlVHlwZSwgZmFsc2UpO1xuICB9XG5cbiAgY29udmVyc2F0aW9uTWFuYWdlci5zZXRBZ2VudFJlc3BvbmRpbmcoaW50ZXJmYWNlVHlwZSwgdHJ1ZSk7XG5cbiAgY29uc29sZS5sb2coXG4gICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBDb252ZXJzYXRpb24gYWN0aXZlLiBQcm9jZXNzaW5nIG1lc3NhZ2UuLi5gXG4gICk7XG4gIC8vIERlc3RydWN0dXJlIHN0cnVjdHVyZWREYXRhIGFzIHdlbGwgZnJvbSBfaW50ZXJuYWxIYW5kbGVNZXNzYWdlXG4gIGNvbnN0IHtcbiAgICB0ZXh0OiBjb3JlUmVzcG9uc2VUZXh0LFxuICAgIG5sdVJlc3BvbnNlLFxuICAgIHN0cnVjdHVyZWREYXRhOiBzdHJ1Y3R1cmVkRGF0YUZyb21JbnRlcm5hbCxcbiAgfSA9IGF3YWl0IF9pbnRlcm5hbEhhbmRsZU1lc3NhZ2UoXG4gICAgaW50ZXJmYWNlVHlwZSxcbiAgICB0ZXh0LFxuICAgIHVzZXJJZCxcbiAgICAvLyBQYXNzIHRoZSBzZW5kQ29tbWFuZFRvQ2xpZW50IGZ1bmN0aW9uIGluIG9wdGlvbnMgZm9yIHZvaWNlIGludGVyYWN0aW9uc1xuICAgIC8vIFRoaXMgbmVlZHMgdG8gYmUgY29ycmVjdGx5IGltcGxlbWVudGVkIGluIHRoZSBzZXJ2ZXIgbGF5ZXIgKGUuZy4gc2VydmVyLnRzIGZvciBXZWJTb2NrZXRzKVxuICAgIHtcbiAgICAgIHNlbmRDb21tYW5kVG9DbGllbnRGdW5jdGlvbjpcbiAgICAgICAgb3B0aW9uc0Zyb21DYWxsZXI/LnNlbmRDb21tYW5kVG9DbGllbnRGdW5jdGlvbixcbiAgICB9IC8vIEFzc3VtaW5nIG9wdGlvbnNGcm9tQ2FsbGVyIGlzIHBhc3NlZCB0byBoYW5kbGVDb252ZXJzYXRpb25JbnB1dFdyYXBwZXJcbiAgKTtcblxuICAvLyBSZWNvcmQgYWdlbnQncyBjb3JlIHRleHQgcmVzcG9uc2UgKGJlZm9yZSBUVFMpIGludG8gY29udmVyc2F0aW9uIGhpc3RvcnlcbiAgLy8gTkxVIHJlc3VsdHMgKGludGVudCwgZW50aXRpZXMpIGZyb20gdGhpcyB0dXJuIGNhbiBhbHNvIGJlIGFkZGVkIHRvIHR1cm5IaXN0b3J5IGhlcmUuXG4gIGNvbnN0IGN1cnJlbnRUdXJuSW50ZW50ID0gbmx1UmVzcG9uc2U/LmludGVudCB8fCB1bmRlZmluZWQ7XG4gIGNvbnN0IGN1cnJlbnRUdXJuRW50aXRpZXMgPSBubHVSZXNwb25zZT8uZW50aXRpZXMgfHwgdW5kZWZpbmVkO1xuICBjb252ZXJzYXRpb25NYW5hZ2VyLnJlY29yZEFnZW50UmVzcG9uc2UoXG4gICAgaW50ZXJmYWNlVHlwZSxcbiAgICB0ZXh0LFxuICAgIHsgdGV4dDogY29yZVJlc3BvbnNlVGV4dCB9LFxuICAgIGN1cnJlbnRUdXJuSW50ZW50LFxuICAgIGN1cnJlbnRUdXJuRW50aXRpZXNcbiAgKTtcblxuICAvLyBTVE0gdG8gTFRNIFByb2Nlc3NpbmcgKEZpcmUtYW5kLWZvcmdldCBmb3Igbm93KVxuICBpZiAobHRtRGJDb25uZWN0aW9uKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGN1cnJlbnRDb252ZXJzYXRpb25TdGF0ZSA9XG4gICAgICAgIGNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udmVyc2F0aW9uU3RhdGVTbmFwc2hvdChpbnRlcmZhY2VUeXBlKTtcbiAgICAgIHByb2Nlc3NTVE1Ub0xUTSh1c2VySWQsIGN1cnJlbnRDb252ZXJzYXRpb25TdGF0ZSwgbHRtRGJDb25uZWN0aW9uKVxuICAgICAgICAudGhlbigoKSA9PlxuICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBTVE0gdG8gTFRNIHByb2Nlc3NpbmcgaW5pdGlhdGVkLmBcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICAgLmNhdGNoKChlcnIpID0+XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICAgIGBbSGFuZGxlcl1bJHtpbnRlcmZhY2VUeXBlfV0gRXJyb3IgaW4gU1RNIHRvIExUTSBwcm9jZXNzaW5nOmAsXG4gICAgICAgICAgICBlcnJcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgIGBbSGFuZGxlcl1bJHtpbnRlcmZhY2VUeXBlfV0gRXJyb3IgaW5pdGlhdGluZyBTVE0gdG8gTFRNIHByb2Nlc3Npbmc6YCxcbiAgICAgICAgZXJyb3JcbiAgICAgICk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgICdbSGFuZGxlcl0gTFRNIERCIGNvbm5lY3Rpb24gbm90IGF2YWlsYWJsZSwgc2tpcHBpbmcgU1RNIHRvIExUTSBwcm9jZXNzaW5nLidcbiAgICApO1xuICB9XG5cbiAgLy8gVFRTIFN5bnRoZXNpcyAoYXMgYmVmb3JlKVxuICB0cnkge1xuICAgIGNvbnN0IHR0c1BheWxvYWQgPSB7IHRleHQ6IGNvcmVSZXNwb25zZVRleHQgfTtcbiAgICBjb25zdCB0dHNSZXNwb25zZSA9IGF3YWl0IGZldGNoKEFVRElPX1BST0NFU1NPUl9UVFNfVVJMLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodHRzUGF5bG9hZCksXG4gICAgfSk7XG5cbiAgICBpZiAodHRzUmVzcG9uc2Uub2spIHtcbiAgICAgIGNvbnN0IHR0c1Jlc3VsdCA9IGF3YWl0IHR0c1Jlc3BvbnNlLmpzb24oKTtcbiAgICAgIGlmICh0dHNSZXN1bHQuYXVkaW9fdXJsKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIGBbSGFuZGxlcl1bJHtpbnRlcmZhY2VUeXBlfV0gVFRTIHN5bnRoZXNpcyBzdWNjZXNzZnVsLiBBdWRpbyBVUkwgZ2VuZXJhdGVkLmBcbiAgICAgICAgKTtcbiAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlci5zZXRBZ2VudFJlc3BvbmRpbmcoaW50ZXJmYWNlVHlwZSwgZmFsc2UpOyAvLyBBZ2VudCBmaW5pc2hlZCBwcm9jZXNzaW5nIGFuZCByZXNwb25kaW5nXG4gICAgICAgIC8vIEluY2x1ZGUgc3RydWN0dXJlZERhdGEgaW4gdGhlIHJlc3BvbnNlIGlmIHByZXNlbnRcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0ZXh0OiBjb3JlUmVzcG9uc2VUZXh0LFxuICAgICAgICAgIGF1ZGlvVXJsOiB0dHNSZXN1bHQuYXVkaW9fdXJsLFxuICAgICAgICAgIHN0cnVjdHVyZWREYXRhOiBzdHJ1Y3R1cmVkRGF0YUZyb21JbnRlcm5hbCxcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBUVFMgcmVzcG9uc2UgT0ssIGJ1dCBubyBhdWRpb191cmw6YCxcbiAgICAgICAgICB0dHNSZXN1bHRcbiAgICAgICAgKTtcbiAgICAgICAgY29udmVyc2F0aW9uTWFuYWdlci5zZXRBZ2VudFJlc3BvbmRpbmcoaW50ZXJmYWNlVHlwZSwgZmFsc2UpOyAvLyBBZ2VudCBmaW5pc2hlZCBwcm9jZXNzaW5nICh3aXRoIGVycm9yKVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHRleHQ6IGNvcmVSZXNwb25zZVRleHQsXG4gICAgICAgICAgZXJyb3I6ICdUVFMgc3ludGhlc2lzIHN1Y2NlZWRlZCBidXQgbm8gYXVkaW8gVVJMIHdhcyByZXR1cm5lZC4nLFxuICAgICAgICAgIHN0cnVjdHVyZWREYXRhOiBzdHJ1Y3R1cmVkRGF0YUZyb21JbnRlcm5hbCxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZXJyb3JCb2R5ID0gYXdhaXQgdHRzUmVzcG9uc2UudGV4dCgpO1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBUVFMgcmVxdWVzdCBmYWlsZWQ6YCxcbiAgICAgICAgdHRzUmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICBlcnJvckJvZHlcbiAgICAgICk7XG4gICAgICBjb252ZXJzYXRpb25NYW5hZ2VyLnNldEFnZW50UmVzcG9uZGluZyhpbnRlcmZhY2VUeXBlLCBmYWxzZSk7IC8vIEFnZW50IGZpbmlzaGVkIHByb2Nlc3NpbmcgKHdpdGggZXJyb3IpXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0ZXh0OiBjb3JlUmVzcG9uc2VUZXh0LFxuICAgICAgICBlcnJvcjogYEZhaWxlZCB0byBzeW50aGVzaXplIGF1ZGlvLiBTdGF0dXM6ICR7dHRzUmVzcG9uc2Uuc3RhdHVzfWAsXG4gICAgICAgIHN0cnVjdHVyZWREYXRhOiBzdHJ1Y3R1cmVkRGF0YUZyb21JbnRlcm5hbCxcbiAgICAgIH07XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIGBbSGFuZGxlcl1bJHtpbnRlcmZhY2VUeXBlfV0gRXJyb3IgY2FsbGluZyBUVFMgc2VydmljZTpgLFxuICAgICAgZXJyb3IubWVzc2FnZSxcbiAgICAgIGVycm9yLnN0YWNrXG4gICAgKTtcbiAgICBjb252ZXJzYXRpb25NYW5hZ2VyLnNldEFnZW50UmVzcG9uZGluZyhpbnRlcmZhY2VUeXBlLCBmYWxzZSk7IC8vIEFnZW50IGZpbmlzaGVkIHByb2Nlc3NpbmcgKHdpdGggZXJyb3IpXG4gICAgcmV0dXJuIHtcbiAgICAgIHRleHQ6IGNvcmVSZXNwb25zZVRleHQsXG4gICAgICBlcnJvcjogJ0Vycm9yIG9jY3VycmVkIGR1cmluZyBhdWRpbyBzeW50aGVzaXMuJyxcbiAgICAgIHN0cnVjdHVyZWREYXRhOiBzdHJ1Y3R1cmVkRGF0YUZyb21JbnRlcm5hbCxcbiAgICB9O1xuICB9XG59XG5cbi8vIFRlbXBvcmFyeTogRGVmaW5lIG9wdGlvbnNGcm9tQ2FsbGVyIHR5cGUgaWYgbm90IHBhc3NlZCB0byBoYW5kbGVDb252ZXJzYXRpb25JbnB1dFdyYXBwZXJcbi8vIFRoaXMgaXMganVzdCBmb3IgdHlwZS1jaGVja2luZyB3aXRoaW4gdGhpcyBmaWxlLCBhY3R1YWwgaW1wbGVtZW50YXRpb24gaXMgaW4gdGhlIGNhbGxpbmcgc2VydmVyLlxuaW50ZXJmYWNlIFRlbXBPcHRpb25zRm9yQ2FsbGVyIHtcbiAgc2VuZENvbW1hbmRUb0NsaWVudEZ1bmN0aW9uPzogKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGNvbW1hbmQ6IEFnZW50Q2xpZW50Q29tbWFuZFxuICApID0+IFByb21pc2U8Ym9vbGVhbj47XG59XG4vLyBNYWtlIHN1cmUgaGFuZGxlQ29udmVyc2F0aW9uSW5wdXRXcmFwcGVyIHJlY2VpdmVzIG9wdGlvbnM6IFRlbXBPcHRpb25zRm9yQ2FsbGVyXG4vLyBleHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlQ29udmVyc2F0aW9uSW5wdXRXcmFwcGVyKFxuLy8gICBwYXlsb2FkOiB7IHRleHQ6IHN0cmluZyB9LFxuLy8gICBvcHRpb25zRnJvbUNhbGxlcj86IFRlbXBPcHRpb25zRm9yQ2FsbGVyIC8vIEFkZGVkIGZvciBwYXNzaW5nIHNlbmRDb21tYW5kVG9DbGllbnRcbi8vICk6IFByb21pc2U8SGFuZGxlTWVzc2FnZVJlc3BvbnNlIHwgeyBlcnJvcjogc3RyaW5nOyBhY3RpdmU6IGJvb2xlYW47IG1lc3NhZ2U/OiBzdHJpbmcgfT4geyAuLi4gfVxuXG4vKipcbiAqIFRoaXMgaXMgdGhlIG9yaWdpbmFsIGhhbmRsZU1lc3NhZ2UgZnVuY3Rpb24sIHByaW1hcmlseSBmb3IgSGFzdXJhIEFjdGlvbi5cbiAqIEl0IHJlbWFpbnMgbGFyZ2VseSBzdGF0ZWxlc3MgYW5kIGRvZXMgbm90IGludGVyYWN0IHdpdGggaXNBZ2VudFJlc3BvbmRpbmcgYnkgZGVmYXVsdC5cbiAqIElmIEhhc3VyYSBhY3Rpb25zIG5lZWQgdG8gYmUgcGFydCBvZiBjb252ZXJzYXRpb25hbCBmbG93LCB0aGlzIHdvdWxkIHJlcXVpcmUgbW9yZSB0aG91Z2h0LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlTWVzc2FnZShcbiAgbWVzc2FnZTogc3RyaW5nLFxuICBzZXR0aW5nczogYW55XG4pOiBQcm9taXNlPEhhbmRsZU1lc3NhZ2VSZXNwb25zZT4ge1xuICBjb25zdCBpbnRlcmZhY2VUeXBlOiBJbnRlcmZhY2VUeXBlID0gJ3RleHQnOyAvLyBUaGlzIGhhbmRsZXIgaXMgZm9yIHRleHQtYmFzZWQgaW50ZXJhY3Rpb25zIChlLmcuLCBIYXN1cmEpXG4gIGNvbnNvbGUubG9nKGBbSGFuZGxlcl1bJHtpbnRlcmZhY2VUeXBlfV0gUmVjZWl2ZWQgbWVzc2FnZTogXCIke21lc3NhZ2V9XCJgKTtcbiAgY29uc3QgdXNlcklkID0gZ2V0Q3VycmVudFVzZXJJZCgpO1xuXG4gIC8vIEhhc3VyYSBhY3Rpb25zIGFyZSB0eXBpY2FsbHkgaW5kZXBlbmRlbnQgYW5kIGRvbid0IHVzZSB0aGUgY29udmVyc2F0aW9uIHN0YXRlJ3MgaXNBZ2VudFJlc3BvbmRpbmcgZmxhZy5cbiAgLy8gSWYgdGhleSB3ZXJlIHRvLCBpdCB3b3VsZCBuZWVkIGNhcmVmdWwgY29uc2lkZXJhdGlvbiBvZiBob3cgdGhleSBmaXQgaW50byB0aGUgY29udmVyc2F0aW9uIGZsb3cuXG4gIC8vIGNvbnZlcnNhdGlvbk1hbmFnZXIuc2V0QWdlbnRSZXNwb25kaW5nKGludGVyZmFjZVR5cGUsIHRydWUpO1xuXG4gIC8vIEFjdGl2YXRlIGNvbnZlcnNhdGlvbiBmb3IgdGhpcyBpbnRlcmFjdGlvbiBpZiBub3QgYWxyZWFkeSBhY3RpdmUgKGZvciBMVE0gY29udGV4dCwgZXRjLilcbiAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgbW9kZWw7IGEgbW9yZSByb2J1c3Qgc3lzdGVtIG1pZ2h0IGhhdmUgZXhwbGljaXQgc2Vzc2lvbiBtYW5hZ2VtZW50IGZvciB0ZXh0LlxuICBpZiAoIWNvbnZlcnNhdGlvbk1hbmFnZXIuaXNDb252ZXJzYXRpb25BY3RpdmUoaW50ZXJmYWNlVHlwZSkpIHtcbiAgICBjb252ZXJzYXRpb25NYW5hZ2VyLmFjdGl2YXRlQ29udmVyc2F0aW9uKGludGVyZmFjZVR5cGUpO1xuICB9XG4gIGNvbnZlcnNhdGlvbk1hbmFnZXIucmVjb3JkVXNlckludGVyYWN0aW9uKGludGVyZmFjZVR5cGUsIG1lc3NhZ2UpO1xuXG4gIC8vIERlc3RydWN0dXJlIHN0cnVjdHVyZWREYXRhIGFzIHdlbGxcbiAgY29uc3Qge1xuICAgIHRleHQ6IGNvcmVSZXNwb25zZVRleHQsXG4gICAgbmx1UmVzcG9uc2UsXG4gICAgc3RydWN0dXJlZERhdGE6IHN0cnVjdHVyZWREYXRhRnJvbUludGVybmFsLFxuICB9ID0gYXdhaXQgX2ludGVybmFsSGFuZGxlTWVzc2FnZShcbiAgICBpbnRlcmZhY2VUeXBlLFxuICAgIG1lc3NhZ2UsXG4gICAgdXNlcklkLFxuICAgIHNldHRpbmdzLmxsbSxcbiAgICAvLyBGb3IgSGFzdXJhL3RleHQsIHNlbmRDb21tYW5kVG9DbGllbnQgaXMgdHlwaWNhbGx5IG5vdCBhdmFpbGFibGUgb3IgbmVlZGVkIHVubGVzcyBzcGVjaWZpY2FsbHkgZGVzaWduZWQuXG4gICAgLy8gU28sIHdlIG1pZ2h0IG5vdCBwYXNzIHNlbmRDb21tYW5kVG9DbGllbnRGdW5jdGlvbiBoZXJlLCBvciBwYXNzIGEgc3R1Yi5cbiAgICAvLyBGb3Igbm93LCBhc3N1bWluZyB0aGUgZGVmYXVsdCBzdHViIGluIF9pbnRlcm5hbEhhbmRsZU1lc3NhZ2UgaXMgc3VmZmljaWVudCBpZiBub3QgcHJvdmlkZWQuXG4gICAge30gLy8gRW1wdHkgb3B0aW9ucywgcmVseWluZyBvbiBkZWZhdWx0IHNlbmRDb21tYW5kVG9DbGllbnQgc3R1YiBpZiBza2lsbCBhdHRlbXB0cyB0byB1c2UgaXQuXG4gICk7XG5cbiAgLy8gUmVjb3JkIGFnZW50J3MgcmVzcG9uc2VcbiAgY29uc3QgY3VycmVudFR1cm5JbnRlbnQgPSBubHVSZXNwb25zZT8uaW50ZW50IHx8IHVuZGVmaW5lZDtcbiAgY29uc3QgY3VycmVudFR1cm5FbnRpdGllcyA9IG5sdVJlc3BvbnNlPy5lbnRpdGllcyB8fCB1bmRlZmluZWQ7XG4gIGNvbnZlcnNhdGlvbk1hbmFnZXIucmVjb3JkQWdlbnRSZXNwb25zZShcbiAgICBpbnRlcmZhY2VUeXBlLFxuICAgIG1lc3NhZ2UsXG4gICAgeyB0ZXh0OiBjb3JlUmVzcG9uc2VUZXh0IH0sXG4gICAgY3VycmVudFR1cm5JbnRlbnQsXG4gICAgY3VycmVudFR1cm5FbnRpdGllc1xuICApO1xuXG4gIC8vIFNUTSB0byBMVE0gUHJvY2Vzc2luZyBmb3IgdGV4dCBpbnRlcmZhY2UgYXMgd2VsbFxuICBpZiAobHRtRGJDb25uZWN0aW9uKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGN1cnJlbnRDb252ZXJzYXRpb25TdGF0ZSA9XG4gICAgICAgIGNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udmVyc2F0aW9uU3RhdGVTbmFwc2hvdChpbnRlcmZhY2VUeXBlKTtcbiAgICAgIHByb2Nlc3NTVE1Ub0xUTSh1c2VySWQsIGN1cnJlbnRDb252ZXJzYXRpb25TdGF0ZSwgbHRtRGJDb25uZWN0aW9uKVxuICAgICAgICAudGhlbigoKSA9PlxuICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBTVE0gdG8gTFRNIHByb2Nlc3NpbmcgaW5pdGlhdGVkLmBcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICAgLmNhdGNoKChlcnIpID0+XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICAgIGBbSGFuZGxlcl1bJHtpbnRlcmZhY2VUeXBlfV0gRXJyb3IgaW4gU1RNIHRvIExUTSBwcm9jZXNzaW5nOmAsXG4gICAgICAgICAgICBlcnJcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgYFtIYW5kbGVyXVske2ludGVyZmFjZVR5cGV9XSBFcnJvciBpbml0aWF0aW5nIFNUTSB0byBMVE0gcHJvY2Vzc2luZzpgLFxuICAgICAgICBlcnJvclxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvLyBGb3IgJ3RleHQnIGludGVyZmFjZSwgd2UgZG8gTk9UIGNhbGwgVFRTLlxuICAvLyBjb252ZXJzYXRpb25NYW5hZ2VyLnNldEFnZW50UmVzcG9uZGluZyhpbnRlcmZhY2VUeXBlLCBmYWxzZSk7IC8vIEFnZW50IGhhcyBmaW5pc2hlZC5cblxuICAvLyBEZWFjdGl2YXRlIGFmdGVyIHNpbmdsZSB0ZXh0IGludGVyYWN0aW9uLCB1bmxlc3MgYSBsb25nZXIgc2Vzc2lvbiBpcyBkZXNpcmVkLlxuICAvLyBGb3Igbm93LCBsZXQncyBhc3N1bWUgc2luZ2xlIGludGVyYWN0aW9uIGZvciBIYXN1cmEuXG4gIGNvbnZlcnNhdGlvbk1hbmFnZXIuZGVhY3RpdmF0ZUNvbnZlcnNhdGlvbihcbiAgICBpbnRlcmZhY2VUeXBlLFxuICAgICdjb21wbGV0ZWRfdGV4dF9pbnRlcmFjdGlvbidcbiAgKTtcblxuICAvLyBJbmNsdWRlIHN0cnVjdHVyZWREYXRhIGluIHRoZSByZXNwb25zZVxuICByZXR1cm4geyB0ZXh0OiBjb3JlUmVzcG9uc2VUZXh0LCBzdHJ1Y3R1cmVkRGF0YTogc3RydWN0dXJlZERhdGFGcm9tSW50ZXJuYWwgfTtcbn1cblxuLy8gRXhhbXBsZSBmb3IgdGVzdGluZyB0aGUgY29udmVyc2F0aW9uIHN0YXRlIChtYW51YWwgYWN0aXZhdGlvbilcbi8vIFRoaXMgd291bGQgYmUgbWFwcGVkIHRvIGFuIGVuZHBvaW50IGxpa2UgL2F0b20tYWdlbnQvdGVzdC1hY3RpdmF0ZVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRlc3RBY3RpdmF0ZUNvbnZlcnNhdGlvbigpIHtcbiAgLy8gVGVzdCB3aXRoICd2b2ljZScgaW50ZXJmYWNlIGJ5IGRlZmF1bHQgZm9yIHRoaXMgdGVzdCB3cmFwcGVyXG4gIGNvbnZlcnNhdGlvbk1hbmFnZXIuX3Rlc3Rfc2V0Q29udmVyc2F0aW9uQWN0aXZlKCd2b2ljZScsIHRydWUpOyAvLyBUaGlzIGl0c2VsZiBjYWxscyBhY3RpdmF0ZUNvbnZlcnNhdGlvbiBub3dcbiAgcmV0dXJuIHtcbiAgICBzdGF0dXM6XG4gICAgICAnQ29udmVyc2F0aW9uIG1hbnVhbGx5IGFjdGl2YXRlZCBmb3IgdGVzdGluZyAodm9pY2UgaW50ZXJmYWNlKSB2aWEgX3Rlc3Rfc2V0Q29udmVyc2F0aW9uQWN0aXZlLicsXG4gICAgYWN0aXZlOiBjb252ZXJzYXRpb25NYW5hZ2VyLmlzQ29udmVyc2F0aW9uQWN0aXZlKCd2b2ljZScpLFxuICAgIGFnZW50UmVzcG9uZGluZzogY29udmVyc2F0aW9uTWFuYWdlci5jaGVja0lmQWdlbnRJc1Jlc3BvbmRpbmcoJ3ZvaWNlJyksXG4gIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0RGVhY3RpdmF0ZUNvbnZlcnNhdGlvbigpIHtcbiAgLy8gVGVzdCB3aXRoICd2b2ljZScgaW50ZXJmYWNlIGJ5IGRlZmF1bHRcbiAgY29udmVyc2F0aW9uTWFuYWdlci5fdGVzdF9zZXRDb252ZXJzYXRpb25BY3RpdmUoJ3ZvaWNlJywgZmFsc2UpOyAvLyBUaGlzIGl0c2VsZiBjYWxscyBkZWFjdGl2YXRlQ29udmVyc2F0aW9uIG5vd1xuICByZXR1cm4ge1xuICAgIHN0YXR1czpcbiAgICAgICdDb252ZXJzYXRpb24gbWFudWFsbHkgZGVhY3RpdmF0ZWQgZm9yIHRlc3RpbmcgKHZvaWNlIGludGVyZmFjZSkgdmlhIF90ZXN0X3NldENvbnZlcnNhdGlvbkFjdGl2ZS4nLFxuICAgIGFjdGl2ZTogY29udmVyc2F0aW9uTWFuYWdlci5pc0NvbnZlcnNhdGlvbkFjdGl2ZSgndm9pY2UnKSxcbiAgICBhZ2VudFJlc3BvbmRpbmc6IGNvbnZlcnNhdGlvbk1hbmFnZXIuY2hlY2tJZkFnZW50SXNSZXNwb25kaW5nKCd2b2ljZScpLFxuICB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29udmVyc2F0aW9uU3RhdHVzKCkge1xuICAvLyBQcm92aWRlIHN0YXR1cyBmb3IgYm90aCBpbnRlcmZhY2VzXG4gIHJldHVybiB7XG4gICAgdm9pY2VfYWN0aXZlOiBjb252ZXJzYXRpb25NYW5hZ2VyLmlzQ29udmVyc2F0aW9uQWN0aXZlKCd2b2ljZScpLFxuICAgIHZvaWNlX2FnZW50UmVzcG9uZGluZzpcbiAgICAgIGNvbnZlcnNhdGlvbk1hbmFnZXIuY2hlY2tJZkFnZW50SXNSZXNwb25kaW5nKCd2b2ljZScpLFxuICAgIHRleHRfYWN0aXZlOiBjb252ZXJzYXRpb25NYW5hZ2VyLmlzQ29udmVyc2F0aW9uQWN0aXZlKCd0ZXh0JyksXG4gICAgdGV4dF9hZ2VudFJlc3BvbmRpbmc6IGNvbnZlcnNhdGlvbk1hbmFnZXIuY2hlY2tJZkFnZW50SXNSZXNwb25kaW5nKCd0ZXh0JyksXG4gICAgdm9pY2Vfc3RhdGU6IGNvbnZlcnNhdGlvbk1hbmFnZXIuZ2V0Q29udmVyc2F0aW9uU3RhdGVTbmFwc2hvdCgndm9pY2UnKSxcbiAgICB0ZXh0X3N0YXRlOiBjb252ZXJzYXRpb25NYW5hZ2VyLmdldENvbnZlcnNhdGlvblN0YXRlU25hcHNob3QoJ3RleHQnKSxcbiAgfTtcbn1cbiJdfQ==