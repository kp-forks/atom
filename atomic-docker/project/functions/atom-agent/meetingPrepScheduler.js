import { agenda } from '../agendaService';
import { listUpcomingEvents } from './skills/calendarSkills';
import { handleMeetingPrep } from './skills/meetingPrep';
agenda.define('generate meeting briefings', async (job) => {
    const { userId } = job.attrs.data;
    const events = await listUpcomingEvents(userId, 10);
    for (const event of events) {
        await handleMeetingPrep(userId, {
            meeting_title: event.summary,
            attendees: event.attendees,
        });
    }
});
(async function () {
    await agenda.start();
    await agenda.every('0 9 * * *', 'generate meeting briefings', {
        userId: 'mock_user_id_from_handler',
    });
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVldGluZ1ByZXBTY2hlZHVsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJtZWV0aW5nUHJlcFNjaGVkdWxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDMUMsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDN0QsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFekQsTUFBTSxDQUFDLE1BQU0sQ0FBQyw0QkFBNEIsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEVBQUU7SUFDeEQsTUFBTSxFQUFFLE1BQU0sRUFBRSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO0lBRWxDLE1BQU0sTUFBTSxHQUFHLE1BQU0sa0JBQWtCLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBRXBELEtBQUssTUFBTSxLQUFLLElBQUksTUFBTSxFQUFFLENBQUM7UUFDM0IsTUFBTSxpQkFBaUIsQ0FBQyxNQUFNLEVBQUU7WUFDOUIsYUFBYSxFQUFFLEtBQUssQ0FBQyxPQUFPO1lBQzVCLFNBQVMsRUFBRSxLQUFLLENBQUMsU0FBUztTQUMzQixDQUFDLENBQUM7SUFDTCxDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUM7QUFFSCxDQUFDLEtBQUs7SUFDSixNQUFNLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUNyQixNQUFNLE1BQU0sQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLDRCQUE0QixFQUFFO1FBQzVELE1BQU0sRUFBRSwyQkFBMkI7S0FDcEMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGFnZW5kYSB9IGZyb20gJy4uL2FnZW5kYVNlcnZpY2UnO1xuaW1wb3J0IHsgbGlzdFVwY29taW5nRXZlbnRzIH0gZnJvbSAnLi9za2lsbHMvY2FsZW5kYXJTa2lsbHMnO1xuaW1wb3J0IHsgaGFuZGxlTWVldGluZ1ByZXAgfSBmcm9tICcuL3NraWxscy9tZWV0aW5nUHJlcCc7XG5cbmFnZW5kYS5kZWZpbmUoJ2dlbmVyYXRlIG1lZXRpbmcgYnJpZWZpbmdzJywgYXN5bmMgKGpvYikgPT4ge1xuICBjb25zdCB7IHVzZXJJZCB9ID0gam9iLmF0dHJzLmRhdGE7XG5cbiAgY29uc3QgZXZlbnRzID0gYXdhaXQgbGlzdFVwY29taW5nRXZlbnRzKHVzZXJJZCwgMTApO1xuXG4gIGZvciAoY29uc3QgZXZlbnQgb2YgZXZlbnRzKSB7XG4gICAgYXdhaXQgaGFuZGxlTWVldGluZ1ByZXAodXNlcklkLCB7XG4gICAgICBtZWV0aW5nX3RpdGxlOiBldmVudC5zdW1tYXJ5LFxuICAgICAgYXR0ZW5kZWVzOiBldmVudC5hdHRlbmRlZXMsXG4gICAgfSk7XG4gIH1cbn0pO1xuXG4oYXN5bmMgZnVuY3Rpb24gKCkge1xuICBhd2FpdCBhZ2VuZGEuc3RhcnQoKTtcbiAgYXdhaXQgYWdlbmRhLmV2ZXJ5KCcwIDkgKiAqIConLCAnZ2VuZXJhdGUgbWVldGluZyBicmllZmluZ3MnLCB7XG4gICAgdXNlcklkOiAnbW9ja191c2VyX2lkX2Zyb21faGFuZGxlcicsXG4gIH0pO1xufSkoKTtcbiJdfQ==