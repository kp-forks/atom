"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const date_utils_1 = require("@lib/date-utils");
const react_1 = __importStar(require("react"));
const AudioModeContext_1 = require("@lib/contexts/AudioModeContext");
const chat_message_actions_1 = require("./chat-message-actions");
const email_content_copy_1 = require("./email-content-copy");
const utils_1 = require("@lib/Chat/utils"); // Import cn for class utility
// Dynamically import the SearchResultsDisplay component
const SearchResultsDisplay = react_1.default.lazy(() => import('./custom/SearchResultsDisplay'));
const MeetingPrepDisplay = react_1.default.lazy(() => import('./custom/MeetingPrepDisplay'));
const DailyBriefingDisplay = react_1.default.lazy(() => import('./custom/DailyBriefingDisplay'));
const ImageDisplay = react_1.default.lazy(() => import('./custom/ImageDisplay'));
const ChartDisplay = react_1.default.lazy(() => import('./custom/ChartDisplay'));
function Message({ message, isLoading, formData, htmlEmail }) {
    const divRef = (0, react_1.useRef)(null);
    const { isAudioModeEnabled, triggerReplyListen } = (0, AudioModeContext_1.useAudioMode)();
    (0, react_1.useEffect)(() => {
        if (isAudioModeEnabled && message.role === 'assistant' && message.content && !message.audioUrl) {
            const ttsErrorMessages = [
                "Failed to synthesize audio.",
                "Error occurred during audio synthesis.",
                "TTS synthesis succeeded but no audio URL was returned."
            ];
            const isTtsError = ttsErrorMessages.some(errMsg => message.content.includes(errMsg));
            if (isTtsError) {
                console.log("Message.tsx: TTS error detected in Audio Mode, playing error sound for message:", message.content);
                const errorAudio = new Audio('/assets/audio/tts_error.mp3');
                errorAudio.play().catch(e => console.error("Error playing TTS error sound:", e));
            }
        }
    }, [message.content, message.role, message.audioUrl, isAudioModeEnabled]);
    const isUser = message?.role === 'user';
    const bubbleBaseClasses = "group/item relative mb-2 px-4 py-3 max-w-xl lg:max-w-2xl break-words"; // Added break-words
    const userBubbleClasses = "bg-sky-600 text-white dark:bg-sky-500 dark:text-white rounded-2xl rounded-br-none";
    const assistantBubbleClasses = "bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100 rounded-2xl rounded-bl-none";
    const loadingBubbleClasses = "bg-gray-200 dark:bg-gray-600 rounded-2xl";
    return ((0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("flex w-full px-2 my-3 font-sans", isUser ? "justify-end" : "justify-start"), children: (0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)("flex flex-col", isUser ? "items-end" : "items-start"), children: [(0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("text-xs mb-1", isUser ? "text-right mr-1" : "text-left ml-1", "text-gray-600 dark:text-gray-400"), children: isUser ? "You" : "Assistant" }), isLoading && !isUser ? ((0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)(bubbleBaseClasses, loadingBubbleClasses, "flex items-center justify-center h-16 w-24"), children: [" ", (0, jsx_runtime_1.jsx)("div", { className: "dot-elastic" }), " "] })) : ((0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)(bubbleBaseClasses, isUser ? userBubbleClasses : assistantBubbleClasses, "text-base" // Ensure base font size for message content
                    ), children: [(0, jsx_runtime_1.jsx)(chat_message_actions_1.ChatMessageActions, { message: message, className: isUser ? "text-white dark:text-white" : "text-gray-700 dark:text-gray-200" }), (0, jsx_runtime_1.jsx)("div", { className: "whitespace-pre-wrap", children: message.content }), " ", message.audioUrl && !isUser && ( // Only show audio for assistant messages if needed
                        (0, jsx_runtime_1.jsx)("audio", { src: message.audioUrl, autoPlay: true, controls: false, style: { display: 'none' }, onEnded: () => {
                                if (isAudioModeEnabled) {
                                    console.log("Message.tsx: Audio ended, requesting listen for reply.");
                                    triggerReplyListen();
                                }
                            }, onError: (e) => console.error('Error playing audio in Message.tsx:', e) }, message.audioUrl))] })), (0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("text-xs mt-1 opacity-75", isUser ? "text-right mr-1" : "text-left ml-1", "text-gray-500 dark:text-gray-400"), children: (0, jsx_runtime_1.jsx)("time", { children: (0, date_utils_1.dayjs)(message.date).fromNow() }) }), !isUser && !isLoading && (htmlEmail || formData || message.customComponentType) && ((0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)("mt-2 w-full max-w-xl lg:max-w-2xl", isUser ? "ml-auto" : "mr-auto"), children: [" ", message.customComponentType === 'semantic_search_results' && message.customComponentProps?.results && ((0, jsx_runtime_1.jsx)(react_1.Suspense, { fallback: (0, jsx_runtime_1.jsx)("div", { className: "text-sm text-gray-500 dark:text-gray-400", children: "Loading search results..." }), children: (0, jsx_runtime_1.jsx)(SearchResultsDisplay, { results: message.customComponentProps.results }) })), message.customComponentType === 'meeting_prep_results' && message.customComponentProps?.briefing && ((0, jsx_runtime_1.jsx)(react_1.Suspense, { fallback: (0, jsx_runtime_1.jsx)("div", { className: "text-sm text-gray-500 dark:text-gray-400", children: "Loading meeting preparation..." }), children: (0, jsx_runtime_1.jsx)(MeetingPrepDisplay, { briefing: message.customComponentProps.briefing }) })), message.customComponentType === 'daily_briefing_results' && message.customComponentProps?.briefing && ((0, jsx_runtime_1.jsx)(react_1.Suspense, { fallback: (0, jsx_runtime_1.jsx)("div", { className: "text-sm text-gray-500 dark:text-gray-400", children: "Loading daily briefing..." }), children: (0, jsx_runtime_1.jsx)(DailyBriefingDisplay, { briefing: message.customComponentProps.briefing }) })), message.customComponentType === 'image_display' && message.customComponentProps?.imageUrl && ((0, jsx_runtime_1.jsx)(react_1.Suspense, { fallback: (0, jsx_runtime_1.jsx)("div", { className: "text-sm text-gray-500 dark:text-gray-400", children: "Loading image..." }), children: (0, jsx_runtime_1.jsx)(ImageDisplay, { imageUrl: message.customComponentProps.imageUrl }) })), message.customComponentType === 'chart_display' && message.customComponentProps?.data && ((0, jsx_runtime_1.jsx)(react_1.Suspense, { fallback: (0, jsx_runtime_1.jsx)("div", { className: "text-sm text-gray-500 dark:text-gray-400", children: "Loading chart..." }), children: (0, jsx_runtime_1.jsx)(ChartDisplay, { data: message.customComponentProps.data, chartType: message.customComponentProps.chartType }) })), htmlEmail && !message.customComponentType && ((0, jsx_runtime_1.jsxs)("div", { className: "group/email p-2 border rounded-lg bg-white dark:bg-gray-800 shadow", children: [(0, jsx_runtime_1.jsx)(email_content_copy_1.EmailContentCopy, { emailContent: divRef }), (0, jsx_runtime_1.jsx)("div", { ref: divRef, className: "prose dark:prose-invert max-w-none", dangerouslySetInnerHTML: { __html: htmlEmail } })] })), formData && !message.customComponentType && !htmlEmail && ((0, jsx_runtime_1.jsx)("div", { className: "p-2 border rounded-lg bg-white dark:bg-gray-800 shadow", children: formData }))] }))] }) }));
}
exports.default = Message;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWVzc2FnZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIk1lc3NhZ2UudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUNBLGdEQUF3QztBQUN4QywrQ0FBMkQ7QUFDM0QscUVBQThEO0FBQzlELGlFQUE0RDtBQUM1RCw2REFBd0Q7QUFDeEQsMkNBQXFDLENBQUMsOEJBQThCO0FBRXBFLHdEQUF3RDtBQUN4RCxNQUFNLG9CQUFvQixHQUFHLGVBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLCtCQUErQixDQUFDLENBQUMsQ0FBQztBQUN2RixNQUFNLGtCQUFrQixHQUFHLGVBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLDZCQUE2QixDQUFDLENBQUMsQ0FBQztBQUNuRixNQUFNLG9CQUFvQixHQUFHLGVBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLCtCQUErQixDQUFDLENBQUMsQ0FBQztBQUN2RixNQUFNLFlBQVksR0FBRyxlQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUM7QUFDdkUsTUFBTSxZQUFZLEdBQUcsZUFBSyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsdUJBQXVCLENBQUMsQ0FBQyxDQUFDO0FBVXZFLFNBQVMsT0FBTyxDQUFDLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFTO0lBQy9ELE1BQU0sTUFBTSxHQUFHLElBQUEsY0FBTSxFQUFpQixJQUFJLENBQUMsQ0FBQztJQUM1QyxNQUFNLEVBQUUsa0JBQWtCLEVBQUUsa0JBQWtCLEVBQUUsR0FBRyxJQUFBLCtCQUFZLEdBQUUsQ0FBQztJQUVsRSxJQUFBLGlCQUFTLEVBQUMsR0FBRyxFQUFFO1FB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LENBQ2QsRUFDQSxTQUFTLElBQUksQ0FBQyxPQUFPLENBQUMsbUJBQW1CLElBQUksQ0FDMUMsaUNBQUssU0FBUyxFQUFDLG9FQUFvRSxhQUMvRSx1QkFBQyxxQ0FBZ0IsSUFBQyxZQUFZLEVBQUUsTUFBTSxHQUFJLEVBQzFDLGdDQUFLLEdBQUcsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFDLG9DQUFvQyxFQUFDLHVCQUF1QixFQUFFLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxHQUFJLElBQ2pILENBQ1QsRUFDQSxRQUFRLElBQUksQ0FBQyxPQUFPLENBQUMsbUJBQW1CLElBQUksQ0FBQyxTQUFTLElBQUksQ0FDdkQsZ0NBQUssU0FBUyxFQUFDLHdEQUF3RCxZQUNsRSxRQUFRLEdBQ1AsQ0FDVCxJQUNDLENBQ1QsSUFDQyxHQUNKLENBQ1QsQ0FBQztBQUNOLENBQUM7QUFFRCxrQkFBZSxPQUFPLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBVc2VyQ2hhdFR5cGUgfSBmcm9tIFwiQGxpYi9kYXRhVHlwZXMvTWVzc2FnaW5nL01lc3NhZ2luZ1R5cGVzXCI7XG5pbXBvcnQgeyBkYXlqcyB9IGZyb20gXCJAbGliL2RhdGUtdXRpbHNcIjtcbmltcG9ydCBSZWFjdCwgeyB1c2VSZWYsIHVzZUVmZmVjdCwgU3VzcGVuc2UgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZUF1ZGlvTW9kZSB9IGZyb20gXCJAbGliL2NvbnRleHRzL0F1ZGlvTW9kZUNvbnRleHRcIjtcbmltcG9ydCB7IENoYXRNZXNzYWdlQWN0aW9ucyB9IGZyb20gXCIuL2NoYXQtbWVzc2FnZS1hY3Rpb25zXCI7XG5pbXBvcnQgeyBFbWFpbENvbnRlbnRDb3B5IH0gZnJvbSBcIi4vZW1haWwtY29udGVudC1jb3B5XCI7XG5pbXBvcnQgeyBjbiB9IGZyb20gXCJAbGliL0NoYXQvdXRpbHNcIjsgLy8gSW1wb3J0IGNuIGZvciBjbGFzcyB1dGlsaXR5XG5cbi8vIER5bmFtaWNhbGx5IGltcG9ydCB0aGUgU2VhcmNoUmVzdWx0c0Rpc3BsYXkgY29tcG9uZW50XG5jb25zdCBTZWFyY2hSZXN1bHRzRGlzcGxheSA9IFJlYWN0LmxhenkoKCkgPT4gaW1wb3J0KCcuL2N1c3RvbS9TZWFyY2hSZXN1bHRzRGlzcGxheScpKTtcbmNvbnN0IE1lZXRpbmdQcmVwRGlzcGxheSA9IFJlYWN0LmxhenkoKCkgPT4gaW1wb3J0KCcuL2N1c3RvbS9NZWV0aW5nUHJlcERpc3BsYXknKSk7XG5jb25zdCBEYWlseUJyaWVmaW5nRGlzcGxheSA9IFJlYWN0LmxhenkoKCkgPT4gaW1wb3J0KCcuL2N1c3RvbS9EYWlseUJyaWVmaW5nRGlzcGxheScpKTtcbmNvbnN0IEltYWdlRGlzcGxheSA9IFJlYWN0LmxhenkoKCkgPT4gaW1wb3J0KCcuL2N1c3RvbS9JbWFnZURpc3BsYXknKSk7XG5jb25zdCBDaGFydERpc3BsYXkgPSBSZWFjdC5sYXp5KCgpID0+IGltcG9ydCgnLi9jdXN0b20vQ2hhcnREaXNwbGF5JykpO1xuXG5cbnR5cGUgUHJvcHMgPSB7XG4gICAgbWVzc2FnZTogVXNlckNoYXRUeXBlLFxuICAgIGlzTG9hZGluZz86IGJvb2xlYW4sXG4gICAgZm9ybURhdGE/OiBSZWFjdC5SZWFjdE5vZGUsXG4gICAgaHRtbEVtYWlsPzogc3RyaW5nLFxufVxuXG5mdW5jdGlvbiBNZXNzYWdlKHsgbWVzc2FnZSwgaXNMb2FkaW5nLCBmb3JtRGF0YSwgaHRtbEVtYWlsIH06IFByb3BzKSB7XG4gICAgY29uc3QgZGl2UmVmID0gdXNlUmVmPEhUTUxEaXZFbGVtZW50PihudWxsKTtcbiAgICBjb25zdCB7IGlzQXVkaW9Nb2RlRW5hYmxlZCwgdHJpZ2dlclJlcGx5TGlzdGVuIH0gPSB1c2VBdWRpb01vZGUoKTtcblxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChpc0F1ZGlvTW9kZUVuYWJsZWQgJiYgbWVzc2FnZS5yb2xlID09PSAnYXNzaXN0YW50JyAmJiBtZXNzYWdlLmNvbnRlbnQgJiYgIW1lc3NhZ2UuYXVkaW9VcmwpIHtcbiAgICAgICAgICAgIGNvbnN0IHR0c0Vycm9yTWVzc2FnZXMgPSBbXG4gICAgICAgICAgICAgICAgXCJGYWlsZWQgdG8gc3ludGhlc2l6ZSBhdWRpby5cIixcbiAgICAgICAgICAgICAgICBcIkVycm9yIG9jY3VycmVkIGR1cmluZyBhdWRpbyBzeW50aGVzaXMuXCIsXG4gICAgICAgICAgICAgICAgXCJUVFMgc3ludGhlc2lzIHN1Y2NlZWRlZCBidXQgbm8gYXVkaW8gVVJMIHdhcyByZXR1cm5lZC5cIlxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGNvbnN0IGlzVHRzRXJyb3IgPSB0dHNFcnJvck1lc3NhZ2VzLnNvbWUoZXJyTXNnID0+IG1lc3NhZ2UuY29udGVudC5pbmNsdWRlcyhlcnJNc2cpKTtcblxuICAgICAgICAgICAgaWYgKGlzVHRzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1lc3NhZ2UudHN4OiBUVFMgZXJyb3IgZGV0ZWN0ZWQgaW4gQXVkaW8gTW9kZSwgcGxheWluZyBlcnJvciBzb3VuZCBmb3IgbWVzc2FnZTpcIiwgbWVzc2FnZS5jb250ZW50KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvckF1ZGlvID0gbmV3IEF1ZGlvKCcvYXNzZXRzL2F1ZGlvL3R0c19lcnJvci5tcDMnKTtcbiAgICAgICAgICAgICAgICBlcnJvckF1ZGlvLnBsYXkoKS5jYXRjaChlID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciBwbGF5aW5nIFRUUyBlcnJvciBzb3VuZDpcIiwgZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgW21lc3NhZ2UuY29udGVudCwgbWVzc2FnZS5yb2xlLCBtZXNzYWdlLmF1ZGlvVXJsLCBpc0F1ZGlvTW9kZUVuYWJsZWRdKTtcblxuICAgIGNvbnN0IGlzVXNlciA9IG1lc3NhZ2U/LnJvbGUgPT09ICd1c2VyJztcblxuICAgIGNvbnN0IGJ1YmJsZUJhc2VDbGFzc2VzID0gXCJncm91cC9pdGVtIHJlbGF0aXZlIG1iLTIgcHgtNCBweS0zIG1heC13LXhsIGxnOm1heC13LTJ4bCBicmVhay13b3Jkc1wiOyAvLyBBZGRlZCBicmVhay13b3Jkc1xuICAgIGNvbnN0IHVzZXJCdWJibGVDbGFzc2VzID0gXCJiZy1za3ktNjAwIHRleHQtd2hpdGUgZGFyazpiZy1za3ktNTAwIGRhcms6dGV4dC13aGl0ZSByb3VuZGVkLTJ4bCByb3VuZGVkLWJyLW5vbmVcIjtcbiAgICBjb25zdCBhc3Npc3RhbnRCdWJibGVDbGFzc2VzID0gXCJiZy1ncmF5LTEwMCB0ZXh0LWdyYXktODAwIGRhcms6YmctZ3JheS03MDAgZGFyazp0ZXh0LWdyYXktMTAwIHJvdW5kZWQtMnhsIHJvdW5kZWQtYmwtbm9uZVwiO1xuICAgIGNvbnN0IGxvYWRpbmdCdWJibGVDbGFzc2VzID0gXCJiZy1ncmF5LTIwMCBkYXJrOmJnLWdyYXktNjAwIHJvdW5kZWQtMnhsXCI7XG5cbiAgICByZXR1cm4gKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y24oXCJmbGV4IHctZnVsbCBweC0yIG15LTMgZm9udC1zYW5zXCIsIGlzVXNlciA/IFwianVzdGlmeS1lbmRcIiA6IFwianVzdGlmeS1zdGFydFwiKX0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y24oXCJmbGV4IGZsZXgtY29sXCIsIGlzVXNlciA/IFwiaXRlbXMtZW5kXCIgOiBcIml0ZW1zLXN0YXJ0XCIpfT5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y24oXCJ0ZXh0LXhzIG1iLTFcIiwgaXNVc2VyID8gXCJ0ZXh0LXJpZ2h0IG1yLTFcIiA6IFwidGV4dC1sZWZ0IG1sLTFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0ZXh0LWdyYXktNjAwIGRhcms6dGV4dC1ncmF5LTQwMFwiKX0+XG4gICAgICAgICAgICAgICAgICAgIHtpc1VzZXIgPyBcIllvdVwiIDogXCJBc3Npc3RhbnRcIn1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIHtpc0xvYWRpbmcgJiYgIWlzVXNlciA/IChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2NuKGJ1YmJsZUJhc2VDbGFzc2VzLCBsb2FkaW5nQnViYmxlQ2xhc3NlcywgXCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBoLTE2IHctMjRcIil9PiB7LyogQWRqdXN0ZWQgbG9hZGluZyBzdHlsZSAqL31cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZG90LWVsYXN0aWNcIj48L2Rpdj4gey8qIEFzc3VtaW5nIGRvdC1lbGFzdGljIGlzIGRlZmluZWQgZ2xvYmFsbHkgb3IgaW4gYSBDU1MgZmlsZSAqL31cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2NuKFxuICAgICAgICAgICAgICAgICAgICAgICAgYnViYmxlQmFzZUNsYXNzZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1VzZXIgPyB1c2VyQnViYmxlQ2xhc3NlcyA6IGFzc2lzdGFudEJ1YmJsZUNsYXNzZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRleHQtYmFzZVwiIC8vIEVuc3VyZSBiYXNlIGZvbnQgc2l6ZSBmb3IgbWVzc2FnZSBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgICl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPENoYXRNZXNzYWdlQWN0aW9ucyBtZXNzYWdlPXttZXNzYWdlfSBjbGFzc05hbWU9e2lzVXNlciA/IFwidGV4dC13aGl0ZSBkYXJrOnRleHQtd2hpdGVcIiA6IFwidGV4dC1ncmF5LTcwMCBkYXJrOnRleHQtZ3JheS0yMDBcIn0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2hpdGVzcGFjZS1wcmUtd3JhcFwiPnttZXNzYWdlLmNvbnRlbnR9PC9kaXY+IHsvKiBBZGRlZCB3aGl0ZXNwYWNlLXByZS13cmFwIGZvciB0ZXh0IGZvcm1hdHRpbmcgKi99XG4gICAgICAgICAgICAgICAgICAgICAgICB7bWVzc2FnZS5hdWRpb1VybCAmJiAhaXNVc2VyICYmICggLy8gT25seSBzaG93IGF1ZGlvIGZvciBhc3Npc3RhbnQgbWVzc2FnZXMgaWYgbmVlZGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGF1ZGlvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17bWVzc2FnZS5hdWRpb1VybH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjPXttZXNzYWdlLmF1ZGlvVXJsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvUGxheVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9scz17ZmFsc2V9IC8vIEtlZXAgY29udHJvbHMgaGlkZGVuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IGRpc3BsYXk6ICdub25lJyB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkVuZGVkPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBdWRpb01vZGVFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJNZXNzYWdlLnRzeDogQXVkaW8gZW5kZWQsIHJlcXVlc3RpbmcgbGlzdGVuIGZvciByZXBseS5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJpZ2dlclJlcGx5TGlzdGVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRXJyb3I9eyhlKSA9PiBjb25zb2xlLmVycm9yKCdFcnJvciBwbGF5aW5nIGF1ZGlvIGluIE1lc3NhZ2UudHN4OicsIGUpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbihcInRleHQteHMgbXQtMSBvcGFjaXR5LTc1XCIsIGlzVXNlciA/IFwidGV4dC1yaWdodCBtci0xXCIgOiBcInRleHQtbGVmdCBtbC0xXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGV4dC1ncmF5LTUwMCBkYXJrOnRleHQtZ3JheS00MDBcIil9PlxuICAgICAgICAgICAgICAgICAgICA8dGltZT57ZGF5anMobWVzc2FnZS5kYXRlKS5mcm9tTm93KCl9PC90aW1lPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgey8qIEN1c3RvbSBjb250ZW50IGRpc3BsYXkgYXJlYSwgZW5zdXJpbmcgaXQncyBvdXRzaWRlIHRoZSBtYWluIGJ1YmJsZSBidXQgYXNzb2NpYXRlZCB3aXRoIHRoZSBtZXNzYWdlICovfVxuICAgICAgICAgICAgICAgIHshaXNVc2VyICYmICFpc0xvYWRpbmcgJiYgKGh0bWxFbWFpbCB8fCBmb3JtRGF0YSB8fCBtZXNzYWdlLmN1c3RvbUNvbXBvbmVudFR5cGUpICYmIChcbiAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbihcIm10LTIgdy1mdWxsIG1heC13LXhsIGxnOm1heC13LTJ4bFwiLCBpc1VzZXIgPyBcIm1sLWF1dG9cIiA6IFwibXItYXV0b1wiKX0+IHsvKiBFbnN1cmUgY3VzdG9tIGNvbnRlbnQgYWxzbyByZXNwZWN0cyBtYXggd2lkdGggKi99XG4gICAgICAgICAgICAgICAgICAgICAgICB7bWVzc2FnZS5jdXN0b21Db21wb25lbnRUeXBlID09PSAnc2VtYW50aWNfc2VhcmNoX3Jlc3VsdHMnICYmIG1lc3NhZ2UuY3VzdG9tQ29tcG9uZW50UHJvcHM/LnJlc3VsdHMgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTdXNwZW5zZSBmYWxsYmFjaz17PGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS01MDAgZGFyazp0ZXh0LWdyYXktNDAwXCI+TG9hZGluZyBzZWFyY2ggcmVzdWx0cy4uLjwvZGl2Pn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTZWFyY2hSZXN1bHRzRGlzcGxheSByZXN1bHRzPXttZXNzYWdlLmN1c3RvbUNvbXBvbmVudFByb3BzLnJlc3VsdHN9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TdXNwZW5zZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICB7bWVzc2FnZS5jdXN0b21Db21wb25lbnRUeXBlID09PSAnbWVldGluZ19wcmVwX3Jlc3VsdHMnICYmIG1lc3NhZ2UuY3VzdG9tQ29tcG9uZW50UHJvcHM/LmJyaWVmaW5nICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U3VzcGVuc2UgZmFsbGJhY2s9ezxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNTAwIGRhcms6dGV4dC1ncmF5LTQwMFwiPkxvYWRpbmcgbWVldGluZyBwcmVwYXJhdGlvbi4uLjwvZGl2Pn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxNZWV0aW5nUHJlcERpc3BsYXkgYnJpZWZpbmc9e21lc3NhZ2UuY3VzdG9tQ29tcG9uZW50UHJvcHMuYnJpZWZpbmd9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9TdXNwZW5zZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICB7bWVzc2FnZS5jdXN0b21Db21wb25lbnRUeXBlID09PSAnZGFpbHlfYnJpZWZpbmdfcmVzdWx0cycgJiYgbWVzc2FnZS5jdXN0b21Db21wb25lbnRQcm9wcz8uYnJpZWZpbmcgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTdXNwZW5zZSBmYWxsYmFjaz17PGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS01MDAgZGFyazp0ZXh0LWdyYXktNDAwXCI+TG9hZGluZyBkYWlseSBicmllZmluZy4uLjwvZGl2Pn0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxEYWlseUJyaWVmaW5nRGlzcGxheSBicmllZmluZz17bWVzc2FnZS5jdXN0b21Db21wb25lbnRQcm9wcy5icmllZmluZ30gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1N1c3BlbnNlPlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHttZXNzYWdlLmN1c3RvbUNvbXBvbmVudFR5cGUgPT09ICdpbWFnZV9kaXNwbGF5JyAmJiBtZXNzYWdlLmN1c3RvbUNvbXBvbmVudFByb3BzPy5pbWFnZVVybCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPFN1c3BlbnNlIGZhbGxiYWNrPXs8ZGl2IGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1ncmF5LTUwMCBkYXJrOnRleHQtZ3JheS00MDBcIj5Mb2FkaW5nIGltYWdlLi4uPC9kaXY+fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEltYWdlRGlzcGxheSBpbWFnZVVybD17bWVzc2FnZS5jdXN0b21Db21wb25lbnRQcm9wcy5pbWFnZVVybH0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1N1c3BlbnNlPlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHttZXNzYWdlLmN1c3RvbUNvbXBvbmVudFR5cGUgPT09ICdjaGFydF9kaXNwbGF5JyAmJiBtZXNzYWdlLmN1c3RvbUNvbXBvbmVudFByb3BzPy5kYXRhICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U3VzcGVuc2UgZmFsbGJhY2s9ezxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LWdyYXktNTAwIGRhcms6dGV4dC1ncmF5LTQwMFwiPkxvYWRpbmcgY2hhcnQuLi48L2Rpdj59PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2hhcnREaXNwbGF5IGRhdGE9e21lc3NhZ2UuY3VzdG9tQ29tcG9uZW50UHJvcHMuZGF0YX0gY2hhcnRUeXBlPXttZXNzYWdlLmN1c3RvbUNvbXBvbmVudFByb3BzLmNoYXJ0VHlwZX0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1N1c3BlbnNlPlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHtodG1sRW1haWwgJiYgIW1lc3NhZ2UuY3VzdG9tQ29tcG9uZW50VHlwZSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncm91cC9lbWFpbCBwLTIgYm9yZGVyIHJvdW5kZWQtbGcgYmctd2hpdGUgZGFyazpiZy1ncmF5LTgwMCBzaGFkb3dcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEVtYWlsQ29udGVudENvcHkgZW1haWxDb250ZW50PXtkaXZSZWZ9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgcmVmPXtkaXZSZWZ9IGNsYXNzTmFtZT1cInByb3NlIGRhcms6cHJvc2UtaW52ZXJ0IG1heC13LW5vbmVcIiBkYW5nZXJvdXNseVNldElubmVySFRNTD17eyBfX2h0bWw6IGh0bWxFbWFpbCB9fSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHtmb3JtRGF0YSAmJiAhbWVzc2FnZS5jdXN0b21Db21wb25lbnRUeXBlICYmICFodG1sRW1haWwgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC0yIGJvcmRlciByb3VuZGVkLWxnIGJnLXdoaXRlIGRhcms6YmctZ3JheS04MDAgc2hhZG93XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtmb3JtRGF0YX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgTWVzc2FnZTtcbiJdfQ==